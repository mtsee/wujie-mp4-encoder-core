var __defProp=Object.defineProperty,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__publicField=(e,t,r)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,r),r),__accessCheck2=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},__privateGet2=(e,t,r)=>(__accessCheck2(e,t,"read from private field"),r?r.call(e):t.get(e)),__privateAdd2=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},__privateSet2=(e,t,r,i)=>(__accessCheck2(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),__privateWrapper2=(t,r,i,e)=>({set _(e){__privateSet2(t,r,e,i)},get _(){return __privateGet2(t,r,e)}}),_head,_tail,_size,commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(r){var t,i;return r.__esModule?r:("function"==typeof(t=r.default)?(i=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)}).prototype=t.prototype:i={},Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(r).forEach(function(e){var t=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(i,e,t.get?t:{enumerable:!0,get:function(){return r[e]}})}),i)}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={},hasRequiredReact_production_min;function requireReact_production_min(){var h,d,e,t,r,i,n,a,s,o,l,p,u,c,f,m,g,v,y,_,b,x,S;return hasRequiredReact_production_min||(hasRequiredReact_production_min=1,h=Symbol.for("react.element"),d=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),t=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),n=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),s=Symbol.for("react.suspense"),o=Symbol.for("react.memo"),l=Symbol.for("react.lazy"),p=Symbol.iterator,u={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},c=Object.assign,f={},T.prototype.isReactComponent={},T.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},T.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},E.prototype=T.prototype,(S=C.prototype=new E).constructor=C,c(S,T.prototype),S.isPureReactComponent=!0,m=Array.isArray,g=Object.prototype.hasOwnProperty,y={key:!0,ref:!0,__self:!0,__source:!0},_=/\/+/g,S={ReactCurrentDispatcher:b={current:null},ReactCurrentBatchConfig:x={transition:null},ReactCurrentOwner:v={current:null}},react_production_min.Children={map:I,forEach:function(e,t,r){I(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(w(e))return e;throw Error("React.Children.only expected to receive a single React element child.")}},react_production_min.Component=T,react_production_min.Fragment=e,react_production_min.Profiler=r,react_production_min.PureComponent=C,react_production_min.StrictMode=t,react_production_min.Suspense=s,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=S,react_production_min.act=R,react_production_min.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=c({},e.props),n=e.key,a=e.ref,s=e._owner;if(null!=t)for(o in void 0!==t.ref&&(a=t.ref,s=v.current),void 0!==t.key&&(n=""+t.key),e.type&&e.type.defaultProps&&(l=e.type.defaultProps),t)g.call(t,o)&&!y.hasOwnProperty(o)&&(i[o]=(void 0===t[o]&&void 0!==l?l:t)[o]);var o=arguments.length-2;if(1===o)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:h,type:e.type,key:n,ref:a,props:i,_owner:s}},react_production_min.createContext=function(e){return(e={$$typeof:n,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},react_production_min.createElement=A,react_production_min.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(e){return{$$typeof:a,render:e}},react_production_min.isValidElement=w,react_production_min.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:D}},react_production_min.memo=function(e,t){return{$$typeof:o,type:e,compare:void 0===t?null:t}},react_production_min.startTransition=function(e){var t=x.transition;x.transition={};try{e()}finally{x.transition=t}},react_production_min.unstable_act=R,react_production_min.useCallback=function(e,t){return b.current.useCallback(e,t)},react_production_min.useContext=function(e){return b.current.useContext(e)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(e){return b.current.useDeferredValue(e)},react_production_min.useEffect=function(e,t){return b.current.useEffect(e,t)},react_production_min.useId=function(){return b.current.useId()},react_production_min.useImperativeHandle=function(e,t,r){return b.current.useImperativeHandle(e,t,r)},react_production_min.useInsertionEffect=function(e,t){return b.current.useInsertionEffect(e,t)},react_production_min.useLayoutEffect=function(e,t){return b.current.useLayoutEffect(e,t)},react_production_min.useMemo=function(e,t){return b.current.useMemo(e,t)},react_production_min.useReducer=function(e,t,r){return b.current.useReducer(e,t,r)},react_production_min.useRef=function(e){return b.current.useRef(e)},react_production_min.useState=function(e){return b.current.useState(e)},react_production_min.useSyncExternalStore=function(e,t,r){return b.current.useSyncExternalStore(e,t,r)},react_production_min.useTransition=function(){return b.current.useTransition()},react_production_min.version="18.3.1"),react_production_min;function T(e,t,r){this.props=e,this.context=t,this.refs=f,this.updater=r||u}function E(){}function C(e,t,r){this.props=e,this.context=t,this.refs=f,this.updater=r||u}function A(e,t,r){var i,n={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)g.call(t,i)&&!y.hasOwnProperty(i)&&(n[i]=t[i]);var o=arguments.length-2;if(1===o)n.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];n.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps)void 0===n[i]&&(n[i]=o[i]);return{$$typeof:h,type:e,key:a,ref:s,props:n,_owner:v.current}}function w(e){return"object"==typeof e&&null!==e&&e.$$typeof===h}function P(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(e=""+e.key,r={"=":"=0",":":"=2"},"$"+e.replace(/[=:]/g,function(e){return r[e]})):t.toString(36);var r}function M(e,t,r,i,n){var a,s,o=!1;if(null===(e="undefined"!==(u=typeof e)&&"boolean"!==u?e:null))o=!0;else switch(u){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case h:case d:o=!0}}if(o)return n=n(o=e),e=""===i?"."+P(o,0):i,m(n)?(r="",M(n,t,r=null!=e?e.replace(_,"$&/")+"/":r,"",function(e){return e})):null!=n&&(w(n)&&(s=r+(!(a=n).key||o&&o.key===n.key?"":(""+n.key).replace(_,"$&/")+"/")+e,n={$$typeof:h,type:a.type,key:s,ref:a.ref,props:a.props,_owner:a._owner}),t.push(n)),1;if(o=0,i=""===i?".":i+":",m(e))for(var l=0;l<e.length;l++){var u,c=i+P(u=e[l],l);o+=M(u,t,r,c,n)}else if("function"==typeof(c=null!==(s=e)&&"object"==typeof s&&"function"==typeof(s=p&&s[p]||s["@@iterator"])?s:null))for(e=c.call(e),l=0;!(u=e.next()).done;)o+=M(u=u.value,t,r,c=i+P(u,l++),n);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function I(e,t,r){var i;return null==e||(i=0,M(e,e=[],"","",function(e){return t.call(r,e,i++)})),e}function D(t){var e;if(-1===t._status&&((e=(e=t._result)()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status)&&(t._status=0,t._result=e),1===t._status)return t._result.default;throw t._result}function R(){throw Error("act(...) is not supported in production builds of React.")}}react.exports=requireReact_production_min();var reactExports=react.exports,hasRequiredReactJsxRuntime_production_min;let React=getDefaultExportFromCjs(reactExports);function requireReactJsxRuntime_production_min(){var e,o,t,l,u,c;return hasRequiredReactJsxRuntime_production_min||(hasRequiredReactJsxRuntime_production_min=1,e=reactExports,o=Symbol.for("react.element"),t=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,u=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0},reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=r,reactJsxRuntime_production_min.jsxs=r),reactJsxRuntime_production_min;function r(e,t,r){var i,n={},a=null,s=null;for(i in void 0!==r&&(a=""+r),void 0!==t.key&&(a=""+t.key),void 0!==t.ref&&(s=t.ref),t)l.call(t,i)&&!c.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===n[i]&&(n[i]=t[i]);return{$$typeof:o,type:e,key:a,ref:s,props:n,_owner:u.current}}}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;let nanoid=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():62<t?"-":"_",""),config={MAX_TRACKINDEX:1e4,cdnHost:"https://cdn.h5ds.com",img404:"https://cdn.h5ds.com/assets/images/404.png",fps:60,emptyBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/1IApAAAAABJRU5ErkJggg=="};function arrayMap$3(e,t){for(var r=-1,i=null==e?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var _arrayMap=arrayMap$3,arrayMap$2=_arrayMap;function baseValues$1(t,e){return arrayMap$2(e,function(e){return t[e]})}var _baseValues=baseValues$1;function baseTimes$2(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var _baseTimes=baseTimes$2,freeGlobal$3="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal$3,freeGlobal$2=_freeGlobal,freeSelf$1="object"==typeof self&&self&&self.Object===Object&&self,root$b=freeGlobal$2||freeSelf$1||Function("return this")(),_root=root$b,root$a=_root,Symbol$7=root$a.Symbol,_Symbol=Symbol$7,Symbol$6=_Symbol,objectProto$r=Object.prototype,hasOwnProperty$l=objectProto$r.hasOwnProperty,nativeObjectToString$3=objectProto$r.toString,symToStringTag$3=Symbol$6?Symbol$6.toStringTag:void 0;function getRawTag$2(e){var t=hasOwnProperty$l.call(e,symToStringTag$3),r=e[symToStringTag$3];try{var i=!(e[symToStringTag$3]=void 0)}catch(e){}var n=nativeObjectToString$3.call(e);return i&&(t?e[symToStringTag$3]=r:delete e[symToStringTag$3]),n}var _getRawTag=getRawTag$2,objectProto$q=Object.prototype,nativeObjectToString$2=objectProto$q.toString;function objectToString$3(e){return nativeObjectToString$2.call(e)}var _objectToString=objectToString$3,Symbol$5=_Symbol,getRawTag$1=_getRawTag,objectToString$2=_objectToString,nullTag$1="[object Null]",undefinedTag$1="[object Undefined]",symToStringTag$2=Symbol$5?Symbol$5.toStringTag:void 0;function baseGetTag$6(e){return null==e?void 0===e?undefinedTag$1:nullTag$1:(symToStringTag$2&&symToStringTag$2 in Object(e)?getRawTag$1:objectToString$2)(e)}var _baseGetTag=baseGetTag$6;function isObjectLike$8(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike$8,baseGetTag$5=_baseGetTag,isObjectLike$7=isObjectLike_1,argsTag$6="[object Arguments]";function baseIsArguments$2(e){return isObjectLike$7(e)&&baseGetTag$5(e)==argsTag$6}var _baseIsArguments=baseIsArguments$2,baseIsArguments$1=_baseIsArguments,isObjectLike$6=isObjectLike_1,objectProto$p=Object.prototype,hasOwnProperty$k=objectProto$p.hasOwnProperty,propertyIsEnumerable$3=objectProto$p.propertyIsEnumerable,isArguments$4=baseIsArguments$1(function(){return arguments}())?baseIsArguments$1:function(e){return isObjectLike$6(e)&&hasOwnProperty$k.call(e,"callee")&&!propertyIsEnumerable$3.call(e,"callee")},isArguments_1=isArguments$4,isArray$g=Array.isArray,isArray_1=isArray$g,isBuffer$5={exports:{}};function stubFalse$1(){return!1}var stubFalse_1=stubFalse$1,isBufferExports=(isBuffer$5.exports,((e,t)=>{var r=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e,t=(r=r&&r.exports===t?_root.Buffer:void 0)?r.isBuffer:void 0;e.exports=t||stubFalse_1})(isBuffer$5,isBuffer$5.exports),isBuffer$5.exports),MAX_SAFE_INTEGER$3=9007199254740991,reIsUint$1=/^(?:0|[1-9]\d*)$/;function isIndex$4(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$3:t)&&("number"==r||"symbol"!=r&&reIsUint$1.test(e))&&-1<e&&e%1==0&&e<t}var _isIndex=isIndex$4,MAX_SAFE_INTEGER$2=9007199254740991;function isLength$4(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER$2}var isLength_1=isLength$4,baseGetTag$4=_baseGetTag,isLength$3=isLength_1,isObjectLike$5=isObjectLike_1,argsTag$5="[object Arguments]",arrayTag$4="[object Array]",boolTag$5="[object Boolean]",dateTag$5="[object Date]",errorTag$4="[object Error]",funcTag$5="[object Function]",mapTag$8="[object Map]",numberTag$5="[object Number]",objectTag$7="[object Object]",regexpTag$5="[object RegExp]",setTag$8="[object Set]",stringTag$5="[object String]",weakMapTag$5="[object WeakMap]",arrayBufferTag$5="[object ArrayBuffer]",dataViewTag$7="[object DataView]",float32Tag$4="[object Float32Array]",float64Tag$4="[object Float64Array]",int8Tag$4="[object Int8Array]",int16Tag$4="[object Int16Array]",int32Tag$4="[object Int32Array]",uint8Tag$4="[object Uint8Array]",uint8ClampedTag$4="[object Uint8ClampedArray]",uint16Tag$4="[object Uint16Array]",uint32Tag$4="[object Uint32Array]",typedArrayTags$1={};function baseIsTypedArray$2(e){return isObjectLike$5(e)&&isLength$3(e.length)&&!!typedArrayTags$1[baseGetTag$4(e)]}typedArrayTags$1[float32Tag$4]=typedArrayTags$1[float64Tag$4]=typedArrayTags$1[int8Tag$4]=typedArrayTags$1[int16Tag$4]=typedArrayTags$1[int32Tag$4]=typedArrayTags$1[uint8Tag$4]=typedArrayTags$1[uint8ClampedTag$4]=typedArrayTags$1[uint16Tag$4]=typedArrayTags$1[uint32Tag$4]=!0,typedArrayTags$1[argsTag$5]=typedArrayTags$1[arrayTag$4]=typedArrayTags$1[arrayBufferTag$5]=typedArrayTags$1[boolTag$5]=typedArrayTags$1[dataViewTag$7]=typedArrayTags$1[dateTag$5]=typedArrayTags$1[errorTag$4]=typedArrayTags$1[funcTag$5]=typedArrayTags$1[mapTag$8]=typedArrayTags$1[numberTag$5]=typedArrayTags$1[objectTag$7]=typedArrayTags$1[regexpTag$5]=typedArrayTags$1[setTag$8]=typedArrayTags$1[stringTag$5]=typedArrayTags$1[weakMapTag$5]=!1;var _baseIsTypedArray=baseIsTypedArray$2;function baseUnary$4(t){return function(e){return t(e)}}var _baseUnary=baseUnary$4,_nodeUtil={exports:{}},_nodeUtilExports=(_nodeUtil.exports,((e,t)=>{var r=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e,i=r&&r.exports===t&&_freeGlobal.process,t=(()=>{try{var e=r&&r.require&&r.require("util").types;return e?e:i&&i.binding&&i.binding("util")}catch(e){}})();e.exports=t})(_nodeUtil,_nodeUtil.exports),_nodeUtil.exports),baseIsTypedArray$1=_baseIsTypedArray,baseUnary$3=_baseUnary,nodeUtil$3=_nodeUtilExports,nodeIsTypedArray$1=nodeUtil$3&&nodeUtil$3.isTypedArray,isTypedArray$4=nodeIsTypedArray$1?baseUnary$3(nodeIsTypedArray$1):baseIsTypedArray$1,isTypedArray_1=isTypedArray$4,baseTimes$1=_baseTimes,isArguments$3=isArguments_1,isArray$f=isArray_1,isBuffer$4=isBufferExports,isIndex$3=_isIndex,isTypedArray$3=isTypedArray_1,objectProto$o=Object.prototype,hasOwnProperty$j=objectProto$o.hasOwnProperty;function arrayLikeKeys$3(e,t){var r,i=isArray$f(e),n=!i&&isArguments$3(e),a=!i&&!n&&isBuffer$4(e),s=!i&&!n&&!a&&isTypedArray$3(e),o=i||n||a||s,l=o?baseTimes$1(e.length,String):[],u=l.length;for(r in e)!t&&!hasOwnProperty$j.call(e,r)||o&&("length"==r||a&&("offset"==r||"parent"==r)||s&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||isIndex$3(r,u))||l.push(r);return l}var _arrayLikeKeys=arrayLikeKeys$3,objectProto$n=Object.prototype;function isPrototype$4(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$n)}var _isPrototype=isPrototype$4;function overArg$3(t,r){return function(e){return t(r(e))}}var _overArg=overArg$3,overArg$2=_overArg,nativeKeys$3=overArg$2(Object.keys,Object),_nativeKeys=nativeKeys$3,isPrototype$3=_isPrototype,nativeKeys$2=_nativeKeys,objectProto$m=Object.prototype,hasOwnProperty$i=objectProto$m.hasOwnProperty;function baseKeys$2(e){if(!isPrototype$3(e))return nativeKeys$2(e);var t,r=[];for(t in Object(e))hasOwnProperty$i.call(e,t)&&"constructor"!=t&&r.push(t);return r}var _baseKeys=baseKeys$2;function isObject$a(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject$a,baseGetTag$3=_baseGetTag,isObject$9=isObject_1,asyncTag$1="[object AsyncFunction]",funcTag$4="[object Function]",genTag$3="[object GeneratorFunction]",proxyTag$1="[object Proxy]";function isFunction$4(e){return!!isObject$9(e)&&((e=baseGetTag$3(e))==funcTag$4||e==genTag$3||e==asyncTag$1||e==proxyTag$1)}var isFunction_1=isFunction$4,isFunction$3=isFunction_1,isLength$2=isLength_1;function isArrayLike$4(e){return null!=e&&isLength$2(e.length)&&!isFunction$3(e)}var isArrayLike_1=isArrayLike$4,arrayLikeKeys$2=_arrayLikeKeys,baseKeys$1=_baseKeys,isArrayLike$3=isArrayLike_1;function keys$7(e){return(isArrayLike$3(e)?arrayLikeKeys$2:baseKeys$1)(e)}var keys_1=keys$7,baseValues=_baseValues,keys$6=keys_1;function values(e){return null==e?[]:baseValues(e,keys$6(e))}var values_1=values;let values$1=getDefaultExportFromCjs(values_1);var root$9=_root,coreJsData$3=root$9["__core-js_shared__"],_coreJsData=coreJsData$3,coreJsData$2=_coreJsData,maskSrcKey$1=(()=>{var e=/[^.]+$/.exec(coreJsData$2&&coreJsData$2.keys&&coreJsData$2.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function isMasked$2(e){return!!maskSrcKey$1&&maskSrcKey$1 in e}var _isMasked=isMasked$2,funcProto$4=Function.prototype,funcToString$4=funcProto$4.toString;function toSource$3(e){if(null!=e){try{return funcToString$4.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource$3,isFunction$2=isFunction_1,isMasked$1=_isMasked,isObject$8=isObject_1,toSource$2=_toSource,reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor$1=/^\[object .+?Constructor\]$/,funcProto$3=Function.prototype,objectProto$l=Object.prototype,funcToString$3=funcProto$3.toString,hasOwnProperty$h=objectProto$l.hasOwnProperty,reIsNative$1=RegExp("^"+funcToString$3.call(hasOwnProperty$h).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative$2(e){return!(!isObject$8(e)||isMasked$1(e))&&(isFunction$2(e)?reIsNative$1:reIsHostCtor$1).test(toSource$2(e))}var _baseIsNative=baseIsNative$2;function getValue$2(e,t){return null==e?void 0:e[t]}var _getValue=getValue$2,baseIsNative$1=_baseIsNative,getValue$1=_getValue;function getNative$8(e,t){e=getValue$1(e,t);return baseIsNative$1(e)?e:void 0}var _getNative=getNative$8,getNative$7=_getNative,defineProperty$3=(()=>{try{var e=getNative$7(Object,"defineProperty");return e({},"",{}),e}catch(e){}})(),_defineProperty=defineProperty$3,defineProperty$2=_defineProperty;function baseAssignValue$4(e,t,r){"__proto__"==t&&defineProperty$2?defineProperty$2(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var _baseAssignValue=baseAssignValue$4;function arrayAggregator$1(e,t,r,i){for(var n=-1,a=null==e?0:e.length;++n<a;){var s=e[n];t(i,s,r(s),e)}return i}var _arrayAggregator=arrayAggregator$1;function createBaseFor$1(l){return function(e,t,r){for(var i=-1,n=Object(e),a=r(e),s=a.length;s--;){var o=a[l?s:++i];if(!1===t(n[o],o,n))break}return e}}var _createBaseFor=createBaseFor$1,createBaseFor=_createBaseFor,baseFor$1=createBaseFor(),_baseFor=baseFor$1,baseFor=_baseFor,keys$5=keys_1;function baseForOwn$1(e,t){return e&&baseFor(e,t,keys$5)}var _baseForOwn=baseForOwn$1,isArrayLike$2=isArrayLike_1;function createBaseEach$1(a,s){return function(e,t){if(null!=e){if(!isArrayLike$2(e))return a(e,t);for(var r=e.length,i=s?r:-1,n=Object(e);(s?i--:++i<r)&&!1!==t(n[i],i,n););}return e}}var _createBaseEach=createBaseEach$1,baseForOwn=_baseForOwn,createBaseEach=_createBaseEach,baseEach$1=createBaseEach(baseForOwn),_baseEach=baseEach$1,baseEach=_baseEach;function baseAggregator$1(e,i,n,a){return baseEach(e,function(e,t,r){i(a,e,n(e),r)}),a}var _baseAggregator=baseAggregator$1;function listCacheClear$2(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear$2;function eq$4(e,t){return e===t||e!=e&&t!=t}var eq_1=eq$4,eq$3=eq_1;function assocIndexOf$5(e,t){for(var r=e.length;r--;)if(eq$3(e[r][0],t))return r;return-1}var _assocIndexOf=assocIndexOf$5,assocIndexOf$4=_assocIndexOf,arrayProto$2=Array.prototype,splice$2=arrayProto$2.splice;function listCacheDelete$2(e){var t=this.__data__,e=assocIndexOf$4(t,e);return!(e<0||(e==t.length-1?t.pop():splice$2.call(t,e,1),--this.size,0))}var _listCacheDelete=listCacheDelete$2,assocIndexOf$3=_assocIndexOf;function listCacheGet$2(e){var t=this.__data__,e=assocIndexOf$3(t,e);return e<0?void 0:t[e][1]}var _listCacheGet=listCacheGet$2,assocIndexOf$2=_assocIndexOf;function listCacheHas$2(e){return-1<assocIndexOf$2(this.__data__,e)}var _listCacheHas=listCacheHas$2,assocIndexOf$1=_assocIndexOf;function listCacheSet$2(e,t){var r=this.__data__,i=assocIndexOf$1(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var _listCacheSet=listCacheSet$2,listCacheClear$1=_listCacheClear,listCacheDelete$1=_listCacheDelete,listCacheGet$1=_listCacheGet,listCacheHas$1=_listCacheHas,listCacheSet$1=_listCacheSet;function ListCache$5(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}ListCache$5.prototype.clear=listCacheClear$1,ListCache$5.prototype.delete=listCacheDelete$1,ListCache$5.prototype.get=listCacheGet$1,ListCache$5.prototype.has=listCacheHas$1,ListCache$5.prototype.set=listCacheSet$1;var _ListCache=ListCache$5,ListCache$4=_ListCache;function stackClear$2(){this.__data__=new ListCache$4,this.size=0}var _stackClear=stackClear$2;function stackDelete$2(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}var _stackDelete=stackDelete$2;function stackGet$2(e){return this.__data__.get(e)}var _stackGet=stackGet$2;function stackHas$2(e){return this.__data__.has(e)}var _stackHas=stackHas$2,getNative$6=_getNative,root$8=_root,Map$5=getNative$6(root$8,"Map"),_Map=Map$5,getNative$5=_getNative,nativeCreate$6=getNative$5(Object,"create"),_nativeCreate=nativeCreate$6,nativeCreate$5=_nativeCreate;function hashClear$2(){this.__data__=nativeCreate$5?nativeCreate$5(null):{},this.size=0}var _hashClear=hashClear$2;function hashDelete$2(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e}var _hashDelete=hashDelete$2,nativeCreate$4=_nativeCreate,HASH_UNDEFINED$4="__lodash_hash_undefined__",objectProto$k=Object.prototype,hasOwnProperty$g=objectProto$k.hasOwnProperty;function hashGet$2(e){var t,r=this.__data__;return nativeCreate$4?(t=r[e])===HASH_UNDEFINED$4?void 0:t:hasOwnProperty$g.call(r,e)?r[e]:void 0}var _hashGet=hashGet$2,nativeCreate$3=_nativeCreate,objectProto$j=Object.prototype,hasOwnProperty$f=objectProto$j.hasOwnProperty;function hashHas$2(e){var t=this.__data__;return nativeCreate$3?void 0!==t[e]:hasOwnProperty$f.call(t,e)}var _hashHas=hashHas$2,nativeCreate$2=_nativeCreate,HASH_UNDEFINED$3="__lodash_hash_undefined__";function hashSet$2(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate$2&&void 0===t?HASH_UNDEFINED$3:t,this}var _hashSet=hashSet$2,hashClear$1=_hashClear,hashDelete$1=_hashDelete,hashGet$1=_hashGet,hashHas$1=_hashHas,hashSet$1=_hashSet;function Hash$2(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Hash$2.prototype.clear=hashClear$1,Hash$2.prototype.delete=hashDelete$1,Hash$2.prototype.get=hashGet$1,Hash$2.prototype.has=hashHas$1,Hash$2.prototype.set=hashSet$1;var _Hash=Hash$2,Hash$1=_Hash,ListCache$3=_ListCache,Map$4=_Map;function mapCacheClear$2(){this.size=0,this.__data__={hash:new Hash$1,map:new(Map$4||ListCache$3),string:new Hash$1}}var _mapCacheClear=mapCacheClear$2;function isKeyable$2(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable$2,isKeyable$1=_isKeyable;function getMapData$5(e,t){e=e.__data__;return isKeyable$1(t)?e["string"==typeof t?"string":"hash"]:e.map}var _getMapData=getMapData$5,getMapData$4=_getMapData;function mapCacheDelete$2(e){e=getMapData$4(this,e).delete(e);return this.size-=e?1:0,e}var _mapCacheDelete=mapCacheDelete$2,getMapData$3=_getMapData;function mapCacheGet$2(e){return getMapData$3(this,e).get(e)}var _mapCacheGet=mapCacheGet$2,getMapData$2=_getMapData;function mapCacheHas$2(e){return getMapData$2(this,e).has(e)}var _mapCacheHas=mapCacheHas$2,getMapData$1=_getMapData;function mapCacheSet$2(e,t){var r=getMapData$1(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var _mapCacheSet=mapCacheSet$2,mapCacheClear$1=_mapCacheClear,mapCacheDelete$1=_mapCacheDelete,mapCacheGet$1=_mapCacheGet,mapCacheHas$1=_mapCacheHas,mapCacheSet$1=_mapCacheSet;function MapCache$4(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}MapCache$4.prototype.clear=mapCacheClear$1,MapCache$4.prototype.delete=mapCacheDelete$1,MapCache$4.prototype.get=mapCacheGet$1,MapCache$4.prototype.has=mapCacheHas$1,MapCache$4.prototype.set=mapCacheSet$1;var _MapCache=MapCache$4,ListCache$2=_ListCache,Map$3=_Map,MapCache$3=_MapCache,LARGE_ARRAY_SIZE$1=200;function stackSet$2(e,t){var r=this.__data__;if(r instanceof ListCache$2){var i=r.__data__;if(!Map$3||i.length<LARGE_ARRAY_SIZE$1-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache$3(i)}return r.set(e,t),this.size=r.size,this}var _stackSet=stackSet$2,ListCache$1=_ListCache,stackClear$1=_stackClear,stackDelete$1=_stackDelete,stackGet$1=_stackGet,stackHas$1=_stackHas,stackSet$1=_stackSet;function Stack$4(e){e=this.__data__=new ListCache$1(e);this.size=e.size}Stack$4.prototype.clear=stackClear$1,Stack$4.prototype.delete=stackDelete$1,Stack$4.prototype.get=stackGet$1,Stack$4.prototype.has=stackHas$1,Stack$4.prototype.set=stackSet$1;var _Stack=Stack$4,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd$1(e){return this.__data__.set(e,HASH_UNDEFINED$2),this}var _setCacheAdd=setCacheAdd$1;function setCacheHas$1(e){return this.__data__.has(e)}var _setCacheHas=setCacheHas$1,MapCache$2=_MapCache,setCacheAdd=_setCacheAdd,setCacheHas=_setCacheHas;function SetCache$1(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new MapCache$2;++t<r;)this.add(e[t])}SetCache$1.prototype.add=SetCache$1.prototype.push=setCacheAdd,SetCache$1.prototype.has=setCacheHas;var _SetCache=SetCache$1;function arraySome$1(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var _arraySome=arraySome$1;function cacheHas$1(e,t){return e.has(t)}var _cacheHas=cacheHas$1,SetCache=_SetCache,arraySome=_arraySome,cacheHas=_cacheHas,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays$2(e,t,r,i,n,a){var s=r&COMPARE_PARTIAL_FLAG$5,o=e.length,l=t.length;if(o!=l&&!(s&&o<l))return!1;var l=a.get(e),u=a.get(t);if(l&&u)return l==t&&u==e;var c=-1,h=!0,d=r&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(a.set(e,t),a.set(t,e);++c<o;){var p,f=e[c],m=t[c];if(void 0!==(p=i?s?i(m,f,c,t,e,a):i(f,m,c,e,t,a):p)){if(p)continue;h=!1;break}if(d){if(!arraySome(t,function(e,t){if(!cacheHas(d,t)&&(f===e||n(f,e,r,i,a)))return d.push(t)})){h=!1;break}}else if(f!==m&&!n(f,m,r,i,a)){h=!1;break}}return a.delete(e),a.delete(t),h}var _equalArrays=equalArrays$2,root$7=_root,Uint8Array$4=root$7.Uint8Array,_Uint8Array=Uint8Array$4;function mapToArray$1(e){var r=-1,i=Array(e.size);return e.forEach(function(e,t){i[++r]=[t,e]}),i}var _mapToArray=mapToArray$1;function setToArray$1(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var _setToArray=setToArray$1,Symbol$4=_Symbol,Uint8Array$3=_Uint8Array,eq$2=eq_1,equalArrays$1=_equalArrays,mapToArray=_mapToArray,setToArray=_setToArray,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$4="[object Boolean]",dateTag$4="[object Date]",errorTag$3="[object Error]",mapTag$7="[object Map]",numberTag$4="[object Number]",regexpTag$4="[object RegExp]",setTag$7="[object Set]",stringTag$4="[object String]",symbolTag$5="[object Symbol]",arrayBufferTag$4="[object ArrayBuffer]",dataViewTag$6="[object DataView]",symbolProto$4=Symbol$4?Symbol$4.prototype:void 0,symbolValueOf$2=symbolProto$4?symbolProto$4.valueOf:void 0;function equalByTag$1(e,t,r,i,n,a,s){switch(r){case dataViewTag$6:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$4:return e.byteLength==t.byteLength&&a(new Uint8Array$3(e),new Uint8Array$3(t))?!0:!1;case boolTag$4:case dateTag$4:case numberTag$4:return eq$2(+e,+t);case errorTag$3:return e.name==t.name&&e.message==t.message;case regexpTag$4:case stringTag$4:return e==t+"";case mapTag$7:var o=mapToArray;case setTag$7:o=o||setToArray;if(e.size!=t.size&&!(i&COMPARE_PARTIAL_FLAG$4))return!1;var l=s.get(e);if(l)return l==t;i|=COMPARE_UNORDERED_FLAG$2,s.set(e,t);l=equalArrays$1(o(e),o(t),i,n,a,s);return s.delete(e),l;case symbolTag$5:if(symbolValueOf$2)return symbolValueOf$2.call(e)==symbolValueOf$2.call(t)}return!1}var _equalByTag=equalByTag$1;function arrayPush$3(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var _arrayPush=arrayPush$3,arrayPush$2=_arrayPush,isArray$e=isArray_1;function baseGetAllKeys$3(e,t,r){t=t(e);return isArray$e(e)?t:arrayPush$2(t,r(e))}var _baseGetAllKeys=baseGetAllKeys$3;function arrayFilter$2(e,t){for(var r=-1,i=null==e?0:e.length,n=0,a=[];++r<i;){var s=e[r];t(s,r,e)&&(a[n++]=s)}return a}var _arrayFilter=arrayFilter$2;function stubArray$3(){return[]}var stubArray_1=stubArray$3,arrayFilter$1=_arrayFilter,stubArray$2=stubArray_1,objectProto$i=Object.prototype,propertyIsEnumerable$2=objectProto$i.propertyIsEnumerable,nativeGetSymbols$3=Object.getOwnPropertySymbols,getSymbols$4=nativeGetSymbols$3?function(t){return null==t?[]:(t=Object(t),arrayFilter$1(nativeGetSymbols$3(t),function(e){return propertyIsEnumerable$2.call(t,e)}))}:stubArray$2,_getSymbols=getSymbols$4,baseGetAllKeys$2=_baseGetAllKeys,getSymbols$3=_getSymbols,keys$4=keys_1;function getAllKeys$3(e){return baseGetAllKeys$2(e,keys$4,getSymbols$3)}var _getAllKeys=getAllKeys$3,getAllKeys$2=_getAllKeys,COMPARE_PARTIAL_FLAG$3=1,objectProto$h=Object.prototype,hasOwnProperty$e=objectProto$h.hasOwnProperty;function equalObjects$1(e,t,r,i,n,a){var s=r&COMPARE_PARTIAL_FLAG$3,o=getAllKeys$2(e),l=o.length;if(l!=getAllKeys$2(t).length&&!s)return!1;for(var u=l;u--;){var c=o[u];if(!(s?c in t:hasOwnProperty$e.call(t,c)))return!1}var h=a.get(e),d=a.get(t);if(h&&d)return h==t&&d==e;for(var p=!0,f=(a.set(e,t),a.set(t,e),s);++u<l;){var m,g=e[c=o[u]],v=t[c];if(!(void 0===(m=i?s?i(v,g,c,t,e,a):i(g,v,c,e,t,a):m)?g===v||n(g,v,r,i,a):m)){p=!1;break}f=f||"constructor"==c}return p&&!f&&(h=e.constructor)!=(d=t.constructor)&&"constructor"in e&&"constructor"in t&&!("function"==typeof h&&h instanceof h&&"function"==typeof d&&d instanceof d)&&(p=!1),a.delete(e),a.delete(t),p}var _equalObjects=equalObjects$1,getNative$4=_getNative,root$6=_root,DataView$3=getNative$4(root$6,"DataView"),_DataView=DataView$3,getNative$3=_getNative,root$5=_root,Promise$4=getNative$3(root$5,"Promise"),_Promise=Promise$4,getNative$2=_getNative,root$4=_root,Set$3=getNative$2(root$4,"Set"),_Set=Set$3,getNative$1=_getNative,root$3=_root,WeakMap$3=getNative$1(root$3,"WeakMap"),_WeakMap=WeakMap$3,DataView$2=_DataView,Map$2=_Map,Promise$3=_Promise,Set$2=_Set,WeakMap$2=_WeakMap,baseGetTag$2=_baseGetTag,toSource$1=_toSource,mapTag$6="[object Map]",objectTag$6="[object Object]",promiseTag$1="[object Promise]",setTag$6="[object Set]",weakMapTag$4="[object WeakMap]",dataViewTag$5="[object DataView]",dataViewCtorString$1=toSource$1(DataView$2),mapCtorString$1=toSource$1(Map$2),promiseCtorString$1=toSource$1(Promise$3),setCtorString$1=toSource$1(Set$2),weakMapCtorString$1=toSource$1(WeakMap$2),getTag$5=baseGetTag$2,_getTag=((DataView$2&&getTag$5(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$5||Map$2&&getTag$5(new Map$2)!=mapTag$6||Promise$3&&getTag$5(Promise$3.resolve())!=promiseTag$1||Set$2&&getTag$5(new Set$2)!=setTag$6||WeakMap$2&&getTag$5(new WeakMap$2)!=weakMapTag$4)&&(getTag$5=function(e){var t=baseGetTag$2(e),e=t==objectTag$6?e.constructor:void 0,e=e?toSource$1(e):"";if(e)switch(e){case dataViewCtorString$1:return dataViewTag$5;case mapCtorString$1:return mapTag$6;case promiseCtorString$1:return promiseTag$1;case setCtorString$1:return setTag$6;case weakMapCtorString$1:return weakMapTag$4}return t}),getTag$5),Stack$3=_Stack,equalArrays=_equalArrays,equalByTag=_equalByTag,equalObjects=_equalObjects,getTag$4=_getTag,isArray$d=isArray_1,isBuffer$3=isBufferExports,isTypedArray$2=isTypedArray_1,COMPARE_PARTIAL_FLAG$2=1,argsTag$4="[object Arguments]",arrayTag$3="[object Array]",objectTag$5="[object Object]",objectProto$g=Object.prototype,hasOwnProperty$d=objectProto$g.hasOwnProperty;function baseIsEqualDeep$1(e,t,r,i,n,a){var s=isArray$d(e),o=isArray$d(t),l=s?arrayTag$3:getTag$4(e),o=o?arrayTag$3:getTag$4(t),u=(l=l==argsTag$4?objectTag$5:l)==objectTag$5,c=(o=o==argsTag$4?objectTag$5:o)==objectTag$5,o=l==o;if(o&&isBuffer$3(e)){if(!isBuffer$3(t))return!1;u=!(s=!0)}if(o&&!u)return a=a||new Stack$3,s||isTypedArray$2(e)?equalArrays(e,t,r,i,n,a):equalByTag(e,t,l,r,i,n,a);if(!(r&COMPARE_PARTIAL_FLAG$2)){s=u&&hasOwnProperty$d.call(e,"__wrapped__"),l=c&&hasOwnProperty$d.call(t,"__wrapped__");if(s||l)return n(s?e.value():e,l?t.value():t,r,i,a=a||new Stack$3)}return o&&(a=a||new Stack$3,equalObjects(e,t,r,i,n,a))}var _baseIsEqualDeep=baseIsEqualDeep$1,baseIsEqualDeep=_baseIsEqualDeep,isObjectLike$4=isObjectLike_1;function baseIsEqual$2(e,t,r,i,n){return e===t||(null==e||null==t||!isObjectLike$4(e)&&!isObjectLike$4(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,r,i,baseIsEqual$2,n))}var _baseIsEqual=baseIsEqual$2,Stack$2=_Stack,baseIsEqual$1=_baseIsEqual,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch$1(e,t,r,i){var n=r.length,a=n,s=!i;if(null==e)return!a;for(e=Object(e);n--;){var o=r[n];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++n<a;){var l=(o=r[n])[0],u=e[l],c=o[1];if(s&&o[2]){if(void 0===u&&!(l in e))return!1}else{var h,d=new Stack$2;if(!(void 0===(h=i?i(u,c,l,e,t,d):h)?baseIsEqual$1(c,u,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,i,d):h))return!1}}return!0}var _baseIsMatch=baseIsMatch$1,isObject$7=isObject_1;function isStrictComparable$2(e){return e==e&&!isObject$7(e)}var _isStrictComparable=isStrictComparable$2,isStrictComparable$1=_isStrictComparable,keys$3=keys_1;function getMatchData$1(e){for(var t=keys$3(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,isStrictComparable$1(n)]}return t}var _getMatchData=getMatchData$1;function matchesStrictComparable$2(t,r){return function(e){return null!=e&&e[t]===r&&(void 0!==r||t in Object(e))}}var _matchesStrictComparable=matchesStrictComparable$2,baseIsMatch=_baseIsMatch,getMatchData=_getMatchData,matchesStrictComparable$1=_matchesStrictComparable;function baseMatches$1(t){var r=getMatchData(t);return 1==r.length&&r[0][2]?matchesStrictComparable$1(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}var _baseMatches=baseMatches$1,baseGetTag$1=_baseGetTag,isObjectLike$3=isObjectLike_1,symbolTag$4="[object Symbol]";function isSymbol$6(e){return"symbol"==typeof e||isObjectLike$3(e)&&baseGetTag$1(e)==symbolTag$4}var isSymbol_1=isSymbol$6,isArray$c=isArray_1,isSymbol$5=isSymbol_1,reIsDeepProp$1=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp$1=/^\w*$/;function isKey$4(e,t){var r;return!isArray$c(e)&&(!("number"!=(r=typeof e)&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol$5(e))||reIsPlainProp$1.test(e)||!reIsDeepProp$1.test(e)||null!=t&&e in Object(t))}var _isKey=isKey$4,MapCache$1=_MapCache,FUNC_ERROR_TEXT$2="Expected a function";function memoize$2(i,n){if("function"!=typeof i||null!=n&&"function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT$2);function a(){var e=arguments,t=n?n.apply(this,e):e[0],r=a.cache;return r.has(t)?r.get(t):(e=i.apply(this,e),a.cache=r.set(t,e)||r,e)}return a.cache=new(memoize$2.Cache||MapCache$1),a}memoize$2.Cache=MapCache$1;var memoize_1=memoize$2,memoize$1=memoize_1,MAX_MEMOIZE_SIZE$1=500;function memoizeCapped$2(e){var e=memoize$1(e,function(e){return t.size===MAX_MEMOIZE_SIZE$1&&t.clear(),e}),t=e.cache;return e}var _memoizeCapped=memoizeCapped$2,memoizeCapped$1=_memoizeCapped,rePropName$2=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar$2=/\\(\\)?/g,stringToPath$4=memoizeCapped$1(function(e){var n=[];return 46===e.charCodeAt(0)&&n.push(""),e.replace(rePropName$2,function(e,t,r,i){n.push(r?i.replace(reEscapeChar$2,"$1"):t||e)}),n}),_stringToPath=stringToPath$4,Symbol$3=_Symbol,arrayMap$1=_arrayMap,isArray$b=isArray_1,isSymbol$4=isSymbol_1,INFINITY$3=1/0,symbolProto$3=Symbol$3?Symbol$3.prototype:void 0,symbolToString$1=symbolProto$3?symbolProto$3.toString:void 0;function baseToString$2(e){var t;return"string"==typeof e?e:isArray$b(e)?arrayMap$1(e,baseToString$2)+"":isSymbol$4(e)?symbolToString$1?symbolToString$1.call(e):"":"0"==(t=e+"")&&1/e==-INFINITY$3?"-0":t}var _baseToString=baseToString$2,baseToString$1=_baseToString;function toString$2(e){return null==e?"":baseToString$1(e)}var toString_1=toString$2,isArray$a=isArray_1,isKey$3=_isKey,stringToPath$3=_stringToPath,toString$1=toString_1;function castPath$4(e,t){return isArray$a(e)?e:isKey$3(e,t)?[e]:stringToPath$3(toString$1(e))}var _castPath=castPath$4,isSymbol$3=isSymbol_1,INFINITY$2=1/0;function toKey$6(e){var t;return"string"==typeof e||isSymbol$3(e)?e:"0"==(t=e+"")&&1/e==-INFINITY$2?"-0":t}var _toKey=toKey$6,castPath$3=_castPath,toKey$5=_toKey;function baseGet$4(e,t){for(var r=0,i=(t=castPath$3(t,e)).length;null!=e&&r<i;)e=e[toKey$5(t[r++])];return r&&r==i?e:void 0}var _baseGet=baseGet$4,baseGet$3=_baseGet;function get$1(e,t,r){e=null==e?void 0:baseGet$3(e,t);return void 0===e?r:e}var get_1=get$1;function baseHasIn$1(e,t){return null!=e&&t in Object(e)}var _baseHasIn=baseHasIn$1,castPath$2=_castPath,isArguments$2=isArguments_1,isArray$9=isArray_1,isIndex$2=_isIndex,isLength$1=isLength_1,toKey$4=_toKey;function hasPath$1(e,t,r){for(var i=-1,n=(t=castPath$2(t,e)).length,a=!1;++i<n;){var s=toKey$4(t[i]);if(!(a=null!=e&&r(e,s)))break;e=e[s]}return a||++i!=n?a:!!(n=null==e?0:e.length)&&isLength$1(n)&&isIndex$2(s,n)&&(isArray$9(e)||isArguments$2(e))}var _hasPath=hasPath$1,baseHasIn=_baseHasIn,hasPath=_hasPath;function hasIn$1(e,t){return null!=e&&hasPath(e,t,baseHasIn)}var hasIn_1=hasIn$1,baseIsEqual=_baseIsEqual,get=get_1,hasIn=hasIn_1,isKey$2=_isKey,isStrictComparable=_isStrictComparable,matchesStrictComparable=_matchesStrictComparable,toKey$3=_toKey,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty$1(r,i){return isKey$2(r)&&isStrictComparable(i)?matchesStrictComparable(toKey$3(r),i):function(e){var t=get(e,r);return void 0===t&&t===i?hasIn(e,r):baseIsEqual(i,t,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}var _baseMatchesProperty=baseMatchesProperty$1;function identity$2(e){return e}var identity_1=identity$2;function baseProperty$1(t){return function(e){return null==e?void 0:e[t]}}var _baseProperty=baseProperty$1,baseGet$2=_baseGet;function basePropertyDeep$1(t){return function(e){return baseGet$2(e,t)}}var _basePropertyDeep=basePropertyDeep$1,baseProperty=_baseProperty,basePropertyDeep=_basePropertyDeep,isKey$1=_isKey,toKey$2=_toKey;function property$1(e){return isKey$1(e)?baseProperty(toKey$2(e)):basePropertyDeep(e)}var property_1=property$1,baseMatches=_baseMatches,baseMatchesProperty=_baseMatchesProperty,identity$1=identity_1,isArray$8=isArray_1,property=property_1;function baseIteratee$2(e){return"function"==typeof e?e:null==e?identity$1:"object"==typeof e?isArray$8(e)?baseMatchesProperty(e[0],e[1]):baseMatches(e):property(e)}var _baseIteratee=baseIteratee$2,arrayAggregator=_arrayAggregator,baseAggregator=_baseAggregator,baseIteratee$1=_baseIteratee,isArray$7=isArray_1;function createAggregator$1(n,a){return function(e,t){var r=isArray$7(e)?arrayAggregator:baseAggregator,i=a?a():{};return r(e,n,baseIteratee$1(t),i)}}var _createAggregator=createAggregator$1,baseAssignValue$3=_baseAssignValue,createAggregator=_createAggregator,objectProto$f=Object.prototype,hasOwnProperty$c=objectProto$f.hasOwnProperty,groupBy$1=createAggregator(function(e,t,r){hasOwnProperty$c.call(e,r)?e[r].push(t):baseAssignValue$3(e,r,[t])}),groupBy_1=groupBy$1;let groupBy$2=getDefaultExportFromCjs(groupBy_1);function last$3(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var last_1=last$3;function baseSlice$2(e,t,r){for(var i=-1,n=e.length,a=((r=n<r?n:r)<0&&(r+=n),n=r<(t=t<0?n<-t?0:n+t:t)?0:r-t>>>0,t>>>=0,Array(n));++i<n;)a[i]=e[i+t];return a}var _baseSlice=baseSlice$2,baseGet$1=_baseGet,baseSlice$1=_baseSlice;function parent$2(e,t){return t.length<2?e:baseGet$1(e,baseSlice$1(t,0,-1))}var _parent=parent$2,castPath$1=_castPath,last$2=last_1,parent$1=_parent,toKey$1=_toKey;function baseUnset$2(e,t){return t=castPath$1(t,e),null==(e=parent$1(e,t))||delete e[toKey$1(last$2(t))]}var _baseUnset=baseUnset$2,baseUnset$1=_baseUnset,isIndex$1=_isIndex,arrayProto$1=Array.prototype,splice$1=arrayProto$1.splice;function basePullAt$1(e,t){for(var r=e?t.length:0,i=r-1;r--;){var n,a=t[r];r!=i&&a===n||(isIndex$1(n=a)?splice$1.call(e,a,1):baseUnset$1(e,a))}return e}var _basePullAt=basePullAt$1,baseIteratee=_baseIteratee,basePullAt=_basePullAt;function remove(e,t){var r=[];if(e&&e.length){var i=-1,n=[],a=e.length;for(t=baseIteratee(t);++i<a;){var s=e[i];t(s,i,e)&&(r.push(s),n.push(i))}basePullAt(e,n)}return r}var remove_1=remove;let remove$1=getDefaultExportFromCjs(remove_1);var DP=20,RM=1,MAX_DP=1e6,MAX_POWER=1e6,NE=-7,PE=21,STRICT=!1,NAME="[big.js] ",INVALID=NAME+"Invalid ",INVALID_DP=INVALID+"decimal places",INVALID_RM=INVALID+"rounding mode",DIV_BY_ZERO=NAME+"Division by zero",P$2={},UNDEFINED$1=void 0,NUMERIC=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function _Big_(){function r(e){var t=this;if(!(t instanceof r))return e===UNDEFINED$1?_Big_():new r(e);if(e instanceof r)t.s=e.s,t.e=e.e,t.c=e.c.slice();else{if("string"!=typeof e){if(!0===r.strict&&"bigint"!=typeof e)throw TypeError(INVALID+"value");e=0===e&&1/e<0?"-0":String(e)}parse$5(t,e)}t.constructor=r}return r.prototype=P$2,r.DP=DP,r.RM=RM,r.NE=NE,r.PE=PE,r.strict=STRICT,r.roundDown=0,r.roundHalfUp=1,r.roundHalfEven=2,r.roundUp=3,r}function parse$5(e,t){var r,i,n;if(!NUMERIC.test(t))throw Error(INVALID+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,0<(i=(t=-1<(r=t.indexOf("."))?t.replace(".",""):t).search(/e/i))?(r<0&&(r=i),r+=+t.slice(i+1),t=t.substring(0,i)):r<0&&(r=t.length),n=t.length,i=0;i<n&&"0"==t.charAt(i);)++i;if(i==n)e.c=[e.e=0];else{for(;0<n&&"0"==t.charAt(--n););for(e.e=r-i-1,e.c=[],r=0;i<=n;)e.c[r++]=+t.charAt(i++)}return e}function round$1(e,t,r,i){var n=e.c;if(0!==(r=r===UNDEFINED$1?e.constructor.RM:r)&&1!==r&&2!==r&&3!==r)throw Error(INVALID_RM);if(t<1)i=3===r&&(i||!!n[0])||0===t&&(1===r&&5<=n[0]||2===r&&(5<n[0]||5===n[0]&&(i||n[1]!==UNDEFINED$1))),n.length=1,i?(e.e=e.e-t+1,n[0]=1):n[0]=e.e=0;else if(t<n.length){if(i=1===r&&5<=n[t]||2===r&&(5<n[t]||5===n[t]&&(i||n[t+1]!==UNDEFINED$1||1&n[t-1]))||3===r&&(i||!!n[0]),n.length=t,i)for(;9<++n[--t];)if((n[t]=0)===t){++e.e,n.unshift(1);break}for(t=n.length;!n[--t];)n.pop()}return e}function stringify$2(e,t,r){var i=e.e,n=e.c.join(""),a=n.length;if(t)n=n.charAt(0)+(1<a?"."+n.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)n="0"+n;n="0."+n}else if(0<i)if(++i>a)for(i-=a;i--;)n+="0";else i<a&&(n=n.slice(0,i)+"."+n.slice(i));else 1<a&&(n=n.charAt(0)+"."+n.slice(1));return e.s<0&&r?"-"+n:n}P$2.abs=function(){var e=new this.constructor(this);return e.s=1,e},P$2.cmp=function(e){var t,r=this.c,i=(e=new this.constructor(e)).c,n=this.s,a=e.s,s=this.e,e=e.e;if(!r[0]||!i[0])return r[0]?n:i[0]?-a:0;if(n!=a)return n;if(t=n<0,s!=e)return e<s^t?1:-1;for(a=(s=r.length)<(e=i.length)?s:e,n=-1;++n<a;)if(r[n]!=i[n])return r[n]>i[n]^t?1:-1;return s==e?0:e<s^t?1:-1},P$2.div=function(e){var t=this.constructor,r=this.c,i=(e=new t(e)).c,n=this.s==e.s?1:-1,a=t.DP;if(a!==~~a||a<0||MAX_DP<a)throw Error(INVALID_DP);if(!i[0])throw Error(DIV_BY_ZERO);if(!r[0])return e.s=n,e.c=[e.e=0],e;var s,o,l,u,c,h=i.slice(),d=s=i.length,p=r.length,f=r.slice(0,s),m=f.length,g=e,v=g.c=[],y=0,a=a+(g.e=this.e-e.e)+1;for(g.s=n,n=a<0?0:a,h.unshift(0);m++<s;)f.push(0);do{for(l=0;l<10;l++){if(s!=(m=f.length))u=m<s?1:-1;else for(c=-1,u=0;++c<s;)if(i[c]!=f[c]){u=i[c]>f[c]?1:-1;break}if(!(u<0))break;for(o=m==s?i:h;m;){if(f[--m]<o[m]){for(c=m;c&&!f[--c];)f[c]=9;--f[c],f[m]+=10}f[m]-=o[m]}for(;!f[0];)f.shift()}}while(v[y++]=u?l:++l,f[0]&&u?f[m]=r[d]||0:f=[r[d]],(d++<p||f[0]!==UNDEFINED$1)&&n--);return v[0]||1==y||(v.shift(),g.e--,a--),a<y&&round$1(g,a,t.RM,f[0]!==UNDEFINED$1),g},P$2.eq=function(e){return 0===this.cmp(e)},P$2.gt=function(e){return 0<this.cmp(e)},P$2.gte=function(e){return-1<this.cmp(e)},P$2.lt=function(e){return this.cmp(e)<0},P$2.lte=function(e){return this.cmp(e)<1},P$2.minus=P$2.sub=function(e){var t,r,i,n,a=this,s=a.constructor,o=a.s,l=(e=new s(e)).s;if(o!=l)return e.s=-l,a.plus(e);var u=a.c.slice(),c=a.e,h=e.c,d=e.e;if(u[0]&&h[0]){if(o=c-d){for((i=(n=o<0)?(o=-o,u):(d=c,h)).reverse(),l=o;l--;)i.push(0);i.reverse()}else for(r=((n=u.length<h.length)?u:h).length,o=l=0;l<r;l++)if(u[l]!=h[l]){n=u[l]<h[l];break}if(n&&(i=u,u=h,h=i,e.s=-e.s),0<(l=(r=h.length)-(t=u.length)))for(;l--;)u[t++]=0;for(l=t;o<r;){if(u[--r]<h[r]){for(t=r;t&&!u[--t];)u[t]=9;--u[t],u[r]+=10}u[r]-=h[r]}for(;0===u[--l];)u.pop();for(;0===u[0];)u.shift(),--d;u[0]||(e.s=1,u=[d=0]),e.c=u,e.e=d}else h[0]?e.s=-l:u[0]?e=new s(a):e.s=1;return e},P$2.mod=function(e){var t,r=this,i=r.constructor,n=r.s,a=(e=new i(e)).s;if(e.c[0])return t=(r.s=e.s=1)==e.cmp(r),r.s=n,e.s=a,t?new i(r):(n=i.DP,a=i.RM,i.DP=i.RM=0,r=r.div(e),i.DP=n,i.RM=a,this.minus(r.times(e)));throw Error(DIV_BY_ZERO)},P$2.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},P$2.plus=P$2.add=function(e){var t,r,i,n=this,a=n.constructor;if(e=new a(e),n.s!=e.s)return e.s=-e.s,n.minus(e);var s=n.e,o=n.c,l=e.e,u=e.c;if(o[0]&&u[0]){if(o=o.slice(),t=s-l){for((i=0<t?(l=s,u):(t=-t,o)).reverse();t--;)i.push(0);i.reverse()}for(o.length-u.length<0&&(i=u,u=o,o=i),t=u.length,r=0;t;o[t]%=10)r=(o[--t]=o[t]+u[t]+r)/10|0;for(r&&(o.unshift(r),++l),t=o.length;0===o[--t];)o.pop();e.c=o,e.e=l}else u[0]||(o[0]?e=new a(n):e.s=n.s);return e},P$2.pow=function(e){var t=this,r=new t.constructor("1"),i=r,n=e<0;if(e!==~~e||e<-MAX_POWER||MAX_POWER<e)throw Error(INVALID+"exponent");for(n&&(e=-e);1&e&&(i=i.times(t)),e>>=1;)t=t.times(t);return n?r.div(i):i},P$2.prec=function(e,t){if(e!==~~e||e<1||MAX_DP<e)throw Error(INVALID+"precision");return round$1(new this.constructor(this),e,t)},P$2.round=function(e,t){if(e===UNDEFINED$1)e=0;else if(e!==~~e||e<-MAX_DP||MAX_DP<e)throw Error(INVALID_DP);return round$1(new this.constructor(this),e+this.e+1,t)},P$2.sqrt=function(){var e,t,r,i=this,n=i.constructor,a=i.s,s=i.e,o=new n("0.5");if(!i.c[0])return new n(i);if(a<0)throw Error(NAME+"No square root");for(s=(e=0===(a=Math.sqrt(i+""))||a===1/0?((t=i.c.join("")).length+s&1||(t+="0"),s=((s+1)/2|0)-(s<0||1&s),new n(((a=Math.sqrt(t))==1/0?"5e":(a=a.toExponential()).slice(0,a.indexOf("e")+1))+s)):new n(a+"")).e+(n.DP+=4);r=e,e=o.times(r.plus(i.div(r))),r.c.slice(0,s).join("")!==e.c.slice(0,s).join(""););return round$1(e,(n.DP-=4)+e.e+1,n.RM)},P$2.times=P$2.mul=function(e){var t,r=this.constructor,i=this.c,n=(e=new r(e)).c,a=i.length,s=n.length,o=this.e,l=e.e;if(e.s=this.s==e.s?1:-1,i[0]&&n[0]){for(e.e=o+l,a<s&&(t=i,i=n,n=t,l=a,a=s,s=l),t=new Array(l=a+s);l--;)t[l]=0;for(o=s;o--;){for(s=0,l=a+o;o<l;)s=t[l]+n[o]*i[l-o-1]+s,t[l--]=s%10,s=s/10|0;t[l]=s}for(s?++e.e:t.shift(),o=t.length;!t[--o];)t.pop();e.c=t}else e.c=[e.e=0];return e},P$2.toExponential=function(e,t){var r=this,i=r.c[0];if(e!==UNDEFINED$1){if(e!==~~e||e<0||MAX_DP<e)throw Error(INVALID_DP);for(r=round$1(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return stringify$2(r,!0,!!i)},P$2.toFixed=function(e,t){var r=this,i=r.c[0];if(e!==UNDEFINED$1){if(e!==~~e||e<0||MAX_DP<e)throw Error(INVALID_DP);for(e=e+(r=round$1(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return stringify$2(r,!1,!!i)},P$2[Symbol.for("nodejs.util.inspect.custom")]=P$2.toJSON=P$2.toString=function(){var e=this,t=e.constructor;return stringify$2(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},P$2.toNumber=function(){var e=Number(stringify$2(this,!0,!0));if(!0!==this.constructor.strict||this.eq(e.toString()))return e;throw Error(NAME+"Imprecise conversion")},P$2.toPrecision=function(e,t){var r=this,i=r.constructor,n=r.c[0];if(e!==UNDEFINED$1){if(e!==~~e||e<1||MAX_DP<e)throw Error(INVALID+"precision");for(r=round$1(new i(r),e,t);r.c.length<e;)r.c.push(0)}return stringify$2(r,e<=r.e||r.e<=i.NE||r.e>=i.PE,!!n)},P$2.valueOf=function(){var e=this.constructor;if(!0===e.strict)throw Error(NAME+"valueOf disallowed");return stringify$2(this,this.e<=e.NE||this.e>=e.PE,!0)};var Big=_Big_();function insertFrameItem(t,e){e.frames||(e.frames=[]);var r,i=e.frames.find(e=>e.startTime===t.startTime);return i?(r=i.id,Object.assign(i,{...t},{id:r})):e.frames.push(t),e.frames.sort((e,t)=>e.startTime-t.startTime),!0}function removeReplayResource(e){let r=[];e.elements.forEach(e=>{var t;e.resourceId&&r.push(e.resourceId),null!=(t=e.mask)&&t.resourceId&&r.push(e.mask.resourceId)}),e.resouces.forEach(e=>{"audio"===e.type&&e.noAudioTracks&&(e.noAudioTracks=!1)}),remove$1(e.resouces,e=>!r.includes(e.id))}function createFrameItem(e,r){let i={id:createID(),startTime:e};return r.style&&["x","y","width","height","alpha","rotation"].forEach(e=>{i[e]=r.style[e],"alpha"===e&&void 0===i.alpha&&(i.alpha=1)}),r.mask&&["x","y","width","height","alpha","rotation","blur"].forEach(e=>{var t=e.charAt(0).toUpperCase()+e.slice(1);i["mask"+t]=r.mask[e],"alpha"===e&&void 0===i.alpha&&(i.alpha=1)}),r.filters&&["saturation","tint","hue","brightness","exposure","contrast","highlights","sharpen","clarity","smooth","blur","grain","vignetteWhite","vignetteBlack","fill"].forEach(t=>{var e=null==(e=r.filters)?void 0:e.find(e=>e.name===t);e&&(i[t]=e.params.value)}),void 0!==r.intensity&&(i.intensity=r.intensity),i}function childrenInjectProps(t,e){return e instanceof Array?e.map(e=>React.Children.toArray(e).map(e=>React.cloneElement(e,{...t}))):React.Children.toArray(e).map(e=>React.cloneElement(e,{...t}))}function syncControlToElement(t,n){let a=n.controlElements.find(e=>e.elementId===t);if(a){let i=getElementById(t,n.data);if(i){if("editMask"===n.controlModeType){let{elementId:e,...t}=a;for(var r in t)switch(r){case"x":case"y":case"width":case"height":i.mask[r]=toNum(a[r]);default:i.mask[r]=toNum(a[r],2)}return!0}if("caption"===i.type){let{elementId:e,...r}=a;return n.data.captions.forEach(e=>{for(var t in r)switch(t){case"x":case"y":e.style[t]=toNum(a[t]);break;case"width":case"height":i.style[t]=toNum(a[t]);break;default:e.style[t]=toNum(a[t],2)}}),!0}if(i.style){let{elementId:e,...t}=a;for(var s in t)switch(s){case"x":case"y":case"width":case"height":i.style[s]=toNum(a[s]);default:i.style[s]=toNum(a[s],2)}return!0}}}return!1}function getElementById(t,e){var{elements:e,captions:r}=e,e=e.find(e=>e.id===t),r=r.find(e=>e.id===t);return e||r}function truncateDecimals(e,t){t=Math.pow(10,t);return Math.trunc(e*t)/t}function getInsertTrackIndex(r,e,i,n){var t=groupByTrackIndex(i.elements);let a=0,s=1/0;for(let e=0;e<t.length;e++){var o=t[e][0].trackIndex;o===r&&(a=t[e-1]?t[e-1][0].trackIndex:0,s=t[e+1]?t[e+1][0].trackIndex:1/0)}switch(e){case"up":return new Big(a),inserValAB(a,r);case"down":return s===1/0?r+1:(new Big(r),inserValAB(a,r));case"auto":if(n){let t=[];["video","image"].includes(n.elementType)?t.push("video","image"):t.push(n.elementType);var l,u=i.elements.filter(e=>t.includes(e.type)),u=groupByTrackIndex(u);for(l of u){let e=!1;for(var c of l){var h=c.speed||1;if(crashRects({x:c.startTime,y:0,width:c.duration/h,height:1},{x:n.time,y:0,width:n.duration||5,height:1})){e=!0;break}}return e?inserValAB(a,r):l[0].trackIndex}}else new Big(a);return inserValAB(a,r)}}function groupByTrackIndex(e){e=groupBy$2(e,"trackIndex"),e=values$1(e);return e.forEach(e=>{e.sort((e,t)=>e.startTime-t.startTime)}),e.sort((e,t)=>e[0].trackIndex-t[0].trackIndex)}function getTotalTime(e){if(!e)return 0;var{captions:e,elements:t}=e;let i=0;return e.forEach(e=>{e=e.startTime+e.duration;i=Math.max(i,e)}),t.forEach(e=>{var{startTime:t,duration:r}=e,t=t+r/videoAvgSpeed(e);i=Math.max(i,t)}),i}function getElementsByIds(t,e){let r=null;return e.forEach(e=>{t.includes(e.id)&&((r=r||[]).push(e),e=e.children)&&getElementsByIds(t,e)}),r}function getAllElements(e,t){e=e||[...t.elements];let r=[];return e.forEach(e=>{r.push(e);e=e.children;e&&getAllElements(e,t)}),r}function geVideoSizeResolution(e="720P",t){var[r,i]=t.split(":").map(e=>Number(e));if(!r||!i)return!1;let n=null,a=0;switch(e.toLocaleUpperCase()){case"480P":n=getAutoSize(480,[r,i]),a=1e6;break;case"720P":n=getAutoSize(720,[r,i]),a=6e6;break;case"1080P":n=getAutoSize(1080,[r,i]),a=8e6;break;case"2K":n=getAutoSize(1440,[r,i]),a=8e6;break;case"4K":n=getAutoSize(2160,[r,i]),a=12e6}return!!n&&{bitrate:a,...n}}function atempo(i){if(.5<=i)return",atempo="+i;let n=(e,t="")=>{let r=.5;return e*r<i?t+",atempo="+(r=i/e):n(e*r,t+",atempo=0.5")};return n(1)}async function getFFmpegAudioCMD(t,r){var i=[],n=[],a=[],s=[];let o="";var l={};let u=0;for(let e=0;e<t.length;e++){var c=t[e];if(0!==c.volume&&!c.muted){var h="input"+u+c.exec,d=(l[c.originURL]||(s.push("server"===r?{name:h,data:c.originURL}:{name:h,data:await fetchFile(c.url)}),l[c.originURL]=h),videoAvgSpeed(c)),p=(n.push("-ss",String(toNum(c.clipTime||0,2)),"-t",String(toNum(c.duration,2)),"-i",l[c.originURL]||h),[]),f=[];if(c.curveSpeed){let t=0,r=0;var m=Math.round(5*c.duration);for(let e=0;e<=m;e++){var{speed:g,progress:v}=getBezierLineAreaFromBezierLineProgress(e/m,c),y=[];y.push(`atrim=${(t*c.duration*d).toFixed(2)}:`+(v*c.duration*d).toFixed(2)+atempo(g)),t=v,p.push((0===e?"":`[${u}:a]`)+y.join(",")+`[sout_${u}_${r}];`),f.push(`[sout_${u}_${r}]`),r++}}else c.speed&&1!==c.speed&&p.push(`atempo=${d},`);0===c.fadeInTime&&0===c.fadeOutTime||p.push(`afade=t=in:st=0:d=${c.fadeInTime/d},afade=t=out:st=${c.fadeOutTime}:d=${toNum((c.duration*d-c.fadeOutTime)/d,2)},`),void 0!==c.startTime&&(h=1e3*toNum(c.startTime||.001,3),p.push(`${f.length?f.join("")+`concat=n=${f.length}:v=0:a=1,`:""}adelay=${h}|${h}|${h},volume=`+c.volume)),i.push(`[${u}:a]${p.join("")}[aout_${u}]`),a.push(`[aout_${u}]`),o=`[aout_${u}]`,u++}}return 1<=a.length&&(o="[aout]",i.push(a.join("")+`amix=inputs=${a.length}:duration=longest:normalize=0`+o),n.push("-filter_complex",i.join(";")),n.push("-c:a","libmp3lame","-map_chapters","-1","-map",o)),n.push("remix.mp3"),{files:[...s],arguments:[...n],fileType:"audio/mp3"}}async function fetchFile(e){return fetch(e).then(async e=>{e=await e.arrayBuffer();return new Uint8Array(e)})}function getAllMedia(e,r,t){let[i,n]=t||[0,getTotalTime(e)];return(getElementDataByTypes(["audio","video"],e)||[]).map(e=>{if(e.noAudioTracks)return null;e={...e};if(i>e.startTime+e.duration)return null;if(n<e.startTime)return null;i>=e.startTime&&i<=e.startTime+e.duration&&(e.startTime=i),n>=e.startTime&&n<=e.startTime+e.duration&&(e.duration=n-e.startTime);var t=r.resourceManage.getCacheItemBySourceId(e.resourceId);return t&&!t.resource.noAudioTracks?{originURL:t.resource.url,url:t.bolbURL||t.url,duration:e.duration,volume:e.volume,speed:e.speed,curveSpeed:e.curveSpeed,curveSpeedName:e.curveSpeedName,curveSpeedLines:e.curveSpeedLines,muted:e.muted,startTime:e.startTime,clipTime:e.clipTime,fadeInTime:e.fadeInTime||0,fadeOutTime:e.fadeOutTime||0,exec:exec(t.resource.url)}:null}).filter(e=>e)}function getAutoSize(e,[t,r]){var i={width:0,height:0};return r<t?(i.height=e,i.width=e*(t/r)):(i.width=e,i.height=e*(r/t)),i.width=2*Math.round(i.width/2),i.height=2*Math.round(i.height/2),i}function fitVideoSize(e,n,a){let s={width:e.width,height:e.height},o=Math.min(n.width/e.width,n.height/e.height);getAllElements(e.elements,e).forEach(e=>{var t,r,i;e.style&&(t=o,r=calcSizeAndPosition({...null==(i=a.getResouceById(e.resourceId))?void 0:i.styleSize},{...s}),t=e.style.width/r.width*calcSizeAndPosition({...null==i?void 0:i.styleSize},{...n}).width/e.style.width,e.style.width*=t,e.style.height*=t,r=e.style.x-s.width/2,i=e.style.y-s.height/2,e.style.x=n.width/2+r*t,e.style.y=n.height/2+i*t)})}function getElementDataByTypes(t,e){let r=[],i=e=>{e.forEach(e=>{e.children?i(e.children):t.includes(e.type)&&r.push(e)})};return i(e.elements),r}function getEffectiveAudio(e){e=getElementDataByTypes(["audio","video"],e);let t=0;return e.length&&e.forEach(e=>{!e.volume||e.muted||e.separate||t++}),t}function deleteElementByIds(t,e){remove$1(e.elements,e=>t.includes(e.id)),remove$1(e.cameras,e=>t.includes(e.id)),remove$1(e.transitions,e=>t.includes(e.id)),remove$1(e.captions,e=>t.includes(e.id))}function addElement(e,t,r){switch(t){case"camera":r.cameras.push(e),r.cameras.sort((e,t)=>e.startTime-t.startTime);break;case"caption":r.captions.push(e),r.captions.sort((e,t)=>e.startTime-t.startTime);break;default:r.elements.push(e),r.elements.sort((e,t)=>e.trackIndex-t.trackIndex)}}let helper=Object.freeze(Object.defineProperty({__proto__:null,addElement:addElement,atempo:atempo,childrenInjectProps:childrenInjectProps,createFrameItem:createFrameItem,deleteElementByIds:deleteElementByIds,fetchFile:fetchFile,fitVideoSize:fitVideoSize,geVideoSizeResolution:geVideoSizeResolution,getAllElements:getAllElements,getAllMedia:getAllMedia,getAutoSize:getAutoSize,getEffectiveAudio:getEffectiveAudio,getElementById:getElementById,getElementDataByTypes:getElementDataByTypes,getElementsByIds:getElementsByIds,getFFmpegAudioCMD:getFFmpegAudioCMD,getInsertTrackIndex:getInsertTrackIndex,getTotalTime:getTotalTime,groupByTrackIndex:groupByTrackIndex,insertFrameItem:insertFrameItem,removeReplayResource:removeReplayResource,syncControlToElement:syncControlToElement,truncateDecimals:truncateDecimals},Symbol.toStringTag,{value:"Module"}));function mediaInfo(e){return new Promise(async t=>{let r=await getVideoFile(e);window.MediaInfo.mediaInfoFactory({format:"JSON"},async e=>{e=await e.analyzeData(r.size,async(e,t)=>new Uint8Array(await r.slice(t,t+e).arrayBuffer())).then(e=>e).catch(e=>{});t(JSON.parse(e))})})}async function getVideoFile(e,t="video.mp4"){try{var r,i=await fetch(e);if(i.ok)return r=await i.blob(),new File([r],t,{type:r.type});throw new Error("无法获取视频: "+i.statusText)}catch(e){throw e}}function createID(e){return nanoid(e||10)}function exec(e){e=e.split("?")[0];var[e]=/\.[^.]+$/.exec(e)||[];return e.split("&")[0]}function inserValAB(e,t){return(e+t)/2}function crashRects(e,t){var{x:e,y:r,width:i,height:n}=e,{x:t,y:a,width:s,height:o}=t;let l=e+i<t||t+s<e||r+n<a||a+o<r?!1:!0;return l}async function loadFont(e,t){if("Default"===e&&(e="siYuanHeiTi",t=""),t=e&&!t?config.cdnHost+`/assets/fonts/${e}/font.woff`:t){/^http/.test(t)||(t=config.cdnHost+t);e=new FontFace(e,`url("${t}")`);try{var r=await e.load();document.fonts.add(r)}catch(e){}}}function readFileAsArrayBuffer(i){return new Promise((t,r)=>{var e=new FileReader;e.onload=function(e){e=e.target.result;t(e)},e.onerror=function(e){r()},e.readAsArrayBuffer(i)})}function readFileAsText(i){return new Promise((t,r)=>{var e=new FileReader;e.onload=function(e){e=e.target.result;t(e)},e.onerror=function(e){r()},e.readAsText(i)})}function blobURL2Data(e){return new Promise(r=>{var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){var e=i.response,t=new FileReader;t.onloadend=function(){var e=t.result;r(e)},t.readAsDataURL(e)},i.send()})}function base642URL(e){return URL.createObjectURL(dataURLtoBlob(e))}function toNum(t,r){void 0===r&&(r=0),null==t&&(t=0);try{let e=Number(t.toFixed(r));return e=isNaN(e)?0:e}catch(e){return 0}}function sleep(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}function uniqArr(e){return Array.from(new Set(e))}function toJS(e){try{return JSON.parse(JSON.stringify(e))}catch(e){}}function updateTrackIndex(e){return e.elements.sort((e,t)=>e.trackIndex-t.trackIndex),groupByTrackIndex(e.elements).forEach((e,t)=>{e.forEach(e=>{e.trackIndex=t+1})}),e}function setCropSize(e,t){var r=toNum(e.style.width/e.style.height,1),i=toNum(t.width/t.height,1);r!==i?e.cropSize=i<r?{x:0,y:(t.height-t.width/r)/2,width:t.width,height:t.width/r}:{x:(t.width-t.height*r)/2,y:0,width:t.height*r,height:t.height}:delete e.cropSize}function calcSizeAndPosition(e,t){var r={width:0,height:0,x:0,y:0},i=t.width,t=t.height,n=e.width,e=e.height;let a,s;var o=n/e;return o<i/t?(s=t,a=s*o):(a=i,s=a/o),a>n&&(a=n),s>e&&(s=e),r.width=a,r.height=s,r.x=(i-a)/2,r.y=(t-s)/2,r.x+=r.width/2,r.y+=r.height/2,r}function bindSelf(e,t,r){let i=r.value;return r.value=function(...e){return i.apply(this,e)},r}function objectCopyValue(e,t){for(var r in e)e.hasOwnProperty(r)&&("object"!=typeof e[r]||Array.isArray(e[r])?t[r]=e[r]:t[r]=objectCopyValue(e[r],t[r]||{}));return t}function getTargetByIds(e){let t=[];return e.forEach(e=>{e=document.querySelector(`[data-elementid="${e}"]`);e&&t.push(e)}),t}function getVideoFrameAtTime(n,a){return new Promise((e,t)=>{let r=document.createElement("canvas"),i=r.getContext("2d");a.onloadeddata=()=>{a.currentTime=n,a.onseeked=()=>{r.width=a.videoWidth,r.height=a.videoHeight,i.drawImage(a,0,0,r.width,r.height),e(r),a.onseeked=null}},a.onerror=e=>t(e),a.load()})}function mediaCanplay(t){return new Promise(e=>{t.onloadeddata=()=>{e(t)}})}async function createMediaTransitionCapture(e,t,r,i,n){var a=document.createElement("canvas"),r=(a.width=r.width,a.height=r.height,a.getContext("2d"));n&&(r.fillStyle=n,r.fillRect(0,0,a.width,a.height));let s=null;e instanceof HTMLVideoElement?((s=e.cloneNode()).muted=!0,s.currentTime=t,await mediaCanplay(s),await s.play(),s.paused||s.pause()):s=e;return r.translate(i.x+ +i.width/2,i.y+ +i.height/2),i.rotation&&r.rotate(i.rotation),s&&r.drawImage(s,-i.width/2,-i.height/2,+i.width,+i.height),r.resetTransform(),a}async function createImageTransitionCapture(e,t,r,i){var n=document.createElement("canvas"),t=(n.width=t.width,n.height=t.height,n.getContext("2d")),i=(i&&(t.fillStyle=i,t.fillRect(0,0,n.width,n.height)),await lazyImage(e));return t.translate(r.x+ +r.width/2,r.y+ +r.height/2),r.rotation&&t.rotate(r.rotation),t.drawImage(i,-r.width/2,-r.height/2,+r.width,+r.height),t.resetTransform(),n}function dataURLtoBlob(e){var e=e.split(","),t=e[0].match(/:(.*?);/)[1],r=atob(e[1]);let i=r.length;for(var n=new Uint8Array(i);i--;)n[i]=r.charCodeAt(i);return new Blob([n],{type:t})}function isIOSWechatBrowser(){var e=window.navigator.userAgent.toLowerCase(),t=/micromessenger/.test(e),e=/iphone|ipad|ipod|ios/.test(e);return t&&e}function isIOS(){var e=window.navigator.userAgent.toLowerCase();return/iphone|ipad|ipod|ios/.test(e)}function mediaLazy(e,t,r){return new Promise((i,n)=>{let a=document.createElement(r||"video");a.preload="auto",a.crossOrigin="Anonymous",a.autoplay=!1,a.src=e,a.setAttribute("playsinline",""),a.setAttribute("webkit-playsinline",""),a.setAttribute("x5-video-player-type","h5"),a.setAttribute("x5-video-player-fullscreen","false");try{a.load()}catch(e){}if(void 0!==t&&(a.currentTime=t),isIOSWechatBrowser())setTimeout(()=>{i(a)},3e3);else{let e=()=>{r(),i(a)},t=e=>{r(),n(e)},r=()=>{a.removeEventListener("loadedmetadata",e),a.removeEventListener("canplay",e),a.removeEventListener("error",t)};a.addEventListener("loadedmetadata",e),a.addEventListener("canplay",e),a.addEventListener("error",t)}})}function lastItem(e){return e[e.length-1]}function lazyImage(r){return new Promise(e=>{let t=new Image;t.onload=()=>{e(t)},t.src=r})}function getFileExtension(e=""){e=(e=e.split("?")[0]).split(".");return 1<e.length?(e.pop()||"").toLowerCase():null}function getFileTypeFromFileName(e){e=getFileExtension(e);if(e){if(e.match(/(mp4|webm|ogg|mov)$/))return"video";if(e.match(/(jpg|jpeg|png|gif|svg|bmp)$/))return"image";if(e.match(/(mp3|wav|ogg)$/))return"audio"}return null}let secToTime=(e,t="hh:mm:ss:ms",r)=>{var i=Math.floor(e/3600),n=Math.floor(e%3600/60),a=Math.floor(e%60),[,e="0"]=e.toString().split(".");let s={hh:i.toString().padStart(2,"0"),"h?":i.toString().padStart(2,"0"),h:i.toString(),mm:n.toString().padStart(2,"0"),m:n.toString(),ss:a.toString().padStart(2,"0"),s:a.toString(),ms:e.padEnd(2,"0").slice(0,2),mss:e.padEnd(3,"0").slice(0,3)},o=[];t.split(":").forEach(e=>{(-1===e.indexOf("?")||"00"!==s[e])&&o.push(s[e])});i=o.join(":");return"min1"===r&&"00:00"===i?"00:01":i};function hitRect(e,t){return e.x<toNum(t.x+t.width,2)&&toNum(e.x+e.width,2)>t.x&&e.y<toNum(t.y+t.height,2)&&toNum(e.y+e.height,2)>t.y}function splitArray(e){var t=Math.ceil(e.length/2);return[e.slice(0,t),e.slice(t)]}let utils$3=Object.freeze(Object.defineProperty({__proto__:null,base642URL:base642URL,bindSelf:bindSelf,blobURL2Data:blobURL2Data,calcSizeAndPosition:calcSizeAndPosition,crashRects:crashRects,createID:createID,createImageTransitionCapture:createImageTransitionCapture,createMediaTransitionCapture:createMediaTransitionCapture,dataURLtoBlob:dataURLtoBlob,exec:exec,getFileExtension:getFileExtension,getFileTypeFromFileName:getFileTypeFromFileName,getTargetByIds:getTargetByIds,getVideoFile:getVideoFile,getVideoFrameAtTime:getVideoFrameAtTime,hitRect:hitRect,inserValAB:inserValAB,isIOS:isIOS,isIOSWechatBrowser:isIOSWechatBrowser,lastItem:lastItem,lazyImage:lazyImage,loadFont:loadFont,mediaCanplay:mediaCanplay,mediaInfo:mediaInfo,mediaLazy:mediaLazy,objectCopyValue:objectCopyValue,readFileAsArrayBuffer:readFileAsArrayBuffer,readFileAsText:readFileAsText,secToTime:secToTime,setCropSize:setCropSize,sleep:sleep,splitArray:splitArray,toJS:toJS,toNum:toNum,uniqArr:uniqArr,updateTrackIndex:updateTrackIndex},Symbol.toStringTag,{value:"Module"})),SPEED_SEGMENTATION=100;function findAdjacentPoints(t,r){t.sort((e,t)=>e.x-t.x);for(let e=0;e<t.length-1;e++)if(r>=t[e].x&&r<=t[e+1].x)return[t[e],t[e+1]];return[null,null]}function getBezierLineAreaFromBezierLineProgress(e,t){var r=videoAvgSpeed(t),e=countX2Duration(e,t);return t.curveSpeed,{progress:e,speed:r}}function getAllSpeedArea(t){let r=0,i=0;var n=SPEED_SEGMENTATION;for(let e=0;e<=n;e++){var a,[s,o]=findAdjacentPoints(t.curveSpeedLines,i);s&&o&&([a,s]=findIntersection({p1:[s.x,s.y],p2:[o.x,o.y],cp1:[(s.x+o.x)/2,s.y],cp2:[(s.x+o.x)/2,o.y]},i),o=xToSpeed(s),r+=o*(1/n)),i+=1/n}return r}function countX2Duration(t,r){if(!r.curveSpeed)return t;var i=SPEED_SEGMENTATION,n=getAllSpeedArea(r);let a=0,s=0;for(let e=0;e<=i;e++){var[o,l]=findAdjacentPoints(r.curveSpeedLines,a);if(o&&l){var[,o]=findIntersection({p1:[o.x,o.y],p2:[l.x,l.y],cp1:[(o.x+l.x)/2,o.y],cp2:[(o.x+l.x)/2,l.y]},a),l=xToSpeed(o);if(s+=l*(1/i),a>=t)return s/n}a+=1/i}return 1}function getBezierLineAreaFromTimelineProgress(i,n){var e=videoAvgSpeed(n),a=1-speedToX(e);if(n.curveSpeed){var s=SPEED_SEGMENTATION;let t=0,r=0;i=countX2Duration(i,n);for(let e=0;e<=s;e++){var[o,l]=findAdjacentPoints(n.curveSpeedLines,t);if(o&&l){var[o,l]=findIntersection({p1:[o.x,o.y],p2:[l.x,l.y],cp1:[(o.x+l.x)/2,o.y],cp2:[(o.x+l.x)/2,l.y]},t);if((r+=l*(1/s))/a>=i)return{speed:xToSpeed(l),cx:o,cy:l,progress:r/a}}t+=1/s}}return{speed:e,cy:.5,cx:i}}function getSpeedByRelative(e,t){return!t.curveSpeed||t.curveSpeedLines.length<2?{speed:t.speed,cx:1,cy:.5}:{...getBezierLineAreaFromTimelineProgress(e,t)}}function videoAvgSpeed(e){return e.curveSpeed?xToSpeed(averageBezierY(e.curveSpeedLines))||1:e.speed||1}function averageBezierY(t){var r=(t,r,i=SPEED_SEGMENTATION)=>{let n=0;for(let e=0;e<=i;e++){var a=e/i;n+=(a=a,o=r,u=l=void 0,l=(s=t).y,u=o.y,Math.pow(1-a,3)*s.y+3*Math.pow(1-a,2)*a*l+3*(1-a)*Math.pow(a,2)*u+Math.pow(a,3)*o.y)}var s,o,l,u;return n/(i+1)};let i=0,n=0;for(let e=0;e<t.length-1;e++){var a=t[e],s=t[e+1],o=s.x-a.x,a=r(a,s);i+=a*o,n+=o}return i/n}function xToSpeed(e){if(e<0||1<e)return 1;let t=1;return toNum(t=e<=.5?10-9*+e/.5:1-.9*(e-.5)/.5,2)}function speedToX(e){if(e<.1||10<e)return 1;let t=.5;return toNum(t=1<=e?0+.5*(10-e)/9:.5+.5*(1-e)/.9,4)}function solveCubic(t,r,i,n){var a=[];var s=e=>t*e**3+r*e**2+i*e+n,o=e=>3*t*e**2+2*r*e+i;for(let e=0;e<=1;e+=.1){var l=((t,r,e)=>{let i=e;for(let e=0;e<100;e++){var n=t(i),a=r(i);if(Math.abs(n)<1e-6)return i;i-=n/a}return null})(s,o,e);null!==l&&0<=l&&l<=1&&a.push(l)}return a}function findIntersection(e,t){var r,{p1:e,cp1:i,cp2:n,p2:a}=e,[s,o]=e,[l,u]=i,[c,h]=n,[d,p]=a,f=[];for(r of solveCubic(3*l-s-3*c+d,3*s-6*l+3*c,-3*s+3*l,s-t)){var m=(1-r)**3*s+3*(1-r)**2*r*l+3*(1-r)*r**2*c+r**3*d,g=(1-r)**3*o+3*(1-r)**2*r*u+3*(1-r)*r**2*h+r**3*p;f.push([m,g])}return filterClosePoints(f)}function filterClosePoints(e,r=1e-6){var i=[];for(let t of e)i.every(e=>Math.abs(e[0]-t[0])>r||Math.abs(e[1]-t[1])>r)&&i.push(t);return i[0]}var ENV=(e=>(e[e.WEBGL_LEGACY=0]="WEBGL_LEGACY",e[e.WEBGL=1]="WEBGL",e[e.WEBGL2=2]="WEBGL2",e))(ENV||{}),RENDERER_TYPE=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.WEBGL=1]="WEBGL",e[e.CANVAS=2]="CANVAS",e))(RENDERER_TYPE||{}),BUFFER_BITS=(e=>(e[e.COLOR=16384]="COLOR",e[e.DEPTH=256]="DEPTH",e[e.STENCIL=1024]="STENCIL",e))(BUFFER_BITS||{}),BLEND_MODES=(e=>(e[e.NORMAL=0]="NORMAL",e[e.ADD=1]="ADD",e[e.MULTIPLY=2]="MULTIPLY",e[e.SCREEN=3]="SCREEN",e[e.OVERLAY=4]="OVERLAY",e[e.DARKEN=5]="DARKEN",e[e.LIGHTEN=6]="LIGHTEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.COLOR_BURN=8]="COLOR_BURN",e[e.HARD_LIGHT=9]="HARD_LIGHT",e[e.SOFT_LIGHT=10]="SOFT_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.NORMAL_NPM=17]="NORMAL_NPM",e[e.ADD_NPM=18]="ADD_NPM",e[e.SCREEN_NPM=19]="SCREEN_NPM",e[e.NONE=20]="NONE",e[e.SRC_OVER=0]="SRC_OVER",e[e.SRC_IN=21]="SRC_IN",e[e.SRC_OUT=22]="SRC_OUT",e[e.SRC_ATOP=23]="SRC_ATOP",e[e.DST_OVER=24]="DST_OVER",e[e.DST_IN=25]="DST_IN",e[e.DST_OUT=26]="DST_OUT",e[e.DST_ATOP=27]="DST_ATOP",e[e.ERASE=26]="ERASE",e[e.SUBTRACT=28]="SUBTRACT",e[e.XOR=29]="XOR",e))(BLEND_MODES||{}),DRAW_MODES=(e=>(e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e))(DRAW_MODES||{}),FORMATS=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(FORMATS||{}),TARGETS=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(TARGETS||{}),TYPES=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(TYPES||{}),SAMPLER_TYPES=(e=>(e[e.FLOAT=0]="FLOAT",e[e.INT=1]="INT",e[e.UINT=2]="UINT",e))(SAMPLER_TYPES||{}),SCALE_MODES=(e=>(e[e.NEAREST=0]="NEAREST",e[e.LINEAR=1]="LINEAR",e))(SCALE_MODES||{}),WRAP_MODES=(e=>(e[e.CLAMP=33071]="CLAMP",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e))(WRAP_MODES||{}),MIPMAP_MODES=(e=>(e[e.OFF=0]="OFF",e[e.POW2=1]="POW2",e[e.ON=2]="ON",e[e.ON_MANUAL=3]="ON_MANUAL",e))(MIPMAP_MODES||{}),ALPHA_MODES=(e=>(e[e.NPM=0]="NPM",e[e.UNPACK=1]="UNPACK",e[e.PMA=2]="PMA",e[e.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",e[e.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",e[e.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",e))(ALPHA_MODES||{}),CLEAR_MODES=(e=>(e[e.NO=0]="NO",e[e.YES=1]="YES",e[e.AUTO=2]="AUTO",e[e.BLEND=0]="BLEND",e[e.CLEAR=1]="CLEAR",e[e.BLIT=2]="BLIT",e))(CLEAR_MODES||{}),GC_MODES=(e=>(e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL",e))(GC_MODES||{}),PRECISION=(e=>(e.LOW="lowp",e.MEDIUM="mediump",e.HIGH="highp",e))(PRECISION||{}),MASK_TYPES=(e=>(e[e.NONE=0]="NONE",e[e.SCISSOR=1]="SCISSOR",e[e.STENCIL=2]="STENCIL",e[e.SPRITE=3]="SPRITE",e[e.COLOR=4]="COLOR",e))(MASK_TYPES||{}),COLOR_MASK_BITS=(e=>(e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e))(COLOR_MASK_BITS||{}),MSAA_QUALITY=(e=>(e[e.NONE=0]="NONE",e[e.LOW=2]="LOW",e[e.MEDIUM=4]="MEDIUM",e[e.HIGH=8]="HIGH",e))(MSAA_QUALITY||{}),BUFFER_TYPE=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(BUFFER_TYPE||{});let BrowserAdapter={createCanvas:(e,t)=>{var r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>(new DOMParser).parseFromString(e,"text/xml")},settings={ADAPTER:BrowserAdapter,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var appleIphone=/iPhone/i,appleIpod=/iPod/i,appleTablet=/iPad/i,appleUniversal=/\biOS-universal(?:.+)Mac\b/i,androidPhone=/\bAndroid(?:.+)Mobile\b/i,androidTablet=/Android/i,amazonPhone=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,amazonTablet=/Silk/i,windowsPhone=/Windows Phone/i,windowsTablet=/\bWindows(?:.+)ARM\b/i,otherBlackBerry=/BlackBerry/i,otherBlackBerry10=/BB10/i,otherOpera=/Opera Mini/i,otherChrome=/\b(CriOS|Chrome)(?:.+)Mobile/i,otherFirefox=/Mobile(?:.+)Firefox\b/i,isAppleTabletOnIos13=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&1<e.maxTouchPoints&&"undefined"==typeof MSStream};function createMatch(t){return function(e){return e.test(t)}}function isMobile$1(e){var t={userAgent:"",platform:"",maxTouchPoints:0},e=(e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0},t.userAgent),r=e.split("[FBAN"),r=createMatch(e=void 0!==(r=(e=void 0!==r[1]?r[0]:e).split("Twitter"))[1]?r[0]:e),e={apple:{phone:r(appleIphone)&&!r(windowsPhone),ipod:r(appleIpod),tablet:!r(appleIphone)&&(r(appleTablet)||isAppleTabletOnIos13(t))&&!r(windowsPhone),universal:r(appleUniversal),device:(r(appleIphone)||r(appleIpod)||r(appleTablet)||r(appleUniversal)||isAppleTabletOnIos13(t))&&!r(windowsPhone)},amazon:{phone:r(amazonPhone),tablet:!r(amazonPhone)&&r(amazonTablet),device:r(amazonPhone)||r(amazonTablet)},android:{phone:!r(windowsPhone)&&r(amazonPhone)||!r(windowsPhone)&&r(androidPhone),tablet:!r(windowsPhone)&&!r(amazonPhone)&&!r(androidPhone)&&(r(amazonTablet)||r(androidTablet)),device:!r(windowsPhone)&&(r(amazonPhone)||r(amazonTablet)||r(androidPhone)||r(androidTablet))||r(/\bokhttp\b/i)},windows:{phone:r(windowsPhone),tablet:r(windowsTablet),device:r(windowsPhone)||r(windowsTablet)},other:{blackberry:r(otherBlackBerry),blackberry10:r(otherBlackBerry10),opera:r(otherOpera),firefox:r(otherFirefox),chrome:r(otherChrome),device:r(otherBlackBerry)||r(otherBlackBerry10)||r(otherOpera)||r(otherFirefox)||r(otherChrome)},any:!1,phone:!1,tablet:!1};return e.any=e.apple.device||e.android.device||e.windows.device||e.other.device,e.phone=e.apple.phone||e.android.phone||e.windows.phone,e.tablet=e.apple.tablet||e.android.tablet||e.windows.tablet,e}let isMobileCall=isMobile$1.default??isMobile$1,isMobile=isMobileCall(globalThis.navigator);settings.RETINA_PREFIX=/@([0-9\.]+)x/,settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var eventemitter3={exports:{}},eventemitter3Exports=((e=>{var i=Object.prototype.hasOwnProperty,p="~";function r(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function n(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");r=new a(r,i||e,n),i=p?p+t:t;return e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],r]:e._events[i].push(r):(e._events[i]=r,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function t(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(p=!1)),t.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(p?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},t.prototype.listeners=function(e){var e=p?p+e:e,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var r=0,i=t.length,n=new Array(i);r<i;r++)n[r]=t[r].fn;return n},t.prototype.listenerCount=function(e){e=p?p+e:e,e=this._events[e];return e?e.fn?1:e.length:0},t.prototype.emit=function(e,t,r,i,n,a){var s=p?p+e:e;if(!this._events[s])return!1;var o,l=this._events[s],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,n),!0;case 6:return l.fn.call(l.context,t,r,i,n,a),!0}for(d=1,o=new Array(u-1);d<u;d++)o[d-1]=arguments[d];l.fn.apply(l.context,o)}else for(var c,h=l.length,d=0;d<h;d++)switch(l[d].once&&this.removeListener(e,l[d].fn,void 0,!0),u){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,t);break;case 3:l[d].fn.call(l[d].context,t,r);break;case 4:l[d].fn.call(l[d].context,t,r,i);break;default:if(!o)for(c=1,o=new Array(u-1);c<u;c++)o[c-1]=arguments[c];l[d].fn.apply(l[d].context,o)}return!0},t.prototype.on=function(e,t,r){return n(this,e,t,r,!1)},t.prototype.once=function(e,t,r){return n(this,e,t,r,!0)},t.prototype.removeListener=function(e,t,r,i){e=p?p+e:e;if(this._events[e])if(t){var n=this._events[e];if(n.fn)n.fn!==t||i&&!n.once||r&&n.context!==r||l(this,e);else{for(var a=0,s=[],o=n.length;a<o;a++)(n[a].fn!==t||i&&!n[a].once||r&&n[a].context!==r)&&s.push(n[a]);s.length?this._events[e]=1===s.length?s[0]:s:l(this,e)}}else l(this,e);return this},t.prototype.removeAllListeners=function(e){return e?(e=p?p+e:e,this._events[e]&&l(this,e)):(this._events=new r,this._eventsCount=0),this},t.prototype.off=t.prototype.removeListener,t.prototype.addListener=t.prototype.on,t.prefixed=p,e.exports=t.EventEmitter=t})(eventemitter3),eventemitter3.exports);let EventEmitter$2=getDefaultExportFromCjs(eventemitter3Exports);var earcut$2={exports:{}};function earcut(e,t,r){r=r||2;var i,n,a,s,o,l=t&&t.length,u=l?t[0]*r:e.length,c=linkedList(e,0,u,r,!0),h=[];if(c&&c.next!==c.prev){if(l&&(c=eliminateHoles(e,t,c,r)),e.length>80*r){for(var d=i=e[0],p=n=e[1],f=r;f<u;f+=r)(a=e[f])<d&&(d=a),(s=e[f+1])<p&&(p=s),i<a&&(i=a),n<s&&(n=s);o=0!==(o=Math.max(i-d,n-p))?32767/o:0}earcutLinked(c,h,r,d,p,o,0)}return h}function linkedList(e,t,r,i,n){var a,s;if(n===0<signedArea(e,t,r,i))for(a=t;a<r;a+=i)s=insertNode(a,e[a],e[a+1],s);else for(a=r-i;t<=a;a-=i)s=insertNode(a,e[a],e[a+1],s);return s&&equals$1(s,s.next)&&(removeNode(s),s=s.next),s}function filterPoints(e,t){if(!e)return e;t=t||e;var r,i=e;do{if(r=!1,i.steiner||!equals$1(i,i.next)&&0!==area(i.prev,i,i.next))i=i.next;else{if(removeNode(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function earcutLinked(e,t,r,i,n,a,s){if(e){!s&&a&&indexCurve(e,i,n,a);for(var o,l,u=e;e.prev!==e.next;)if(o=e.prev,l=e.next,a?isEarHashed(e,i,n,a):isEar(e))t.push(o.i/r|0),t.push(e.i/r|0),t.push(l.i/r|0),removeNode(e),e=l.next,u=l.next;else if((e=l)===u){s?1===s?earcutLinked(e=cureLocalIntersections(filterPoints(e),t,r),t,r,i,n,a,2):2===s&&splitEarcut(e,t,r,i,n,a):earcutLinked(filterPoints(e),t,r,i,n,a,1);break}}}function isEar(e){var t=e.prev,r=e,e=e.next;if(0<=area(t,r,e))return!1;for(var i=t.x,n=r.x,a=e.x,s=t.y,o=r.y,l=e.y,u=i<n?i<a?i:a:n<a?n:a,c=s<o?s<l?s:l:o<l?o:l,h=n<i?a<i?i:a:a<n?n:a,d=o<s?l<s?s:l:l<o?o:l,p=e.next;p!==t;){if(p.x>=u&&p.x<=h&&p.y>=c&&p.y<=d&&pointInTriangle(i,s,n,o,a,l,p.x,p.y)&&0<=area(p.prev,p,p.next))return!1;p=p.next}return!0}function isEarHashed(e,t,r,i){var n=e.prev,a=e,s=e.next;if(0<=area(n,a,s))return!1;for(var o=n.x,l=a.x,u=s.x,c=n.y,h=a.y,d=s.y,p=o<l?o<u?o:u:l<u?l:u,f=c<h?c<d?c:d:h<d?h:d,m=l<o?u<o?o:u:u<l?l:u,g=h<c?d<c?c:d:d<h?h:d,v=zOrder(p,f,t,r,i),y=zOrder(m,g,t,r,i),_=e.prevZ,b=e.nextZ;_&&_.z>=v&&b&&b.z<=y;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==s&&pointInTriangle(o,c,l,h,u,d,_.x,_.y)&&0<=area(_.prev,_,_.next))return!1;if(_=_.prevZ,b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==s&&pointInTriangle(o,c,l,h,u,d,b.x,b.y)&&0<=area(b.prev,b,b.next))return!1;b=b.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==n&&_!==s&&pointInTriangle(o,c,l,h,u,d,_.x,_.y)&&0<=area(_.prev,_,_.next))return!1;_=_.prevZ}for(;b&&b.z<=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==n&&b!==s&&pointInTriangle(o,c,l,h,u,d,b.x,b.y)&&0<=area(b.prev,b,b.next))return!1;b=b.nextZ}return!0}function cureLocalIntersections(e,t,r){var i=e;do{var n=i.prev,a=i.next.next}while(!equals$1(n,a)&&intersects(n,i,i.next,a)&&locallyInside(n,a)&&locallyInside(a,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(a.i/r|0),removeNode(i),removeNode(i.next),i=e=a),(i=i.next)!==e);return filterPoints(i)}function splitEarcut(e,t,r,i,n,a){var s=e;do{for(var o,l=s.next.next;l!==s.prev;){if(s.i!==l.i&&isValidDiagonal(s,l))return o=splitPolygon(s,l),s=filterPoints(s,s.next),o=filterPoints(o,o.next),earcutLinked(s,t,r,i,n,a,0),void earcutLinked(o,t,r,i,n,a,0);l=l.next}}while((s=s.next)!==e)}function eliminateHoles(e,t,r,i){for(var n,a=[],s=0,o=t.length;s<o;s++)(n=linkedList(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i,!1))===n.next&&(n.steiner=!0),a.push(getLeftmost(n));for(a.sort(compareX),s=0;s<a.length;s++)r=eliminateHole(a[s],r);return r}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){var r=findHoleBridge(e,t);return r?(filterPoints(e=splitPolygon(r,e),e.next),filterPoints(r,r.next)):t}function findHoleBridge(e,t){var r,i=t,n=e.x,a=e.y,s=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var o=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&s<o&&(r=i.x<i.next.x?i:i.next,(s=o)===n))return r}}while((i=i.next)!==t);if(!r)return null;for(var l,u=r,c=r.x,h=r.y,d=1/0,i=r;n>=i.x&&i.x>=c&&n!==i.x&&pointInTriangle(a<h?n:s,a,c,h,a<h?s:n,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(n-i.x),locallyInside(i,e))&&(l<d||l===d&&(i.x>r.x||i.x===r.x&&sectorContainsSector(r,i)))&&(r=i,d=l),(i=i.next)!==u;);return r}function sectorContainsSector(e,t){return area(e.prev,e,t.prev)<0&&area(t.next,e,e.next)<0}function indexCurve(e,t,r,i){for(var n=e;0===n.z&&(n.z=zOrder(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==e;);n.prevZ.nextZ=null,n.prevZ=null,sortLinked(n)}function sortLinked(e){var t,r,i,n,a,s,o,l,u=1;do{for(r=e,a=e=null,s=0;r;){for(s++,i=r,t=o=0;t<u&&(o++,i=i.nextZ);t++);for(l=u;0<o||0<l&&i;)0!==o&&(0===l||!i||r.z<=i.z)?(r=(n=r).nextZ,o--):(i=(n=i).nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;r=i}}while(a.nextZ=null,u*=2,1<s);return e}function zOrder(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function getLeftmost(e){for(var t=e,r=e;(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),(t=t.next)!==e;);return r}function pointInTriangle(e,t,r,i,n,a,s,o){return(e-s)*(a-o)<=(n-s)*(t-o)&&(r-s)*(t-o)<=(e-s)*(i-o)&&(n-s)*(i-o)<=(r-s)*(a-o)}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!intersectsPolygon(e,t)&&(locallyInside(e,t)&&locallyInside(t,e)&&middleInside(e,t)&&(area(e.prev,e,t.prev)||area(e,t.prev,t))||equals$1(e,t)&&0<area(e.prev,e,e.next)&&0<area(t.prev,t,t.next))}function area(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function equals$1(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,r,i){var n=sign$2(area(e,t,r)),a=sign$2(area(e,t,i)),s=sign$2(area(r,i,e)),o=sign$2(area(r,i,t));return n!==a&&s!==o||!!(0===n&&onSegment(e,r,t)||0===a&&onSegment(e,i,t)||0===s&&onSegment(r,e,i)||0===o&&onSegment(r,t,i))}function onSegment(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function sign$2(e){return 0<e?1:e<0?-1:0}function intersectsPolygon(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&intersects(r,r.next,e,t))return!0}while((r=r.next)!==e);return!1}function locallyInside(e,t){return area(e.prev,e,e.next)<0?0<=area(e,t,e.next)&&0<=area(e,e.prev,t):area(e,t,e.prev)<0||area(e,e.next,t)<0}function middleInside(e,t){for(var r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),(r=r.next)!==e;);return i}function splitPolygon(e,t){var r=new Node$1(e.i,e.x,e.y),i=new Node$1(t.i,t.x,t.y),n=e.next,a=t.prev;return(e.next=t).prev=e,(r.next=n).prev=r,(i.next=r).prev=i,(a.next=i).prev=a,i}function insertNode(e,t,r,i){e=new Node$1(e,t,r);return i?(e.next=i.next,(e.prev=i).next.prev=e,i.next=e):(e.prev=e).next=e,e}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node$1(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,t,r,i){for(var n=0,a=t,s=r-i;a<r;a+=i)n+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return n}earcut$2.exports=earcut,earcut$2.exports.default=earcut,earcut.deviation=function(e,t,r,i){var n=t&&t.length,a=n?t[0]*r:e.length,s=Math.abs(signedArea(e,0,a,r));if(n)for(var o=0,l=t.length;o<l;o++){var u=t[o]*r,c=o<l-1?t[o+1]*r:e.length;s-=Math.abs(signedArea(e,u,c,r))}for(var h=0,o=0;o<i.length;o+=3){var d=i[o]*r,p=i[o+1]*r,f=i[o+2]*r;h+=Math.abs((e[d]-e[f])*(e[1+p]-e[1+d])-(e[d]-e[p])*(e[1+f]-e[1+d]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},earcut.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var a=0;a<e[n].length;a++)for(var s=0;s<t;s++)r.vertices.push(e[n][a][s]);0<n&&(i+=e[n-1].length,r.holes.push(i))}return r};var earcutExports=earcut$2.exports;let earcut$1=getDefaultExportFromCjs(earcutExports);var punycode$1={exports:{}},punycodeExports=(punycode$1.exports,(e=>{var t=commonjsGlobal,r=e&&!e.nodeType&&e,e=punycode$1&&!punycode$1.nodeType&&punycode$1,i="object"==typeof commonjsGlobal&&commonjsGlobal;i.global!==i&&i.window!==i&&i.self!==i||(t=i);var n,a,g=2147483647,v=36,y=26,s=38,o=700,l=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=v-1,_=Math.floor,b=String.fromCharCode;function x(e){throw new RangeError(h[e])}function p(e,t){for(var r=e.length,i=[];r--;)i[r]=t(e[r]);return i}function f(e,t){var r=e.split("@"),i="",r=(1<r.length&&(i=r[0]+"@",e=r[1]),(e=e.replace(c,".")).split("."));return i+p(r,t).join(".")}function S(e){for(var t,r,i=[],n=0,a=e.length;n<a;)55296<=(t=e.charCodeAt(n++))&&t<=56319&&n<a?56320==(64512&(r=e.charCodeAt(n++)))?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--):i.push(t);return i}function m(e){return p(e,function(e){var t="";return 65535<e&&(t+=b((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=b(e)}).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function E(e,t,r){var i=0;for(e=r?_(e/o):e>>1,e+=_(e/t);d*y>>1<e;i+=v)e=_(e/d);return _(i+(d+1)*e/(e+s))}function C(e){var t,r,i,n,a,s,o,l=[],u=e.length,c=0,h=128,d=72,p=e.lastIndexOf("-");for(p<0&&(p=0),r=0;r<p;++r)128<=e.charCodeAt(r)&&x("not-basic"),l.push(e.charCodeAt(r));for(i=0<p?p+1:0;i<u;){for(n=c,a=1,s=v;u<=i&&x("invalid-input"),o=e.charCodeAt(i++),(v<=(o=o-48<10?o-22:o-65<26?o-65:o-97<26?o-97:v)||o>_((g-c)/a))&&x("overflow"),c+=o*a,!(o<(o=s<=d?1:d+y<=s?y:s-d));s+=v)a>_(g/(o=v-o))&&x("overflow"),a*=o;d=E(c-n,t=l.length+1,0==n),_(c/t)>g-h&&x("overflow"),h+=_(c/t),c%=t,l.splice(c++,0,h)}return m(l)}function A(e){for(var t,r,i,n,a,s,o,l,u,c,h=[],d=(e=S(e)).length,p=128,f=72,m=t=0;m<d;++m)(o=e[m])<128&&h.push(b(o));for(r=i=h.length,i&&h.push("-");r<d;){for(n=g,m=0;m<d;++m)p<=(o=e[m])&&o<n&&(n=o);for(n-p>_((g-t)/(l=r+1))&&x("overflow"),t+=(n-p)*l,p=n,m=0;m<d;++m)if((o=e[m])<p&&++t>g&&x("overflow"),o==p){for(a=t,s=v;!(a<(u=s<=f?1:f+y<=s?y:s-f));s+=v)h.push(b(T(u+(c=a-u)%(u=v-u),0))),a=_(c/u);h.push(b(T(a,0))),f=E(t,l,r==i),t=0,++r}++t,++p}return h.join("")}if(n={version:"1.4.1",ucs2:{decode:S,encode:m},decode:C,encode:A,toASCII:function(e){return f(e,function(e){return u.test(e)?"xn--"+A(e):e})},toUnicode:function(e){return f(e,function(e){return l.test(e)?C(e.slice(4).toLowerCase()):e})}},r&&e)if(punycode$1.exports==r)e.exports=n;else for(a in n)n.hasOwnProperty(a)&&(r[a]=n[a]);else t.punycode=n})(punycode$1.exports),punycode$1.exports),esErrors=Error,_eval=EvalError,range=RangeError,ref$1=ReferenceError,syntax=SyntaxError,type=TypeError,uri=URIError,shams=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"!=typeof Symbol.iterator){var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){r=Object.getOwnPropertyDescriptor(e,t);if(42!==r.value||!0!==r.enumerable)return!1}}return!0},origSymbol="undefined"!=typeof Symbol&&Symbol,hasSymbolSham=shams,hasSymbols$1=function(){return"function"==typeof origSymbol&&"function"==typeof Symbol&&"symbol"==typeof origSymbol("foo")&&"symbol"==typeof Symbol("bar")&&hasSymbolSham()},test={__proto__:null,foo:{}},$Object=Object,hasProto$1=function(){return{__proto__:test}.foo===test.foo&&!(test instanceof $Object)},ERROR_MESSAGE="Function.prototype.bind called on incompatible ",toStr$1=Object.prototype.toString,max$1=Math.max,funcType="[object Function]",concatty=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var n=0;n<t.length;n+=1)r[n+e.length]=t[n];return r},slicy=function(e,t){for(var r=[],i=t||0,n=0;i<e.length;i+=1,n+=1)r[n]=e[i];return r},joiny=function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r},implementation$1=function(t){var r=this;if("function"!=typeof r||toStr$1.apply(r)!==funcType)throw new TypeError(ERROR_MESSAGE+r);for(var i,e,n=slicy(arguments,1),a=max$1(0,r.length-n.length),s=[],o=0;o<a;o++)s[o]="$"+o;return i=Function("binder","return function ("+joiny(s,",")+"){ return binder.apply(this,arguments); }")(function(){var e;return this instanceof i?(e=r.apply(this,concatty(n,arguments)),Object(e)===e?e:this):r.apply(t,concatty(n,arguments))}),r.prototype&&((e=function(){}).prototype=r.prototype,i.prototype=new e,e.prototype=null),i},implementation=implementation$1,functionBind=Function.prototype.bind||implementation,call=Function.prototype.call,$hasOwn=Object.prototype.hasOwnProperty,bind$1=functionBind,hasown=bind$1.call(call,$hasOwn),undefined$1,$Error=esErrors,$EvalError=_eval,$RangeError=range,$ReferenceError=ref$1,$SyntaxError$1=syntax,$TypeError$3=type,$URIError=uri,$Function=Function,getEvalledConstructor=function(e){try{return $Function('"use strict"; return ('+e+").constructor;")()}catch(e){}},$gOPD$1=Object.getOwnPropertyDescriptor;if($gOPD$1)try{$gOPD$1({},"")}catch(e5){$gOPD$1=null}var throwTypeError=function(){throw new $TypeError$3},ThrowTypeError=$gOPD$1?function(){try{return throwTypeError}catch(e){try{return $gOPD$1(arguments,"callee").get}catch(e){return throwTypeError}}}():throwTypeError,hasSymbols=hasSymbols$1(),hasProto=hasProto$1(),getProto=Object.getPrototypeOf||(hasProto?function(e){return e.__proto__}:null),needsEval={},TypedArray="undefined"!=typeof Uint8Array&&getProto?getProto(Uint8Array):undefined$1,INTRINSICS={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto?getProto([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":"undefined"==typeof Atomics?undefined$1:Atomics,"%BigInt%":"undefined"==typeof BigInt?undefined$1:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?undefined$1:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":$Error,"%eval%":eval,"%EvalError%":$EvalError,"%Float32Array%":"undefined"==typeof Float32Array?undefined$1:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?undefined$1:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":"undefined"==typeof Int8Array?undefined$1:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?undefined$1:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto?getProto(getProto([][Symbol.iterator]())):undefined$1,"%JSON%":"object"==typeof JSON?JSON:undefined$1,"%Map%":"undefined"==typeof Map?undefined$1:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&hasSymbols&&getProto?getProto((new Map)[Symbol.iterator]()):undefined$1,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?undefined$1:Promise,"%Proxy%":"undefined"==typeof Proxy?undefined$1:Proxy,"%RangeError%":$RangeError,"%ReferenceError%":$ReferenceError,"%Reflect%":"undefined"==typeof Reflect?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?undefined$1:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&hasSymbols&&getProto?getProto((new Set)[Symbol.iterator]()):undefined$1,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto?getProto(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols?Symbol:undefined$1,"%SyntaxError%":$SyntaxError$1,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError$3,"%Uint8Array%":"undefined"==typeof Uint8Array?undefined$1:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?undefined$1:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?undefined$1:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?undefined$1:Uint32Array,"%URIError%":$URIError,"%WeakMap%":"undefined"==typeof WeakMap?undefined$1:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?undefined$1:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?undefined$1:WeakSet};if(getProto)try{null.error}catch(e5){var errorProto=getProto(getProto(e5));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function e(t){var r,i;return"%AsyncFunction%"===t?r=getEvalledConstructor("async function () {}"):"%GeneratorFunction%"===t?r=getEvalledConstructor("function* () {}"):"%AsyncGeneratorFunction%"===t?r=getEvalledConstructor("async function* () {}"):"%AsyncGenerator%"===t?(i=e("%AsyncGeneratorFunction%"))&&(r=i.prototype):"%AsyncIteratorPrototype%"===t&&(i=e("%AsyncGenerator%"))&&getProto&&(r=getProto(i.prototype)),INTRINSICS[t]=r},LEGACY_ALIASES={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=functionBind,hasOwn$1=hasown,$concat$1=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace$1=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),$exec=bind.call(Function.call,RegExp.prototype.exec),rePropName$1=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar$1=/\\(\\)?/g,stringToPath$2=function(e){var t=$strSlice(e,0,1),r=$strSlice(e,-1);if("%"===t&&"%"!==r)throw new $SyntaxError$1("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new $SyntaxError$1("invalid intrinsic syntax, expected opening `%`");var n=[];return $replace$1(e,rePropName$1,function(e,t,r,i){n[n.length]=r?$replace$1(i,reEscapeChar$1,"$1"):t||e}),n},getBaseIntrinsic=function(e,t){var r,i=e;if(hasOwn$1(LEGACY_ALIASES,i)&&(i="%"+(r=LEGACY_ALIASES[i])[0]+"%"),hasOwn$1(INTRINSICS,i)){var n=INTRINSICS[i];if(void 0!==(n=n===needsEval?doEval(i):n)||t)return{alias:r,name:i,value:n};throw new $TypeError$3("intrinsic "+e+" exists, but is not available. Please file an issue!")}throw new $SyntaxError$1("intrinsic "+e+" does not exist!")},getIntrinsic=function(e,t){if("string"!=typeof e||0===e.length)throw new $TypeError$3("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof t)throw new $TypeError$3('"allowMissing" argument must be a boolean');if(null===$exec(/^%?[^%]*%?$/,e))throw new $SyntaxError$1("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=stringToPath$2(e),i=0<r.length?r[0]:"",n=getBaseIntrinsic("%"+i+"%",t),a=(n.name,n.value),s=!1,n=n.alias;n&&(i=n[0],$spliceApply(r,$concat$1([0,1],n)));for(var o=1,l=!0;o<r.length;o+=1){var u=r[o],c=$strSlice(u,0,1),h=$strSlice(u,-1);if(('"'===c||"'"===c||"`"===c||'"'===h||"'"===h||"`"===h)&&c!==h)throw new $SyntaxError$1("property names with quotes must have matching quotes");if("constructor"!==u&&l||(s=!0),hasOwn$1(INTRINSICS,c="%"+(i+="."+u)+"%"))a=INTRINSICS[c];else if(null!=a){if(!(u in a)){if(t)return;throw new $TypeError$3("base intrinsic for "+e+" exists, but the property is not available.")}a=$gOPD$1&&o+1>=r.length?(l=!!(h=$gOPD$1(a,u)))&&"get"in h&&!("originalValue"in h.get)?h.get:a[u]:(l=hasOwn$1(a,u),a[u]),l&&!s&&(INTRINSICS[c]=a)}}return a},callBind$1={exports:{}},esDefineProperty,hasRequiredEsDefineProperty;function requireEsDefineProperty(){if(!hasRequiredEsDefineProperty){hasRequiredEsDefineProperty=1;var t=getIntrinsic("%Object.defineProperty%",!0)||!1;if(t)try{t({},"a",{value:1})}catch(e){t=!1}esDefineProperty=t}return esDefineProperty}var GetIntrinsic$3=getIntrinsic,$gOPD=GetIntrinsic$3("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch(e5){$gOPD=null}var gopd$1=$gOPD,$defineProperty$1=requireEsDefineProperty(),$SyntaxError=syntax,$TypeError$2=type,gopd=gopd$1,defineDataProperty=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new $TypeError$2("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new $TypeError$2("`property` must be a string or a symbol`");if(3<arguments.length&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new $TypeError$2("`nonEnumerable`, if provided, must be a boolean or null");if(4<arguments.length&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new $TypeError$2("`nonWritable`, if provided, must be a boolean or null");if(5<arguments.length&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new $TypeError$2("`nonConfigurable`, if provided, must be a boolean or null");if(6<arguments.length&&"boolean"!=typeof arguments[6])throw new $TypeError$2("`loose`, if provided, must be a boolean");var i=3<arguments.length?arguments[3]:null,n=4<arguments.length?arguments[4]:null,a=5<arguments.length?arguments[5]:null,s=6<arguments.length&&arguments[6],o=!!gopd&&gopd(e,t);if($defineProperty$1)$defineProperty$1(e,t,{configurable:null===a&&o?o.configurable:!a,enumerable:null===i&&o?o.enumerable:!i,value:r,writable:null===n&&o?o.writable:!n});else{if(!s&&(i||n||a))throw new $SyntaxError("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}},$defineProperty=requireEsDefineProperty(),hasPropertyDescriptors=function(){return!!$defineProperty},hasPropertyDescriptors_1=(hasPropertyDescriptors.hasArrayLengthDefineBug=function(){if(!$defineProperty)return null;try{return 1!==$defineProperty([],"length",{value:1}).length}catch(e){return!0}},hasPropertyDescriptors),GetIntrinsic$2=getIntrinsic,define=defineDataProperty,hasDescriptors=hasPropertyDescriptors_1(),gOPD=gopd$1,$TypeError$1=type,$floor$1=GetIntrinsic$2("%Math.floor%"),setFunctionLength=function(e,t){if("function"!=typeof e)throw new $TypeError$1("`fn` is not a function");if("number"!=typeof t||t<0||4294967295<t||$floor$1(t)!==t)throw new $TypeError$1("`length` must be a positive 32-bit integer");var r,i=2<arguments.length&&!!arguments[2],n=!0,a=!0;return"length"in e&&gOPD&&((r=gOPD(e,"length"))&&!r.configurable&&(n=!1),r)&&!r.writable&&(a=!1),!n&&!a&&i||(hasDescriptors?define(e,"length",t,!0,!0):define(e,"length",t)),e},callBindExports=((e=>{function t(){return l(r,s,arguments)}var r=functionBind,i=getIntrinsic,n=setFunctionLength,a=type,s=i("%Function.prototype.apply%"),o=i("%Function.prototype.call%"),l=i("%Reflect.apply%",!0)||r.call(o,s),u=requireEsDefineProperty(),c=i("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=l(r,o,arguments);return n(t,1+c(0,e.length-(arguments.length-1)),!0)},u?u(e.exports,"apply",{value:t}):e.exports.apply=t})(callBind$1),callBind$1.exports),GetIntrinsic$1=getIntrinsic,callBind=callBindExports,$indexOf=callBind(GetIntrinsic$1("String.prototype.indexOf")),callBound$1=function(e,t){t=GetIntrinsic$1(e,!!t);return"function"==typeof t&&-1<$indexOf(e,".prototype.")?callBind(t):t};let __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);var hasMap$1="function"==typeof Map&&Map.prototype,mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap$1?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,mapSize$1=hasMap$1&&mapSizeDescriptor&&"function"==typeof mapSizeDescriptor.get?mapSizeDescriptor.get:null,mapForEach=hasMap$1&&Map.prototype.forEach,hasSet$1="function"==typeof Set&&Set.prototype,setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet$1?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,setSize=hasSet$1&&setSizeDescriptor&&"function"==typeof setSizeDescriptor.get?setSizeDescriptor.get:null,setForEach=hasSet$1&&Set.prototype.forEach,hasWeakMap="function"==typeof WeakMap&&WeakMap.prototype,weakMapHas=hasWeakMap?WeakMap.prototype.has:null,hasWeakSet="function"==typeof WeakSet&&WeakSet.prototype,weakSetHas=hasWeakSet?WeakSet.prototype.has:null,hasWeakRef="function"==typeof WeakRef&&WeakRef.prototype,weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null,booleanValueOf=Boolean.prototype.valueOf,objectToString$1=Object.prototype.toString,functionToString=Function.prototype.toString,$match=String.prototype.match,$slice=String.prototype.slice,$replace=String.prototype.replace,$toUpperCase=String.prototype.toUpperCase,$toLowerCase=String.prototype.toLowerCase,$test=RegExp.prototype.test,$concat=Array.prototype.concat,$join=Array.prototype.join,$arrSlice=Array.prototype.slice,$floor=Math.floor,bigIntValueOf="function"==typeof BigInt?BigInt.prototype.valueOf:null,gOPS=Object.getOwnPropertySymbols,symToString="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,hasShammedSymbols="function"==typeof Symbol&&"object"==typeof Symbol.iterator,toStringTag="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,isEnumerable=Object.prototype.propertyIsEnumerable,gPO=("function"==typeof Reflect?Reflect:Object).getPrototypeOf||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function addNumericSeparator(e,t){if(e===1/0||e===-1/0||e!=e||e&&-1e3<e&&e<1e3||$test.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var i=e<0?-$floor(-e):$floor(e);if(i!==e)return e=String(i),i=$slice.call(t,e.length+1),$replace.call(e,r,"$&_")+"."+$replace.call($replace.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}return $replace.call(t,r,"$&_")}var utilInspect=require$$0,inspectCustom=utilInspect.custom,inspectSymbol=isSymbol$2(inspectCustom)?inspectCustom:null,objectInspect=function i(r,e,n,a){var s=e||{};if(has$3(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(has$3(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');e=!has$3(s,"customInspect")||s.customInspect;if("boolean"!=typeof e&&"symbol"!==e)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(has$3(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&0<s.indent))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(has$3(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var t=s.numericSeparator;if(void 0===r)return"undefined";if(null===r)return"null";if("boolean"==typeof r)return r?"true":"false";if("string"==typeof r)return inspectString(r,s);if("number"==typeof r)return 0===r?0<1/0/r?"0":"-0":(h=String(r),t?addNumericSeparator(r,h):h);if("bigint"==typeof r)return h=String(r)+"n",t?addNumericSeparator(r,h):h;t=void 0===s.depth?5:s.depth;if(t<=(n=void 0===n?0:n)&&0<t&&"object"==typeof r)return isArray$6(r)?"[Array]":"[Object]";var o,l,u,c,h=getIndent(s,n);if(void 0===a)a=[];else if(0<=indexOf(a,r))return"[Circular]";function d(e,t,r){return t&&(a=$arrSlice.call(a)).push(t),r?(t={depth:s.depth},has$3(s,"quoteStyle")&&(t.quoteStyle=s.quoteStyle),i(e,t,n+1,a)):i(e,s,n+1,a)}if("function"==typeof r&&!isRegExp$1(r))return"[Function"+((u=nameOf(r))?": "+u:" (anonymous)")+"]"+(0<(u=arrObjKeys(r,d)).length?" { "+$join.call(u,", ")+" }":"");if(isSymbol$2(r))return u=hasShammedSymbols?$replace.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(r),"object"!=typeof r||hasShammedSymbols?u:markBoxed(u);if(isElement(r)){for(var p="<"+$toLowerCase.call(String(r.nodeName)),f=r.attributes||[],m=0;m<f.length;m++)p+=" "+f[m].name+"="+wrapQuotes(quote(f[m].value),"double",s);return p+=">",r.childNodes&&r.childNodes.length&&(p+="..."),p+="</"+$toLowerCase.call(String(r.nodeName))+">"}if(isArray$6(r))return 0===r.length?"[]":(u=arrObjKeys(r,d),h&&!singleLineValues(u)?"["+indentedJoin(u,h)+"]":"[ "+$join.call(u,", ")+" ]");if(isError(r))return u=arrObjKeys(r,d),"cause"in Error.prototype||!("cause"in r)||isEnumerable.call(r,"cause")?0===u.length?"["+String(r)+"]":"{ ["+String(r)+"] "+$join.call(u,", ")+" }":"{ ["+String(r)+"] "+$join.call($concat.call("[cause]: "+d(r.cause),u),", ")+" }";if("object"==typeof r&&e){if(inspectSymbol&&"function"==typeof r[inspectSymbol]&&utilInspect)return utilInspect(r,{depth:t-n});if("symbol"!==e&&"function"==typeof r.inspect)return r.inspect()}return isMap$3(r)?(o=[],mapForEach&&mapForEach.call(r,function(e,t){o.push(d(t,r,!0)+" => "+d(e,r))}),collectionOf("Map",mapSize$1.call(r),o,h)):isSet$3(r)?(l=[],setForEach&&setForEach.call(r,function(e){l.push(d(e,r))}),collectionOf("Set",setSize.call(r),l,h)):isWeakMap(r)?weakCollectionOf("WeakMap"):isWeakSet(r)?weakCollectionOf("WeakSet"):isWeakRef(r)?weakCollectionOf("WeakRef"):isNumber$1(r)?markBoxed(d(Number(r))):isBigInt(r)?markBoxed(d(bigIntValueOf.call(r))):isBoolean(r)?markBoxed(booleanValueOf.call(r)):isString$1(r)?markBoxed(d(String(r))):"undefined"!=typeof window&&r===window?"{ [object Window] }":"undefined"!=typeof globalThis&&r===globalThis||void 0!==commonjsGlobal&&r===commonjsGlobal?"{ [object globalThis] }":isDate(r)||isRegExp$1(r)?String(r):(u=arrObjKeys(r,d),t=gPO?gPO(r)===Object.prototype:r instanceof Object||r.constructor===Object,e=r instanceof Object?"":"null prototype",c=!t&&toStringTag&&Object(r)===r&&toStringTag in r?$slice.call(toStr(r),8,-1):e?"Object":"",t=(!t&&"function"==typeof r.constructor&&r.constructor.name?r.constructor.name+" ":"")+(c||e?"["+$join.call($concat.call([],c||[],e||[]),": ")+"] ":""),0===u.length?t+"{}":h?t+"{"+indentedJoin(u,h)+"}":t+"{ "+$join.call(u,", ")+" }")};function wrapQuotes(e,t,r){r="double"===(r.quoteStyle||t)?'"':"'";return r+e+r}function quote(e){return $replace.call(String(e),/"/g,"&quot;")}function isArray$6(e){return!("[object Array]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isDate(e){return!("[object Date]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isRegExp$1(e){return!("[object RegExp]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isError(e){return!("[object Error]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isString$1(e){return!("[object String]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isNumber$1(e){return!("[object Number]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isBoolean(e){return!("[object Boolean]"!==toStr(e)||toStringTag&&"object"==typeof e&&toStringTag in e)}function isSymbol$2(e){if(hasShammedSymbols)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(e&&"object"==typeof e&&symToString)try{return symToString.call(e),!0}catch(e){}return!1}function isBigInt(e){if(e&&"object"==typeof e&&bigIntValueOf)try{return bigIntValueOf.call(e),!0}catch(e){}return!1}var hasOwn=Object.prototype.hasOwnProperty||function(e){return e in this};function has$3(e,t){return hasOwn.call(e,t)}function toStr(e){return objectToString$1.call(e)}function nameOf(e){return e.name||((e=$match.call(functionToString.call(e),/^function\s*([\w$]+)/))?e[1]:null)}function indexOf(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function isMap$3(e){if(mapSize$1&&e&&"object"==typeof e)try{mapSize$1.call(e);try{setSize.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}function isWeakMap(e){if(weakMapHas&&e&&"object"==typeof e)try{weakMapHas.call(e,weakMapHas);try{weakSetHas.call(e,weakSetHas)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}function isWeakRef(e){if(weakRefDeref&&e&&"object"==typeof e)try{return weakRefDeref.call(e),!0}catch(e){}return!1}function isSet$3(e){if(setSize&&e&&"object"==typeof e)try{setSize.call(e);try{mapSize$1.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}function isWeakSet(e){if(weakSetHas&&e&&"object"==typeof e)try{weakSetHas.call(e,weakSetHas);try{weakMapHas.call(e,weakMapHas)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}function isElement(e){return!(!e||"object"!=typeof e)&&("undefined"!=typeof HTMLElement&&e instanceof HTMLElement||"string"==typeof e.nodeName&&"function"==typeof e.getAttribute)}function inspectString(e,t){var r;return e.length>t.maxStringLength?(r="... "+(r=e.length-t.maxStringLength)+" more character"+(1<r?"s":""),inspectString($slice.call(e,0,t.maxStringLength),t)+r):wrapQuotes($replace.call($replace.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte),"single",t)}function lowbyte(e){var e=e.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+$toUpperCase.call(e.toString(16))}function markBoxed(e){return"Object("+e+")"}function weakCollectionOf(e){return e+" { ? }"}function collectionOf(e,t,r,i){return e+" ("+t+") {"+(i?indentedJoin(r,i):$join.call(r,", "))+"}"}function singleLineValues(e){for(var t=0;t<e.length;t++)if(0<=indexOf(e[t],"\n"))return!1;return!0}function getIndent(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&0<e.indent))return null;r=$join.call(Array(e.indent+1)," ")}return{base:r,prev:$join.call(Array(t+1),r)}}function indentedJoin(e,t){var r;return 0===e.length?"":(r="\n"+t.prev+t.base)+$join.call(e,","+r)+"\n"+t.prev}function arrObjKeys(e,t){var r=isArray$6(e),i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++)i[n]=has$3(e,n)?t(e[n],e):""}var a,s="function"==typeof gOPS?gOPS(e):[];if(hasShammedSymbols)for(var o={},l=0;l<s.length;l++)o["$"+s[l]]=s[l];for(a in e)!has$3(e,a)||r&&String(Number(a))===a&&a<e.length||hasShammedSymbols&&o["$"+a]instanceof Symbol||($test.call(/[^\w$]/,a)?i.push(t(a,e)+": "+t(e[a],e)):i.push(a+": "+t(e[a],e)));if("function"==typeof gOPS)for(var u=0;u<s.length;u++)isEnumerable.call(e,s[u])&&i.push("["+t(s[u])+"]: "+t(e[s[u]],e));return i}var GetIntrinsic=getIntrinsic,callBound=callBound$1,inspect=objectInspect,$TypeError=type,$WeakMap=GetIntrinsic("%WeakMap%",!0),$Map=GetIntrinsic("%Map%",!0),$weakMapGet=callBound("WeakMap.prototype.get",!0),$weakMapSet=callBound("WeakMap.prototype.set",!0),$weakMapHas=callBound("WeakMap.prototype.has",!0),$mapGet=callBound("Map.prototype.get",!0),$mapSet=callBound("Map.prototype.set",!0),$mapHas=callBound("Map.prototype.has",!0),listGetNode=function(e,t){for(var r,i=e;null!==(r=i.next);i=r)if(r.key===t)return i.next=r.next,r.next=e.next,e.next=r},listGet=function(e,t){e=listGetNode(e,t);return e&&e.value},listSet=function(e,t,r){var i=listGetNode(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}},listHas=function(e,t){return!!listGetNode(e,t)},sideChannel=function(){var r,i,n,t={assert:function(e){if(!t.has(e))throw new $TypeError("Side channel does not contain "+inspect(e))},get:function(e){if($WeakMap&&e&&("object"==typeof e||"function"==typeof e)){if(r)return $weakMapGet(r,e)}else if($Map){if(i)return $mapGet(i,e)}else if(n)return listGet(n,e)},has:function(e){if($WeakMap&&e&&("object"==typeof e||"function"==typeof e)){if(r)return $weakMapHas(r,e)}else if($Map){if(i)return $mapHas(i,e)}else if(n)return listHas(n,e);return!1},set:function(e,t){$WeakMap&&e&&("object"==typeof e||"function"==typeof e)?(r=r||new $WeakMap,$weakMapSet(r,e,t)):$Map?(i=i||new $Map,$mapSet(i,e,t)):listSet(n=n||{key:{},next:null},e,t)}};return t},replace=String.prototype.replace,percentTwenties=/%20/g,Format={RFC1738:"RFC1738",RFC3986:"RFC3986"},formats$4={default:Format.RFC3986,formatters:{RFC1738:function(e){return replace.call(e,percentTwenties,"+")},RFC3986:function(e){return String(e)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986},formats$3=formats$4,has$2=Object.prototype.hasOwnProperty,isArray$5=Array.isArray,hexTable=(()=>{for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),compactQueue=function(e){for(;1<e.length;){var t=e.pop(),r=t.obj[t.prop];if(isArray$5(r)){for(var i=[],n=0;n<r.length;++n)void 0!==r[n]&&i.push(r[n]);t.obj[t.prop]=i}}},arrayToObject=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r},merge=function i(n,a,s){if(!a)return n;if("object"!=typeof a){if(isArray$5(n))n.push(a);else{if(!n||"object"!=typeof n)return[n,a];(s&&(s.plainObjects||s.allowPrototypes)||!has$2.call(Object.prototype,a))&&(n[a]=!0)}return n}var e;return n&&"object"==typeof n?(isArray$5(e=n)&&!isArray$5(a)&&(e=arrayToObject(n,s)),isArray$5(n)&&isArray$5(a)?(a.forEach(function(e,t){var r;has$2.call(n,t)?(r=n[t])&&"object"==typeof r&&e&&"object"==typeof e?n[t]=i(r,e,s):n.push(e):n[t]=e}),n):Object.keys(a).reduce(function(e,t){var r=a[t];return has$2.call(e,t)?e[t]=i(e[t],r,s):e[t]=r,e},e)):[n].concat(a)},assign=function(e,r){return Object.keys(r).reduce(function(e,t){return e[t]=r[t],e},e)},decode=function(t,e,r){t=t.replace(/\+/g," ");if("iso-8859-1"===r)return t.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(t)}catch(e){return t}},limit=1024,encode=function(e,t,r,i,n){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var s="",o=0;o<a.length;o+=limit){for(var l=a.length>=limit?a.slice(o,o+limit):a,u=[],c=0;c<l.length;++c){var h=l.charCodeAt(c);45===h||46===h||95===h||126===h||48<=h&&h<=57||65<=h&&h<=90||97<=h&&h<=122||n===formats$3.RFC1738&&(40===h||41===h)?u[u.length]=l.charAt(c):h<128?u[u.length]=hexTable[h]:h<2048?u[u.length]=hexTable[192|h>>6]+hexTable[128|63&h]:h<55296||57344<=h?u[u.length]=hexTable[224|h>>12]+hexTable[128|h>>6&63]+hexTable[128|63&h]:(c+=1,h=65536+((1023&h)<<10|1023&l.charCodeAt(c)),u[u.length]=hexTable[240|h>>18]+hexTable[128|h>>12&63]+hexTable[128|h>>6&63]+hexTable[128|63&h])}s+=u.join("")}return s},compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var n=t[i],a=n.obj[n.prop],s=Object.keys(a),o=0;o<s.length;++o){var l=s[o],u=a[l];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:a,prop:l}),r.push(u))}return compactQueue(t),e},isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isBuffer$2=function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},combine=function(e,t){return[].concat(e,t)},maybeMap=function(e,t){if(isArray$5(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)},utils$2={arrayToObject:arrayToObject,assign:assign,combine:combine,compact:compact,decode:decode,encode:encode,isBuffer:isBuffer$2,isRegExp:isRegExp,maybeMap:maybeMap,merge:merge},getSideChannel=sideChannel,utils$1=utils$2,formats$2=formats$4,has$1=Object.prototype.hasOwnProperty,arrayPrefixGenerators={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},isArray$4=Array.isArray,push=Array.prototype.push,pushToArray=function(e,t){push.apply(e,isArray$4(t)?t:[t])},toISO=Date.prototype.toISOString,defaultFormat=formats$2.default,defaults$1={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:utils$1.encode,encodeValuesOnly:!1,format:defaultFormat,formatter:formats$2.formatters[defaultFormat],indices:!1,serializeDate:function(e){return toISO.call(e)},skipNulls:!1,strictNullHandling:!1},isNonNullishPrimitive=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"bigint"==typeof e},sentinel={},stringify$1=function e(t,r,i,n,a,s,o,l,u,c,h,d,p,f,m,g,v,y){for(var _=t,b=y,x=0,S=!1;void 0!==(b=b.get(sentinel))&&!S;){var T=b.get(t);if(x+=1,void 0!==T){if(T===x)throw new RangeError("Cyclic object value");S=!0}void 0===b.get(sentinel)&&(x=0)}if("function"==typeof c?_=c(r,_):_ instanceof Date?_=p(_):"comma"===i&&isArray$4(_)&&(_=utils$1.maybeMap(_,function(e){return e instanceof Date?p(e):e})),null===_){if(s)return u&&!g?u(r,defaults$1.encoder,v,"key",f):r;_=""}if(isNonNullishPrimitive(_)||utils$1.isBuffer(_))return u?[m(g?r:u(r,defaults$1.encoder,v,"key",f))+"="+m(u(_,defaults$1.encoder,v,"value",f))]:[m(r)+"="+m(String(_))];var E=[];if(void 0!==_){C="comma"===i&&isArray$4(_)?[{value:0<(_=g&&u?utils$1.maybeMap(_,u):_).length?_.join(",")||null:void 0}]:isArray$4(c)?c:(A=Object.keys(_),h?A.sort(h):A);var C,A=l?r.replace(/\./g,"%2E"):r,w=n&&isArray$4(_)&&1===_.length?A+"[]":A;if(a&&isArray$4(_)&&0===_.length)return w+"[]";for(var P=0;P<C.length;++P){var M,I=C[P],D="object"==typeof I&&void 0!==I.value?I.value:_[I];o&&null===D||(I=d&&l?I.replace(/\./g,"%2E"):I,I=isArray$4(_)?"function"==typeof i?i(w,I):w:w+(d?"."+I:"["+I+"]"),y.set(t,x),(M=getSideChannel()).set(sentinel,y),pushToArray(E,e(D,I,i,n,a,s,o,l,"comma"===i&&g&&isArray$4(_)?null:u,c,h,d,p,f,m,g,v,M)))}}return E},normalizeStringifyOptions=function(e){if(!e)return defaults$1;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!=e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||defaults$1.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=formats$2.default;if(void 0!==e.format){if(!has$1.call(formats$2.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i,n=formats$2.formatters[r],a=defaults$1.filter;if("function"!=typeof e.filter&&!isArray$4(e.filter)||(a=e.filter),i=e.arrayFormat in arrayPrefixGenerators?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":defaults$1.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var s=void 0===e.allowDots?!0===e.encodeDotInKeys||defaults$1.allowDots:!!e.allowDots;return{addQueryPrefix:("boolean"==typeof e.addQueryPrefix?e:defaults$1).addQueryPrefix,allowDots:s,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:defaults$1.allowEmptyArrays,arrayFormat:i,charset:t,charsetSentinel:("boolean"==typeof e.charsetSentinel?e:defaults$1).charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:(void 0===e.delimiter?defaults$1:e).delimiter,encode:("boolean"==typeof e.encode?e:defaults$1).encode,encodeDotInKeys:("boolean"==typeof e.encodeDotInKeys?e:defaults$1).encodeDotInKeys,encoder:("function"==typeof e.encoder?e:defaults$1).encoder,encodeValuesOnly:("boolean"==typeof e.encodeValuesOnly?e:defaults$1).encodeValuesOnly,filter:a,format:r,formatter:n,serializeDate:("function"==typeof e.serializeDate?e:defaults$1).serializeDate,skipNulls:("boolean"==typeof e.skipNulls?e:defaults$1).skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:("boolean"==typeof e.strictNullHandling?e:defaults$1).strictNullHandling}},stringify_1=function(e,t){var r=e,i=normalizeStringifyOptions(t),n=("function"==typeof i.filter?r=(0,i.filter)("",r):isArray$4(i.filter)&&(o=i.filter),[]);if("object"!=typeof r||null===r)return"";var a=arrayPrefixGenerators[i.arrayFormat],s="comma"===a&&i.commaRoundTrip,o=o||Object.keys(r);i.sort&&o.sort(i.sort);for(var l=getSideChannel(),u=0;u<o.length;++u){var c=o[u];i.skipNulls&&null===r[c]||pushToArray(n,stringify$1(r[c],c,a,s,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,l))}e=n.join(i.delimiter),t=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&("iso-8859-1"===i.charset?t+="utf8=%26%2310003%3B&":t+="utf8=%E2%9C%93&"),0<e.length?t+e:""},utils=utils$2,has=Object.prototype.hasOwnProperty,isArray$3=Array.isArray,defaults={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:utils.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},interpretNumericEntities=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},parseArrayValue=function(e,t){return e&&"string"==typeof e&&t.comma&&-1<e.indexOf(",")?e.split(","):e},isoSentinel="utf8=%26%2310003%3B",charsetSentinel="utf8=%E2%9C%93",parseValues=function(e,t){var r,i,n,a,s={__proto__:null},e=(e=t.ignoreQueryPrefix?e.replace(/^\?/,""):e).replace(/%5B/gi,"[").replace(/%5D/gi,"]"),o=t.parameterLimit===1/0?void 0:t.parameterLimit,l=e.split(t.delimiter,o),u=-1,c=t.charset;if(t.charsetSentinel)for(r=0;r<l.length;++r)0===l[r].indexOf("utf8=")&&(l[r]===charsetSentinel?c="utf-8":l[r]===isoSentinel&&(c="iso-8859-1"),u=r,r=l.length);for(r=0;r<l.length;++r)r!==u&&((n=-1===(n=-1===(n=(a=l[r]).indexOf("]="))?a.indexOf("="):n+1)?(i=t.decoder(a,defaults.decoder,c,"key"),t.strictNullHandling?null:""):(i=t.decoder(a.slice(0,n),defaults.decoder,c,"key"),utils.maybeMap(parseArrayValue(a.slice(n+1),t),function(e){return t.decoder(e,defaults.decoder,c,"value")})))&&t.interpretNumericEntities&&"iso-8859-1"===c&&(n=interpretNumericEntities(n)),-1<a.indexOf("[]=")&&(n=isArray$3(n)?[n]:n),(a=has.call(s,i))&&"combine"===t.duplicates?s[i]=utils.combine(s[i],n):a&&"last"!==t.duplicates||(s[i]=n));return s},parseObject=function(e,t,r,i){for(var n=i?t:parseArrayValue(t,r),a=e.length-1;0<=a;--a){var s,o,l,u=e[a];"[]"===u&&r.parseArrays?s=r.allowEmptyArrays&&(""===n||r.strictNullHandling&&null===n)?[]:[].concat(n):(s=r.plainObjects?Object.create(null):{},o="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,o=r.decodeDotInKeys?o.replace(/%2E/g,"."):o,l=parseInt(o,10),r.parseArrays||""!==o?!isNaN(l)&&u!==o&&String(l)===o&&0<=l&&r.parseArrays&&l<=r.arrayLimit?(s=[])[l]=n:"__proto__"!==o&&(s[o]=n):s={0:n}),n=s}return n},parseKeys=function(e,t,r,i){if(e){var n=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=0<r.depth&&/(\[[^[\]]*])/.exec(n),e=s?n.slice(0,s.index):n,o=[];if(e){if(!r.plainObjects&&has.call(Object.prototype,e)&&!r.allowPrototypes)return;o.push(e)}for(var l=0;0<r.depth&&null!==(s=a.exec(n))&&l<r.depth;){if(l+=1,!r.plainObjects&&has.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;o.push(s[1])}if(s){if(!0===r.strictDepth)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");o.push("["+n.slice(s.index)+"]")}return parseObject(o,t,r,i)}},normalizeParseOptions=function(e){if(!e)return defaults;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.decodeDotInKeys&&"boolean"!=typeof e.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!=e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=(void 0===e.charset?defaults:e).charset,r=(void 0===e.duplicates?defaults:e).duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===e.allowDots?!0===e.decodeDotInKeys||defaults.allowDots:!!e.allowDots,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:defaults.allowEmptyArrays,allowPrototypes:("boolean"==typeof e.allowPrototypes?e:defaults).allowPrototypes,allowSparse:("boolean"==typeof e.allowSparse?e:defaults).allowSparse,arrayLimit:("number"==typeof e.arrayLimit?e:defaults).arrayLimit,charset:t,charsetSentinel:("boolean"==typeof e.charsetSentinel?e:defaults).charsetSentinel,comma:("boolean"==typeof e.comma?e:defaults).comma,decodeDotInKeys:("boolean"==typeof e.decodeDotInKeys?e:defaults).decodeDotInKeys,decoder:("function"==typeof e.decoder?e:defaults).decoder,delimiter:("string"==typeof e.delimiter||utils.isRegExp(e.delimiter)?e:defaults).delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:defaults.depth,duplicates:r,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:("boolean"==typeof e.interpretNumericEntities?e:defaults).interpretNumericEntities,parameterLimit:("number"==typeof e.parameterLimit?e:defaults).parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:("boolean"==typeof e.plainObjects?e:defaults).plainObjects,strictDepth:"boolean"==typeof e.strictDepth?!!e.strictDepth:defaults.strictDepth,strictNullHandling:("boolean"==typeof e.strictNullHandling?e:defaults).strictNullHandling}},parse$4=function(e,t){var r=normalizeParseOptions(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var i="string"==typeof e?parseValues(e,r):e,n=r.plainObjects?Object.create(null):{},a=Object.keys(i),s=0;s<a.length;++s)var o=a[s],o=parseKeys(o,i[o],r,"string"==typeof e),n=utils.merge(n,o,r);return!0===r.allowSparse?n:utils.compact(n)},stringify=stringify_1,parse$3=parse$4,formats$1=formats$4,lib$2={formats:formats$1,parse:parse$3,stringify:stringify},punycode=punycodeExports;function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=lib$2;function urlParse(e,t,r){var i;return e&&"object"==typeof e&&e instanceof Url?e:((i=new Url).parse(e,t,r),i)}function urlFormat(e){return(e="string"==typeof e?urlParse(e):e)instanceof Url?e.format():Url.prototype.format.call(e)}function urlResolve(e,t){return urlParse(e,!1,!0).resolve(t)}Url.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),i=-1!==i&&i<e.indexOf("#")?"?":"#",n=e.split(i);n[0]=n[0].replace(/\\/g,"/");var a=(a=e=n.join(i)).trim();if(!r&&1===e.split("#").length){n=simplePathPattern.exec(a);if(n)return this.path=a,this.href=a,this.pathname=n[1],n[2]?(this.search=n[2],this.query=t?querystring.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var s,i=protocolPattern.exec(a);if(i&&(s=(i=i[0]).toLowerCase(),this.protocol=s,a=a.substr(i.length)),!(r||i||a.match(/^\/\/[^@/]+@[^@/]+/))||!(b="//"===a.substr(0,2))||i&&hostlessProtocol[i]||(a=a.substr(2),this.slashes=!0),!hostlessProtocol[i]&&(b||i&&!slashedProtocol[i])){for(var o=-1,l=0;l<hostEndingChars.length;l++)-1!==(u=a.indexOf(hostEndingChars[l]))&&(-1===o||u<o)&&(o=u);-1!==(e=-1===o?a.lastIndexOf("@"):a.lastIndexOf("@",o))&&(n=a.slice(0,e),a=a.slice(e+1),this.auth=decodeURIComponent(n));for(var u,o=-1,l=0;l<nonHostChars.length;l++)-1!==(u=a.indexOf(nonHostChars[l]))&&(-1===o||u<o)&&(o=u);-1===o&&(o=a.length),this.host=a.slice(0,o),a=a.slice(o),this.parseHost(),this.hostname=this.hostname||"";r="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!r)for(var c=this.hostname.split(/\./),l=0,h=c.length;l<h;l++){var d=c[l];if(d&&!d.match(hostnamePartPattern)){for(var p="",f=0,m=d.length;f<m;f++)127<d.charCodeAt(f)?p+="x":p+=d[f];if(!p.match(hostnamePartPattern)){var g=c.slice(0,l),v=c.slice(l+1),y=d.match(hostnamePartStart);y&&(g.push(y[1]),v.unshift(y[2])),v.length&&(a="/"+v.join(".")+a),this.hostname=g.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),r||(this.hostname=punycode.toASCII(this.hostname));var _=this.port?":"+this.port:"",b=this.hostname||"";this.host=b+_,this.href+=this.host,r&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0])&&(a="/"+a)}if(!unsafeProtocol[s])for(l=0,h=autoEscape.length;l<h;l++){var x,S=autoEscape[l];-1!==a.indexOf(S)&&((x=encodeURIComponent(S))===S&&(x=escape(S)),a=a.split(S).join(x))}i=a.indexOf("#"),-1!==i&&(this.hash=a.substr(i),a=a.slice(0,i)),e=a.indexOf("?");return-1!==e?(this.search=a.substr(e),this.query=a.substr(e+1),t&&(this.query=querystring.parse(this.query)),a=a.slice(0,e)):t&&(this.search="",this.query={}),a&&(this.pathname=a),slashedProtocol[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(_=this.pathname||"",n=this.search||"",this.path=_+n),this.href=this.format(),this},Url.prototype.format=function(){var e=this.auth||"",t=(e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@"),this.protocol||""),r=this.pathname||"",i=this.hash||"",n=!1,a="",e=(this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port)&&(n+=":"+this.port),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(a=querystring.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1})),this.search||a&&"?"+a||"");return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||slashedProtocol[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n=n||"",i&&"#"!==i.charAt(0)&&(i="#"+i),e&&"?"!==e.charAt(0)&&(e="?"+e),t+n+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(e=e.replace("#","%23"))+i},Url.prototype.resolve=function(e){return this.resolveObject(urlParse(e,!1,!0)).format()},Url.prototype.resolveObject=function(e){"string"==typeof e&&((d=new Url).parse(e,!1,!0),e=d);for(var t=new Url,r=Object.keys(this),i=0;i<r.length;i++){var n=r[i];t[n]=this[n]}if(t.hash=e.hash,""!==e.href)if(e.slashes&&!e.protocol){for(var a=Object.keys(e),s=0;s<a.length;s++){var o=a[s];"protocol"!==o&&(t[o]=e[o])}slashedProtocol[t.protocol]&&t.hostname&&!t.pathname&&(t.pathname="/",t.path=t.pathname)}else if(e.protocol&&e.protocol!==t.protocol)if(slashedProtocol[e.protocol]){if(t.protocol=e.protocol,e.host||hostlessProtocol[e.protocol])t.pathname=e.pathname;else{for(var l=(e.pathname||"").split("/");l.length&&!(e.host=l.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==l[0]&&l.unshift(""),l.length<2&&l.unshift(""),t.pathname=l.join("/")}t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,(t.pathname||t.search)&&(d=t.pathname||"",p=t.search||"",t.path=d+p),t.slashes=t.slashes||e.slashes}else for(var u=Object.keys(e),c=0;c<u.length;c++){var h=u[c];t[h]=e[h]}else{var d=t.pathname&&"/"===t.pathname.charAt(0),p=e.host||e.pathname&&"/"===e.pathname.charAt(0),d=p||d||t.host&&e.pathname,f=d,m=t.pathname&&t.pathname.split("/")||[],l=e.pathname&&e.pathname.split("/")||[],g=t.protocol&&!slashedProtocol[t.protocol];if(g&&(t.hostname="",t.port=null,t.host&&(""===m[0]?m[0]=t.host:m.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===l[0]?l[0]=e.host:l.unshift(e.host)),e.host=null),d=d&&(""===l[0]||""===m[0])),p)t.host=(e.host||""===e.host?e:t).host,t.hostname=(e.hostname||""===e.hostname?e:t).hostname,t.search=e.search,t.query=e.query,m=l;else if(l.length)(m=m||[]).pop(),m=m.concat(l),t.search=e.search,t.query=e.query;else if(null!=e.search)return g&&(t.host=m.shift(),t.hostname=t.host,b=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=b.shift(),t.hostname=b.shift(),t.host=t.hostname),t.search=e.search,t.query=e.query,null===t.pathname&&null===t.search||(t.path=(t.pathname||"")+(t.search||"")),t.href=t.format(),t;if(m.length){for(var v=m.slice(-1)[0],p=(t.host||e.host||1<m.length)&&("."===v||".."===v)||""===v,y=0,_=m.length;0<=_;_--)"."===(v=m[_])?m.splice(_,1):".."===v?(m.splice(_,1),y++):y&&(m.splice(_,1),y--);if(!d&&!f)for(;y--;)m.unshift("..");!d||""===m[0]||m[0]&&"/"===m[0].charAt(0)||m.unshift(""),p&&"/"!==m.join("/").substr(-1)&&m.push("");var b,f=""===m[0]||m[0]&&"/"===m[0].charAt(0);g&&(t.hostname=!f&&m.length?m.shift():"",t.host=t.hostname,b=!!(t.host&&0<t.host.indexOf("@"))&&t.host.split("@"))&&(t.auth=b.shift(),t.hostname=b.shift(),t.host=t.hostname),(d=d||t.host&&m.length)&&!f&&m.unshift(""),0<m.length?t.pathname=m.join("/"):(t.pathname=null,t.path=null),null===t.pathname&&null===t.search||(t.path=(t.pathname||"")+(t.search||"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes}else t.pathname=null,t.search?t.path="/"+t.search:t.path=null}return t.href=t.format(),t},Url.prototype.parseHost=function(){var e=this.host,t=portPattern.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var parse$2=urlParse,resolve=urlResolve,format=urlFormat;let warnings={};function deprecation(e,t,r=3){if(!warnings[t]){let e=(new Error).stack;"u"<typeof e||(e=e.split(`
`).splice(r).join(`
`),console.groupCollapsed),warnings[t]=!0}}let url$1={get parse(){return deprecation("7.3.0","utils.url.parse is deprecated, use native URL API instead."),parse$2},get format(){return deprecation("7.3.0","utils.url.format is deprecated, use native URL API instead."),format},get resolve(){return deprecation("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),resolve}};function assertPath(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function removeUrlParams(e){return e.split("?")[0].split("#")[0]}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function replaceAll(e,t,r){return e.replace(new RegExp(escapeRegExp(t),"g"),r)}function normalizeStringPosix(t,r){let i="",n=0,a=-1,s=0,o=-1;for(let e=0;e<=t.length;++e){if(e<t.length)o=t.charCodeAt(e);else{if(47===o)break;o=47}if(47===o){if(a!==e-1&&1!==s)if(a!==e-1&&2===s){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(2<i.length){var l=i.lastIndexOf("/");if(l!==i.length-1){n=-1===l?(i="",0):(i=i.slice(0,l)).length-1-i.lastIndexOf("/"),a=e,s=0;continue}}else if(2===i.length||1===i.length){i="",n=0,a=e,s=0;continue}r&&(0<i.length?i+="/..":i="..",n=2)}else 0<i.length?i+="/"+t.slice(a+1,e):i=t.slice(a+1,e),n=e-a-1;a=e,s=0}else 46===o&&-1!==s?++s:s=-1}return i}let path={toPosix(e){return replaceAll(e,"\\","/")},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl(e){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e)},isBlobUrl(e){return e.startsWith("blob:")},hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){assertPath(e),e=this.toPosix(e);var t=/^file:\/\/\//.exec(e);return(t=t||/^[^/:]+:\/{0,2}/.exec(e))?t[0]:""},toAbsolute(e,t,r){return assertPath(e),this.isDataUrl(e)||this.isBlobUrl(e)?e:(t=removeUrlParams(this.toPosix(t??settings.ADAPTER.getBaseUrl())),r=removeUrlParams(this.toPosix(r??this.rootname(t))),(e=this.toPosix(e)).startsWith("/")?path.join(r,e.slice(1)):this.isAbsolute(e)?e:this.join(t,e))},normalize(e){if(assertPath(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;let t="";var r=(e=this.toPosix(e)).startsWith("/"),i=(this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length)),e.endsWith("/"));return 0<(e=normalizeStringPosix(e,!1)).length&&i&&(e+="/"),r?"/"+e:t+e},isAbsolute(e){return assertPath(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join(...t){if(0===t.length)return".";let r;for(let e=0;e<t.length;++e){var i,n=t[e];assertPath(n),0<n.length&&(void 0===r?r=n:(i=t[e-1]??"",this.joinExtensions.includes(this.extname(i).toLowerCase())?r+="/../"+n:r+="/"+n))}return void 0===r?".":this.normalize(r)},dirname(t){if(assertPath(t),0===t.length)return".";var e=47===(t=this.toPosix(t)).charCodeAt(0);let r=-1,i=!0;var n=this.getProtocol(t),a=t;for(let e=(t=t.slice(n.length)).length-1;1<=e;--e)if(47===t.charCodeAt(e)){if(!i){r=e;break}}else i=!1;return-1===r?e?"/":this.isUrl(a)?n+t:n:e&&1===r?"//":n+t.slice(0,r)},rootname(e){assertPath(e),e=this.toPosix(e);let t="";var r;return t=e.startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)&&(r=e.indexOf("/",t.length),(t=-1!==r?e.slice(0,r):e).endsWith("/")||(t+="/")),t},basename(r,i){assertPath(r),i&&assertPath(i),r=removeUrlParams(this.toPosix(r));let n=0,a=-1,s=!0,o;if(void 0!==i&&0<i.length&&i.length<=r.length){if(i.length===r.length&&i===r)return"";let e=i.length-1,t=-1;for(o=r.length-1;0<=o;--o){var l=r.charCodeAt(o);if(47===l){if(!s){n=o+1;break}}else-1===t&&(s=!1,t=o+1),0<=e&&(l===i.charCodeAt(e)?-1==--e&&(a=o):(e=-1,a=t))}return n===a?a=t:-1===a&&(a=r.length),r.slice(n,a)}for(o=r.length-1;0<=o;--o)if(47===r.charCodeAt(o)){if(!s){n=o+1;break}}else-1===a&&(s=!1,a=o+1);return-1===a?"":r.slice(n,a)},extname(t){assertPath(t);let r=-1,i=0,n=-1,a=!0,s=0;for(let e=(t=removeUrlParams(this.toPosix(t))).length-1;0<=e;--e){var o=t.charCodeAt(e);if(47===o){if(a)continue;i=e+1;break}-1===n&&(a=!1,n=e+1),46===o?-1===r?r=e:1!==s&&(s=1):-1!==r&&(s=-1)}return-1===r||-1===n||0===s||1===s&&r===n-1&&r===i+1?"":t.slice(r,n)},parse(o){assertPath(o);var l={root:"",dir:"",base:"",ext:"",name:""};if(0!==o.length){(o=removeUrlParams(this.toPosix(o))).charCodeAt(0);var u,c=this.isAbsolute(o);let e,t=(l.root=this.rootname(o),e=c||this.hasProtocol(o)?1:0,-1),r=0,i=-1,n=!0,a=o.length-1,s=0;for(;a>=e;--a){if(47===(u=o.charCodeAt(a))){if(n)continue;r=a+1;break}-1===i&&(n=!1,i=a+1),46===u?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1)}-1===t||-1===i||0===s||1===s&&t===i-1&&t===r+1?-1!==i&&(0===r&&c?l.base=l.name=o.slice(1,i):l.base=l.name=o.slice(r,i)):(0===r&&c?(l.name=o.slice(1,t),l.base=o.slice(1,i)):(l.name=o.slice(r,t),l.base=o.slice(r,i)),l.ext=o.slice(t,i)),l.dir=this.dirname(o)}return l},sep:"/",delimiter:":",joinExtensions:[".html"]},promise;async function detectVideoAlphaMode(){return promise=promise??(async()=>{var e,t,r,i=document.createElement("canvas").getContext("webgl");return i&&(r=await new Promise(e=>{let t=document.createElement("video");t.onloadeddata=()=>e(t),t.onerror=()=>e(null),t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()}))&&(e=i.createTexture(),i.bindTexture(i.TEXTURE_2D,e),t=i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,t),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),r=new Uint8Array(4),i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,r),i.deleteFramebuffer(t),i.deleteTexture(e),null!=(t=i.getExtension("WEBGL_lose_context"))&&t.loseContext(),r[0]<=r[3])?ALPHA_MODES.PMA:ALPHA_MODES.UNPACK})()}function skipHello(){deprecation("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function sayHello(){deprecation("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}let supported;function isWebGLSupported(){return supported="u"<typeof supported?(()=>{var t,r={stencil:!0,failIfMajorPerformanceCaveat:settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!settings.ADAPTER.getWebGLRenderingContext())return!1;var i=settings.ADAPTER.createCanvas();let e=i.getContext("webgl",r)||i.getContext("experimental-webgl",r);var n,a=!(null==(t=null==e?void 0:e.getContextAttributes())||!t.stencil);return e&&(n=e.getExtension("WEBGL_lose_context"))&&n.loseContext(),e=null,a}catch{return!1}})():supported}var r$7={grad:.9,turn:360,rad:360/(2*Math.PI)},t$6=function(e){return"string"==typeof e?0<e.length:"number"==typeof e},n$a=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},e$6=function(e,t,r){return void 0===t&&(t=0),(r=void 0===r?1:r)<e?r:t<e?e:t},u$8=function(e){return 0<(e=isFinite(e)?e%360:0)?e:e+360},a$b=function(e){return{r:e$6(e.r,0,255),g:e$6(e.g,0,255),b:e$6(e.b,0,255),a:e$6(e.a)}},o$b=function(e){return{r:n$a(e.r),g:n$a(e.g),b:n$a(e.b),a:n$a(e.a,3)}},i$d=/^#([0-9a-f]{3,8})$/i,s$7=function(e){e=e.toString(16);return e.length<2?"0"+e:e},h$3=function(e){var t=e.r,r=e.g,i=e.b,e=e.a,n=Math.max(t,r,i),a=n-Math.min(t,r,i),i=a?n===t?(r-i)/a:n===r?2+(i-t)/a:4+(t-r)/a:0;return{h:60*(i<0?6+i:i),s:n?a/n*100:0,v:n/255*100,a:e}},b$3=function(e){var t=e.h,r=e.s,i=e.v,e=e.a,t=t/360*6,n=(r/=100,i/=100,Math.floor(t)),a=i*(1-r),s=i*(1-(t-n)*r),t=i*(1-(1-t+n)*r),r=n%6;return{r:255*[i,s,a,a,t,i][r],g:255*[t,i,i,s,a,a][r],b:255*[a,a,t,i,i,s][r],a:e}},g$3=function(e){return{h:u$8(e.h),s:e$6(e.s,0,100),l:e$6(e.l,0,100),a:e$6(e.a)}},d$4=function(e){return{h:n$a(e.h),s:n$a(e.s),l:n$a(e.l),a:n$a(e.a,3)}},f$4=function(e){return b$3((t=e.s,{h:e.h,s:0<(t*=((r=e.l)<50?r:100-r)/100)?2*t/(r+t)*100:0,v:r+t,a:e.a}));var t,r},c$a=function(e){return{h:(e=h$3(e)).h,s:0<(i=(200-(t=e.s))*(r=e.v)/100)&&i<200?t*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var t,r,i},l$8=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$3=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$3=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$5=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$2={string:[[function(e){var t=i$d.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?n$a(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?n$a(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){e=v$3.exec(e)||m$5.exec(e);return!e||e[2]!==e[4]||e[4]!==e[6]?null:a$b({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:void 0===e[7]?1:Number(e[7])/(e[8]?100:1)})},"rgb"],[function(e){var t,r,e=l$8.exec(e)||p$3.exec(e);return e?(r=g$3({h:(r=e[1],void 0===(t=e[2])&&(t="deg"),Number(r)*(r$7[t]||1)),s:Number(e[3]),l:Number(e[4]),a:void 0===e[5]?1:Number(e[5])/(e[6]?100:1)}),f$4(r)):null},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,e=e.a,e=void 0===e?1:e;return t$6(t)&&t$6(r)&&t$6(i)?a$b({r:Number(t),g:Number(r),b:Number(i),a:Number(e)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,e=e.a,e=void 0===e?1:e;return t$6(t)&&t$6(r)&&t$6(i)?(t=g$3({h:Number(t),s:Number(r),l:Number(i),a:Number(e)}),f$4(t)):null},"hsl"],[function(e){var t=e.h,r=e.s,i=e.v,e=e.a,e=void 0===e?1:e;return t$6(t)&&t$6(r)&&t$6(i)?(t={h:Number(t),s:Number(r),v:Number(i),a:Number(e)},r={h:u$8(t.h),s:e$6(t.s,0,100),v:e$6(t.v,0,100),a:e$6(t.a)},b$3(r)):null},"hsv"]]},N$1=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},x$4=function(e){return"string"==typeof e?N$1(e.trim(),y$2.string):"object"==typeof e&&null!==e?N$1(e,y$2.object):[null,void 0]},M$1=function(e,t){e=c$a(e);return{h:e.h,s:e$6(e.s+100*t,0,100),l:e.l,a:e.a}},H=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},$=function(e,t){e=c$a(e);return{h:e.h,s:e.s,l:e$6(e.l+100*t,0,100),a:e.a}},j$1=(()=>{function e(e){this.parsed=x$4(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return n$a(H(this.rgba),2)},e.prototype.isDark=function(){return H(this.rgba)<.5},e.prototype.isLight=function(){return.5<=H(this.rgba)},e.prototype.toHex=function(){return e=(i=o$b(this.rgba)).r,t=i.g,r=i.b,i=(i=i.a)<1?s$7(n$a(255*i)):"","#"+s$7(e)+s$7(t)+s$7(r)+i;var e,t,r,i},e.prototype.toRgb=function(){return o$b(this.rgba)},e.prototype.toRgbString=function(){return e=(i=o$b(this.rgba)).r,t=i.g,r=i.b,(i=i.a)<1?"rgba("+e+", "+t+", "+r+", "+i+")":"rgb("+e+", "+t+", "+r+")";var e,t,r,i},e.prototype.toHsl=function(){return d$4(c$a(this.rgba))},e.prototype.toHslString=function(){return e=(i=d$4(c$a(this.rgba))).h,t=i.s,r=i.l,(i=i.a)<1?"hsla("+e+", "+t+"%, "+r+"%, "+i+")":"hsl("+e+", "+t+"%, "+r+"%)";var e,t,r,i},e.prototype.toHsv=function(){return e=h$3(this.rgba),{h:n$a(e.h),s:n$a(e.s),v:n$a(e.v),a:n$a(e.a,3)};var e},e.prototype.invert=function(){return w$1({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return w$1(M$1(this.rgba,e=void 0===e?.1:e))},e.prototype.desaturate=function(e){return w$1(M$1(this.rgba,-(e=void 0===e?.1:e)))},e.prototype.grayscale=function(){return w$1(M$1(this.rgba,-1))},e.prototype.lighten=function(e){return w$1($(this.rgba,e=void 0===e?.1:e))},e.prototype.darken=function(e){return w$1($(this.rgba,-(e=void 0===e?.1:e)))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?w$1({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):n$a(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=c$a(this.rgba);return"number"==typeof e?w$1({h:e,s:t.s,l:t.l,a:t.a}):n$a(t.h)},e.prototype.isEqual=function(e){return this.toHex()===w$1(e).toHex()},e})(),w$1=function(e){return e instanceof j$1?e:new j$1(e)},S$1=[],k$1=function(e){e.forEach(function(e){S$1.indexOf(e)<0&&(e(j$1,y$2),S$1.push(e))})};function namesPlugin(u,e){var t,c={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},h={};for(t in c)h[c[t]]=t;var d={};u.prototype.toName=function(e){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var t,r=h[this.toHex()];if(r)return r;if(null!=e&&e.closest){var i,n=this.toRgb(),a=1/0,s="black";if(!d.length)for(var o in c)d[o]=new u(c[o]).toRgb();for(i in c){l=n,t=d[i];var l=Math.pow(l.r-t.r,2)+Math.pow(l.g-t.g,2)+Math.pow(l.b-t.b,2);l<a&&(a=l,s=i)}return s}},e.string.push([function(e){e=e.toLowerCase(),e="transparent"===e?"#0000":c[e];return e?new u(e).toRgb():null},"name"])}k$1([namesPlugin]);let _Color=class _Color2{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof _Color2)this._value=this.cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(null===e)throw new Error("Cannot set PIXI.Color#value to null");null!==this._value&&this.isSourceEqual(this._value,e)||(this.normalize(e),this._value=this.cloneSource(e))}}get value(){return this._value}cloneSource(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==typeof e&&null!==e?{...e}:e}isSourceEqual(t,r){var e,i=typeof t;return i==typeof r&&("number"==i||"string"==i||t instanceof Number?t===r:Array.isArray(t)&&Array.isArray(r)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(r)?t.length===r.length&&t.every((e,t)=>e===r[t]):null!==t&&null!==r?(i=Object.keys(t),e=Object.keys(r),i.length===e.length&&i.every(e=>t[e]===r[e])):t===r)}toRgba(){var[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){var[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){var[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){var[t,r,i]=this._components;return(e=e??[])[0]=Math.round(255*t),e[1]=Math.round(255*r),e[2]=Math.round(255*i),e}toRgbArray(e){var[t,r,i]=this._components;return(e=e??[])[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){var e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}multiply(e){var[e,t,r,i]=_Color2.temp.setValue(e)._components;return this._components[0]*=e,this._components[1]*=t,this._components[2]*=r,this._components[3]*=i,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,n=255&this._int;return t&&(r=r*e+.5|0,i=i*e+.5|0,n=n*e+.5|0),(255*e<<24)+(r<<16)+(i<<8)+n}toHex(){var e=this._int.toString(16);return"#"+("000000".substring(0,6-e.length)+e)}toHexa(){var e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){var[t,r,i]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){var[t,r,i,n]=this._components;return(e=e??[])[0]=t,e[1]=r,e[2]=i,e[3]=n,e}normalize(e){let t,r,i,n;var a;if(("number"==typeof e||e instanceof Number)&&0<=e&&e<=16777215?(t=(e>>16&255)/255,r=(e>>8&255)/255,i=(255&e)/255,n=1):(Array.isArray(e)||e instanceof Float32Array)&&3<=e.length&&e.length<=4?(e=this._clamp(e),[t,r,i,n=1]=e):(e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&3<=e.length&&e.length<=4?(e=this._clamp(e,0,255),[t,r,i,n=255]=e,t/=255,r/=255,i/=255,n/=255):"string"!=typeof e&&"object"!=typeof e||("string"==typeof e&&(a=_Color2.HEX_PATTERN.exec(e))&&(e="#"+a[2]),(a=w$1(e)).isValid()&&({r:t,g:r,b:i,a:n}=a.rgba,t/=255,r/=255,i/=255)),void 0===t)throw new Error("Unable to convert color "+e);this._components[0]=t,this._components[1]=r,this._components[2]=i,this._components[3]=n,this.refreshInt()}refreshInt(){this._clamp(this._components);var[e,t,r]=this._components;this._int=(255*e<<16)+(255*t<<8)+(255*r|0)}_clamp(r,i=0,n=1){return"number"==typeof r?Math.min(Math.max(r,i),n):(r.forEach((e,t)=>{r[t]=Math.min(Math.max(e,i),n)}),r)}},Color=(_Color.shared=new _Color,_Color.temp=new _Color,_Color.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i,_Color);function hex2rgb(e,t=[]){return deprecation("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),Color.shared.setValue(e).toRgbArray(t)}function hex2string(e){return deprecation("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Color.shared.setValue(e).toHex()}function string2hex(e){return deprecation("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),Color.shared.setValue(e).toNumber()}function rgb2hex(e){return deprecation("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Color.shared.setValue(e).toNumber()}function mapPremultipliedBlendModes(){var t=[],r=[];for(let e=0;e<32;e++)r[t[e]=e]=e;t[BLEND_MODES.NORMAL_NPM]=BLEND_MODES.NORMAL,t[BLEND_MODES.ADD_NPM]=BLEND_MODES.ADD,t[BLEND_MODES.SCREEN_NPM]=BLEND_MODES.SCREEN,r[BLEND_MODES.NORMAL]=BLEND_MODES.NORMAL_NPM,r[BLEND_MODES.ADD]=BLEND_MODES.ADD_NPM,r[BLEND_MODES.SCREEN]=BLEND_MODES.SCREEN_NPM;var e=[];return e.push(r),e.push(t),e}let premultiplyBlendMode=mapPremultipliedBlendModes();function correctBlendMode(e,t){return premultiplyBlendMode[t?1:0][e]}function premultiplyRgba(e,t,r,i=!0){return deprecation("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),Color.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}function premultiplyTint(e,t){return deprecation("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),Color.shared.setValue(e).toPremultiplied(t)}function premultiplyTintToRgba(e,t,r,i=!0){return deprecation("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),Color.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}let DATA_URI=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function createIndicesForQuads(e,r=null){var i=6*e;if((r=r||new Uint16Array(i)).length!==i)throw new Error(`Out buffer length is incorrect, got ${r.length} and expected `+i);for(let e=0,t=0;e<i;e+=6,t+=4)r[e+0]=t+0,r[e+1]=t+1,r[e+2]=t+2,r[e+3]=t+0,r[e+4]=t+2,r[e+5]=t+3;return r}function getBufferType(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}let map$2={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function interleaveTypedArrays$1(t,r){let i=0,n=0;var a={};for(let e=0;e<t.length;e++)n+=r[e],i+=t[e].length;var s=new ArrayBuffer(4*i);let o=null,l=0;for(let e=0;e<t.length;e++){var u=r[e],c=t[e],h=getBufferType(c);a[h]||(a[h]=new map$2[h](s)),o=a[h];for(let e=0;e<c.length;e++){var d=(e/u|0)*n+l,p=e%u;o[d+p]=c[e]}l+=u}return new Float32Array(s)}function nextPow2(e){return e+=0===e?1:0,--e,(e=(e=(e=(e=(e|=e>>>1)|e>>>2)|e>>>4)|e>>>8)|e>>>16)+1}function isPow2(e){return!(e&e-1||!e)}function log2(e){var t=(65535<e?1:0)<<4,r=(255<(e>>>=t)?1:0)<<3;return(t|=r)|(r=(15<(e>>>=r)?1:0)<<2)|(r=(3<(e>>>=r)?1:0)<<1)|(e>>>=r)>>1}function removeItems(e,t,r){var i=e.length;let n;if(!(i<=t||0===r)){var a=i-(r=i<t+r?i-t:r);for(n=t;n<a;++n)e[n]=e[n+r];e.length=a}}function sign$1(e){return 0===e?0:e<0?-1:1}let nextUid=0;function uid(){return++nextUid}let _BoundingBox=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}},BoundingBox=(_BoundingBox.EMPTY=new _BoundingBox(0,0,0,0),_BoundingBox),ProgramCache={},TextureCache=Object.create(null),BaseTextureCache=Object.create(null);function destroyTextureCache(){let e;for(e in TextureCache)TextureCache[e].destroy();for(e in BaseTextureCache)BaseTextureCache[e].destroy()}function clearTextureCache(){let e;for(e in TextureCache)delete TextureCache[e];for(e in BaseTextureCache)delete BaseTextureCache[e]}class CanvasRenderTarget{constructor(e,t,r){this._canvas=settings.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||settings.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function checkRow(r,i,n){for(let e=0,t=4*n*i;e<i;++e,t+=4)if(0!==r[t+3])return!1;return!0}function checkColumn(r,e,i,n,a){var s=4*e;for(let e=n,t=n*s+4*i;e<=a;++e,t+=s)if(0!==r[t+3])return!1;return!0}function getCanvasBoundingBox(e){var{width:t,height:r}=e,e=e.getContext("2d",{willReadFrequently:!0});if(null===e)throw new TypeError("Failed to get canvas 2D context");var i=e.getImageData(0,0,t,r).data;let n=0,a=0,s=t-1,o=r-1;for(;a<r&&checkRow(i,t,a);)++a;if(a===r)return BoundingBox.EMPTY;for(;checkRow(i,t,o);)--o;for(;checkColumn(i,t,n,a,o);)++n;for(;checkColumn(i,t,s,a,o);)--s;return++s,++o,new BoundingBox(n,a,s,o)}function trimCanvas(e){var t=getCanvasBoundingBox(e),{width:r,height:i}=t;let n=null;if(!t.isEmpty()){e=e.getContext("2d");if(null===e)throw new TypeError("Failed to get canvas 2D context");n=e.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:n}}function decomposeDataUri(e){e=DATA_URI.exec(e);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}}function determineCrossOrigin(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location;e=new URL(e,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function getResolutionOfUrl(e,t=1){var r=null==(r=settings.RETINA_PREFIX)?void 0:r.exec(e);return r?parseFloat(r[1]):t}let index=Object.freeze(Object.defineProperty({__proto__:null,BaseTextureCache:BaseTextureCache,BoundingBox:BoundingBox,CanvasRenderTarget:CanvasRenderTarget,DATA_URI:DATA_URI,EventEmitter:EventEmitter$2,ProgramCache:ProgramCache,TextureCache:TextureCache,clearTextureCache:clearTextureCache,correctBlendMode:correctBlendMode,createIndicesForQuads:createIndicesForQuads,decomposeDataUri:decomposeDataUri,deprecation:deprecation,destroyTextureCache:destroyTextureCache,detectVideoAlphaMode:detectVideoAlphaMode,determineCrossOrigin:determineCrossOrigin,earcut:earcut$1,getBufferType:getBufferType,getCanvasBoundingBox:getCanvasBoundingBox,getResolutionOfUrl:getResolutionOfUrl,hex2rgb:hex2rgb,hex2string:hex2string,interleaveTypedArrays:interleaveTypedArrays$1,isMobile:isMobile,isPow2:isPow2,isWebGLSupported:isWebGLSupported,log2:log2,nextPow2:nextPow2,path:path,premultiplyBlendMode:premultiplyBlendMode,premultiplyRgba:premultiplyRgba,premultiplyTint:premultiplyTint,premultiplyTintToRgba:premultiplyTintToRgba,removeItems:removeItems,rgb2hex:rgb2hex,sayHello:sayHello,sign:sign$1,skipHello:skipHello,string2hex:string2hex,trimCanvas:trimCanvas,uid:uid,url:url$1},Symbol.toStringTag,{value:"Module"}));var ExtensionType=(e=>(e.Renderer="renderer",e.Application="application",e.RendererSystem="renderer-webgl-system",e.RendererPlugin="renderer-webgl-plugin",e.CanvasRendererSystem="renderer-canvas-system",e.CanvasRendererPlugin="renderer-canvas-plugin",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e))(ExtensionType||{});let normalizeExtension=e=>{if("function"==typeof e||"object"==typeof e&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={..."object"!=typeof e.extension?{type:e.extension}:e.extension,ref:e}}if("object"!=typeof e)throw new Error("Invalid extension type");return"string"==typeof(e={...e}).type&&(e.type=[e.type]),e},normalizePriority=(e,t)=>normalizeExtension(e).priority??t,extensions$1={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(normalizeExtension).forEach(r=>{r.type.forEach(e=>{var t;return null==(e=(t=this._removeHandlers)[e])?void 0:e.call(t,r)})}),this},add(...e){return e.map(normalizeExtension).forEach(n=>{n.type.forEach(e=>{var t,r=this._addHandlers,i=this._queue;r[e]?null!=(t=r[e])&&t.call(r,n):(i[e]=i[e]||[],null!=(t=i[e])&&t.push(n))})}),this},handle(e,t,r){var i=this._addHandlers,n=this._removeHandlers;if(i[e]||n[e])throw new Error(`Extension type ${e} already has a handler`);i[e]=t,n[e]=r;i=this._queue;return i[e]&&(null!=(n=i[e])&&n.forEach(e=>t(e)),delete i[e]),this},handleByMap(e,t){return this.handle(e,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByList(e,t,r=-1){return this.handle(e,e=>{t.includes(e.ref)||(t.push(e.ref),t.sort((e,t)=>normalizePriority(t,r)-normalizePriority(e,r)))},e=>{e=t.indexOf(e.ref);-1!==e&&t.splice(e,1)})}};class ViewableBuffer{constructor(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[e+"View"]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}}}let fragTemplate$1=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function generateIfTestSrc(t){let r="";for(let e=0;e<t;++e)0<e&&(r+=`
else `),e<t-1&&(r+=`if(test == ${e}.0){}`);return r}function checkMaxIfStatementsInShader(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var i=fragTemplate$1.replace(/%forloop%/gi,generateIfTestSrc(e));if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}let BLEND$1=0,OFFSET$1=1,CULLING$1=2,DEPTH_TEST$1=3,WINDING$1=4,DEPTH_MASK$1=5;class State{constructor(){this.data=0,this.blendMode=BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<BLEND$1)}set blend(e){!!(this.data&1<<BLEND$1)!==e&&(this.data^=1<<BLEND$1)}get offsets(){return!!(this.data&1<<OFFSET$1)}set offsets(e){!!(this.data&1<<OFFSET$1)!==e&&(this.data^=1<<OFFSET$1)}get culling(){return!!(this.data&1<<CULLING$1)}set culling(e){!!(this.data&1<<CULLING$1)!==e&&(this.data^=1<<CULLING$1)}get depthTest(){return!!(this.data&1<<DEPTH_TEST$1)}set depthTest(e){!!(this.data&1<<DEPTH_TEST$1)!==e&&(this.data^=1<<DEPTH_TEST$1)}get depthMask(){return!!(this.data&1<<DEPTH_MASK$1)}set depthMask(e){!!(this.data&1<<DEPTH_MASK$1)!==e&&(this.data^=1<<DEPTH_MASK$1)}get clockwiseFrontFace(){return!!(this.data&1<<WINDING$1)}set clockwiseFrontFace(e){!!(this.data&1<<WINDING$1)!==e&&(this.data^=1<<WINDING$1)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==BLEND_MODES.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){var e=new State;return e.depthTest=!1,e.blend=!0,e}}State.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};let INSTALLED=[];function autoDetectResource(t,r){if(!t)return null;let i="";var e;"string"==typeof t&&(e=/\.(\w{3,4})(?:$|\?|#)/i.exec(t))&&(i=e[1].toLowerCase());for(let e=INSTALLED.length-1;0<=e;--e){var n=INSTALLED[e];if(n.test&&n.test(t,i))return new n(t,r)}throw new Error("Unrecognized source type to auto-detect Resource")}class Runner{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(r,i,n,a,s,o,l,u){if(8<arguments.length)throw new Error("max arguments reached");var{name:c,items:h}=this;this._aliasCount++;for(let e=0,t=h.length;e<t;e++)h[e][c](r,i,n,a,s,o,l,u);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){0<this._aliasCount&&1<this.items.length&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){e=this.items.indexOf(e);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items.length=0,this._name=""}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(Runner.prototype,{dispatch:{value:Runner.prototype.emit},run:{value:Runner.prototype.emit}});class Resource{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Runner("setRealSize"),this.onUpdate=new Runner("update"),this.onError=new Runner("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class BufferResource extends Resource{constructor(e,t){var{width:r,height:i}=t||{};if(!r||!i)throw new Error("BufferResource width or height invalid");super(r,i),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,r){var e=e.gl,i=(e.pixelStorei(e.UNPACK_ALIGNMENT,this.unpackAlignment),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES.UNPACK),t.realWidth),n=t.realHeight;return r.width===i&&r.height===n?e.texSubImage2D(t.target,0,0,0,i,n,t.format,r.type,this.data):(r.width=i,r.height=n,e.texImage2D(t.target,0,r.internalFormat,i,n,0,t.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return null===e||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}let defaultBufferOptions={scaleMode:SCALE_MODES.NEAREST,alphaMode:ALPHA_MODES.NPM},_BaseTexture=class _BaseTexture2 extends EventEmitter$2{constructor(e=null,t=null){super();var{alphaMode:t,mipmap:r,anisotropicLevel:i,scaleMode:n,width:a,height:s,wrapMode:o,format:l,type:u,target:c,resolution:h,resourceOptions:d}=t=Object.assign({},_BaseTexture2.defaultOptions,t);!e||e instanceof Resource||((e=autoDetectResource(e,d)).internal=!0),this.resolution=h||settings.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((s||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=i,this._wrapMode=o,this._scaleMode=n,this.format=l,this.type=u,this.target=c,this.alphaMode=t,this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=0<a&&0<s,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(e)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)}setResolution(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT()),this}setResource(e){if(this.resource!==e){if(this.resource)throw new Error("Resource can be set only once");e.bind(this),this.resource=e}return this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):0<this.width&&0<this.height&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete BaseTextureCache[this.cacheId],delete TextureCache[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),_BaseTexture2.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(e,t,r=settings.STRICT_TEXTURE_CACHE){var i,n="string"==typeof e;let a=null,s=(a=n?e:(e._pixiId||(i=(null==t?void 0:t.pixiIdPrefix)||"pixiid",e._pixiId=i+"_"+uid()),e._pixiId),BaseTextureCache[a]);if(n&&r&&!s)throw new Error(`The cacheId "${a}" does not exist in BaseTextureCache.`);return s||((s=new _BaseTexture2(e,t)).cacheId=a,_BaseTexture2.addToCache(s,a)),s}static fromBuffer(e,t,r,i){e=e||new Float32Array(t*r*4);t=new BufferResource(e,{width:t,height:r,...null==i?void 0:i.resourceOptions});let n,a;return a=e instanceof Float32Array?(n=FORMATS.RGBA,TYPES.FLOAT):e instanceof Int32Array?(n=FORMATS.RGBA_INTEGER,TYPES.INT):e instanceof Uint32Array?(n=FORMATS.RGBA_INTEGER,TYPES.UNSIGNED_INT):e instanceof Int16Array?(n=FORMATS.RGBA_INTEGER,TYPES.SHORT):e instanceof Uint16Array?(n=FORMATS.RGBA_INTEGER,TYPES.UNSIGNED_SHORT):e instanceof Int8Array?(n=FORMATS.RGBA,TYPES.BYTE):(n=FORMATS.RGBA,TYPES.UNSIGNED_BYTE),t.internal=!0,new _BaseTexture2(t,Object.assign({},defaultBufferOptions,{type:a,format:n},i))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),BaseTextureCache[t]&&BaseTextureCache[t],BaseTextureCache[t]=e)}static removeFromCache(t){if("string"==typeof t){var e,r=BaseTextureCache[t];if(r)return-1<(e=r.textureCacheIds.indexOf(t))&&r.textureCacheIds.splice(e,1),delete BaseTextureCache[t],r}else if(null!=t&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete BaseTextureCache[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}},BaseTexture=(_BaseTexture.defaultOptions={mipmap:MIPMAP_MODES.POW2,anisotropicLevel:0,scaleMode:SCALE_MODES.LINEAR,wrapMode:WRAP_MODES.CLAMP,alphaMode:ALPHA_MODES.UNPACK,target:TARGETS.TEXTURE_2D,format:FORMATS.RGBA,type:TYPES.UNSIGNED_BYTE},_BaseTexture._globalBatch=0,_BaseTexture);class BatchDrawCall{constructor(){this.texArray=null,this.blend=0,this.type=DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}let UID$4=0,Buffer$2=class Buffer2{constructor(e,t=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=UID$4++,this.disposeRunner=new Runner("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?BUFFER_TYPE.ELEMENT_ARRAY_BUFFER:BUFFER_TYPE.ARRAY_BUFFER}get index(){return this.type===BUFFER_TYPE.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new Buffer2(e)}};class Attribute{constructor(e,t=0,r=!1,i=TYPES.FLOAT,n,a,s,o=1){this.buffer=e,this.size=t,this.normalized=r,this.type=i,this.stride=n,this.start=a,this.instance=s,this.divisor=o}destroy(){this.buffer=null}static from(e,t,r,i,n){return new Attribute(e,t,r,i,n)}}let map$1={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function interleaveTypedArrays(t,r){let i=0,n=0;var a={};for(let e=0;e<t.length;e++)n+=r[e],i+=t[e].length;var s=new ArrayBuffer(4*i);let o=null,l=0;for(let e=0;e<t.length;e++){var u=r[e],c=t[e],h=getBufferType(c);a[h]||(a[h]=new map$1[h](s)),o=a[h];for(let e=0;e<c.length;e++){var d=(e/u|0)*n+l,p=e%u;o[d+p]=c[e]}l+=u}return new Float32Array(s)}let byteSizeMap$1={5126:4,5123:2,5121:1},UID$3=0,map={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};class Geometry{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=UID$3++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Runner("disposeGeometry"),this.refCount=0}addAttribute(t,r,i=0,n=!1,a,s,o,l=!1){if(!r)throw new Error("You must pass a buffer when creating an attribute");r instanceof Buffer$2||(r instanceof Array&&(r=new Float32Array(r)),r=new Buffer$2(r));var u=t.split("|");if(1<u.length)for(let e=0;e<u.length;e++)this.addAttribute(u[e],r,i,n,a);else{let e=this.buffers.indexOf(r);-1===e&&(this.buffers.push(r),e=this.buffers.length-1),this.attributes[t]=new Attribute(e,i,n,a,s,o,l),this.instanced=this.instanced||l}return this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof Buffer$2||(e instanceof Array&&(e=new Uint16Array(e)),e=new Buffer$2(e)),e.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){if(!(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)){var t=[],r=[],i=new Buffer$2;let e;for(e in this.attributes){var n=this.attributes[e],a=this.buffers[n.buffer];t.push(a.data),r.push(n.size*byteSizeMap$1[n.type]/4),n.buffer=0}for(i.data=interleaveTypedArrays(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer)}return this}getSize(){for(var e in this.attributes){e=this.attributes[e];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){var e,t=new Geometry;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Buffer$2(this.buffers[e].data.slice(0));for(e in this.attributes){var r=this.attributes[e];t.attributes[e]=new Attribute(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER),t}static merge(a){var s=new Geometry,t=[],r=[],i=[];let o;for(let e=0;e<a.length;e++){o=a[e];for(let e=0;e<o.buffers.length;e++)r[e]=r[e]||0,r[e]+=o.buffers[e].data.length,i[e]=0}for(let e=0;e<o.buffers.length;e++)t[e]=new map[getBufferType(o.buffers[e].data)](r[e]),s.buffers[e]=new Buffer$2(t[e]);for(let e=0;e<a.length;e++){o=a[e];for(let e=0;e<o.buffers.length;e++)t[e].set(o.buffers[e].data,i[e]),i[e]+=o.buffers[e].data.length}if(s.attributes=o.attributes,o.indexBuffer){s.indexBuffer=s.buffers[o.buffers.indexOf(o.indexBuffer)],s.indexBuffer.type=BUFFER_TYPE.ELEMENT_ARRAY_BUFFER;let t=0,r=0,i=0,n=0;for(let e=0;e<o.buffers.length;e++)if(o.buffers[e]!==o.indexBuffer){n=e;break}for(var e in o.attributes){e=o.attributes[e];(0|e.buffer)===n&&(r+=e.size*byteSizeMap$1[e.type]/4)}for(let e=0;e<a.length;e++){var l=a[e].indexBuffer.data;for(let e=0;e<l.length;e++)s.indexBuffer.data[e+i]+=t;t+=a[e].buffers[n].data.length/r,i+=l.length}}return s}}class BatchGeometry extends Geometry{constructor(e=!1){super(),this._buffer=new Buffer$2(null,e,!1),this._indexBuffer=new Buffer$2(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,TYPES.FLOAT).addAttribute("aColor",this._buffer,4,!0,TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,TYPES.FLOAT).addIndex(this._indexBuffer)}}let PI_2=2*Math.PI,RAD_TO_DEG=180/Math.PI,DEG_TO_RAD=Math.PI/180;var SHAPES=(e=>(e[e.POLY=0]="POLY",e[e.RECT=1]="RECT",e[e.CIRC=2]="CIRC",e[e.ELIP=3]="ELIP",e[e.RREC=4]="RREC",e))(SHAPES||{});class Point{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Point(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}Point.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};let tempPoints$1=[new Point,new Point,new Point,new Point];class Rectangle{constructor(e=0,t=0,r=0,i=0){this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(i),this.type=SHAPES.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Rectangle(0,0,0,0)}clone(){return new Rectangle(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return!(this.width<=0||this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){var r,i,n,a,s,o,l,u,c,h,d,p,f;return t?(r=this.left,i=this.right,n=this.top,a=this.bottom,!(i<=r||a<=n||(s=tempPoints$1[0].set(e.left,e.top),f=tempPoints$1[1].set(e.left,e.bottom),o=tempPoints$1[2].set(e.right,e.top),l=tempPoints$1[3].set(e.right,e.bottom),o.x<=s.x)||f.y<=s.y||0===(u=Math.sign(t.a*t.d-t.b*t.c))||(t.apply(s,s),t.apply(f,f),t.apply(o,o),t.apply(l,l),Math.max(s.x,f.x,o.x,l.x)<=r)||Math.min(s.x,f.x,o.x,l.x)>=i||Math.max(s.y,f.y,o.y,l.y)<=n||Math.min(s.y,f.y,o.y,l.y)>=a||(c=(t=u*(f.y-s.y))*r+(f=u*(s.x-f.x))*n,h=t*i+f*n,d=t*r+f*a,p=t*i+f*a,Math.max(c,h,d,p)<=t*s.x+f*s.y)||Math.min(c,h,d,p)>=t*l.x+f*l.y||(d=(c=u*(s.y-o.y))*r+(h=u*(o.x-s.x))*n,p=c*i+h*n,t=c*r+h*a,f=c*i+h*a,Math.max(d,p,t,f)<=c*s.x+h*s.y)||Math.min(d,p,t,f)>=c*l.x+h*l.y)):(u=(this.x<e.x?e:this).x,!((this.right>e.right?e:this).right<=u)&&(o=(this.y<e.y?e:this).y,(this.bottom>e.bottom?e:this).bottom>o))}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}fit(e){var t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),e=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=i,this.height=Math.max(e-i,0),this}ceil(e=1,t=.001){var r=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){var t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),e=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=i,this.height=e-i,this}}Rectangle.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Circle{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.radius=r,this.type=SHAPES.CIRC}clone(){return new Circle(this.x,this.y,this.radius)}contains(e,t){var r;return!(this.radius<=0)&&(r=this.radius*this.radius,e=this.x-e,t=this.y-t,(e*=e)+(t*=t)<=r)}getBounds(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}Circle.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class Ellipse{constructor(e=0,t=0,r=0,i=0){this.x=e,this.y=t,this.width=r,this.height=i,this.type=SHAPES.ELIP}clone(){return new Ellipse(this.x,this.y,this.width,this.height)}contains(e,t){return!(this.width<=0||this.height<=0)&&(e=(e-this.x)/this.width,t=(t-this.y)/this.height,(e*=e)+(t*=t)<=1)}getBounds(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}}Ellipse.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class Polygon{constructor(...e){let r=Array.isArray(e[0])?e[0]:e;if("number"!=typeof r[0]){var i=[];for(let e=0,t=r.length;e<t;e++)i.push(r[e].x,r[e].y);r=i}this.points=r,this.type=SHAPES.POLY,this.closeStroke=!0}clone(){var e=this.points.slice(),e=new Polygon(e);return e.closeStroke=this.closeStroke,e}contains(r,i){let n=!1;var a=this.points.length/2;for(let e=0,t=a-1;e<a;t=e++){var s=this.points[2*e],o=this.points[2*e+1],l=this.points[2*t],u=this.points[2*t+1];i<o!=i<u&&r<(i-o)/(u-o)*(l-s)+s&&(n=!n)}return n}}Polygon.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,t)=>e+", "+t,"")}]`};class RoundedRectangle{constructor(e=0,t=0,r=0,i=0,n=20){this.x=e,this.y=t,this.width=r,this.height=i,this.radius=n,this.type=SHAPES.RREC}clone(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)}contains(r,i){if(!(this.width<=0||this.height<=0)&&r>=this.x&&r<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(i>=this.y+n&&i<=this.y+this.height-n||r>=this.x+n&&r<=this.x+this.width-n)return!0;let e=r-(this.x+n),t=i-(this.y+n);var a=n*n;if(e*e+t*t<=a||(e=r-(this.x+this.width-n))*e+t*t<=a||(t=i-(this.y+this.height-n),e*e+t*t<=a)||(e=r-(this.x+n))*e+t*t<=a)return!0}return!1}}RoundedRectangle.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Matrix{constructor(e=1,t=0,r=0,i=1,n=0,a=0){this.array=null,this.a=e,this.b=t,this.c=r,this.d=i,this.tx=n,this.ty=a}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,r,i,n,a){return this.a=e,this.b=t,this.c=r,this.d=i,this.tx=n,this.ty=a,this}toArray(e,t){this.array||(this.array=new Float32Array(9));t=t||this.array;return e?(t[0]=this.a,t[1]=this.b,t[2]=0,t[3]=this.c,t[4]=this.d,t[5]=0,t[6]=this.tx,t[7]=this.ty):(t[0]=this.a,t[1]=this.c,t[2]=this.tx,t[3]=this.b,t[4]=this.d,t[5]=this.ty,t[6]=0,t[7]=0),t[8]=1,t}apply(e,t){t=t||new Point;var r=e.x,e=e.y;return t.x=this.a*r+this.c*e+this.tx,t.y=this.b*r+this.d*e+this.ty,t}applyInverse(e,t){t=t||new Point;var r=1/(this.a*this.d+this.c*-this.b),i=e.x,e=e.y;return t.x=this.d*r*i+-this.c*r*e+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*e+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){var t=Math.cos(e),e=Math.sin(e),r=this.a,i=this.c,n=this.tx;return this.a=r*t-this.b*e,this.b=r*e+this.b*t,this.c=i*t-this.d*e,this.d=i*e+this.d*t,this.tx=n*t-this.ty*e,this.ty=n*e+this.ty*t,this}append(e){var t=this.a,r=this.b,i=this.c,n=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*r+e.b*n,this.c=e.c*t+e.d*i,this.d=e.c*r+e.d*n,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*n+this.ty,this}setTransform(e,t,r,i,n,a,s,o,l){return this.a=Math.cos(s+l)*n,this.b=Math.sin(s+l)*n,this.c=-Math.sin(s-o)*a,this.d=Math.cos(s-o)*a,this.tx=e-(r*this.a+i*this.c),this.ty=t-(r*this.b+i*this.d),this}prepend(e){var t,r,i=this.tx;return 1===e.a&&0===e.b&&0===e.c&&1===e.d||(t=this.a,r=this.c,this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d),this.tx=i*e.a+this.ty*e.c+e.tx,this.ty=i*e.b+this.ty*e.d+e.ty,this}decompose(e){var t=this.a,r=this.b,i=this.c,n=this.d,a=e.pivot,s=-Math.atan2(-i,n),o=Math.atan2(r,t),l=Math.abs(s+o);return l<1e-5||Math.abs(PI_2-l)<1e-5?(e.rotation=o,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=s,e.skew.y=o),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(i*i+n*n),e.position.x=this.tx+(a.x*t+a.y*i),e.position.y=this.ty+(a.x*r+a.y*n),e}invert(){var e=this.a,t=this.b,r=this.c,i=this.d,n=this.tx,a=e*i-t*r;return this.a=i/a,this.b=-t/a,this.c=-r/a,this.d=e/a,this.tx=(r*this.ty-i*n)/a,this.ty=-(e*this.ty-t*n)/a,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){var e=new Matrix;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new Matrix}static get TEMP_MATRIX(){return new Matrix}}Matrix.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};let ux=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],uy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vx=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],rotationCayley=[],rotationMatrices=[],signum=Math.sign;function init(){for(let t=0;t<16;t++){var r=[];rotationCayley.push(r);for(let e=0;e<16;e++){var i=signum(ux[t]*ux[e]+vx[t]*uy[e]),n=signum(uy[t]*ux[e]+vy[t]*uy[e]),a=signum(ux[t]*vx[e]+vx[t]*vy[e]),s=signum(uy[t]*vx[e]+vy[t]*vy[e]);for(let e=0;e<16;e++)if(ux[e]===i&&uy[e]===n&&vx[e]===a&&vy[e]===s){r.push(e);break}}}for(let e=0;e<16;e++){var t=new Matrix;t.set(ux[e],uy[e],vx[e],vy[e],0,0),rotationMatrices.push(t)}}init();let groupD8={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>ux[e],uY:e=>uy[e],vX:e=>vx[e],vY:e=>vy[e],inv:e=>8&e?15&e:7&-e,add:(e,t)=>rotationCayley[e][t],sub:(e,t)=>rotationCayley[e][groupD8.inv(t)],rotate180:e=>4^e,isVertical:e=>2==(3&e),byDirection:(e,t)=>2*Math.abs(e)<=Math.abs(t)?0<=t?groupD8.S:groupD8.N:2*Math.abs(t)<=Math.abs(e)?0<e?groupD8.E:groupD8.W:0<t?0<e?groupD8.SE:groupD8.SW:0<e?groupD8.NE:groupD8.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{t=rotationMatrices[groupD8.inv(t)];t.tx=r,t.ty=i,e.append(t)}};class ObservablePoint{constructor(e,t,r=0,i=0){this._x=r,this._y=i,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new ObservablePoint(e,t,this._x,this._y)}set(e=0,t=e){return this._x===e&&this._y===t||(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}ObservablePoint.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};let _Transform=class{constructor(){this.worldTransform=new Matrix,this.localTransform=new Matrix,this.position=new ObservablePoint(this.onChange,this,0,0),this.scale=new ObservablePoint(this.onChange,this,1,1),this.pivot=new ObservablePoint(this.onChange,this,0,0),this.skew=new ObservablePoint(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){var t,r,i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID&&(t=e.worldTransform,(r=this.worldTransform).a=i.a*t.a+i.b*t.c,r.b=i.a*t.b+i.b*t.d,r.c=i.c*t.a+i.d*t.c,r.d=i.c*t.b+i.d*t.d,r.tx=i.tx*t.a+i.ty*t.c+t.tx,r.ty=i.tx*t.b+i.ty*t.d+t.ty,this._parentID=e._worldID,this._worldID++)}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}},Transform=(_Transform.IDENTITY=new _Transform,_Transform);Transform.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var defaultFragment$2=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,defaultVertex$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function compileShader(e,t,r){t=e.createShader(t);return e.shaderSource(t,r),e.compileShader(t),t}function booleanArray(e){var t=new Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function defaultValue(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return booleanArray(2*t);case"bvec3":return booleanArray(3*t);case"bvec4":return booleanArray(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}let uniformParsers=[{test:e=>"float"===e.type&&1===e.size&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>!("sampler2D"!==e.type&&"samplerCube"!==e.type&&"sampler2DArray"!==e.type||1!==e.size||e.isArray||null!=t&&void 0===t.castToBaseTexture),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>"vec2"===e.type&&1===e.size&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>"vec4"===e.type&&1===e.size&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],GLSL_TO_SINGLE_SETTERS_CACHED={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GLSL_TO_ARRAY_SETTERS={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function generateUniformsSync(e,t){var r,i=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(r in e.uniforms){var n=t[r];if(n){var a,s=e.uniforms[r];let t=!1;for(let e=0;e<uniformParsers.length;e++)if(uniformParsers[e].test(n,s)){i.push(uniformParsers[e].code(r,s)),t=!0;break}t||(a=(1!==n.size||n.isArray?GLSL_TO_ARRAY_SETTERS:GLSL_TO_SINGLE_SETTERS_CACHED)[n.type].replace("location",`ud["${r}"].location`),i.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${a};`))}else!0===(null==(a=e.uniforms[r])?void 0:a.group)&&(e.uniforms[r].ubo?i.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):i.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `))}return new Function("ud","uv","renderer","syncData",i.join(`
`))}let unknownContext={},context=unknownContext;function getTestContext(){if(context===unknownContext||null!=context&&context.isContextLost()){var t=settings.ADAPTER.createCanvas();let e;(e=settings.PREFER_ENV>=ENV.WEBGL2?t.getContext("webgl2",{}):e)||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),context=e}return context}let maxFragmentPrecision;function getMaxFragmentPrecision(){var e;return maxFragmentPrecision||(maxFragmentPrecision=PRECISION.MEDIUM,(e=getTestContext())&&e.getShaderPrecisionFormat&&(e=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT))&&(maxFragmentPrecision=e.precision?PRECISION.HIGH:PRECISION.MEDIUM)),maxFragmentPrecision}function logPrettyShaderError(e,t){let r=e.getShaderSource(t).split(`
`).map((e,t)=>t+": "+e),i=e.getShaderInfoLog(t),n=i.split(`
`),a={},s=n.map(e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(e=>!(!e||a[e]||(a[e]=!0,0))),o=[""];s.forEach(e=>{r[e-1]=`%c${r[e-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});e=r.join(`
`);o[0]=e}function logProgramError(e,t,r,i){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||logPrettyShaderError(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||logPrettyShaderError(e,i),e.getProgramInfoLog(t))}let GLSL_TO_SIZE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(e){return GLSL_TO_SIZE[e]}let GL_TABLE=null,GL_TO_GLSL_TYPES={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(t,e){if(!GL_TABLE){var r=Object.keys(GL_TO_GLSL_TYPES);GL_TABLE={};for(let e=0;e<r.length;++e){var i=r[e];GL_TABLE[t[i]]=GL_TO_GLSL_TYPES[i]}}return GL_TABLE[e]}function setPrecision(t,r,i){if("precision"===t.substring(0,9))return i!==PRECISION.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;{let e=r;return`precision ${e=r===PRECISION.HIGH&&i!==PRECISION.HIGH?PRECISION.MEDIUM:e} float;
`+t}}let unsafeEval;function unsafeEvalSupported(){if("boolean"!=typeof unsafeEval)try{unsafeEval=!0===new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{unsafeEval=!1}return unsafeEval}let UID$2=0,nameCache={},_Program=class _Program2{constructor(e,t,r="pixi-shader",i={}){this.extra={},this.id=UID$2++,this.vertexSrc=e||_Program2.defaultVertexSrc,this.fragmentSrc=t||_Program2.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),nameCache[r]?(nameCache[r]++,r+="-"+nameCache[r]):nameCache[r]=1,this.vertexSrc=`#define SHADER_NAME ${r}
`+this.vertexSrc,this.fragmentSrc=`#define SHADER_NAME ${r}
`+this.fragmentSrc,this.vertexSrc=setPrecision(this.vertexSrc,_Program2.defaultVertexPrecision,PRECISION.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,_Program2.defaultFragmentPrecision,getMaxFragmentPrecision())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return defaultVertex$3}static get defaultFragmentSrc(){return defaultFragment$2}static from(e,t,r){var i=e+t;let n=ProgramCache[i];return n||(ProgramCache[i]=n=new _Program2(e,t,r)),n}},Program=(_Program.defaultVertexPrecision=PRECISION.HIGH,_Program.defaultFragmentPrecision=isMobile.apple.device?PRECISION.HIGH:PRECISION.MEDIUM,_Program),UID$1=0;class UniformGroup{constructor(e,t,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=UID$1++,this.static=!!t,this.ubo=!!r,e instanceof Buffer$2?(this.buffer=e,this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new Buffer$2(new Float32Array(1)),this.buffer.type=BUFFER_TYPE.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,r){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new UniformGroup(t,r)}static from(e,t,r){return new UniformGroup(e,t,r)}static uboFrom(e,t){return new UniformGroup(e,t??!0,!0)}}class Shader{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof UniformGroup?this.uniformGroup=t:this.uniformGroup=new UniformGroup(t):this.uniformGroup=new UniformGroup({}),this.disposeRunner=new Runner("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){r=t.uniforms[r];if(!0===r.group&&this.checkUniformExists(e,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,r){e=Program.from(e,t);return new Shader(e,r)}}class BatchShaderGenerator{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){var r=new Int32Array(t);for(let e=0;e<t;e++)r[e]=e;this.defaultGroupCache[t]=UniformGroup.from({uSamplers:r},!0);let e=this.fragTemplate;e=(e=e.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Program(this.vertexSrc,e)}var e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:this.defaultGroupCache[t]};return new Shader(this.programCache[t],e)}generateSampleSrc(t){let r="";r=r+`
`+`
`;for(let e=0;e<t;e++)0<e&&(r+=`
else `),e<t-1&&(r+=`if(vTextureId < ${e}.5)`),r=(r+=`
{`)+`
	color = texture2D(uSamplers[${e}], vTextureCoord);`+`
}`;return r=r+`
`+`
`}}class BatchTextureArray{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}function canUploadSameBuffer(){return!isMobile.apple.device}function maxRecommendedTextures(e){let t=!0;var r,i=settings.ADAPTER.getNavigator();return(t=(isMobile.tablet||isMobile.phone)&&(isMobile.apple.device&&(r=i.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(r[1],10)<11&&(t=!1),isMobile.android.device)&&(r=i.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(r[1],10)<7?!1:t)?e:4}class ObjectRenderer{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var defaultFragment$1=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,defaultVertex$2=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;let _BatchRenderer=class _BatchRenderer2 extends ObjectRenderer{constructor(e){super(e),this.setShaderGenerator(),this.geometryClass=BatchGeometry,this.vertexSize=6,this.state=State.for2d(),this.size=4*_BatchRenderer2.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),e.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??maxRecommendedTextures(32),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??canUploadSameBuffer(),this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return deprecation("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return defaultVertex$2}static get defaultFragmentTemplate(){return defaultFragment$1}setShaderGenerator({vertex:e=_BatchRenderer2.defaultVertexSrc,fragment:t=_BatchRenderer2.defaultFragmentTemplate}={}){this.shaderGenerator=new BatchShaderGenerator(e,t)}contextChange(){var e=this.renderer.gl;settings.PREFER_ENV===ENV.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),_BatchRenderer2.defaultMaxTextures),this.maxTextures=checkMaxIfStatementsInShader(this.maxTextures,e)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){for(var{_drawCallPool:e,_textureArrayPool:t}=_BatchRenderer2,r=this.size/4,i=Math.floor(r/this.maxTextures)+1;e.length<r;)e.push(new BatchDrawCall);for(;t.length<i;)t.push(new BatchTextureArray);for(let e=0;e<this.maxTextures;e++)this._tempBoundTextures[e]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){var{_bufferedTextures:t,maxTextures:r}=this,i=_BatchRenderer2._textureArrayPool,n=this.renderer.batch,a=this._tempBoundTextures,s=this.renderer.textureGC.count;let o=++BaseTexture._globalBatch,l=0,u=i[0],c=0;n.copyBoundTextures(a,r);for(let e=0;e<this._bufferSize;++e){var h=t[e];t[e]=null,h._batchEnabled!==o&&(u.count>=r&&(n.boundArray(u,a,o,r),this.buildDrawCalls(u,c,e),c=e,u=i[++l],++o),h._batchEnabled=o,h.touched=s,u.elements[u.count++]=h)}0<u.count&&(n.boundArray(u,a,o,r),this.buildDrawCalls(u,c,this._bufferSize),++l,++o);for(let e=0;e<a.length;e++)a[e]=null;BaseTexture._globalBatch=o}buildDrawCalls(t,r,i){var{_bufferedElements:n,_attributeBuffer:a,_indexBuffer:s,vertexSize:o}=this,l=_BatchRenderer2._drawCallPool;let u=this._dcIndex,c=this._aIndex,h=this._iIndex,d=l[u];d.start=this._iIndex,d.texArray=t;for(let e=r;e<i;++e){var p=n[e],f=p._texture.baseTexture,f=premultiplyBlendMode[f.alphaMode?1:0][p.blendMode];n[e]=null,r<e&&d.blend!==f&&(d.size=h-d.start,r=e,(d=l[++u]).texArray=t,d.start=h),this.packInterleavedGeometry(p,a,s,c,h),c+=p.vertexData.length/2*o,h+=p.indices.length,d.blend=f}r<i&&(d.size=h-d.start,++u),this._dcIndex=u,this._aIndex=c,this._iIndex=h}bindAndClearTexArray(t){var r=this.renderer.texture;for(let e=0;e<t.count;e++)r.bind(t.elements[e],t.ids[e]),t.elements[e]=null;t.count=0}updateGeometry(){var{_packedGeometries:e,_attributeBuffer:t,_indexBuffer:r}=this;_BatchRenderer2.canUploadSameBuffer?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){var t=this._dcIndex,{gl:r,state:i}=this.renderer,n=_BatchRenderer2._drawCallPool;let a=null;for(let e=0;e<t;e++){var{texArray:s,type:o,size:l,start:u,blend:c}=n[e];a!==s&&(a=s,this.bindAndClearTexArray(s)),this.state.blendMode=c,i.set(this.state),r.drawElements(o,l,r.UNSIGNED_SHORT,2*u)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),_BatchRenderer2.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){var e=nextPow2(Math.ceil(e/8)),t=log2(e),e=8*e;this._aBuffers.length<=t&&(this._iBuffers.length=t+1);let r=this._aBuffers[e];return r||(this._aBuffers[e]=r=new ViewableBuffer(e*this.vertexSize*4)),r}getIndexBuffer(e){var e=nextPow2(Math.ceil(e/12)),t=log2(e),e=12*e;this._iBuffers.length<=t&&(this._iBuffers.length=t+1);let r=this._iBuffers[t];return r||(this._iBuffers[t]=r=new Uint16Array(e)),r}packInterleavedGeometry(e,t,r,i,n){var{uint32View:a,float32View:s}=t,o=i/this.vertexSize,l=e.uvs,u=e.indices,c=e.vertexData,h=e._texture.baseTexture._batchLocation,t=Math.min(e.worldAlpha,1),d=Color.shared.setValue(e._tintRGB).toPremultiplied(t,0<e._texture.baseTexture.alphaMode);for(let e=0;e<c.length;e+=2)s[i++]=c[e],s[i++]=c[e+1],s[i++]=l[e],s[i++]=l[e+1],a[i++]=d,s[i++]=h;for(let e=0;e<u.length;e++)r[n++]=o+u[e]}},BatchRenderer=(_BatchRenderer.defaultBatchSize=4096,_BatchRenderer.extension={name:"batch",type:ExtensionType.RendererPlugin},_BatchRenderer._drawCallPool=[],_BatchRenderer._textureArrayPool=[],_BatchRenderer);extensions$1.add(BatchRenderer);var defaultFragment=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,defaultVertex$1=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;let _Filter=class _Filter2 extends Shader{constructor(e,t,r){super(Program.from(e||_Filter2.defaultVertexSrc,t||_Filter2.defaultFragmentSrc),r),this.padding=0,this.resolution=_Filter2.defaultResolution,this.multisample=_Filter2.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new State}apply(e,t,r,i,n){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return defaultVertex$1}static get defaultFragmentSrc(){return defaultFragment}},Filter=(_Filter.defaultResolution=1,_Filter.defaultMultisample=MSAA_QUALITY.NONE,_Filter);class BackgroundSystem{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Color(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;var{backgroundColor:e,background:t,backgroundAlpha:r}=e,t=t??e;void 0!==t&&(this.color=t),this.alpha=r}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}BackgroundSystem.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},BackgroundSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"background"},extensions$1.add(BackgroundSystem);class BatchSystem{constructor(e){this.renderer=e,this.emptyRenderer=new ObjectRenderer(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,r){var i=this.renderer.texture.boundTextures;for(let e=r-1;0<=e;--e)t[e]=i[e]||null,t[e]&&(t[e]._batchLocation=e)}boundArray(e,t,r,i){var{elements:n,ids:a,count:s}=e;let o=0;for(let e=0;e<s;e++){var l=n[e],u=l._batchLocation;if(0<=u&&u<i&&t[u]===l)a[e]=u;else for(;o<i;){var c=t[o];if(!c||c._batchEnabled!==r||c._batchLocation!==o){a[e]=o,t[l._batchLocation=o]=l;break}o++}}}destroy(){this.renderer=null}}BatchSystem.extension={type:ExtensionType.RendererSystem,name:"batch"},extensions$1.add(BatchSystem);let CONTEXT_UID_COUNTER=0;class ContextSystem{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++}init(e){var t,r;e.context?this.initFromContext(e.context):(t=this.renderer.background.alpha<1,r=e.premultipliedAlpha,this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference}))}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=CONTEXT_UID_COUNTER++,this.renderer.runners.contextChange.emit(e);e=this.renderer.view;void 0!==e.addEventListener&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){e=this.createContext(this.renderer.view,e);this.initFromContext(e)}createContext(e,t){let r;if(r=settings.PREFER_ENV>=ENV.WEBGL2?e.getContext("webgl2",t):r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){var e=this.gl,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){var e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext,t=(r&&(this.webGLVersion=2),t&&t.stencil,r||!!e.getExtension("OES_element_index_uint"));this.supports.uint32Indices=t}}ContextSystem.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},ContextSystem.extension={type:ExtensionType.RendererSystem,name:"context"},extensions$1.add(ContextSystem);class Framebuffer{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Runner("disposeFramebuffer"),this.multisample=MSAA_QUALITY.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,mipmap:MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new BaseTexture(null,{scaleMode:SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:MIPMAP_MODES.OFF,format:FORMATS.DEPTH_COMPONENT,type:TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,r){if(t=Math.round(t),r=Math.round(r),!t||!r)throw new Error("Framebuffer width and height must not be zero");if(t!==this.width||r!==this.height){this.width=t,this.height=r,this.dirtyId++,this.dirtySize++;for(let e=0;e<this.colorTextures.length;e++){var i=this.colorTextures[e],n=i.resolution;i.setSize(t/n,r/n)}var e;this.depthTexture&&(e=this.depthTexture.resolution,this.depthTexture.setSize(t/e,r/e))}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class BaseRenderTexture extends BaseTexture{constructor(e={}){(e="number"==typeof e?{width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}:e).width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=MSAA_QUALITY.NONE),super(null,e),this.mipmap=MIPMAP_MODES.OFF,this.valid=!0,this._clear=new Color([0,0,0,0]),this.framebuffer=new Framebuffer(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class BaseImageResource extends Resource{constructor(e){super(e.naturalWidth||e.videoWidth||e.displayWidth||e.width,e.naturalHeight||e.videoHeight||e.displayHeight||e.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,r){void 0!==r||t.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=determineCrossOrigin(t)}upload(e,t,r,i){var e=e.gl,n=t.realWidth,a=t.realHeight;if(i=i||this.source,typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if(typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===ALPHA_MODES.UNPACK),this.noSubImage||t.target!==e.TEXTURE_2D||r.width!==n||r.height!==a?(r.width=n,r.height=a,e.texImage2D(t.target,0,r.internalFormat,t.format,r.type,i)):e.texSubImage2D(e.TEXTURE_2D,0,0,0,t.format,r.type,i),!0}update(){var e,t;this.destroyed||(e=(t=this.source).naturalWidth||t.videoWidth||t.width,t=t.naturalHeight||t.videoHeight||t.height,this.resize(e,t),super.update())}dispose(){this.source=null}}class ImageResource extends BaseImageResource{constructor(e,t){var r;t=t||{},"string"==typeof e&&(r=new Image,BaseImageResource.crossOrigin(r,e,t.crossorigin),r.src=e,e=r),super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??settings.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.bitmap=null,this._load=null,!1!==t.autoLoad&&this.load()}load(e){return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((e,t)=>{let r=this.source;this.url=r.src;var i=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?i():(r.onload=i,r.onerror=e=>{t(e),this.onError.emit(e)})}),this._load)}process(){let r=this.source;if(null===this._process){if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);let t=globalThis.createImageBitmap,e=!r.crossOrigin||"anonymous"===r.crossOrigin;this._process=fetch(r.src,{mode:e?"cors":"no-cors"}).then(e=>e.blob()).then(e=>t(e,0,0,r.width,r.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"})).then(e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this)))}return this._process}upload(e,t,r){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,r,this.bitmap),!this.preserveBitmap){let e=!0;var i,n=t._glTextures;for(i in n){var a=n[i];if(a!==r&&a.dirtyId!==t.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return typeof HTMLImageElement<"u"&&("string"==typeof e||e instanceof HTMLImageElement)}}class TextureUvs{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,r){var i,n,a,s,o=t.width,t=t.height;r?(i=e.width/2/o,a=e.x/o+i,s=e.y/t+(n=e.height/2/t),r=groupD8.add(r,groupD8.NW),this.x0=a+i*groupD8.uX(r),this.y0=s+n*groupD8.uY(r),r=groupD8.add(r,2),this.x1=a+i*groupD8.uX(r),this.y1=s+n*groupD8.uY(r),r=groupD8.add(r,2),this.x2=a+i*groupD8.uX(r),this.y2=s+n*groupD8.uY(r),r=groupD8.add(r,2),this.x3=a+i*groupD8.uX(r),this.y3=s+n*groupD8.uY(r)):(this.x0=e.x/o,this.y0=e.y/t,this.x1=(e.x+e.width)/o,this.y1=e.y/t,this.x2=(e.x+e.width)/o,this.y2=(e.y+e.height)/t,this.x3=e.x/o,this.y3=(e.y+e.height)/t),this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}TextureUvs.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};let DEFAULT_UVS=new TextureUvs;function removeAllHandlers(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class Texture extends EventEmitter$2{constructor(e,t,r,i,n,a,s){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new Rectangle(0,0,1,1)),e instanceof Texture&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=DEFAULT_UVS,this.uvMatrix=null,this.orig=r||t,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new Point(a.x,a.y):new Point(0,0),this.defaultBorders=s,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){this.baseTexture&&(e&&(e=this.baseTexture.resource,null!=e&&e.url&&TextureCache[e.url]&&Texture.removeFromCache(e.url),this.baseTexture.destroy()),this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),t=new Texture(this.baseTexture,!this.noFrame&&e,t,null==(t=this.trim)?void 0:t.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(t._frame=e),t}updateUvs(){this._uvs===DEFAULT_UVS&&(this._uvs=new TextureUvs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},r=settings.STRICT_TEXTURE_CACHE){var i,n="string"==typeof e;let a=null,s=(a=n?e:e instanceof BaseTexture?(e.cacheId||(i=(null==t?void 0:t.pixiIdPrefix)||"pixiid",e.cacheId=i+"-"+uid(),BaseTexture.addToCache(e,e.cacheId)),e.cacheId):(e._pixiId||(i=(null==t?void 0:t.pixiIdPrefix)||"pixiid",e._pixiId=i+"_"+uid()),e._pixiId),TextureCache[a]);if(n&&r&&!s)throw new Error(`The cacheId "${a}" does not exist in TextureCache.`);return s||e instanceof BaseTexture?!s&&e instanceof BaseTexture&&(s=new Texture(e),Texture.addToCache(s,a)):(t.resolution||(t.resolution=getResolutionOfUrl(e)),(s=new Texture(new BaseTexture(e,t))).baseTexture.cacheId=a,BaseTexture.addToCache(s.baseTexture,a),Texture.addToCache(s,a)),s}static fromURL(e,t){let r=Object.assign({autoLoad:!1},null==t?void 0:t.resourceOptions),i=Texture.from(e,Object.assign({resourceOptions:r},t),!1),n=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):n.load().then(()=>Promise.resolve(i))}static fromBuffer(e,t,r,i){return new Texture(BaseTexture.fromBuffer(e,t,r,i))}static fromLoader(e,t,r,i){e=new BaseTexture(e,Object.assign({scaleMode:BaseTexture.defaultOptions.scaleMode,resolution:getResolutionOfUrl(t)},i)),i=e.resource;i instanceof ImageResource&&(i.url=t);let n=new Texture(e);return r=r||t,BaseTexture.addToCache(n.baseTexture,r),Texture.addToCache(n,r),r!==t&&(BaseTexture.addToCache(n.baseTexture,t),Texture.addToCache(n,t)),n.baseTexture.valid?Promise.resolve(n):new Promise(e=>{n.baseTexture.once("loaded",()=>e(n))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),TextureCache[t]&&TextureCache[t],TextureCache[t]=e)}static removeFromCache(t){if("string"==typeof t){var e,r=TextureCache[t];if(r)return-1<(e=r.textureCacheIds.indexOf(t))&&r.textureCacheIds.splice(e,1),delete TextureCache[t],r}else if(null!=t&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)TextureCache[t.textureCacheIds[e]]===t&&delete TextureCache[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;var{x:t,y:r,width:i,height:n}=e,a=t+i>this.baseTexture.width,s=r+n>this.baseTexture.height;if(a||s)throw t=`X: ${t} + ${i} = ${t+i} > `+this.baseTexture.width,r=`Y: ${r} + ${n} = ${r+n} > `+this.baseTexture.height,new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${t} ${a&&s?"and":"or"} `+r);this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return Texture._EMPTY||(Texture._EMPTY=new Texture(new BaseTexture),removeAllHandlers(Texture._EMPTY),removeAllHandlers(Texture._EMPTY.baseTexture)),Texture._EMPTY}static get WHITE(){var e,t;return Texture._WHITE||(t=(e=settings.ADAPTER.createCanvas(16,16)).getContext("2d"),e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),Texture._WHITE=new Texture(BaseTexture.from(e)),removeAllHandlers(Texture._WHITE),removeAllHandlers(Texture._WHITE.baseTexture)),Texture._WHITE}}class RenderTexture extends Texture{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,r=!0){var i=this.baseTexture.resolution,e=Math.round(e*i)/i,t=Math.round(t*i)/i;this.valid=0<e&&0<t,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()}setResolution(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new RenderTexture(new BaseRenderTexture(e))}}class RenderTexturePool{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,r=MSAA_QUALITY.NONE){e=new BaseRenderTexture(Object.assign({width:e,height:t,resolution:1,multisample:r},this.textureOptions));return new RenderTexture(e)}getOptimalTexture(e,t,r=1,i=MSAA_QUALITY.NONE){let n,a=(e=Math.max(Math.ceil(e*r-1e-6),1),t=Math.max(Math.ceil(t*r-1e-6),1),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?n=1<i?-i:-1:(e=nextPow2(e),t=nextPow2(t),n=((65535&e)<<16|65535&t)>>>0,1<i&&(n+=4294967296*i)),this.texturePool[n]||(this.texturePool[n]=[]),this.texturePool[n].pop());return(a=a||this.createTexture(e,t,i)).filterPoolKey=n,a.setResolution(r),a}getFilterTexture(e,t,r){t=this.getOptimalTexture(e.width,e.height,t||e.resolution,r||MSAA_QUALITY.NONE);return t.filterFrame=e.filterFrame,t}returnTexture(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(let e=0;e<r.length;e++)r[e].destroy(!0)}this.texturePool={}}setScreenSize(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){for(var t in this.enableFullScreen=0<e.width&&0<e.height,this.texturePool)if(Number(t)<0){var r=this.texturePool[t];if(r)for(let e=0;e<r.length;e++)r[e].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}RenderTexturePool.SCREEN_KEY=-1;class Quad extends Geometry{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class QuadUv extends Geometry{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Buffer$2(this.vertices),this.uvBuffer=new Buffer$2(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){var r;return this.uvs[0]=0,this.uvs[1]=0,this.uvs[2]=0+t.width/e.width,this.uvs[3]=0,this.uvs[4]=0+t.width/e.width,this.uvs[5]=0+t.height/e.height,this.uvs[6]=0,this.uvs[7]=0+t.height/e.height,e=t.y,this.vertices[0]=r=t.x,this.vertices[1]=e,this.vertices[2]=r+t.width,this.vertices[3]=e,this.vertices[4]=r+t.width,this.vertices[5]=e+t.height,this.vertices[6]=r,this.vertices[7]=e+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class FilterState{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=MSAA_QUALITY.NONE,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.bindingSourceFrame=new Rectangle,this.bindingDestinationFrame=new Rectangle,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}let tempPoints=[new Point,new Point,new Point,new Point],tempMatrix$2=new Matrix;class FilterSystem{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new RenderTexturePool,this.statePool=[],this.quad=new Quad,this.quadUv=new QuadUv,this.tempRect=new Rectangle,this.activeState={},this.globalUniforms=new UniformGroup({outputFrame:new Rectangle,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new FilterState,a=r.renderTexture;let s,o,l=(o=(a.current?(f=a.current,s=f.resolution,f):(s=r.resolution,r)).multisample,t[0].resolution||s),u=t[0].multisample??o,c=t[0].padding,h=t[0].autoFit,d=t[0].legacy??!0;for(let e=1;e<t.length;e++){var p=t[e];l=Math.min(l,p.resolution||s),u=Math.min(u,p.multisample??o),c=this.useMaxPadding?Math.max(c,p.padding):c+p.padding,h=h&&p.autoFit,d=d||(p.legacy??!0)}1===i.length&&(this.defaultFilterStack[0].renderTexture=a.current),i.push(n),n.resolution=l,n.multisample=u,n.legacy=d,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(c);var f=this.tempRect.copyFrom(a.sourceFrame),i=(r.projection.transform&&this.transformAABB(tempMatrix$2.copyFrom(r.projection.transform).invert(),f),h?(n.sourceFrame.fit(f),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(f)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,(a.current||r).resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,l,u),n.filters=t,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,this.tempRect);i.x=0,i.y=0,i.width=n.sourceFrame.width,i.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(a.sourceFrame),n.bindingDestinationFrame.copyFrom(a.destinationFrame),n.transform=r.projection.transform,r.projection.transform=null,a.bind(n.renderTexture,n.sourceFrame,i),r.framebuffer.clear(0,0,0,0)}pop(){var e=this.defaultFilterStack,i=e.pop(),n=i.filters,t=(this.activeState=i,this.globalUniforms.uniforms),a=(t.outputFrame=i.sourceFrame,t.resolution=i.resolution,t.inputSize),r=t.inputPixel,s=t.inputClamp,a=(a[0]=i.destinationFrame.width,a[1]=i.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],r[0]=Math.round(a[0]*i.resolution),r[1]=Math.round(a[1]*i.resolution),r[2]=1/r[0],r[3]=1/r[1],s[0]=.5*r[2],s[1]=.5*r[3],s[2]=i.sourceFrame.width*a[2]-.5*r[2],s[3]=i.sourceFrame.height*a[3]-.5*r[3],i.legacy&&((s=t.filterArea)[0]=i.destinationFrame.width,s[1]=i.destinationFrame.height,s[2]=i.sourceFrame.x,s[3]=i.sourceFrame.y,t.filterClamp=t.inputClamp),this.globalUniforms.update(),e[e.length-1]);if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,i.renderTexture,a.renderTexture,CLEAR_MODES.BLEND,i),this.returnFilterTexture(i.renderTexture);else{let e=i.renderTexture,t=this.getOptimalFilterTexture(e.width,e.height,i.resolution),r=(t.filterFrame=e.filterFrame,0);for(r=0;r<n.length-1;++r){1===r&&1<i.multisample&&((t=this.getOptimalFilterTexture(e.width,e.height,i.resolution)).filterFrame=e.filterFrame),n[r].apply(this,e,t,CLEAR_MODES.CLEAR,i);var o=e;e=t,t=o}n[r].apply(this,e,a.renderTexture,CLEAR_MODES.BLEND,i),1<r&&1<i.multisample&&this.returnFilterTexture(i.renderTexture),this.returnFilterTexture(e),this.returnFilterTexture(t)}i.clear(),this.statePool.push(i)}bindAndClear(e,t=CLEAR_MODES.CLEAR){var{renderTexture:r,state:i}=this.renderer,n=(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,null!=e&&e.filterFrame?((n=this.tempRect).x=0,n.y=0,n.width=e.filterFrame.width,n.height=e.filterFrame.height,r.bind(e,e.filterFrame,n)):e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame),1&i.stateId||this.forceClear);(t===CLEAR_MODES.CLEAR||t===CLEAR_MODES.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,r,i){var n=this.renderer;n.state.set(e.state),this.bindAndClear(r,i),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(DRAW_MODES.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(DRAW_MODES.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){var{sourceFrame:r,destinationFrame:i}=this.activeState,n=t._texture.orig,e=e.set(i.width,0,0,i.height,r.x,r.y),i=t.worldTransform.copyTo(Matrix.TEMP_MATRIX);return i.invert(),e.prepend(i),e.scale(1/n.width,1/n.height),e.translate(t.anchor.x,t.anchor.y),e}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,r=1,i=MSAA_QUALITY.NONE){return this.texturePool.getOptimalTexture(e,t,r,i)}getFilterTexture(e,t,r){"number"==typeof e&&(i=e,e=t,t=i),e=e||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,r||MSAA_QUALITY.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){var r=tempPoints[0],i=tempPoints[1],n=tempPoints[2],a=tempPoints[3],e=(r.set(t.left,t.top),i.set(t.left,t.bottom),n.set(t.right,t.top),a.set(t.right,t.bottom),e.apply(r,r),e.apply(i,i),e.apply(n,n),e.apply(a,a),Math.min(r.x,i.x,n.x,a.x)),s=Math.min(r.y,i.y,n.y,a.y),o=Math.max(r.x,i.x,n.x,a.x),r=Math.max(r.y,i.y,n.y,a.y);t.x=e,t.y=s,t.width=o-e,t.height=r-s}roundFrame(e,t,r,i,n){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(n){var{a,b:s,c:o,d:l}=n;if((1e-4<Math.abs(s)||1e-4<Math.abs(o))&&(1e-4<Math.abs(a)||1e-4<Math.abs(l)))return}(n=n?tempMatrix$2.copyFrom(n):tempMatrix$2.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(n,e),e.ceil(t),this.transformAABB(n.invert(),e)}}}FilterSystem.extension={type:ExtensionType.RendererSystem,name:"filter"},extensions$1.add(FilterSystem);class GLFramebuffer{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}let tempRectangle=new Rectangle;class FramebufferSystem{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new Framebuffer(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);var r=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let t=this.renderer.context.extensions.drawBuffers,e=this.renderer.context.extensions.depthTexture;settings.PREFER_ENV===ENV.WEBGL_LEGACY&&(t=null,e=null),t?r.drawBuffers=e=>t.drawBuffersWEBGL(e):(this.hasMRT=!1,r.drawBuffers=()=>{}),e||(this.writeDepthTexture=!1)}else this.msaaSamples=r.getInternalformatParameter(r.RENDERBUFFER,r.RGBA8,r.SAMPLES)}bind(t,e,r=0){var i=this.gl;if(t){var n,a=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,a.framebuffer)),a.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,a.mipLevel=r),a.dirtyId!==t.dirtyId&&(a.dirtyId=t.dirtyId,a.dirtyFormat!==t.dirtyFormat?(a.dirtyFormat=t.dirtyFormat,a.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):a.dirtySize!==t.dirtySize&&(a.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let e=0;e<t.colorTextures.length;e++){var s=t.colorTextures[e];this.renderer.texture.unbind(s.parentTextureArray||s)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?(a=e.width>>r,this.setViewport(e.x*(n=a/e.width),e.y*n,a,e.height>>r)):(n=t.width>>r,this.setViewport(0,0,n,t.height>>r))}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,r,i){var n=this.viewport;e=Math.round(e),t=Math.round(t),r=Math.round(r),i=Math.round(i),n.width===r&&n.height===i&&n.x===e&&n.y===t||(n.x=e,n.y=t,n.width=r,n.height=i,this.gl.viewport(e,t,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,r,i,n=BUFFER_BITS.COLOR|BUFFER_BITS.DEPTH){var a=this.gl;a.clearColor(e,t,r,i),a.clear(n)}initFramebuffer(e){var t=this.gl,t=new GLFramebuffer(t.createFramebuffer());return t.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=t,this.managedFramebuffers.push(e),e.disposeRunner.add(this),t}resizeFramebuffer(t){var r=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){r.bindRenderbuffer(r.RENDERBUFFER,i.stencil);let e;e=1===this.renderer.context.webGLVersion?r.DEPTH_STENCIL:t.depth&&t.stencil?r.DEPTH24_STENCIL8:t.depth?r.DEPTH_COMPONENT24:r.STENCIL_INDEX8,i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,e,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,e,t.width,t.height)}var n=t.colorTextures;let a=n.length;r.drawBuffers||(a=Math.min(a,1));for(let e=0;e<a;e++){var s=n[e],s=s.parentTextureArray||s;this.renderer.texture.bind(s,0),0===e&&i.msaaBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,s._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(r,t){var i=this.gl,n=r.glFramebuffers[this.CONTEXT_UID],a=r.colorTextures;let s=a.length;i.drawBuffers||(s=Math.min(s,1)),1<n.multisample&&this.canMultisampleFramebuffer(r)?n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer():n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null,n.blitFramebuffer)&&(n.blitFramebuffer.dispose(),n.blitFramebuffer=null);var e,o=[];for(let e=0;e<s;e++){var l=a[e],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),0===e&&n.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,u._glTextures[this.CONTEXT_UID].internalFormat,r.width,r.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+e,l.target,u._glTextures[this.CONTEXT_UID].texture,t),o.push(i.COLOR_ATTACHMENT0+e))}if(1<o.length&&i.drawBuffers(o),r.depthTexture&&this.writeDepthTexture&&(e=r.depthTexture,this.renderer.texture.bind(e,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,e._glTextures[this.CONTEXT_UID].texture,t)),!r.stencil&&!r.depth||r.depthTexture&&this.writeDepthTexture)n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null);else{n.stencil=n.stencil||i.createRenderbuffer();let e,t;t=1===this.renderer.context.webGLVersion?(e=i.DEPTH_STENCIL_ATTACHMENT,i.DEPTH_STENCIL):r.depth&&r.stencil?(e=i.DEPTH_STENCIL_ATTACHMENT,i.DEPTH24_STENCIL8):r.depth?(e=i.DEPTH_ATTACHMENT,i.DEPTH_COMPONENT24):(e=i.STENCIL_ATTACHMENT,i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,t,r.width,r.height):i.renderbufferStorage(i.RENDERBUFFER,t,r.width,r.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,e,i.RENDERBUFFER,n.stencil)}}canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(t){var r=this.msaaSamples;let i=MSAA_QUALITY.NONE;if(!(t<=1||null===r)){for(let e=0;e<r.length;e++)if(r[e]<=t){i=r[e];break}1===i&&(i=MSAA_QUALITY.NONE)}return i}blit(e,t,r){var{current:i,renderer:n,gl:a,CONTEXT_UID:s}=this;if(2===n.context.webGLVersion&&i){n=i.glFramebuffers[s];if(n){if(!e){if(!n.msaaBuffer)return;s=i.colorTextures[0];if(!s)return;n.blitFramebuffer||(n.blitFramebuffer=new Framebuffer(i.width,i.height),n.blitFramebuffer.addColorTexture(0,s)),(e=n.blitFramebuffer).colorTextures[0]!==s&&(e.colorTextures[0]=s,e.dirtyId++,e.dirtyFormat++),e.width===i.width&&e.height===i.height||(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}t||((t=tempRectangle).width=i.width,t.height=i.height);s=t.width===(r=r||t).width&&t.height===r.height;this.bind(e),a.bindFramebuffer(a.READ_FRAMEBUFFER,n.framebuffer),a.blitFramebuffer(t.left,t.top,t.right,t.bottom,r.left,r.top,r.right,r.bottom,a.COLOR_BUFFER_BIT,s?a.NEAREST:a.LINEAR),a.bindFramebuffer(a.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}}}disposeFramebuffer(e,t){var r,i=e.glFramebuffers[this.CONTEXT_UID],n=this.gl;i&&(delete e.glFramebuffers[this.CONTEXT_UID],0<=(r=this.managedFramebuffers.indexOf(e))&&this.managedFramebuffers.splice(r,1),e.disposeRunner.remove(this),t||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil)),i.blitFramebuffer)&&this.disposeFramebuffer(i.blitFramebuffer,t)}disposeAll(t){var r=this.managedFramebuffers;this.managedFramebuffers=[];for(let e=0;e<r.length;e++)this.disposeFramebuffer(r[e],t)}forceStencil(){var r=this.current;if(r){var i=r.glFramebuffers[this.CONTEXT_UID];if(!(!i||i.stencil&&r.stencil)){r.stencil=!0;var n=r.width,a=r.height,s=this.gl,o=i.stencil=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o);let e,t;t=1===this.renderer.context.webGLVersion?(e=s.DEPTH_STENCIL_ATTACHMENT,s.DEPTH_STENCIL):r.depth?(e=s.DEPTH_STENCIL_ATTACHMENT,s.DEPTH24_STENCIL8):(e=s.STENCIL_ATTACHMENT,s.STENCIL_INDEX8),i.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,t,n,a):s.renderbufferStorage(s.RENDERBUFFER,t,n,a),s.framebufferRenderbuffer(s.FRAMEBUFFER,e,s.RENDERBUFFER,o)}}}reset(){this.current=this.unknownFramebuffer,this.viewport=new Rectangle}destroy(){this.renderer=null}}FramebufferSystem.extension={type:ExtensionType.RendererSystem,name:"framebuffer"},extensions$1.add(FramebufferSystem);let byteSizeMap={5126:4,5123:2,5121:1};class GeometrySystem{constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){let t=this.renderer.context.extensions.vertexArrayObject;(t=settings.PREFER_ENV===ENV.WEBGL_LEGACY?null:t)?(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(2!==t.webGLVersion){let a=e.getExtension("ANGLE_instanced_arrays");a?(e.vertexAttribDivisor=(e,t)=>a.vertexAttribDivisorANGLE(e,t),e.drawElementsInstanced=(e,t,r,i,n)=>a.drawElementsInstancedANGLE(e,t,r,i,n),e.drawArraysInstanced=(e,t,r,i)=>a.drawArraysInstancedANGLE(e,t,r,i)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;var r=this.gl;let i=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||((this.managedGeometries[e.id]=e).disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var a=i[t.program.id]||this.initGeometryVao(e,t,n);this._activeGeometry=e,this._activeVao!==a&&(this._activeVao=a,this.hasVao?r.bindVertexArray(a):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){var t=this._activeGeometry,r=this.renderer.buffer;for(let e=0;e<t.buffers.length;e++){var i=t.buffers[e];r.update(i)}}checkCompatibility(e,t){var r,i=e.attributes;for(r in t.attributeData)if(!i[r])throw new Error(`shader and geometry incompatible, geometry missing the "${r}" attribute`)}getSignature(e,t){var r,i=e.attributes,n=t.attributeData,a=["g",e.id];for(r in i)n[r]&&a.push(r,n[r].location);return a.join("-")}initGeometryVao(e,t,r=!0){var i=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,s=t.program,t=(s.glPrograms[n]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,s),this.getSignature(e,s)),o=e.glVertexArrayObjects[this.CONTEXT_UID],l=o[t];if(l)o[s.id]=l;else{var u,c,h,d=e.buffers,p=e.attributes,f={},m={};for(u in d)f[u]=0,m[u]=0;for(c in p)!p[c].size&&s.attributeData[c]?p[c].size=s.attributeData[c].size:p[c].size,f[p[c].buffer]+=p[c].size*byteSizeMap[p[c].type];for(h in p){var g=p[h],v=g.size;void 0===g.stride&&(f[g.buffer]===v*byteSizeMap[g.type]?g.stride=0:g.stride=f[g.buffer]),void 0===g.start&&(g.start=m[g.buffer],m[g.buffer]+=v*byteSizeMap[g.type])}l=i.createVertexArray(),i.bindVertexArray(l);for(let e=0;e<d.length;e++){var y=d[e];a.bind(y),r&&y._glBuffers[n].refCount++}this.activateVao(e,s),o[s.id]=l,o[t]=l,i.bindVertexArray(null),a.unbind(BUFFER_TYPE.ARRAY_BUFFER)}return l}disposeGeometry(e,t){var r;if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var i=e.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,a=e.buffers,s=null==(r=this.renderer)?void 0:r.buffer;if(e.disposeRunner.remove(this),i){if(s)for(let e=0;e<a.length;e++){var o=a[e]._glBuffers[this.CONTEXT_UID];o&&(o.refCount--,0===o.refCount)&&!t&&s.dispose(a[e],t)}if(!t)for(var l in i)"g"===l[0]&&(l=i[l],this._activeVao===l&&this.unbind(),n.deleteVertexArray(l));delete e.glVertexArrayObjects[this.CONTEXT_UID]}}}disposeAll(t){var r=Object.keys(this.managedGeometries);for(let e=0;e<r.length;e++)this.disposeGeometry(this.managedGeometries[r[e]],t)}activateVao(e,t){var r,i=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,s=e.buffers,o=e.attributes;e.indexBuffer&&a.bind(e.indexBuffer);let l=null;for(r in o){var u=o[r],c=s[u.buffer],h=c._glBuffers[n];if(t.attributeData[r]){l!==h&&(a.bind(c),l=h);c=t.attributeData[r].location;if(i.enableVertexAttribArray(c),i.vertexAttribPointer(c,u.size,u.type||i.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(c,u.divisor)}}}}draw(e,t,r,i){var n,a,s=this.gl,o=this._activeGeometry;return o.indexBuffer?(a=2===(n=o.indexBuffer.data.BYTES_PER_ELEMENT)?s.UNSIGNED_SHORT:s.UNSIGNED_INT,(2===n||4===n&&this.canUseUInt32ElementIndex)&&(o.instanced?s.drawElementsInstanced(e,t||o.indexBuffer.data.length,a,(r||0)*n,i||1):s.drawElements(e,t||o.indexBuffer.data.length,a,(r||0)*n))):o.instanced?s.drawArraysInstanced(e,r,t||o.getSize(),i||1):s.drawArrays(e,r,t||o.getSize()),this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}GeometrySystem.extension={type:ExtensionType.RendererSystem,name:"geometry"},extensions$1.add(GeometrySystem);let tempMat$1=new Matrix;class TextureMatrix{constructor(e,t){this._texture=e,this.mapCoord=new Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin="u"<typeof t?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(t,r){void 0===r&&(r=t);var i=this.mapCoord;for(let e=0;e<t.length;e+=2){var n=t[e],a=t[e+1];r[e]=n*i.a+a*i.c+i.tx,r[e+1]=n*i.b+a*i.d+i.ty}return r}update(e){var t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var e=t._uvs,e=(this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0),t.orig),r=t.trim,e=(r&&(tempMat$1.set(e.width/r.width,0,0,e.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(tempMat$1)),t.baseTexture),r=this.uClampFrame,i=this.clampMargin/e.resolution,n=this.clampOffset;return r[0]=(t._frame.x+i+n)/e.width,r[1]=(t._frame.y+i+n)/e.height,r[2]=(t._frame.x+t._frame.width-i+n)/e.width,r[3]=(t._frame.y+t._frame.height-i+n)/e.height,this.uClampOffset[0]=n/e.realWidth,this.uClampOffset[1]=n/e.realHeight,this.isSimple=t._frame.width===e.width&&t._frame.height===e.height&&0===t.rotate,!0}}var fragment$y=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,vertex$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class SpriteMaskFilter extends Filter{constructor(e,t,r){let i=null;"string"!=typeof e&&void 0===t&&void 0===r&&(i=e,r=t=e=void 0),super(e||vertex$4,t||fragment$y,r),this.maskSprite=i,this.maskMatrix=new Matrix}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,r,i){var n=this._maskSprite,a=n._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new TextureMatrix(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,t,r,i))}}class MaskData{constructor(e=null){this.type=MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Filter.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=MASK_TYPES.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class MaskSystem{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let r=t;r.isMaskData||((i=this.maskDataPool.pop()||new MaskData).pooled=!0,i.maskObject=t,r=i);var i,t=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(t),r._colorMask=t?t._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==MASK_TYPES.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.push(r);break;case MASK_TYPES.STENCIL:this.renderer.stencil.push(r);break;case MASK_TYPES.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case MASK_TYPES.COLOR:this.pushColorMask(r)}r.type===MASK_TYPES.SPRITE&&this.maskStack.push(r)}pop(e){var t=this.maskStack.pop();if(t&&t._target===e){if(t.enabled)switch(t.type){case MASK_TYPES.SCISSOR:this.renderer.scissor.pop(t);break;case MASK_TYPES.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case MASK_TYPES.SPRITE:this.popSpriteMask(t);break;case MASK_TYPES.COLOR:this.popColorMask(t)}t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length&&(e=this.maskStack[this.maskStack.length-1]).type===MASK_TYPES.SPRITE&&e._filters&&(e._filters[0].maskSprite=e.maskObject)}}detect(e){var t=e.maskObject;t?t.isSprite?e.type=MASK_TYPES.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=MASK_TYPES.SCISSOR:e.type=MASK_TYPES.STENCIL:e.type=MASK_TYPES.COLOR}pushSpriteMask(e){var t=e.maskObject,r=e._target;let i=e._filters;(i=i?i:(i=this.alphaMaskPool[this.alphaMaskIndex])||(this.alphaMaskPool[this.alphaMaskIndex]=[new SpriteMaskFilter]))[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=t;var n=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){var t=e._colorMask,e=e._colorMask=t&e.colorMask;e!==t&&this.renderer.gl.colorMask(0!=(1&e),0!=(2&e),0!=(4&e),0!=(8&e))}popColorMask(e){var e=e._colorMask,t=0<this.maskStack.length?this.maskStack[this.maskStack.length-1]._colorMask:15;t!==e&&this.renderer.gl.colorMask(0!=(1&t),0!=(2&t),0!=(4&t),0!=(8&t))}destroy(){this.renderer=null}}MaskSystem.extension={type:ExtensionType.RendererSystem,name:"mask"},extensions$1.add(MaskSystem);class AbstractMaskSystem{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){var t=this.renderer.gl,r=this.getStackLength(),e=(this.maskStack=e,this.getStackLength());e!==r&&(0===e?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}let tempMatrix$1=new Matrix,rectPool=[],_ScissorSystem=class _ScissorSystem2 extends AbstractMaskSystem{constructor(e){super(e),this.glConst=settings.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){var t,r,i,n;e._scissorRectLocal||(t=e._scissorRect,n=e.maskObject,r=this.renderer,i=r.renderTexture,n=n.getBounds(!0,rectPool.pop()??new Rectangle),this.roundFrameToPixels(n,(i.current||r).resolution,i.sourceFrame,i.destinationFrame,r.projection.transform),t&&n.fit(t),e._scissorRectLocal=n)}static isMatrixRotated(e){var t,r,i;return!!e&&({a:e,b:t,c:r,d:i}=e,1e-4<Math.abs(t)||1e-4<Math.abs(r))&&(1e-4<Math.abs(e)||1e-4<Math.abs(i))}testScissor(e){var t=e.maskObject;if(!t.isFastRect||!t.isFastRect()||_ScissorSystem2.isMatrixRotated(t.worldTransform)||_ScissorSystem2.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);t=e._scissorRectLocal;return 0<t.width&&0<t.height}roundFrameToPixels(e,t,r,i,n){_ScissorSystem2.isMatrixRotated(n)||((n=n?tempMatrix$1.copyFrom(n):tempMatrix$1.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.renderer.filter.transformAABB(n,e),e.fit(i),e.x=Math.round(e.x*t),e.y=Math.round(e.y*t),e.width=Math.round(e.width*t),e.height=Math.round(e.height*t))}push(e){e._scissorRectLocal||this.calcScissorRect(e);var t=this.renderer.gl;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){var t=this.renderer.gl;e&&rectPool.push(e._scissorRectLocal),0<this.getStackLength()?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){var e=this.maskStack[this.maskStack.length-1]._scissorRect;let t;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)}},ScissorSystem=(_ScissorSystem.extension={type:ExtensionType.RendererSystem,name:"scissor"},_ScissorSystem);extensions$1.add(ScissorSystem);class StencilSystem extends AbstractMaskSystem{constructor(e){super(e),this.glConst=settings.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){var t=e.maskObject,r=this.renderer.gl,i=e._stencilCounter,n=(0===i&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++,e._colorMask);0!==n&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==n&&(e._colorMask=n,r.colorMask(0!=(1&n),0!=(2&n),0!=(4&n),0!=(8&n))),this._useCurrent()}pop(e){var t,r,i=this.renderer.gl;0===this.getStackLength()?i.disable(i.STENCIL_TEST):(0!==(r=(t=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null)?t._colorMask:15)&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==r&&(t._colorMask=r,i.colorMask(0!=(1&r),0!=(2&r),0!=(4&r),0!=(8&r))),this._useCurrent())}_useCurrent(){var e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}StencilSystem.extension={type:ExtensionType.RendererSystem,name:"stencil"},extensions$1.add(StencilSystem);class PluginSystem{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract}},prepare:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare}},interaction:{enumerable:!1,get(){return deprecation("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events}}})}init(){var e,t=this.rendererPlugins;for(e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}PluginSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_plugin"},extensions$1.add(PluginSystem);class ProjectionSystem{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Matrix,this.transform=null}update(e,t,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);t=this.renderer;t.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,t.globalUniforms.update(),t.shader.shader&&t.shader.syncUniformGroup(t.shader.shader.uniforms.globals)}calculateProjection(e,t,r,i){var n=this.projectionMatrix,i=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=1/t.height*2*i,n.tx=-1-t.x*n.a,n.ty=-i-t.y*n.d}setTransform(e){}destroy(){this.renderer=null}}ProjectionSystem.extension={type:ExtensionType.RendererSystem,name:"projection"},extensions$1.add(ProjectionSystem);let tempTransform=new Transform,tempRect$1=new Rectangle;class GenerateTextureSystem{constructor(e){this.renderer=e,this._tempMatrix=new Matrix}generateTexture(e,t){let{region:r,...i}=t||{},n=(null==r?void 0:r.copyTo(tempRect$1))||e.getLocalBounds(tempRect$1,!0),a=i.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/a),n.height=Math.max(n.height,1/a),i.width=n.width,i.height=n.height,i.resolution=a,i.multisample??(i.multisample=this.renderer.multisample);var t=RenderTexture.create(i),s=(this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y,e.transform);return e.transform=tempTransform,this.renderer.render(e,{renderTexture:t,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=s,t}destroy(){}}GenerateTextureSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"textureGenerator"},extensions$1.add(GenerateTextureSystem);let tempRect=new Rectangle,tempRect2=new Rectangle;class RenderTextureSystem{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Rectangle,this.destinationFrame=new Rectangle,this.viewportFrame=new Rectangle}contextChange(){var e=null==(e=this.renderer)?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,r){var i=this.renderer;let n,a,s;(this.current=e)?(n=e.baseTexture,s=n.resolution,t||(tempRect.width=e.frame.width,tempRect.height=e.frame.height,t=tempRect),r||(tempRect2.x=e.frame.x,tempRect2.y=e.frame.y,tempRect2.width=t.width,tempRect2.height=t.height,r=tempRect2),a=n.framebuffer):(s=i.resolution,t||(tempRect.width=i._view.screen.width,tempRect.height=i._view.screen.height,t=tempRect),r||((r=tempRect).width=t.width,r.height=t.height));var o=this.viewportFrame;o.x=r.x*s,o.y=r.y*s,o.width=r.width*s,o.height=r.height*s,e||(o.y=i.view.height-(o.y+o.height)),o.ceil(),this.renderer.framebuffer.bind(a,o),this.renderer.projection.update(r,t,s,!a),e?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)}clear(e,t){var r,i,n,a=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,e=Color.shared.setValue(e||a),a=((this.current&&0<this.current.baseTexture.alphaMode||!this.current&&this._rendererPremultipliedAlpha)&&e.premultiply(e.alpha),this.destinationFrame),s=this.current?this.current.baseTexture:this.renderer._view.screen,a=a.width!==s.width||a.height!==s.height;a&&({x:s,y:r,width:i,height:n}=this.viewportFrame,s=Math.round(s),r=Math.round(r),i=Math.round(i),n=Math.round(n),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(s,r,i,n)),this.renderer.framebuffer.clear(e.red,e.green,e.blue,e.alpha,t),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}RenderTextureSystem.extension={type:ExtensionType.RendererSystem,name:"renderTexture"},extensions$1.add(RenderTextureSystem);class IGLUniformData{}class GLProgram{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function getAttributeData(t,r){var i={},n=r.getProgramParameter(t,r.ACTIVE_ATTRIBUTES);for(let e=0;e<n;e++){var a,s=r.getActiveAttrib(t,e);s.name.startsWith("gl_")||(a={type:a=mapType(r,s.type),name:s.name,size:mapSize(a),location:r.getAttribLocation(t,s.name)},i[s.name]=a)}return i}function getUniformData(t,r){var i={},n=r.getProgramParameter(t,r.ACTIVE_UNIFORMS);for(let e=0;e<n;e++){var a=r.getActiveUniform(t,e),s=a.name.replace(/\[.*?\]$/,""),o=!!a.name.match(/\[.*?\]$/),l=mapType(r,a.type);i[s]={name:s,index:e,type:l,size:a.size,isArray:o,value:defaultValue(l,a.size)}}return i}function generateProgram(t,r){var e=compileShader(t,t.VERTEX_SHADER,r.vertexSrc),i=compileShader(t,t.FRAGMENT_SHADER,r.fragmentSrc),n=t.createProgram(),a=(t.attachShader(n,e),t.attachShader(n,i),null==(a=r.extra)?void 0:a.transformFeedbackVaryings);if(a&&"function"==typeof t.transformFeedbackVaryings&&t.transformFeedbackVaryings(n,a.names,"separate"===a.bufferMode?t.SEPARATE_ATTRIBS:t.INTERLEAVED_ATTRIBS),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)||logProgramError(t,n,e,i),r.attributeData=getAttributeData(n,t),r.uniformData=getUniformData(n,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(r.vertexSrc)){var s=Object.keys(r.attributeData);s.sort((e,t)=>t<e?1:-1);for(let e=0;e<s.length;e++)r.attributeData[s[e]].location=e,t.bindAttribLocation(n,e,s[e]);t.linkProgram(n)}t.deleteShader(e),t.deleteShader(i);var o,l={};for(o in r.uniformData){var u=r.uniformData[o];l[o]={location:t.getUniformLocation(n,o),value:defaultValue(u.type,u.size)}}return new GLProgram(n,l)}function uboUpdate(e,t,r,i,n){r.buffer.update(n)}let UBO_TO_SINGLE_SETTERS={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},GLSL_TO_STD40_SIZE={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function createUBOElements(e){var t=e.map(e=>({data:e,offset:0,dataLen:0,dirty:0}));let r=0,i=0,n=0;for(let e=0;e<t.length;e++){var a,s=t[e];r=GLSL_TO_STD40_SIZE[s.data.type],1<s.data.size&&(r=Math.max(r,16)*s.data.size),s.dataLen=r,i%r!=0&&i<16&&(a=i%r%16,i+=a,n+=a),16<i+r?(n=16*Math.ceil(n/16),s.offset=n,n+=r,i=r):(s.offset=n,i+=r,n+=r)}return{uboElements:t,size:n=16*Math.ceil(n/16)}}function getUBOData(e,t){var r,i=[];for(r in e)t[r]&&i.push(t[r]);return i.sort((e,t)=>e.index-t.index),i}function generateUniformBufferSync(r,e){if(!r.autoManage)return{size:0,syncFunc:uboUpdate};var{uboElements:i,size:e}=createUBOElements(getUBOData(r.uniforms,e)),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let e=0;e<i.length;e++){var a,s,o=i[e],l=r.uniforms[o.data.name],u=o.data.name;let t=!1;for(let e=0;e<uniformParsers.length;e++){var c=uniformParsers[e];if(c.codeUbo&&c.test(o.data,l)){n.push(`offset = ${o.offset/4};`,uniformParsers[e].codeUbo(o.data.name,l)),t=!0;break}}t||(1<o.data.size?(a=mapSize(o.data.type),s=Math.max(GLSL_TO_STD40_SIZE[o.data.type]/16,1),n.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${o.offset/4};

                t = 0;

                for(var i=0; i < ${o.data.size*s}; i++)
                {
                    for(var j = 0; j < ${a=a/s}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${(4-a%4)%4};
                }

                `)):(s=UBO_TO_SINGLE_SETTERS[o.data.type],n.push(`
                cv = ud.${u}.value;
                v = uv.${u};
                offset = ${o.offset/4};
                ${s};
                `)))}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:e,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let UID=0,defaultSyncData={textureCount:0,uboCount:0};class ShaderSystem{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=UID++}systemCheck(){if(!unsafeEvalSupported())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),t||(defaultSyncData.textureCount=0,defaultSyncData.uboCount=0,this.syncUniformGroup(e.uniformGroup,defaultSyncData)),i}setUniforms(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)}syncUniformGroup(e,t){var r=this.getGlProgram();e.static&&e.dirtyId===r.uniformDirtyGroups[e.id]||(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))}syncUniforms(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){var t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=generateUniformsSync(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){var r,i=this.getGlProgram();e.static&&0===e.dirtyId&&i.uniformGroups[e.id]||(e.dirtyId=0,r=i.uniformGroups[e.id]||this.createSyncBufferGroup(e,i,t),e.buffer.update(),r(i.uniformData,e.uniforms,this.renderer,defaultSyncData,e.buffer)),this.renderer.buffer.bindBufferBase(e.buffer,i.uniformBufferBindings[t])}createSyncBufferGroup(e,t,r){var i=this.renderer.gl,n=(this.renderer.buffer.bind(e.buffer),this.gl.getUniformBlockIndex(t.program,r)),r=(t.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(t.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++,this.getSignature(e,this.shader.program.uniformData,"ubo"));let a=this._uboCache[r];return a=a||(this._uboCache[r]=generateUniformBufferSync(e,this.shader.program.uniformData)),e.autoManage&&(i=new Float32Array(a.size/4),e.buffer.update(i)),t.uniformGroups[e.id]=a.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,r){var i,n=[r+"-"];for(i in e.uniforms)n.push(i),t[i]&&n.push(t[i].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){var t=this.gl,e=e.program,t=generateProgram(t,e);return e.glPrograms[this.renderer.CONTEXT_UID]=t}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ShaderSystem.extension={type:ExtensionType.RendererSystem,name:"shader"},extensions$1.add(ShaderSystem);class StartupSystem{constructor(e){this.renderer=e}run(e){var t=this.renderer;t.runners.init.emit(t.options),e.hello,t.resize(t.screen.width,t.screen.height)}destroy(){}}function mapWebGLBlendModesToPixi(e,t=[]){return t[BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.ADD]=[e.ONE,e.ONE],t[BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.NONE]=[0,0],t[BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[BLEND_MODES.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[BLEND_MODES.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[BLEND_MODES.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[BLEND_MODES.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[BLEND_MODES.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[BLEND_MODES.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}StartupSystem.defaultOptions={hello:!1},StartupSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"startup"},extensions$1.add(StartupSystem);let BLEND=0,OFFSET=1,CULLING=2,DEPTH_TEST=3,WINDING=4,DEPTH_MASK=5,_StateSystem=class _StateSystem2{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=BLEND_MODES.NONE,this._blendEq=!1,this.map=[],this.map[BLEND]=this.setBlend,this.map[OFFSET]=this.setOffset,this.map[CULLING]=this.setCullFace,this.map[DEPTH_TEST]=this.setDepthTest,this.map[WINDING]=this.setFrontFace,this.map[DEPTH_MASK]=this.setDepthMask,this.checks=[],this.defaultState=new State,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=mapWebGLBlendModesToPixi(e),this.set(this.defaultState),this.reset()}set(r){if(r=r||this.defaultState,this.stateId!==r.data){let e=this.stateId^r.data,t=0;for(;e;)1&e&&this.map[t].call(this,!!(r.data&1<<t)),e>>=1,t++;this.stateId=r.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,r)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(e){this.updateCheck(_StateSystem2.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)}setOffset(e){this.updateCheck(_StateSystem2.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){var t;e!==this.blendMode&&(this.blendMode=e,e=this.blendModes[e],t=this.gl,2===e.length?t.blendFunc(e[0],e[1]):t.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,t.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD)))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}},StateSystem=(_StateSystem.extension={type:ExtensionType.RendererSystem,name:"state"},_StateSystem);extensions$1.add(StateSystem);class SystemManager extends EventEmitter$2{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);let r=(t.priority??[]).filter(e=>t.systems[e]),e=[...r,...Object.keys(t.systems).filter(e=>!r.includes(e))];for(var i of e)this.addSystem(t.systems[i],i)}addRunners(...e){e.forEach(e=>{this.runners[e]=new Runner(e)})}addSystem(e,t){var r,i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);for(r in this[t]=i,this._systemsHash[t]=i,this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(r,i){let n=Object.keys(this._systemsHash);r.items.forEach(t=>{var e=n.find(e=>this._systemsHash[e]===t);t[r.name](i[e])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}let _TextureGCSystem=class _TextureGCSystem2{constructor(e){this.renderer=e,this.count=0,this.checkCount=0,this.maxIdle=_TextureGCSystem2.defaultMaxIdle,this.checkCountMax=_TextureGCSystem2.defaultCheckCountMax,this.mode=_TextureGCSystem2.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==GC_MODES.MANUAL)&&(this.checkCount++,this.checkCount>this.checkCountMax)&&(this.checkCount=0,this.run())}run(){var t=this.renderer.texture,r=t.managedTextures;let i=!1;for(let e=0;e<r.length;e++){var n=r[e];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),r[e]=null,i=!0)}if(i){let t=0;for(let e=0;e<r.length;e++)null!==r[e]&&(r[t++]=r[e]);r.length=t}}unload(t){var e=this.renderer.texture,r=t._texture;r&&!r.framebuffer&&e.destroyTexture(r);for(let e=t.children.length-1;0<=e;e--)this.unload(t.children[e])}destroy(){this.renderer=null}},TextureGCSystem=(_TextureGCSystem.defaultMode=GC_MODES.AUTO,_TextureGCSystem.defaultMaxIdle=3600,_TextureGCSystem.defaultCheckCountMax=600,_TextureGCSystem.extension={type:ExtensionType.RendererSystem,name:"textureGC"},_TextureGCSystem);extensions$1.add(TextureGCSystem);class GLTexture{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=TYPES.UNSIGNED_BYTE,this.internalFormat=FORMATS.RGBA,this.samplerType=0}}function mapInternalFormatToSamplerType(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[e.RGB]:SAMPLER_TYPES.FLOAT,[e.RGBA]:SAMPLER_TYPES.FLOAT,[e.ALPHA]:SAMPLER_TYPES.FLOAT,[e.LUMINANCE]:SAMPLER_TYPES.FLOAT,[e.LUMINANCE_ALPHA]:SAMPLER_TYPES.FLOAT,[e.R8]:SAMPLER_TYPES.FLOAT,[e.R8_SNORM]:SAMPLER_TYPES.FLOAT,[e.RG8]:SAMPLER_TYPES.FLOAT,[e.RG8_SNORM]:SAMPLER_TYPES.FLOAT,[e.RGB8]:SAMPLER_TYPES.FLOAT,[e.RGB8_SNORM]:SAMPLER_TYPES.FLOAT,[e.RGB565]:SAMPLER_TYPES.FLOAT,[e.RGBA4]:SAMPLER_TYPES.FLOAT,[e.RGB5_A1]:SAMPLER_TYPES.FLOAT,[e.RGBA8]:SAMPLER_TYPES.FLOAT,[e.RGBA8_SNORM]:SAMPLER_TYPES.FLOAT,[e.RGB10_A2]:SAMPLER_TYPES.FLOAT,[e.RGB10_A2UI]:SAMPLER_TYPES.FLOAT,[e.SRGB8]:SAMPLER_TYPES.FLOAT,[e.SRGB8_ALPHA8]:SAMPLER_TYPES.FLOAT,[e.R16F]:SAMPLER_TYPES.FLOAT,[e.RG16F]:SAMPLER_TYPES.FLOAT,[e.RGB16F]:SAMPLER_TYPES.FLOAT,[e.RGBA16F]:SAMPLER_TYPES.FLOAT,[e.R32F]:SAMPLER_TYPES.FLOAT,[e.RG32F]:SAMPLER_TYPES.FLOAT,[e.RGB32F]:SAMPLER_TYPES.FLOAT,[e.RGBA32F]:SAMPLER_TYPES.FLOAT,[e.R11F_G11F_B10F]:SAMPLER_TYPES.FLOAT,[e.RGB9_E5]:SAMPLER_TYPES.FLOAT,[e.R8I]:SAMPLER_TYPES.INT,[e.R8UI]:SAMPLER_TYPES.UINT,[e.R16I]:SAMPLER_TYPES.INT,[e.R16UI]:SAMPLER_TYPES.UINT,[e.R32I]:SAMPLER_TYPES.INT,[e.R32UI]:SAMPLER_TYPES.UINT,[e.RG8I]:SAMPLER_TYPES.INT,[e.RG8UI]:SAMPLER_TYPES.UINT,[e.RG16I]:SAMPLER_TYPES.INT,[e.RG16UI]:SAMPLER_TYPES.UINT,[e.RG32I]:SAMPLER_TYPES.INT,[e.RG32UI]:SAMPLER_TYPES.UINT,[e.RGB8I]:SAMPLER_TYPES.INT,[e.RGB8UI]:SAMPLER_TYPES.UINT,[e.RGB16I]:SAMPLER_TYPES.INT,[e.RGB16UI]:SAMPLER_TYPES.UINT,[e.RGB32I]:SAMPLER_TYPES.INT,[e.RGB32UI]:SAMPLER_TYPES.UINT,[e.RGBA8I]:SAMPLER_TYPES.INT,[e.RGBA8UI]:SAMPLER_TYPES.UINT,[e.RGBA16I]:SAMPLER_TYPES.INT,[e.RGBA16UI]:SAMPLER_TYPES.UINT,[e.RGBA32I]:SAMPLER_TYPES.INT,[e.RGBA32UI]:SAMPLER_TYPES.UINT,[e.DEPTH_COMPONENT16]:SAMPLER_TYPES.FLOAT,[e.DEPTH_COMPONENT24]:SAMPLER_TYPES.FLOAT,[e.DEPTH_COMPONENT32F]:SAMPLER_TYPES.FLOAT,[e.DEPTH_STENCIL]:SAMPLER_TYPES.FLOAT,[e.DEPTH24_STENCIL8]:SAMPLER_TYPES.FLOAT,[e.DEPTH32F_STENCIL8]:SAMPLER_TYPES.FLOAT}:{[e.RGB]:SAMPLER_TYPES.FLOAT,[e.RGBA]:SAMPLER_TYPES.FLOAT,[e.ALPHA]:SAMPLER_TYPES.FLOAT,[e.LUMINANCE]:SAMPLER_TYPES.FLOAT,[e.LUMINANCE_ALPHA]:SAMPLER_TYPES.FLOAT,[e.DEPTH_STENCIL]:SAMPLER_TYPES.FLOAT}}function mapTypeAndFormatToInternalFormat(e){let t;return t="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:e.RGBA8,[FORMATS.RGB]:e.RGB8,[FORMATS.RG]:e.RG8,[FORMATS.RED]:e.R8,[FORMATS.RGBA_INTEGER]:e.RGBA8UI,[FORMATS.RGB_INTEGER]:e.RGB8UI,[FORMATS.RG_INTEGER]:e.RG8UI,[FORMATS.RED_INTEGER]:e.R8UI,[FORMATS.ALPHA]:e.ALPHA,[FORMATS.LUMINANCE]:e.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[TYPES.BYTE]:{[FORMATS.RGBA]:e.RGBA8_SNORM,[FORMATS.RGB]:e.RGB8_SNORM,[FORMATS.RG]:e.RG8_SNORM,[FORMATS.RED]:e.R8_SNORM,[FORMATS.RGBA_INTEGER]:e.RGBA8I,[FORMATS.RGB_INTEGER]:e.RGB8I,[FORMATS.RG_INTEGER]:e.RG8I,[FORMATS.RED_INTEGER]:e.R8I},[TYPES.UNSIGNED_SHORT]:{[FORMATS.RGBA_INTEGER]:e.RGBA16UI,[FORMATS.RGB_INTEGER]:e.RGB16UI,[FORMATS.RG_INTEGER]:e.RG16UI,[FORMATS.RED_INTEGER]:e.R16UI,[FORMATS.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[TYPES.SHORT]:{[FORMATS.RGBA_INTEGER]:e.RGBA16I,[FORMATS.RGB_INTEGER]:e.RGB16I,[FORMATS.RG_INTEGER]:e.RG16I,[FORMATS.RED_INTEGER]:e.R16I},[TYPES.UNSIGNED_INT]:{[FORMATS.RGBA_INTEGER]:e.RGBA32UI,[FORMATS.RGB_INTEGER]:e.RGB32UI,[FORMATS.RG_INTEGER]:e.RG32UI,[FORMATS.RED_INTEGER]:e.R32UI,[FORMATS.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[TYPES.INT]:{[FORMATS.RGBA_INTEGER]:e.RGBA32I,[FORMATS.RGB_INTEGER]:e.RGB32I,[FORMATS.RG_INTEGER]:e.RG32I,[FORMATS.RED_INTEGER]:e.R32I},[TYPES.FLOAT]:{[FORMATS.RGBA]:e.RGBA32F,[FORMATS.RGB]:e.RGB32F,[FORMATS.RG]:e.RG32F,[FORMATS.RED]:e.R32F,[FORMATS.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[TYPES.HALF_FLOAT]:{[FORMATS.RGBA]:e.RGBA16F,[FORMATS.RGB]:e.RGB16F,[FORMATS.RG]:e.RG16F,[FORMATS.RED]:e.R16F},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:e.RGB565},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:e.RGBA4},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:e.RGB5_A1},[TYPES.UNSIGNED_INT_2_10_10_10_REV]:{[FORMATS.RGBA]:e.RGB10_A2,[FORMATS.RGBA_INTEGER]:e.RGB10_A2UI},[TYPES.UNSIGNED_INT_10F_11F_11F_REV]:{[FORMATS.RGB]:e.R11F_G11F_B10F},[TYPES.UNSIGNED_INT_5_9_9_9_REV]:{[FORMATS.RGB]:e.RGB9_E5},[TYPES.UNSIGNED_INT_24_8]:{[FORMATS.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[TYPES.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[FORMATS.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:{[TYPES.UNSIGNED_BYTE]:{[FORMATS.RGBA]:e.RGBA,[FORMATS.RGB]:e.RGB,[FORMATS.ALPHA]:e.ALPHA,[FORMATS.LUMINANCE]:e.LUMINANCE,[FORMATS.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[TYPES.UNSIGNED_SHORT_5_6_5]:{[FORMATS.RGB]:e.RGB},[TYPES.UNSIGNED_SHORT_4_4_4_4]:{[FORMATS.RGBA]:e.RGBA},[TYPES.UNSIGNED_SHORT_5_5_5_1]:{[FORMATS.RGBA]:e.RGBA}}}class TextureSystem{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new BaseTexture,this.hasIntegerTextures=!1}contextChange(){var t=this.gl=this.renderer.gl,r=(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=mapTypeAndFormatToInternalFormat(t),this.samplerTypes=mapInternalFormatToSamplerType(t),t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS));this.boundTextures.length=r;for(let e=0;e<r;e++)this.boundTextures[e]=null;this.emptyTextures={};var e=new GLTexture(t.createTexture());t.bindTexture(t.TEXTURE_2D,e.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=e,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new GLTexture(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let e=0;e<6;e++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let e=0;e<this.boundTextures.length;e++)this.bind(null,e)}bind(e,t=0){var r,i=this.gl;null!=(e=null==e?void 0:e.castToBaseTexture())&&e.valid&&!e.parentTextureArray?(e.touched=this.renderer.textureGC.count,r=e._glTextures[this.CONTEXT_UID]||this.initTexture(e),this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(e.target,r.texture)),r.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),this.updateTexture(e)):r.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e):(this.currentLocation!==t&&(this.currentLocation=t,i.activeTexture(i.TEXTURE0+t)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[t]=null)}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(t){var{gl:r,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let e=0;e<i.length;e++)i[e]===this.unknownTexture&&this.bind(null,e)}for(let e=0;e<i.length;e++)i[e]===t&&(this.currentLocation!==e&&(r.activeTexture(r.TEXTURE0+e),this.currentLocation=e),r.bindTexture(t.target,this.emptyTextures[t.target].texture),i[e]=null)}ensureSamplerType(t){var{boundTextures:r,hasIntegerTextures:e,CONTEXT_UID:i}=this;if(e)for(let e=t-1;0<=e;--e){var n=r[e];n&&n._glTextures[i].samplerType!==SAMPLER_TYPES.FLOAT&&this.renderer.texture.unbind(n)}}initTexture(e){var t=new GLTexture(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){var r;t.internalFormat=(null==(r=this.internalFormats[e.type])?void 0:r[e.format])??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??SAMPLER_TYPES.FLOAT,2===this.webGLVersion&&e.type===TYPES.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){var t,r,i,n=e._glTextures[this.CONTEXT_UID];n&&(i=this.renderer,this.initTextureType(e,n),null!=(t=e.resource)&&t.upload(i,e,n)?n.samplerType!==SAMPLER_TYPES.FLOAT&&(this.hasIntegerTextures=!0):(t=e.realWidth,r=e.realHeight,i=i.gl,(n.width!==t||n.height!==r||n.dirtyId<0)&&(n.width=t,n.height=r,i.texImage2D(e.target,0,n.internalFormat,t,r,0,e.format,n.type,null))),e.dirtyStyleId!==n.dirtyStyleId&&this.updateTextureStyle(e),n.dirtyId=e.dirtyId)}destroyTexture(e,t){var r=this.gl;(e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)&&-1!==(r=this.managedTextures.indexOf(e))&&removeItems(this.managedTextures,r,1)}updateTextureStyle(e){var t,r=e._glTextures[this.CONTEXT_UID];r&&(e.mipmap!==MIPMAP_MODES.POW2&&2===this.webGLVersion||e.isPowerOfTwo?r.mipmap=1<=e.mipmap:r.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?r.wrapMode=e.wrapMode:r.wrapMode=WRAP_MODES.CLAMP,null!=(t=e.resource)&&t.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){var r,i=this.gl;t.mipmap&&e.mipmap!==MIPMAP_MODES.ON_MANUAL&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,t.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,t.wrapMode),t.mipmap?(i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST),(t=this.renderer.context.extensions.anisotropicFiltering)&&0<e.anisotropicLevel&&e.scaleMode===SCALE_MODES.LINEAR&&(r=Math.min(e.anisotropicLevel,i.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),i.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY_EXT,r))):i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST),i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}TextureSystem.extension={type:ExtensionType.RendererSystem,name:"texture"},extensions$1.add(TextureSystem);class TransformFeedbackSystem{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){var{gl:t,CONTEXT_UID:r}=this,r=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,r)}unbind(){var e=this.gl;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){var{gl:r,renderer:i}=this;t&&i.shader.bind(t),r.beginTransformFeedback(e)}endTransformFeedback(){var e=this.gl;e.endTransformFeedback()}createGLTransformFeedback(t){var{gl:r,renderer:i,CONTEXT_UID:n}=this,e=r.createTransformFeedback();t._glTransformFeedbacks[n]=e,r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,e);for(let e=0;e<t.buffers.length;e++){var a=t.buffers[e];a&&(i.buffer.update(a),a._glBuffers[n].refCount++,r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,e,a._glBuffers[n].buffer||null))}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),e}disposeTransformFeedback(t,r){var e=t._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl,n=(t.disposeRunner.remove(this),this.renderer.buffer);if(n)for(let e=0;e<t.buffers.length;e++){var a,s=t.buffers[e];s&&(a=s._glBuffers[this.CONTEXT_UID])&&(a.refCount--,0===a.refCount)&&!r&&n.dispose(s,r)}e&&(r||i.deleteTransformFeedback(e),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}TransformFeedbackSystem.extension={type:ExtensionType.RendererSystem,name:"transformFeedback"},extensions$1.add(TransformFeedbackSystem);class ViewSystem{constructor(e){this.renderer=e}init(e){this.screen=new Rectangle(0,0,e.width,e.height),this.element=e.view||settings.ADAPTER.createCanvas(),this.resolution=e.resolution||settings.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);e=this.element.width/this.resolution,t=this.element.height/this.resolution;this.screen.width=e,this.screen.height=t,this.autoDensity&&(this.element.style.width=e+"px",this.element.style.height=t+"px"),this.renderer.emit("resize",e,t),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&null!=(e=this.element.parentNode)&&e.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}ViewSystem.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ViewSystem.extension={type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem],name:"_view"},extensions$1.add(ViewSystem),settings.PREFER_ENV=ENV.WEBGL2,settings.STRICT_TEXTURE_CACHE=!1,settings.RENDER_OPTIONS={...ContextSystem.defaultOptions,...BackgroundSystem.defaultOptions,...ViewSystem.defaultOptions,...StartupSystem.defaultOptions},Object.defineProperties(settings,{WRAP_MODE:{get(){return BaseTexture.defaultOptions.wrapMode},set(e){deprecation("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),BaseTexture.defaultOptions.wrapMode=e}},SCALE_MODE:{get(){return BaseTexture.defaultOptions.scaleMode},set(e){deprecation("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),BaseTexture.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get(){return BaseTexture.defaultOptions.mipmap},set(e){deprecation("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),BaseTexture.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get(){return BaseTexture.defaultOptions.anisotropicLevel},set(e){deprecation("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),BaseTexture.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get(){return deprecation("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Filter.defaultResolution},set(e){Filter.defaultResolution=e}},FILTER_MULTISAMPLE:{get(){return deprecation("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Filter.defaultMultisample},set(e){Filter.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get(){return BatchRenderer.defaultMaxTextures},set(e){deprecation("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),BatchRenderer.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get(){return BatchRenderer.defaultBatchSize},set(e){deprecation("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),BatchRenderer.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get(){return BatchRenderer.canUploadSameBuffer},set(e){deprecation("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),BatchRenderer.canUploadSameBuffer=e}},GC_MODE:{get(){return TextureGCSystem.defaultMode},set(e){deprecation("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),TextureGCSystem.defaultMode=e}},GC_MAX_IDLE:{get(){return TextureGCSystem.defaultMaxIdle},set(e){deprecation("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),TextureGCSystem.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get(){return TextureGCSystem.defaultCheckCountMax},set(e){deprecation("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),TextureGCSystem.defaultCheckCountMax=e}},PRECISION_VERTEX:{get(){return Program.defaultVertexPrecision},set(e){deprecation("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Program.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get(){return Program.defaultFragmentPrecision},set(e){deprecation("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Program.defaultFragmentPrecision=e}}});var UPDATE_PRIORITY=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(UPDATE_PRIORITY||{});class TickerListener{constructor(e,t=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=i}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(e){(this.previous=e).next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t}}let _Ticker=class _Ticker2{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new TickerListener(null,null,1/0),this.deltaMS=1/_Ticker2.targetFPMS,this.elapsedMS=1/_Ticker2.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started)&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(e,t,r))}addOnce(e,t,r=UPDATE_PRIORITY.NORMAL){return this._addListener(new TickerListener(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}t=(r=t).next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let r;if(t>this.lastTime){if((r=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*_Ticker2.targetFPMS;i=this._head;let e=i.next;for(;e;)e=e.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){e=Math.min(this.maxFPS,e),e=Math.min(Math.max(0,e)/1e3,_Ticker2.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){0===e?this._minElapsedMS=0:(e=Math.max(this.minFPS,e),this._minElapsedMS=1/(e/1e3))}static get shared(){var e;return _Ticker2._shared||((e=_Ticker2._shared=new _Ticker2).autoStart=!0,e._protected=!0),_Ticker2._shared}static get system(){var e;return _Ticker2._system||((e=_Ticker2._system=new _Ticker2).autoStart=!0,e._protected=!0),_Ticker2._system}},Ticker=(_Ticker.targetFPMS=.06,_Ticker);Object.defineProperties(settings,{TARGET_FPMS:{get(){return Ticker.targetFPMS},set(e){deprecation("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ticker.targetFPMS=e}}});class TickerPlugin{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),(this._ticker=e)&&e.add(this.render,this,UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ticker.shared:new Ticker,e.autoStart&&this.start()}static destroy(){var e;this._ticker&&(e=this._ticker,this.ticker=null,e.destroy())}}TickerPlugin.extension=ExtensionType.Application,extensions$1.add(TickerPlugin);let renderers=[];function autoDetectRenderer(e){for(var t of renderers)if(t.test(e))return new t(e);throw new Error("Unable to auto-detect a suitable renderer.")}extensions$1.handleByList(ExtensionType.Renderer,renderers);var $defaultVertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,$defaultFilterVertex=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;let defaultVertex=$defaultVertex,defaultFilterVertex=$defaultFilterVertex;class MultisampleSystem{constructor(e){this.renderer=e}contextChange(e){let t;var r;1===this.renderer.context.webGLVersion?(r=e.getParameter(e.FRAMEBUFFER_BINDING),e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)):(r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)),t>=MSAA_QUALITY.HIGH?this.multisample=MSAA_QUALITY.HIGH:t>=MSAA_QUALITY.MEDIUM?this.multisample=MSAA_QUALITY.MEDIUM:t>=MSAA_QUALITY.LOW?this.multisample=MSAA_QUALITY.LOW:this.multisample=MSAA_QUALITY.NONE}destroy(){}}MultisampleSystem.extension={type:ExtensionType.RendererSystem,name:"_multisample"},extensions$1.add(MultisampleSystem);class GLBuffer{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class BufferSystem{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){var{gl:t,CONTEXT_UID:r}=this,r=e._glBuffers[r]||this.createGLBuffer(e);t.bindBuffer(e.type,r.buffer)}unbind(e){var t=this.gl;t.bindBuffer(e,null)}bindBufferBase(e,t){var{gl:r,CONTEXT_UID:i}=this;this.boundBufferBases[t]!==e&&(i=e._glBuffers[i]||this.createGLBuffer(e),this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,i.buffer))}bindBufferRange(e,t,r){var{gl:i,CONTEXT_UID:n}=this,n=(r=r||0,e._glBuffers[n]||this.createGLBuffer(e));i.bindBufferRange(i.UNIFORM_BUFFER,t||0,n.buffer,256*r,256)}update(e){var t,{gl:r,CONTEXT_UID:i}=this,i=e._glBuffers[i]||this.createGLBuffer(e);e._updateID!==i.updateID&&(i.updateID=e._updateID,r.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength?r.bufferSubData(e.type,0,e.data):(t=e.static?r.STATIC_DRAW:r.DYNAMIC_DRAW,i.byteLength=e.data.byteLength,r.bufferData(e.type,e.data,t)))}dispose(e,t){var r,i;this.managedBuffers[e.id]&&(delete this.managedBuffers[e.id],r=e._glBuffers[this.CONTEXT_UID],i=this.gl,e.disposeRunner.remove(this),r)&&(t||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(t){var r=Object.keys(this.managedBuffers);for(let e=0;e<r.length;e++)this.dispose(this.managedBuffers[r[e]],t)}createGLBuffer(e){var{CONTEXT_UID:t,gl:r}=this;return e._glBuffers[t]=new GLBuffer(r.createBuffer()),(this.managedBuffers[e.id]=e).disposeRunner.add(this),e._glBuffers[t]}}BufferSystem.extension={type:ExtensionType.RendererSystem,name:"buffer"},extensions$1.add(BufferSystem);class ObjectRendererSystem{constructor(e){this.renderer=e}render(e,t){var r,i=this.renderer;let n,a,s,o;t&&(n=t.renderTexture,a=t.clear,s=t.transform,o=t.skipUpdateTransform),this.renderingToScreen=!n,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=s,i.context.isLost||(n||(this.lastObjectRendered=e),o||(r=e.enableTempParent(),e.updateTransform(),e.disableTempParent(r)),i.renderTexture.bind(n),i.batch.currentRenderer.start(),(a??i.background.clearBeforeRender)&&i.renderTexture.clear(),e.render(i),i.batch.currentRenderer.flush(),n&&(t.blit&&i.framebuffer.blit(),n.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender"))}destroy(){this.renderer=null,this.lastObjectRendered=null}}ObjectRendererSystem.extension={type:ExtensionType.RendererSystem,name:"objectRenderer"},extensions$1.add(ObjectRendererSystem);let _Renderer=class _Renderer2 extends SystemManager{constructor(e){super(),this.type=RENDERER_TYPE.WEBGL,e=Object.assign({},settings.RENDER_OPTIONS,e),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new UniformGroup({projectionMatrix:new Matrix},!0);var t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:_Renderer2.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in e&&(deprecation("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),e.premultipliedAlpha=e.useContextAlpha&&"notMultiplied"!==e.useContextAlpha,e.backgroundAlpha=!1===e.useContextAlpha?1:e.backgroundAlpha),this._plugin.rendererPlugins=_Renderer2.__plugins,this.options=e,this.startup.run(this.options)}static test(e){return(null==e||!e.forceCanvas)&&isWebGLSupported()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return"WebGL "+this.context.webGLVersion}get clearBeforeRender(){return deprecation("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return deprecation("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return deprecation("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){deprecation("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){deprecation("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return deprecation("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}},Renderer=(_Renderer.extension={type:ExtensionType.Renderer,priority:1},_Renderer.__plugins={},_Renderer.__systems={},_Renderer);extensions$1.handleByMap(ExtensionType.RendererPlugin,Renderer.__plugins),extensions$1.handleByMap(ExtensionType.RendererSystem,Renderer.__systems),extensions$1.add(Renderer);class AbstractMultiResource extends Resource{constructor(t,e){var{width:e,height:r}=e||{};super(e,r),this.items=[],this.itemDirtyIds=[];for(let e=0;e<t;e++){var i=new BaseTexture;this.items.push(i),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,r){for(let e=0;e<this.length;e++)t[e]&&(t[e].castToBaseTexture?this.addBaseTextureAt(t[e].castToBaseTexture(),e):t[e]instanceof Resource?this.addResourceAt(t[e],e):this.addResourceAt(autoDetectResource(t[e],r),e))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(this.items[t])return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this;throw new Error(`Index ${t} is out of bounds`)}bind(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){var e;return this._load||(e=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load()),this._load=Promise.all(e).then(()=>{var{realWidth:e,realHeight:t}=this.items[0];return this.resize(e,t),this.update(),Promise.resolve(this)})),this._load}}class ArrayResource extends AbstractMultiResource{constructor(e,t){var{width:r,height:i}=t||{};let n,a;super(a=Array.isArray(e)?(n=e).length:e,{width:r,height:i}),n&&this.initFromArray(n,t)}addBaseTextureAt(e,t){if(e.resource)return this.addResourceAt(e.resource,t),this;throw new Error("ArrayResource does not support RenderTexture")}bind(e){super.bind(e),e.target=TARGETS.TEXTURE_2D_ARRAY}upload(e,t,r){var{length:i,itemDirtyIds:n,items:a}=this,s=e.gl;r.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,t.format,r.type,null);for(let e=0;e<i;e++){var o=a[e];n[e]<o.dirtyId&&(n[e]=o.dirtyId,o.valid)&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,e,o.resource.width,o.resource.height,1,t.format,r.type,o.resource.source)}return!0}}class CanvasResource extends BaseImageResource{constructor(e){super(e)}static test(e){var t=globalThis.OffscreenCanvas;return!!(t&&e instanceof t)||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}}let _CubeResource=class _CubeResource2 extends AbstractMultiResource{constructor(e,t){var{width:r,height:i,autoLoad:n,linkBaseTexture:a}=t||{};if(e&&e.length!==_CubeResource2.SIDES)throw new Error(`Invalid length. Got ${e.length}, expected 6`);super(6,{width:r,height:i});for(let e=0;e<_CubeResource2.SIDES;e++)this.items[e].target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+e;this.linkBaseTexture=!1!==a,e&&this.initFromArray(e,t),!1!==n&&this.load()}bind(e){super.bind(e),e.target=TARGETS.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||0<Object.keys(e._glTextures).length){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(t,r,i){var n=this.itemDirtyIds;for(let e=0;e<_CubeResource2.SIDES;e++){var a=this.items[e];(n[e]<a.dirtyId||i.dirtyId<r.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(t,a,i),n[e]=a.dirtyId):n[e]<-1&&(t.gl.texImage2D(a.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),n[e]=-1))}return!0}static test(e){return Array.isArray(e)&&e.length===_CubeResource2.SIDES}},CubeResource=(_CubeResource.SIDES=6,_CubeResource);class ImageBitmapResource extends BaseImageResource{constructor(e,t){t=t||{};let r,i,n;n="string"==typeof e?(r=ImageBitmapResource.EMPTY,i=e,!0):(r=e,i=null,!1),super(r),this.url=i,this.crossOrigin=t.crossOrigin??!0,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??n,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(async(e,t)=>{if(null===this.url)e(this);else try{var r,i,n=await settings.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});this.destroyed||(r=await n.blob(),this.destroyed)||(i=await createImageBitmap(r,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===ALPHA_MODES.UNPACK?"premultiply":"none"}),this.destroyed?i.close():(this.source=i,this.update(),e(this)))}catch(e){this.destroyed||(t(e),this.onError.emit(e))}}),this._load)}upload(e,t,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),super.upload(e,t,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&("string"==typeof e||e instanceof ImageBitmap)}static get EMPTY(){return ImageBitmapResource._EMPTY=ImageBitmapResource._EMPTY??settings.ADAPTER.createCanvas(0,0),ImageBitmapResource._EMPTY}}let _SVGResource=class _SVGResource2 extends BaseImageResource{constructor(e,t){t=t||{},super(settings.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(e=>{if(this._resolve=()=>{this.update(),e(this)},_SVGResource2.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this.svg)))}this._loadSvg()}),this._load)}_loadSvg(){let a=new Image;BaseImageResource.crossOrigin(a,this.svg,this._crossorigin),a.src=this.svg,a.onerror=e=>{this._resolve&&(a.onerror=null,this.onError.emit(e))},a.onload=()=>{if(this._resolve){var r=a.width,i=a.height;if(!r||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let e=r*this.scale,t=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(e=this._overrideWidth||this._overrideHeight/i*r,t=this._overrideHeight||this._overrideWidth/r*i),e=Math.round(e),t=Math.round(t);var n=this.source;n.width=e,n.height=t,n._pixiId="canvas_"+uid(),n.getContext("2d").drawImage(a,0,0,r,i,0,0,e,t),this._resolve(),this._resolve=null}}}static getSize(e){var e=_SVGResource2.SVG_SIZE.exec(e),t={};return e&&(t[e[1]]=Math.round(parseFloat(e[3])),t[e[5]]=Math.round(parseFloat(e[7]))),t}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(e,t){return"svg"===t||"string"==typeof e&&e.startsWith("data:image/svg+xml")||"string"==typeof e&&_SVGResource2.SVG_XML.test(e)}},SVGResource=(_SVGResource.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,_SVGResource.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,_SVGResource);class VideoFrameResource extends BaseImageResource{constructor(e){super(e)}static test(e){return!!globalThis.VideoFrame&&e instanceof globalThis.VideoFrame}}let _VideoResource=class _VideoResource2 extends BaseImageResource{constructor(i,e){if(e=e||{},!(i instanceof HTMLVideoElement)){var n=document.createElement("video"),t=(!1!==e.autoLoad&&n.setAttribute("preload","auto"),!1!==e.playsinline&&(n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline","")),!0===e.muted&&(n.setAttribute("muted",""),n.muted=!0),!0===e.loop&&n.setAttribute("loop",""),!1!==e.autoPlay&&n.setAttribute("autoplay",""),(i="string"==typeof i?[i]:i)[0].src||i[0]);BaseImageResource.crossOrigin(n,t,e.crossorigin);for(let r=0;r<i.length;++r){var a,s=document.createElement("source");let{src:e,mime:t}=i[r];(e=e||i[r]).startsWith("data:")?t=e.slice(5,e.indexOf(";")):e.startsWith("blob:")||(a=(a=e.split("?").shift().toLowerCase()).slice(a.lastIndexOf(".")+1),t=t||_VideoResource2.MIME_TYPES[a]||"video/"+a),s.src=e,t&&(s.type=t),n.appendChild(s)}i=n}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==e.autoLoad&&this.load()}update(e=0){var t;!this.destroyed&&(this._updateFPS&&(t=Ticker.shared.elapsedMS*this.source.playbackRate,this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)),!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(!this._load){let r=this.source;(r.readyState===r.HAVE_ENOUGH_DATA||r.readyState===r.HAVE_FUTURE_DATA)&&r.width&&r.height&&(r.complete=!0),r.addEventListener("play",this._onPlayStart),r.addEventListener("pause",this._onPlayStop),r.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(r.addEventListener("canplay",this._onCanPlay),r.addEventListener("canplaythrough",this._onCanPlay),r.addEventListener("error",this._onError,!0)),this._load=new Promise((e,t)=>{this.valid?e(this):(this._resolve=e,this._reject=t,r.load())})}return this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){var e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return 2<this.source.readyState}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){var e=this.source,t=(e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),this.valid);this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();var e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e,t){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||_VideoResource2.TYPES.includes(t)}},VideoResource=(_VideoResource.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],_VideoResource.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},_VideoResource);INSTALLED.push(ImageBitmapResource,ImageResource,CanvasResource,VideoResource,VideoFrameResource,SVGResource,BufferResource,CubeResource,ArrayResource);class TransformFeedback{constructor(){this._glTransformFeedbacks={},this.buffers=[],this.disposeRunner=new Runner("disposeTransformFeedback")}bindBuffer(e,t){this.buffers[e]=t}destroy(){this.disposeRunner.emit(this,!1)}}let VERSION="7.4.0";class Bounds{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?Rectangle.EMPTY:((e=e||new Rectangle(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){var{a:e,b:r,c:i,d:n,tx:a,ty:s}=e,e=e*t.x+i*t.y+a,i=r*t.x+n*t.y+s;this.minX=Math.min(this.minX,e),this.maxX=Math.max(this.maxX,e),this.minY=Math.min(this.minY,i),this.maxY=Math.max(this.maxY,i)}addQuad(e){var t=this.minX,r=this.minY,i=this.maxX,n=this.maxY,a=e[0],s=e[1],t=a<t?a:t,r=s<r?s:r,i=i<a?a:i,n=n<s?s:n;t=(a=e[2])<t?a:t,r=(s=e[3])<r?s:r,i=i<a?a:i,n=n<s?s:n,t=(a=e[4])<t?a:t,r=(s=e[5])<r?s:r,n=n<s?s:n,r=(s=e[7])<r?s:r,i=(i=i<a?a:i)<(a=e[6])?a:i,n=n<s?s:n,this.minX=a<t?a:t,this.minY=r,this.maxX=i,this.maxY=n}addFrame(e,t,r,i,n){this.addFrameMatrix(e.worldTransform,t,r,i,n)}addFrameMatrix(e,t,r,i,n){var a=e.a,s=e.b,o=e.c,l=e.d,u=e.tx,e=e.ty,c=a*t+o*r+u,h=s*t+l*r+e,d=c<(d=this.minX)?c:d,p=h<(p=this.minY)?h:p,f=(f=this.maxX)<c?c:f,m=(m=this.maxY)<h?h:m;d=(c=a*i+o*r+u)<d?c:d,p=(h=s*i+l*r+e)<p?h:p,f=f<c?c:f,m=m<h?h:m,d=(c=a*t+o*n+u)<d?c:d,p=(h=s*t+l*n+e)<p?h:p,m=m<h?h:m,p=(h=s*i+l*n+e)<p?h:p,f=(f=f<c?c:f)<(c=a*i+o*n+u)?c:f,m=m<h?h:m,this.minX=c<d?c:d,this.minY=p,this.maxX=f,this.maxY=m}addVertexData(t,r,i){let n=this.minX,a=this.minY,s=this.maxX,o=this.maxY;for(let e=r;e<i;e+=2){var l=t[e],u=t[e+1];n=l<n?l:n,a=u<a?u:a,s=l>s?l:s,o=u>o?u:o}this.minX=n,this.minY=a,this.maxX=s,this.maxY=o}addVertices(e,t,r,i){this.addVerticesMatrix(e.worldTransform,t,r,i)}addVerticesMatrix(e,t,r,i,n=0,a=n){var s=e.a,o=e.b,l=e.c,u=e.d,c=e.tx,h=e.ty;let d=this.minX,p=this.minY,f=this.maxX,m=this.maxY;for(let e=r;e<i;e+=2){var g=t[e],v=t[e+1],y=s*g+l*v+c,v=u*v+o*g+h;d=Math.min(d,y-n),f=Math.max(f,y+n),p=Math.min(p,v-a),m=Math.max(m,v+a)}this.minX=d,this.minY=p,this.maxX=f,this.maxY=m}addBounds(e){var t=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=i<e.maxX?e.maxX:i,this.maxY=n<e.maxY?e.maxY:n}addBoundsMask(e,t){var r,i,n,a=(e.minX>t.minX?e:t).minX,s=(t.minY<e.minY?e:t).minY,o=(e.maxX<t.maxX?e:t).maxX,e=(e.maxY<t.maxY?e:t).maxY;a<=o&&s<=e&&(t=this.minX,r=this.minY,i=this.maxX,n=this.maxY,this.minX=a<t?a:t,this.minY=s<r?s:r,this.maxX=i<o?o:i,this.maxY=n<e?e:n)}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){var r,i,n,a=e.minX>t.x?e.minX:t.x,s=t.y<e.minY?e.minY:t.y,o=e.maxX<t.x+t.width?e.maxX:t.x+t.width,e=e.maxY<t.y+t.height?e.maxY:t.y+t.height;a<=o&&s<=e&&(t=this.minX,r=this.minY,i=this.maxX,n=this.maxY,this.minX=a<t?a:t,this.minY=s<r?s:r,this.maxX=i<o?o:i,this.maxY=n<e?e:n)}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,r,i,n,a){t-=a,r+=n,i+=a,this.minX=this.minX<(e-=n)?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>i?this.maxY:i}}class DisplayObject extends EventEmitter$2{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Transform,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Bounds,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){var r=Object.keys(t);for(let e=0;e<r.length;++e){var i=r[e];Object.defineProperty(DisplayObject.prototype,i,Object.getOwnPropertyDescriptor(t,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new Rectangle),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Bounds);var t=this.transform,r=this.parent,i=(this.parent=null,this._tempDisplayObjectParent.worldAlpha=(null==r?void 0:r.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform,this._bounds),n=this._boundsID,e=(this._bounds=this._localBounds,this.getBounds(!1,e));return this.parent=r,this.transform=t,this._bounds=i,this._bounds.updateID+=this._boundsID-n,e}toGlobal(e,t,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,r,i){return t&&(e=t.toGlobal(e,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)}setParent(e){if(e&&e.addChild)return e.addChild(this),e;throw new Error("setParent: Argument must be a Container")}removeFromParent(){var e;null!=(e=this.parent)&&e.removeChild(this)}setTransform(e=0,t=0,r=1,i=1,n=0,a=0,s=0,o=0,l=0){return this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=a,this.skew.y=s,this.pivot.x=o,this.pivot.y=l,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new TemporaryDisplayObject),this.tempDisplayObjectParent}enableTempParent(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*RAD_TO_DEG}set angle(e){this.transform.rotation=e*DEG_TO_RAD}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent)&&(this.parent.sortDirty=!0)}get worldVisible(){let e=this;do{if(!e.visible)return!1}while(e=e.parent);return!0}get mask(){return this._mask}set mask(e){var t;this._mask!==e&&(this._mask&&(t=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(t._maskRefCount--,0===t._maskRefCount)&&(t.renderable=!0,t.isMask=!1),this._mask=e,this._mask)&&(t=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(0===t._maskRefCount&&(t.renderable=!1,t.isMask=!0),t._maskRefCount++)}}class TemporaryDisplayObject extends DisplayObject{constructor(){super(...arguments),this.sortDirty=null}}DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform;let tempMatrix=new Matrix;function sortChildren(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}let _Container=class _Container2 extends DisplayObject{constructor(){super(),this.children=[],this.sortableChildren=_Container2.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...t){if(1<t.length)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{var e=t[0];e.parent&&e.parent.removeChild(e),(e.parent=this).sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(e+`addChildAt: The index ${t} supplied is out of bounds `+this.children.length);return e.parent&&e.parent.removeChild(e),(e.parent=this).sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){var r,i;e!==t&&(r=this.getChildIndex(e),i=this.getChildIndex(t),this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i))}getChildIndex(e){e=this.children.indexOf(e);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds `+this.children.length);var r=this.getChildIndex(e);removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...t){if(1<t.length)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{var e=t[0],r=this.children.indexOf(e);if(-1===r)return null;e.parent=null,e.transform._parentID=-1,removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),e.emit("removed",this),this.emit("childRemoved",e,this,r)}return t[0]}removeChildAt(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){var r,i=t-e;if(0<i&&i<=t){r=this.children.splice(e,i);for(let e=0;e<r.length;++e)r[e].parent=null,r[e].transform&&(r[e].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let e=0;e<r.length;++e)r[e].emit("removed",this),this.emit("childRemoved",r[e],this,e);return r}if(0==i&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let r=!1;for(let e=0,t=this.children.length;e<t;++e){var i=this.children[e];i._lastSortedIndex=e,r||0===i.zIndex||(r=!0)}r&&1<this.children.length&&this.children.sort(sortChildren),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){var r=this.children[e];r.visible&&r.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){var t,r=this.children[e];r.visible&&r.renderable&&(r.calculateBounds(),r._mask?(t=r._mask.isMaskData?r._mask.maskObject:r._mask)?(t.calculateBounds(),this._bounds.addBoundsMask(r._bounds,t._bounds)):this._bounds.addBounds(r._bounds):r.filterArea?this._bounds.addBoundsArea(r._bounds,r.filterArea):this._bounds.addBounds(r._bounds))}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){e=super.getLocalBounds(e);if(!t)for(let e=0,t=this.children.length;e<t;++e){var r=this.children[e];r.visible&&r.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(r){var i=r.renderTexture.sourceFrame;if(0<i.width&&0<i.height){let e,t;this.cullArea?(e=this.cullArea,t=this.worldTransform):this._render!==_Container2.prototype._render&&(e=this.getBounds(!0));var n=r.projection.transform;if(n&&(t?(t=tempMatrix.copyFrom(t)).prepend(n):t=n),e&&i.intersects(e,t))this._render(r);else if(this.cullArea)return;for(let e=0,t=this.children.length;e<t;++e){var a=this.children[e],s=a.cullable;a.cullable=s||!this.cullArea,a.render(r),a.cullable=s}}}render(r){var e;if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||null!=(e=this.filters)&&e.length)this.renderAdvanced(r);else if(this.cullable)this._renderWithCulling(r);else{this._render(r);for(let e=0,t=this.children.length;e<t;++e)this.children[e].render(r)}}renderAdvanced(r){var e,t=this.filters,i=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]);for(let e=this._enabledFilters.length=0;e<t.length;e++)t[e].enabled&&this._enabledFilters.push(t[e])}var n=t&&(null==(n=this._enabledFilters)?void 0:n.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==MASK_TYPES.NONE));if(n&&r.batch.flush(),t&&null!=(e=this._enabledFilters)&&e.length&&r.filter.push(this,this._enabledFilters),i&&r.mask.push(this,this._mask),this.cullable)this._renderWithCulling(r);else{this._render(r);for(let e=0,t=this.children.length;e<t;++e)this.children[e].render(r)}n&&r.batch.flush(),i&&r.mask.pop(this),t&&null!=(e=this._enabledFilters)&&e.length&&r.filter.pop()}_render(e){}destroy(t){super.destroy(),this.sortDirty=!1;var e="boolean"==typeof t?t:null==t?void 0:t.children,r=this.removeChildren(0,this.children.length);if(e)for(let e=0;e<r.length;++e)r[e].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}},Container=(_Container.defaultSortableChildren=!1,_Container),tempPoint$2=(Container.prototype.containerUpdateTransform=Container.prototype.updateTransform,Object.defineProperties(settings,{SORTABLE_CHILDREN:{get(){return Container.defaultSortableChildren},set(e){deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Container.defaultSortableChildren=e}}}),new Point),indices=new Uint16Array([0,1,2,0,2,3]);class Sprite extends Container{constructor(e){super(),this._anchor=new ObservablePoint(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Color(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=BLEND_MODES.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||Texture.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=indices,this.pluginName="batch",this.isSprite=!0,this._roundPixels=settings.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=sign$1(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=sign$1(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){var n=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==n._updateID){this._textureID!==n._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=n._updateID;var a=this.transform.worldTransform,s=a.a,o=a.b,l=a.c,u=a.d,c=a.tx,a=a.ty,h=this.vertexData,d=n.trim,n=n.orig,p=this._anchor;let e=0,t=0,r=0,i=0;if(r=d?(t=d.x-p._x*n.width,e=t+d.width,(i=d.y-p._y*n.height)+d.height):(t=-p._x*n.width,e=t+n.width,(i=-p._y*n.height)+n.height),h[0]=s*t+l*i+c,h[1]=u*i+o*t+a,h[2]=s*e+l*i+c,h[3]=u*i+o*e+a,h[4]=s*e+l*r+c,h[5]=u*r+o*e+a,h[6]=s*t+l*r+c,h[7]=u*r+o*t+a,this._roundPixels){var f=settings.RESOLUTION;for(let e=0;e<h.length;++e)h[e]=Math.round(h[e]*f)/f}}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,t=this.vertexTrimmedData,e=e.orig,r=this._anchor,i=this.transform.worldTransform,n=i.a,a=i.b,s=i.c,o=i.d,l=i.tx,i=i.ty,u=-r._x*e.width,c=u+e.width,r=-r._y*e.height,e=r+e.height;if(t[0]=n*u+s*r+l,t[1]=o*r+a*u+i,t[2]=n*c+s*r+l,t[3]=o*r+a*c+i,t[4]=n*c+s*e+l,t[5]=o*e+a*c+i,t[6]=n*u+s*e+l,t[7]=o*e+a*u+i,this._roundPixels){var h=settings.RESOLUTION;for(let e=0;e<t.length;++e)t[e]=Math.round(t[e]*h)/h}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){var e=this._texture.trim,t=this._texture.orig;!e||e.width===t.width&&e.height===t.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new Bounds),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,tempPoint$2);var e=this._texture.orig.width,t=this._texture.orig.height,r=-e*this.anchor.x;return tempPoint$2.x>=r&&tempPoint$2.x<r+e&&(r=-t*this.anchor.y,tempPoint$2.y>=r)&&tempPoint$2.y<r+t}destroy(e){super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,("boolean"==typeof e?e:null!=e&&e.texture)&&(e="boolean"==typeof e?e:null==e?void 0:e.baseTexture,this._texture.destroy(!!e)),this._texture=null}static from(e,t){e=e instanceof Texture?e:Texture.from(e,t);return new Sprite(e)}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){var t=sign$1(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){var t=sign$1(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e)&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this))}}let _tempMatrix=new Matrix;DisplayObject.prototype._cacheAsBitmap=!1,DisplayObject.prototype._cacheData=null,DisplayObject.prototype._cacheAsBitmapResolution=null,DisplayObject.prototype._cacheAsBitmapMultisample=null;class CacheData{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(DisplayObject.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap)&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0)}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap)&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0)}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(t){if(this._cacheAsBitmap!==t){let e;(this._cacheAsBitmap=t)?(this._cacheData||(this._cacheData=new CacheData),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea)}}}}),DisplayObject.prototype._renderCached=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},DisplayObject.prototype._initCachedDisplayObject=function(e){var t,r,i,n,a,s,o,l;null!=(t=this._cacheData)&&t.sprite||(t=this.alpha,this.alpha=1,e.batch.flush(),r=this.getLocalBounds(new Rectangle,!0),null!=(o=this.filters)&&o.length&&(o=this.filters[0].padding,r.pad(o)),o=this.cacheAsBitmapResolution||e.resolution,r.ceil(o),r.width=Math.max(r.width,1/o),r.height=Math.max(r.height,1/o),i=e.renderTexture.current,n=e.renderTexture.sourceFrame.clone(),a=e.renderTexture.destinationFrame.clone(),s=e.projection.transform,o=RenderTexture.create({width:r.width,height:r.height,resolution:o,multisample:this.cacheAsBitmapMultisample??e.multisample}),l="cacheAsBitmap_"+uid(),this._cacheData.textureCacheId=l,BaseTexture.addToCache(o.baseTexture,l),Texture.addToCache(o,l),l=this.transform.localTransform.copyTo(_tempMatrix).invert().translate(-r.x,-r.y),this.render=this._cacheData.originalRender,e.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=s,e.renderTexture.bind(i,n,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t,(l=new Sprite(o)).transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(r.x/r.width),l.anchor.y=-(r.y/r.height),l.alpha=t,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=l.containsPoint.bind(l))},DisplayObject.prototype._renderCachedCanvas=function(e){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},DisplayObject.prototype._initCachedDisplayObjectCanvas=function(e){var t,r,i,n,a,s;null!=(t=this._cacheData)&&t.sprite||(t=this.getLocalBounds(new Rectangle,!0),r=this.alpha,this.alpha=1,i=e.canvasContext.activeContext,n=e._projTransform,a=this.cacheAsBitmapResolution||e.resolution,t.ceil(a),t.width=Math.max(t.width,1/a),t.height=Math.max(t.height,1/a),a=RenderTexture.create({width:t.width,height:t.height,resolution:a}),s="cacheAsBitmap_"+uid(),this._cacheData.textureCacheId=s,BaseTexture.addToCache(a.baseTexture,s),Texture.addToCache(a,s),s=_tempMatrix,this.transform.localTransform.copyTo(s),s.invert(),s.tx-=t.x,s.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:a,clear:!0,transform:s,skipUpdateTransform:!1}),e.canvasContext.activeContext=i,e._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r,(s=new Sprite(a)).transform.worldTransform=this.transform.worldTransform,s.anchor.x=-(t.x/t.width),s.anchor.y=-(t.y/t.height),s.alpha=r,s._bounds=this._bounds,this._cacheData.sprite=s,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=s.containsPoint.bind(s))},DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,BaseTexture.removeFromCache(this._cacheData.textureCacheId),Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},DisplayObject.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},DisplayObject.prototype.name=null,Container.prototype.getChildByName=function(r,e){for(let e=0,t=this.children.length;e<t;e++)if(this.children[e].name===r)return this.children[e];if(e)for(let e=0,t=this.children.length;e<t;e++){var i=this.children[e];if(i.getChildByName){i=i.getChildByName(r,!0);if(i)return i}}return null},DisplayObject.prototype.getGlobalPosition=function(e=new Point,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};var fragment$x=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class AlphaFilter extends Filter{constructor(e=1){super(defaultVertex,fragment$x,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}let GAUSSIAN_VALUES={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},fragTemplate=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function generateBlurFragSource(r){var i=GAUSSIAN_VALUES[r],n=i.length;let e=fragTemplate,a="";let s;for(let t=0;t<r;t++){let e="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",t.toString());(s=t)>=n&&(s=r-t-1),e=e.replace("%value%",i[s].toString()),a=a+e+`
`}return e=(e=e.replace("%blur%",a)).replace("%size%",r.toString())}let vertTemplate=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function generateBlurVertSource(e,t){var r=Math.ceil(e/2);let i=vertTemplate,n="",a;a=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let t=0;t<e;t++){let e=a.replace("%index%",t.toString());e=e.replace("%sampleIndex%",t-(r-1)+".0"),n=n+e+`
`}return i=(i=i.replace("%blur%",n)).replace("%size%",e.toString())}class BlurFilterPass extends Filter{constructor(e,t=8,r=4,i=Filter.defaultResolution,n=5){super(generateBlurVertSource(n,e),generateBlurFragSource(n)),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=r,this.blur=t}apply(i,e,n,a){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/i.renderer.width*(i.renderer.width/e.width):this.uniforms.strength=1/i.renderer.height*(i.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)i.applyFilter(this,e,n,a);else{var s=i.getFilterTexture(),o=i.renderer;let t=e,r=s;this.state.blend=!1,i.applyFilter(this,t,r,CLEAR_MODES.CLEAR);for(let e=1;e<this.passes-1;e++){i.bindAndClear(t,CLEAR_MODES.BLIT);var l=this.uniforms.uSampler=r;r=t,t=l,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,i.applyFilter(this,r,n,a),i.returnFilterTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}class BlurFilter extends Filter{constructor(e=8,t=4,r=Filter.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new BlurFilterPass(!0,e,t,r,i),this.blurYFilter=new BlurFilterPass(!1,e,t,r,i),this.resolution=r,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,r,i){var n=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);n&&a?(n=e.getFilterTexture(),this.blurXFilter.apply(e,t,n,CLEAR_MODES.CLEAR),this.blurYFilter.apply(e,n,r,i),e.returnFilterTexture(n)):(a?this.blurYFilter:this.blurXFilter).apply(e,t,r,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}var fragment$w=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class ColorMatrixFilter extends Filter{constructor(){var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(defaultFilterVertex,fragment$w,e),this.alpha=1}_loadMatrix(e,t=!1){let r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e}_colorMatrix(e){e=new Float32Array(e);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(e,t){this._loadMatrix([e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0],t)}tint(e,t){var[e,r,i]=Color.shared.setValue(e).toArray();this._loadMatrix([e,0,0,0,0,0,r,0,0,0,0,0,i,0,0,0,0,0,1,0],t)}greyscale(e,t){this._loadMatrix([e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0],t)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,t){e=(e||0)/180*Math.PI;var r=Math.cos(e),e=Math.sin(e),i=(0,Math.sqrt)(1/3);this._loadMatrix([r+1/3*(1-r),1/3*(1-r)-i*e,1/3*(1-r)+i*e,0,0,1/3*(1-r)+i*e,r+1/3*(1-r),1/3*(1-r)-i*e,0,0,1/3*(1-r)-i*e,1/3*(1-r)+i*e,r+1/3*(1-r),0,0,0,0,0,1,0],t)}contrast(e,t){var e=(e||0)+1,r=-.5*(e-1);this._loadMatrix([e,0,0,0,r,0,e,0,0,r,0,0,e,0,r,0,0,0,1,0],t)}saturate(e=0,t){var e=2*e/3+1,r=-.5*(e-1);this._loadMatrix([e,r,r,0,0,r,e,r,0,0,r,r,e,0,0,0,0,0,1,0],t)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,t,r,i,n){e=e||.2,t=t||.15,r=r||16770432,i=i||3375104;var a=Color.shared,[r,s,o]=a.setValue(r).toArray(),[a,i,l]=a.setValue(i).toArray();this._loadMatrix([.3,.59,.11,0,0,r,s,o,e,0,a,i,l,t,0,r-a,s-i,o-l,0,0],n)}night(e,t){this._loadMatrix([-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0],t)}predator(e,t){this._loadMatrix([11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0],t)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale;var fragment$v=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,vertex$3=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class DisplacementFilter extends Filter{constructor(e,t){var r=new Matrix;e.renderable=!1,super(vertex$3,fragment$v,{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==t&&(t=20),this.scale=new Point(t,t)}apply(e,t,r,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.worldTransform,a=Math.sqrt(n.a*n.a+n.b*n.b),s=Math.sqrt(n.c*n.c+n.d*n.d);0!==a&&0!==s&&(this.uniforms.rotation[0]=n.a/a,this.uniforms.rotation[1]=n.b/a,this.uniforms.rotation[2]=n.c/s,this.uniforms.rotation[3]=n.d/s),e.applyFilter(this,t,r,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}}var fragment$u=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,vertex$2=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class FXAAFilter extends Filter{constructor(){super(vertex$2,fragment$u)}}var fragment$t=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class NoiseFilter extends Filter{constructor(e=.5,t=Math.random()){super(defaultFilterVertex,fragment$t,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}let filters$2={AlphaFilter:AlphaFilter,BlurFilter:BlurFilter,BlurFilterPass:BlurFilterPass,ColorMatrixFilter:ColorMatrixFilter,DisplacementFilter:DisplacementFilter,FXAAFilter:FXAAFilter,NoiseFilter:NoiseFilter};Object.entries(filters$2).forEach(([e,t])=>{Object.defineProperty(filters$2,e,{get(){return deprecation("7.1.0",`filters.${e} has moved to `+e),t}})});class EventsTickerClass{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){!this.tickerAdded&&this.domElement&&(Ticker.system.add(this.tickerUpdate,this,UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(Ticker.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){var e;this.domElement&&!this._pauseUpdate&&(this._didMove?this._didMove=!1:(e=this.events.rootPointerEvent,this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))))}tickerUpdate(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())}}let EventsTicker=new EventsTickerClass;class FederatedEvent{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point,this.page=new Point,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,r,i,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client=new Point,this.movement=new Point,this.offset=new Point,this.global=new Point,this.screen=new Point}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,r,i,n,a,s,o,l,u,c,h,d,p,f){throw new Error("Method not implemented.")}}class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2;let PROPAGATION_LIMIT=2048,tempHitLocation=new Point,tempLocalMapping=new Point;class EventBoundary{constructor(e){this.dispatch=new EventEmitter$2,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((e,t)=>e.priority-t.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(r){if(this.rootTarget){var i=this.mappingTable[r.type];if(i)for(let e=0,t=i.length;e<t;e++)i[e].fn(r)}}hitTest(e,t){EventsTicker.pauseUpdate=!0;e=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,tempHitLocation.set(e,t),this.hitTestFn,this.hitPruneFn);return e&&e[0]}propagate(r,i){if(r.target){var n=r.composedPath();r.eventPhase=r.CAPTURING_PHASE;for(let e=0,t=n.length-1;e<t;e++)if(r.currentTarget=n[e],this.notifyTarget(r,i),r.propagationStopped||r.propagationImmediatelyStopped)return;if(r.eventPhase=r.AT_TARGET,r.currentTarget=r.target,this.notifyTarget(r,i),!r.propagationStopped&&!r.propagationImmediatelyStopped){r.eventPhase=r.BUBBLING_PHASE;for(let e=n.length-2;0<=e;e--)if(r.currentTarget=n[e],this.notifyTarget(r,i),r.propagationStopped||r.propagationImmediatelyStopped)return}}}all(r,e,i=this._allInteractiveElements){if(0!==i.length){r.eventPhase=r.BUBBLING_PHASE;var n=Array.isArray(e)?e:[e];for(let t=i.length-1;0<=t;t--)n.forEach(e=>{r.currentTarget=i[t],this.notifyTarget(r,e)})}}propagationPath(t){var r=[t];for(let e=0;e<PROPAGATION_LIMIT&&t!==this.rootTarget;e++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");r.push(t.parent),t=t.parent}return r.reverse(),r}hitTestMoveRecursive(t,r,i,n,a,s=!1){let o=!1;if(this._interactivePrune(t))return null;if("dynamic"!==t.eventMode&&"dynamic"!==r||(EventsTicker.pauseUpdate=!1),t.interactiveChildren&&t.children){var l=t.children;for(let e=l.length-1;0<=e;e--){var u,c=l[e],c=this.hitTestMoveRecursive(c,this._isInteractive(r)?r:c.eventMode,i,n,a,s||a(t,i));!c||0<c.length&&!c[c.length-1].parent||(u=t.isInteractive(),(0<c.length||u)&&(u&&this._allInteractiveElements.push(t),c.push(t)),0===this._hitElements.length&&(this._hitElements=c),o=!0)}}var e=this._isInteractive(r),h=t.isInteractive();return e&&h&&this._allInteractiveElements.push(t),s||0<this._hitElements.length?null:o?this._hitElements:e&&!a(t,i)&&n(t,i)?h?[t]:[]:null}hitTestRecursive(t,r,i,n,a){if(this._interactivePrune(t)||a(t,i))return null;if("dynamic"!==t.eventMode&&"dynamic"!==r||(EventsTicker.pauseUpdate=!1),t.interactiveChildren&&t.children){var s=t.children;for(let e=s.length-1;0<=e;e--){var o,l=s[e],l=this.hitTestRecursive(l,this._isInteractive(r)?r:l.eventMode,i,n,a);if(l)if(!(0<l.length)||l[l.length-1].parent)return o=t.isInteractive(),(0<l.length||o)&&l.push(t),l}}var e=this._isInteractive(r),u=t.isInteractive();return e&&n(t,i)?u?[t]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!(e&&!e.isMask&&e.visible&&e.renderable&&"none"!==e.eventMode&&("passive"!==e.eventMode||e.interactiveChildren)&&!e.isMask)}hitPruneFn(e,t){var r;if(e.hitArea&&(e.worldTransform.applyInverse(t,tempLocalMapping),!e.hitArea.contains(tempLocalMapping.x,tempLocalMapping.y)))return!0;if(e._mask){e=e._mask.isMaskData?e._mask.maskObject:e._mask;if(e&&(null==(r=e.containsPoint)||!r.call(e,t)))return!0}return!1}hitTestFn(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t))}notifyTarget(e,t){var r,i="on"+(t=t??e.type),i=(null!=(i=(r=e.currentTarget)[i])&&i.call(r,e),e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?t+"capture":t);this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){var t,r;e instanceof FederatedPointerEvent&&(t=this.createPointerEvent(e),this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType?this.dispatchEvent(t,"touchstart"):"mouse"!==t.pointerType&&"pen"!==t.pointerType||(r=2===t.button,this.dispatchEvent(t,r?"rightdown":"mousedown")),this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t))}mapPointerMove(t){if(t instanceof FederatedPointerEvent){this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;var r=this.createPointerEvent(t),i=(this._isPointerMoveEvent=!1,"mouse"===r.pointerType||"pen"===r.pointerType),e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.overTargets);if(0<(null==(a=e.overTargets)?void 0:a.length)&&n!==r.target){var a="mousemove"===t.type?"mouseout":"pointerout",a=this.createPointerEvent(t,a,n);if(this.dispatchEvent(a,"pointerout"),i&&this.dispatchEvent(a,"mouseout"),!r.composedPath().includes(n)){var s=this.createPointerEvent(t,"pointerleave",n);for(s.eventPhase=s.AT_TARGET;s.target&&!r.composedPath().includes(s.target);)s.currentTarget=s.target,this.notifyTarget(s),i&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;this.freeEvent(s)}this.freeEvent(a)}if(n!==r.target){var a="mousemove"===t.type?"mouseover":"pointerover",t=this.clonePointerEvent(r,a);this.dispatchEvent(t,"pointerover"),i&&this.dispatchEvent(t,"mouseover");let e=null==n?void 0:n.parent;for(;e&&e!==this.rootTarget.parent&&e!==r.target;)e=e.parent;if(!e||e===this.rootTarget.parent){var o=this.clonePointerEvent(r,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==n&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;this.freeEvent(o)}this.freeEvent(t)}a=[],t=this.enableGlobalMoveEvents??!0;this.moveOnAll?a.push("pointermove"):this.dispatchEvent(r,"pointermove"),t&&a.push("globalpointermove"),"touch"===r.pointerType&&(this.moveOnAll?a.splice(1,0,"touchmove"):this.dispatchEvent(r,"touchmove"),t)&&a.push("globaltouchmove"),i&&(this.moveOnAll?a.splice(1,0,"mousemove"):this.dispatchEvent(r,"mousemove"),t&&a.push("globalmousemove"),this.cursor=null==(t=r.target)?void 0:t.cursor),0<a.length&&this.all(r,a),this._allInteractiveElements.length=0,this._hitElements.length=0,e.overTargets=r.composedPath(),this.freeEvent(r)}}mapPointerOver(e){var t;if(e instanceof FederatedPointerEvent){var r=this.trackingData(e.pointerId),e=this.createPointerEvent(e),i="mouse"===e.pointerType||"pen"===e.pointerType,n=(this.dispatchEvent(e,"pointerover"),i&&this.dispatchEvent(e,"mouseover"),"mouse"===e.pointerType&&(this.cursor=null==(t=e.target)?void 0:t.cursor),this.clonePointerEvent(e,"pointerenter"));for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;r.overTargets=e.composedPath(),this.freeEvent(e),this.freeEvent(n)}}mapPointerOut(e){if(e instanceof FederatedPointerEvent){var t=this.trackingData(e.pointerId);if(t.overTargets){var r="mouse"===e.pointerType||"pen"===e.pointerType,i=this.findMountedTarget(t.overTargets),n=this.createPointerEvent(e,"pointerout",i),a=(this.dispatchEvent(n),r&&this.dispatchEvent(n,"mouseout"),this.createPointerEvent(e,"pointerleave",i));for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),r&&this.notifyTarget(a,"mouseleave"),a.target=a.target.parent;t.overTargets=null,this.freeEvent(n),this.freeEvent(a)}this.cursor=null}}mapPointerUp(r){if(r instanceof FederatedPointerEvent){var i,e=performance.now(),n=this.createPointerEvent(r),a=(this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType?this.dispatchEvent(n,"touchend"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(a=2===n.button,this.dispatchEvent(n,a?"rightup":"mouseup")),this.trackingData(r.pointerId)),s=this.findMountedTarget(a.pressTargetsByButton[r.button]);let t=s;if(s&&!n.composedPath().includes(s)){let e=s;for(;e&&!n.composedPath().includes(e);)n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(i=2===n.button,this.notifyTarget(n,i?"rightupoutside":"mouseupoutside")),e=e.parent;delete a.pressTargetsByButton[r.button],t=e}t&&((s=this.clonePointerEvent(n,"click")).target=t,s.path=null,a.clicksByButton[r.button]||(a.clicksByButton[r.button]={clickCount:0,target:s.target,timeStamp:e}),(a=a.clicksByButton[r.button]).target===s.target&&e-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=s.target,a.timeStamp=e,s.detail=a.clickCount,"mouse"===s.pointerType?(r=2===s.button,this.dispatchEvent(s,r?"rightclick":"click")):"touch"===s.pointerType&&this.dispatchEvent(s,"tap"),this.dispatchEvent(s,"pointertap"),this.freeEvent(s)),this.freeEvent(n)}}mapPointerUpOutside(t){if(t instanceof FederatedPointerEvent){var r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),n=this.createPointerEvent(t);if(i){let e=i;for(;e;)n.currentTarget=e,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),e=e.parent;delete r.pressTargetsByButton[t.button]}this.freeEvent(n)}}mapWheel(e){e instanceof FederatedWheelEvent&&(e=this.createWheelEvent(e),this.dispatchEvent(e),this.freeEvent(e))}findMountedTarget(t){if(!t)return null;let r=t[0];for(let e=1;e<t.length&&t[e].parent===r;e++)r=t[e];return r}createPointerEvent(e,t,r){var i=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],"string"==typeof t&&(i.type=t),i}createWheelEvent(e){var t=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){var r=this.allocateEvent(FederatedPointerEvent);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t??r.type,r}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof FederatedPointerEvent&&t instanceof FederatedPointerEvent&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof FederatedMouseEvent&&t instanceof FederatedMouseEvent&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);e=this.eventPool.get(e).pop()||new e(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(r,i){var n=r.currentTarget._events[i];if(n&&r.currentTarget.isInteractive())if("fn"in n)n.once&&r.currentTarget.removeListener(i,n.fn,void 0,!0),n.fn.call(n.context,r);else for(let e=0,t=n.length;e<t&&!r.propagationImmediatelyStopped;e++)n[e].once&&r.currentTarget.removeListener(i,n[e].fn,void 0,!0),n[e].fn.call(n[e].context,r)}}let MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},_EventSystem=class _EventSystem2{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new EventBoundary(null),EventsTicker.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({..._EventSystem2.defaultEventFeatures},{set:(e,t,r)=>("globalMove"===t&&(this.rootBoundary.enableGlobalMoveEvents=r),e[t]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){var{view:t,resolution:r}=this.renderer;this.setTargetElement(t),this.resolution=r,_EventSystem2._defaultEventMode=e.eventMode??"auto",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor!==e){this.currentCursor=e;var r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var r=this.normalizeToPointerData(e);!this.autoPreventDefault||!r[0].isNormalized||!e.cancelable&&"cancelable"in e||e.preventDefault();for(let e=0,t=r.length;e<t;e++){var i=r[e],i=this.bootstrapEvent(this.rootPointerEvent,i);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}onPointerMove(e){if(this.features.move){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,EventsTicker.pointerMoved();var r=this.normalizeToPointerData(e);for(let e=0,t=r.length;e<t;e++){var i=this.bootstrapEvent(this.rootPointerEvent,r[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}onPointerUp(t){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;var r=(e=t.composedPath&&0<t.composedPath().length?t.composedPath()[0]:e)!==this.domElement?"outside":"",i=this.normalizeToPointerData(t);for(let e=0,t=i.length;e<t;e++){var n=this.bootstrapEvent(this.rootPointerEvent,i[e]);n.type+=r,this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}}onPointerOverOut(e){if(this.features.click){this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;var r=this.normalizeToPointerData(e);for(let e=0,t=r.length;e<t;e++){var i=this.bootstrapEvent(this.rootPointerEvent,r[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}}onWheel(e){this.features.wheel&&(e=this.normalizeWheelEvent(e),this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e))}setTargetElement(e){this.removeEvents(),this.domElement=e,EventsTicker.domElement=e,this.addEvents()}addEvents(){var e;!this.eventsAdded&&this.domElement&&(EventsTicker.addTickerListener(),(e=this.domElement.style)&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0)}removeEvents(){var e;this.eventsAdded&&this.domElement&&(EventsTicker.removeTickerListener(),e=this.domElement.style,globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1)}mapPositionToPoint(e,t,r){var i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*n,e.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(r){var e,i=[];if(this.supportsTouchEvents&&r instanceof TouchEvent)for(let e=0,t=r.changedTouches.length;e<t;e++){var n=r.changedTouches[e];"u"<typeof n.button&&(n.button=0),"u"<typeof n.buttons&&(n.buttons=1),"u"<typeof n.isPrimary&&(n.isPrimary=1===r.touches.length&&"touchstart"===r.type),"u"<typeof n.width&&(n.width=n.radiusX||1),"u"<typeof n.height&&(n.height=n.radiusY||1),"u"<typeof n.tiltX&&(n.tiltX=0),"u"<typeof n.tiltY&&(n.tiltY=0),"u"<typeof n.pointerType&&(n.pointerType="touch"),"u"<typeof n.pointerId&&(n.pointerId=n.identifier||0),"u"<typeof n.pressure&&(n.pressure=n.force||.5),"u"<typeof n.twist&&(n.twist=0),"u"<typeof n.tangentialPressure&&(n.tangentialPressure=0),"u"<typeof n.layerX&&(n.layerX=n.offsetX=n.clientX),"u"<typeof n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=r.type,i.push(n)}else!globalThis.MouseEvent||r instanceof MouseEvent&&!(this.supportsPointerEvents&&r instanceof globalThis.PointerEvent)?("u"<typeof(e=r).isPrimary&&(e.isPrimary=!0),"u"<typeof e.width&&(e.width=1),"u"<typeof e.height&&(e.height=1),"u"<typeof e.tiltX&&(e.tiltX=0),"u"<typeof e.tiltY&&(e.tiltY=0),"u"<typeof e.pointerType&&(e.pointerType="mouse"),"u"<typeof e.pointerId&&(e.pointerId=MOUSE_POINTER_ID),"u"<typeof e.pressure&&(e.pressure=.5),"u"<typeof e.twist&&(e.twist=0),"u"<typeof e.tangentialPressure&&(e.tangentialPressure=0),e.isNormalized=!0,i.push(e)):i.push(r);return i}normalizeWheelEvent(e){var t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=TOUCH_TO_POINTER[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}},EventSystem=(_EventSystem.extension={name:"events",type:[ExtensionType.RendererSystem,ExtensionType.CanvasRendererSystem]},_EventSystem.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},_EventSystem);function convertEventModeToInteractiveMode(e){return"dynamic"===e||"static"===e}extensions$1.add(EventSystem);let FederatedDisplayObject={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??convertEventModeToInteractiveMode(EventSystem.defaultEventMode)},set interactive(e){deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=e,this.eventMode=e?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??EventSystem.defaultEventMode},set eventMode(e){this._internalInteractive=convertEventModeToInteractiveMode(e),this._internalEventMode=e},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){let i="boolean"==typeof r&&r||"object"==typeof r&&r.capture,n="object"==typeof r?r.signal:void 0,a="object"==typeof r&&!0===r.once,s="function"==typeof t?void 0:t,o=(e=i?e+"capture":e,"function"==typeof t?t:t.handleEvent),l=this;n&&n.addEventListener("abort",()=>{l.off(e,o,s)}),a?l.once(e,o,s):l.on(e,o,s)},removeEventListener(e,t,r){var r="boolean"==typeof r&&r||"object"==typeof r&&r.capture,i="function"==typeof t?void 0:t;t="function"==typeof t?t:t.handleEvent,this.off(e=r?e+"capture":e,t,i)},dispatchEvent(e){if(e instanceof FederatedEvent)return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented;throw new Error("DisplayObject cannot propagate events outside of the Federated Events API")}},accessibleTarget=(DisplayObject.mixin(FederatedDisplayObject),{accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1}),KEY_CODE_TAB=(DisplayObject.mixin(accessibleTarget),9),DIV_TOUCH_SIZE=100,DIV_TOUCH_POS_X=0,DIV_TOUCH_POS_Y=0,DIV_TOUCH_ZINDEX=2,DIV_HOOK_SIZE=1,DIV_HOOK_POS_X=-1e3,DIV_HOOK_POS_Y=-1e3,DIV_HOOK_ZINDEX=2;class AccessibilityManager{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(isMobile.tablet||isMobile.phone)&&this.createTouchHook();var t=document.createElement("div");t.style.width=DIV_TOUCH_SIZE+"px",t.style.height=DIV_TOUCH_SIZE+"px",t.style.position="absolute",t.style.top=DIV_TOUCH_POS_X+"px",t.style.left=DIV_TOUCH_POS_Y+"px",t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){var e=document.createElement("button");e.style.width=DIV_HOOK_SIZE+"px",e.style.height=DIV_HOOK_SIZE+"px",e.style.position="absolute",e.style.top=DIV_HOOK_POS_X+"px",e.style.left=DIV_HOOK_POS_Y+"px",e.style.zIndex=DIV_HOOK_ZINDEX.toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var e;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null!=(e=this.renderer.view.parentNode)&&e.appendChild(this.div))}deactivate(){var e;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null!=(e=this.div.parentNode))&&e.removeChild(this.div)}updateAccessibleObjects(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);var t=e.children;if(t)for(let e=0;e<t.length;e++)this.updateAccessibleObjects(t[e])}}update(){var e=performance.now();if(!(isMobile.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);var{x:e,y:r,width:i,height:n}=this.renderer.view.getBoundingClientRect(),{width:a,height:s,resolution:o}=this.renderer,l=i/a*o,u=n/s*o;let t=this.div;t.style.left=e+"px",t.style.top=r+"px",t.style.width=a+"px",t.style.height=s+"px";for(let e=0;e<this.children.length;e++){var c,h,d=this.children[e];d.renderId!==this.renderId?(d._accessibleActive=!1,removeItems(this.children,e,1),this.div.removeChild(d._accessibleDiv),this.pool.push(d._accessibleDiv),d._accessibleDiv=null,e--):(t=d._accessibleDiv,c=d.hitArea,h=d.worldTransform,d.hitArea?(t.style.left=(h.tx+c.x*h.a)*l+"px",t.style.top=(h.ty+c.y*h.d)*u+"px",t.style.width=c.width*h.a*l+"px",t.style.height=c.height*h.d*u+"px"):(c=d.getBounds(),this.capHitArea(c),t.style.left=c.x*l+"px",t.style.top=c.y*u+"px",t.style.width=c.width*l+"px",t.style.height=c.height*u+"px",t.title!==d.accessibleTitle&&null!==d.accessibleTitle&&(t.title=d.accessibleTitle),t.getAttribute("aria-label")!==d.accessibleHint&&null!==d.accessibleHint&&t.setAttribute("aria-label",d.accessibleHint)),d.accessibleTitle===t.title&&d.tabIndex===t.tabIndex||(t.title=d.accessibleTitle,t.tabIndex=d.tabIndex,!this.debug)||this.updateDebugHTML(t))}this.renderId++}}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: `+e.tabIndex}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);var{width:t,height:r}=this.renderer;t<e.x+e.width&&(e.width=t-e.x),r<e.y+e.height&&(e.height=r-e.y)}addChild(e){let t=this.pool.pop();t||((t=document.createElement("button")).style.width=DIV_TOUCH_SIZE+"px",t.style.height=DIV_TOUCH_SIZE+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=DIV_TOUCH_ZINDEX.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title="displayObject "+e.tabIndex),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,(e._accessibleDiv=t).displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){let r=e.target.displayObject,i=this.renderer.events.rootBoundary,n=Object.assign(new FederatedEvent(i),{target:r});i.rootTarget=this.renderer.lastObjectRendered,t.forEach(e=>i.dispatchEvent(n,e))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){e.keyCode===KEY_CODE_TAB&&this.activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}AccessibilityManager.extension={name:"accessibility",type:[ExtensionType.RendererPlugin,ExtensionType.CanvasRendererPlugin]},extensions$1.add(AccessibilityManager);let _Application=class _Application2{constructor(t){this.stage=new Container,t=Object.assign({forceCanvas:!1},t),this.renderer=autoDetectRenderer(t),_Application2._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var e;return null==(e=this.renderer)?void 0:e.view}get screen(){var e;return null==(e=this.renderer)?void 0:e.screen}destroy(e,t){var r=_Application2._plugins.slice(0);r.reverse(),r.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}},Application=(_Application._plugins=[],_Application);extensions$1.handleByList(ExtensionType.Application,Application._plugins);class ResizePlugin{static init(e){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),(this._resizeTo=e)&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(this._resizeTo){this.cancelResize();let e,t;var r,i;t=this._resizeTo===globalThis.window?(e=globalThis.innerWidth,globalThis.innerHeight):({clientWidth:r,clientHeight:i}=this._resizeTo,e=r,i),this.renderer.resize(e,t),this.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ResizePlugin.extension=ExtensionType.Application,extensions$1.add(ResizePlugin);let assetKeyMap={loader:ExtensionType.LoadParser,resolver:ExtensionType.ResolveParser,cache:ExtensionType.CacheParser,detection:ExtensionType.DetectionParser};extensions$1.handle(ExtensionType.Asset,e=>{let r=e.ref;Object.entries(assetKeyMap).filter(([e])=>!!r[e]).forEach(([e,t])=>extensions$1.add(Object.assign(r[e],{extension:r[e].extension??t})))},e=>{let t=e.ref;Object.keys(assetKeyMap).filter(e=>!!t[e]).forEach(e=>extensions$1.remove(t[e]))});class BackgroundLoader{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(e=>{this._assetList.push(e)}),this.verbose,this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;var t=[],r=Math.min(this._assetList.length,this._maxConcurrent);for(let e=0;e<r;e++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e)&&!this._isLoading&&this._next()}}function checkDataUrl(e,t){if(Array.isArray(t)){for(var r of t)if(e.startsWith("data:"+r))return!0;return!1}return e.startsWith("data:"+t)}function checkExtension(e,t){e=e.split("?")[0],e=path.extname(e).toLowerCase();return Array.isArray(t)?t.includes(e):e===t}let convertToList=(e,t,r=!1)=>(Array.isArray(e)||(e=[e]),t?e.map(e=>"string"==typeof e||r?t(e):e):e),copySearchParams=(e,t)=>{t=t.split("?")[1];return t&&(e+="?"+t),e};function processX(t,r,i,n,a){var s=r[i];for(let e=0;e<s.length;e++){var o=s[e];i<r.length-1?processX(t.replace(n[i],o),r,i+1,n,a):a.push(t.replace(n[i],o))}}function createStringVariations(e){var r=e.match(/\{(.*?)\}/g),i=[];if(r){let t=[];r.forEach(e=>{e=e.substring(1,e.length-1).split(",");t.push(e)}),processX(e,t,0,r,i)}else i.push(e);return i}let isSingleItem=e=>!Array.isArray(e);class CacheClass{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){e=this._cache.get(e);return e}set(e,r){var i=convertToList(e);let t;for(let e=0;e<this.parsers.length;e++){var n=this.parsers[e];if(n.test(r)){t=n.getCacheableAssets(i,r);break}}t||(t={},i.forEach(e=>{t[e]=r}));let a=Object.keys(t),s={cacheKeys:a,keys:i};if(i.forEach(e=>{this._cacheMap.set(e,s)}),a.forEach(e=>{this._cache.has(e)&&this._cache.get(e),this._cache.set(e,t[e])}),r instanceof Texture){let t=r;i.forEach(e=>{t.baseTexture!==Texture.EMPTY.baseTexture&&BaseTexture.addToCache(t.baseTexture,e),Texture.addToCache(t,e)})}}remove(e){this._cacheMap.has(e)&&((e=this._cacheMap.get(e)).cacheKeys.forEach(e=>{this._cache.delete(e)}),e.keys.forEach(e=>{this._cacheMap.delete(e)}))}get parsers(){return this._parsers}}let Cache=new CacheClass;class Loader{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,r)=>(this._parsersValidated=!1,e[t]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(o,l){let u={promise:null,parser:null};return u.promise=(async()=>{let t,r,i=null,n=null;if(!(n=l.loadParser?this._parserHash[l.loadParser]:n)){for(let e=0;e<this.parsers.length;e++){var a=this.parsers[e];if(a.load&&null!=(t=a.test)&&t.call(a,o,l,this)){n=a;break}}if(!n)return null}i=await n.load(o,l,this),u.parser=n;for(let e=0;e<this.parsers.length;e++){var s=this.parsers[e];s.parse&&await(null==(r=s.testParse)?void 0:r.call(s,i,l,this))&&(i=await s.parse(i,l,this)||i,u.parser=s)}return i})(),u}async load(e,i){this._parsersValidated||this._validateParsers();let n=0,a={},t=isSingleItem(e),r=convertToList(e,e=>({alias:[e],src:e})),s=r.length,o=r.map(async t=>{var r=path.toAbsolute(t.src);if(!a[t.src])try{this.promiseCache[r]||(this.promiseCache[r]=this._getLoadPromiseAndParser(r,t)),a[t.src]=await this.promiseCache[r].promise,i&&i(++n/s)}catch(e){throw delete this.promiseCache[r],delete a[t.src],new Error(`[Loader.load] Failed to load ${r}.
`+e)}});return await Promise.all(o),t?a[r[0].src]:a}async unload(e){e=convertToList(e,e=>({alias:[e],src:e})).map(async e=>{var t,r=path.toAbsolute(e.src),i=this.promiseCache[r];i&&(t=await i.promise,delete this.promiseCache[r],null!=(i=null==(r=i.parser)?void 0:r.unload))&&i.call(r,t,e,this)});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(e[t.name],{...e,[t.name]:t}),{})}}var LoaderParserPriority=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(LoaderParserPriority||{});let validJSONExtension=".json",validJSONMIME="application/json",loadJson={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadJson",test(e){return checkDataUrl(e,validJSONMIME)||checkExtension(e,validJSONExtension)},async load(e){return(await settings.ADAPTER.fetch(e)).json()}},validTXTExtension=(extensions$1.add(loadJson),".txt"),validTXTMIME="text/plain",loadTxt={name:"loadTxt",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},test(e){return checkDataUrl(e,validTXTMIME)||checkExtension(e,validTXTExtension)},async load(e){return(await settings.ADAPTER.fetch(e)).text()}},validWeights=(extensions$1.add(loadTxt),["normal","bold","100","200","300","400","500","600","700","800","900"]),validFontExtensions=[".ttf",".otf",".woff",".woff2"],validFontMIMEs=["font/ttf","font/otf","font/woff","font/woff2"],CSS_IDENT_TOKEN_REGEX=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function getFontFamilyName(e){var t,r=path.extname(e),e=path.basename(e,r).replace(/(-|_)/g," ").toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1));let i=0<e.length;for(t of e)if(!t.match(CSS_IDENT_TOKEN_REGEX)){i=!1;break}let n=e.join(" ");return n=i?n:`"${n.replace(/[\\"]/g,"\\$&")}"`}let validURICharactersRegex=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function encodeURIWhenNeeded(e){return validURICharactersRegex.test(e)?e:encodeURI(e)}let loadWebFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Low},name:"loadWebFont",test(e){return checkDataUrl(e,validFontMIMEs)||checkExtension(e,validFontExtensions)},async load(t,e){var r,i=settings.ADAPTER.getFontFaceSet();if(i){var n=[],a=(null==(r=e.data)?void 0:r.family)??getFontFamilyName(t),s=(null==(r=null==(r=e.data)?void 0:r.weights)?void 0:r.filter(e=>validWeights.includes(e)))??["normal"],o=e.data??{};for(let e=0;e<s.length;e++){var l=s[e],l=new FontFace(a,`url(${encodeURIWhenNeeded(t)})`,{...o,weight:l});await l.load(),i.add(l),n.push(l)}return 1===n.length?n[0]:n}return null},unload(e){(Array.isArray(e)?e:[e]).forEach(e=>settings.ADAPTER.getFontFaceSet().delete(e))}},WORKER_CODE$1=(extensions$1.add(loadWebFont),`(function() {
  "use strict";
  const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
  async function checkImageBitmap() {
    try {
      if (typeof createImageBitmap != "function")
        return !1;
      const imageBlob = await (await fetch(WHITE_PNG)).blob(), imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap.width === 1 && imageBitmap.height === 1;
    } catch {
      return !1;
    }
  }
  checkImageBitmap().then((result) => {
    self.postMessage(result);
  });
})();
`),WORKER_URL$1=null,WorkerInstance$1=class WorkerInstance2 extends Worker{constructor(){super(WORKER_URL$1=WORKER_URL$1||URL.createObjectURL(new Blob([WORKER_CODE$1],{type:"application/javascript"})))}},WORKER_CODE=(WorkerInstance$1.revokeObjectURL=function(){WORKER_URL$1&&(URL.revokeObjectURL(WORKER_URL$1),WORKER_URL$1=null)},`(function() {
  "use strict";
  async function loadImageBitmap(url) {
    const response = await fetch(url);
    if (!response.ok)
      throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
    const imageBlob = await response.blob();
    return await createImageBitmap(imageBlob);
  }
  self.onmessage = async (event) => {
    try {
      const imageBitmap = await loadImageBitmap(event.data.data[0]);
      self.postMessage({
        data: imageBitmap,
        uuid: event.data.uuid,
        id: event.data.id
      }, [imageBitmap]);
    } catch (e) {
      self.postMessage({
        error: e,
        uuid: event.data.uuid,
        id: event.data.id
      });
    }
  };
})();
`),WORKER_URL=null;class WorkerInstance extends Worker{constructor(){super(WORKER_URL=WORKER_URL||URL.createObjectURL(new Blob([WORKER_CODE],{type:"application/javascript"})))}}WorkerInstance.revokeObjectURL=function(){WORKER_URL&&(URL.revokeObjectURL(WORKER_URL),WORKER_URL=null)};let UUID=0,MAX_WORKERS;class WorkerManagerClass{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(t=>{let r=new WorkerInstance$1;r.addEventListener("message",e=>{r.terminate(),WorkerInstance$1.revokeObjectURL(),t(e.data)})})),this._isImageBitmapSupported}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===MAX_WORKERS&&(MAX_WORKERS=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<MAX_WORKERS&&(this._createdWorkers++,(e=new WorkerInstance).addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(r,i){await this._initWorkers();var e=new Promise((e,t)=>{this.queue.push({id:r,arguments:i,resolve:e,reject:t})});return this.next(),e}next(){var e,t,r;this.queue.length&&(e=this.getWorker())&&(r=(t=this.queue.pop()).id,this.resolveHash[UUID]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:UUID++,id:r}))}}let WorkerManager=new WorkerManagerClass;function createTexture(e,t,r){e.resource.internal=!0;let i=new Texture(e),n=()=>{delete t.promiseCache[r],Cache.has(r)&&Cache.remove(r)};return i.baseTexture.once("destroyed",()=>{r in t.promiseCache&&n()}),i.once("destroyed",()=>{e.destroyed||n()}),i}let validImageExtensions=[".jpeg",".jpg",".png",".webp",".avif"],validImageMIMEs=["image/jpeg","image/png","image/webp","image/avif"];async function loadImageBitmap(e){var t,r=await settings.ADAPTER.fetch(e);if(r.ok)return t=await r.blob(),createImageBitmap(t);throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${r.status} `+r.statusText)}let loadTextures={name:"loadTextures",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(e){return checkDataUrl(e,validImageMIMEs)||checkExtension(e,validImageExtensions)},async load(i,e,t){var r=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let n;n=r?this.config.preferWorkers&&await WorkerManager.isImageBitmapSupported()?await WorkerManager.loadImageBitmap(i):await loadImageBitmap(i):await new Promise((e,t)=>{let r=new Image;r.crossOrigin=this.config.crossOrigin,r.src=i,r.complete?e(r):(r.onload=()=>e(r),r.onerror=e=>t(e))});e={...e.data},e.resolution??(e.resolution=getResolutionOfUrl(i)),r&&void 0===(null==(r=e.resourceOptions)?void 0:r.ownsImageBitmap)&&(e.resourceOptions={...e.resourceOptions},e.resourceOptions.ownsImageBitmap=!0),r=new BaseTexture(n,e);return r.resource.src=i,createTexture(r,t,i)},unload(e){e.destroy(!0)}},validSVGExtension=(extensions$1.add(loadTextures),".svg"),validSVGMIME="image/svg+xml",loadSVG={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadSVG",test(e){return checkDataUrl(e,validSVGMIME)||checkExtension(e,validSVGExtension)},async testParse(e){return SVGResource.test(e)},async parse(e,t,r){var i=new SVGResource(e,null==(i=null==t?void 0:t.data)?void 0:i.resourceOptions),i=(await i.load(),new BaseTexture(i,{resolution:getResolutionOfUrl(e),...null==t?void 0:t.data}));return i.resource.src=t.src,createTexture(i,r,t.src)},async load(e,t){return(await settings.ADAPTER.fetch(e)).text()},unload:loadTextures.unload},validVideoExtensions=(extensions$1.add(loadSVG),[".mp4",".m4v",".webm",".ogv"]),validVideoMIMEs=["video/mp4","video/webm","video/ogg"],loadVideo={name:"loadVideo",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},config:{defaultAutoPlay:!0,defaultUpdateFPS:0,defaultLoop:!1,defaultMuted:!1,defaultPlaysinline:!0},test(e){return checkDataUrl(e,validVideoMIMEs)||checkExtension(e,validVideoExtensions)},async load(e,t,r){let i,n,a=await(await settings.ADAPTER.fetch(e)).blob(),s=URL.createObjectURL(a);try{var o={autoPlay:this.config.defaultAutoPlay,updateFPS:this.config.defaultUpdateFPS,loop:this.config.defaultLoop,muted:this.config.defaultMuted,playsinline:this.config.defaultPlaysinline,...null==(i=null==t?void 0:t.data)?void 0:i.resourceOptions,autoLoad:!0},l=new VideoResource(s,o),u=(await l.load(),new BaseTexture(l,{alphaMode:await detectVideoAlphaMode(),resolution:getResolutionOfUrl(e),...null==t?void 0:t.data}));u.resource.src=e,(n=createTexture(u,r,e)).baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(e){throw URL.revokeObjectURL(s),e}return n},unload(e){e.destroy(!0)}};extensions$1.add(loadVideo);class Resolver{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>""+e+this._bundleIdConnector+t,extractAssetIdFromBundle:(e,t)=>t.replace(""+e+this._bundleIdConnector,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{let t=e;this._defaultSearchParams=Object.keys(t).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e])).join("&")}}getAlias(e){var{alias:e,name:t,src:r,srcs:i}=e;return convertToList(e||t||r||i,e=>"string"==typeof e?e:Array.isArray(e)?e.map(e=>(null==e?void 0:e.src)??(null==e?void 0:e.srcs)??e):null!=e&&e.src||null!=e&&e.srcs?e.src??e.srcs:e,!0)}addManifest(e){this._manifest,(this._manifest=e).bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(a,i){let s=[];Array.isArray(i)?i.forEach(e=>{var t,r=e.src??e.srcs,i=e.alias??e.name;let n;n="string"==typeof i?(t=this._createBundleAssetId(a,i),s.push(t),[i,t]):(t=i.map(e=>this._createBundleAssetId(a,e)),s.push(...t),[...i,...t]),this.add({...e,alias:n,src:r})}):Object.keys(i).forEach(e=>{var t,r=[e,this._createBundleAssetId(a,e)];"string"==typeof i[e]||Array.isArray(i[e])?this.add({alias:r,src:i[e]}):(t=(e=i[e]).src??e.srcs,this.add({...e,alias:r,src:Array.isArray(t)?t:[t]})),s.push(...r)}),this._bundles[a]=s}add(e,t,r,i,n){var a=[];"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]?(deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),a.push({alias:e,src:t,data:r,format:i,loadParser:n})):Array.isArray(e)?a.push(...e):a.push(e);let u;u=e=>{this.hasKey(e)},convertToList(a).forEach(e=>{var{src:t,srcs:r}=e;let{data:n,format:a,loadParser:s}=e,i=convertToList(t||r).map(e=>"string"==typeof e?createStringVariations(e):Array.isArray(e)?e:[e]),o=this.getAlias(e),l=(Array.isArray(o)?o.forEach(u):u(o),[]);i.forEach(e=>{e.forEach(t=>{let r={};if("object"!=typeof t){r.src=t;for(let e=0;e<this._parsers.length;e++){var i=this._parsers[e];if(i.test(t)){r=i.parse(t);break}}}else n=t.data??n,a=t.format??a,s=t.loadParser??s,r={...r,...t};if(!o)throw new Error("[Resolver] alias is undefined for this asset: "+r.src);r=this.buildResolvedAsset(r,{aliases:o,data:n,format:a,loadParser:s}),l.push(r)})}),o.forEach(e=>{this._assetMap[e]=l})})}resolveBundle(e){var t=isSingleItem(e);e=convertToList(e);let s={};return e.forEach(e=>{var t=this._bundles[e];if(t){var r,i=this.resolve(t),n={};for(r in i){var a=i[r];n[this._extractAssetIdFromBundle(e,r)]=a}s[e]=n}}),t?s[e[0]]:s}resolveUrl(e){var t=this.resolve(e);if("string"==typeof e)return t.src;var r,i={};for(r in t)i[r]=t[r].src;return i}resolve(e){var t=isSingleItem(e);e=convertToList(e);let i={};return e.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let i=this._assetMap[r],e=i[0],t=this._getPreferredOrder(i);null!=t&&t.priority.forEach(r=>{t.params[r].forEach(t=>{var e=i.filter(e=>!!e[r]&&e[r]===t);e.length&&(i=e)})}),this._resolverHash[r]=i[0]??e}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(r){for(let e=0;e<r.length;e++){let t=r[0],e=this._preferredOrder.find(e=>e.params.format.includes(t.format));if(e)return e}return this._preferredOrder[0]}_appendDefaultSearchParams(e){return this._defaultSearchParams?e+(/\?/.test(e)?"&":"?")+this._defaultSearchParams:e}buildResolvedAsset(e,t){var{aliases:t,data:r,loadParser:i,format:n}=t;return(this._basePath||this._rootPath)&&(e.src=path.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=t??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...r||{},...e.data},e.loadParser=i??e.loadParser,e.format=n??path.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}class AssetsClass{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Resolver,this.loader=new Loader,this.cache=Cache,this._backgroundLoader=new BackgroundLoader(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(!this._initialized){if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}var e=(null==(e=t.texturePreference)?void 0:e.resolution)??1,e="number"==typeof e?[e]:e,r=await this._detectFormats({preferredFormats:null==(r=t.texturePreference)?void 0:r.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:e}}),t.preferences&&this.setPreferences(t.preferences)}}add(e,t,r,i,n){this.resolver.add(e,t,r,i,n)}async load(e,t){this._initialized||await this.init();var r=isSingleItem(e),e=convertToList(e).map(e=>{var t;return"string"!=typeof e?((t=this.resolver.getAlias(e)).some(e=>!this.resolver.hasKey(e))&&this.add(e),Array.isArray(t)?t[0]:t):(this.resolver.hasKey(e)||this.add({alias:e,src:e}),e)}),i=this.resolver.resolve(e),i=await this._mapLoadToResolve(i,t);return r?i[e[0]]:i}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let r=!1,i=("string"==typeof e&&(r=!0,e=[e]),this.resolver.resolveBundle(e)),n={},a=Object.keys(i),s=0,o=0,l=()=>{null!=t&&t(++s/o)},u=a.map(t=>{var e=i[t];return o+=Object.keys(e).length,this._mapLoadToResolve(e,l).then(e=>{n[t]=e})});return await Promise.all(u),r?n[e[0]]:n}async backgroundLoad(e){this._initialized||await this.init();e=this.resolver.resolve(e="string"==typeof e?[e]:e);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(e){this._initialized||await this.init();e=this.resolver.resolveBundle(e="string"==typeof e?[e]:e);Object.values(e).forEach(e=>{this._backgroundLoader.add(Object.values(e))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return Cache.get(t);var r={};for(let e=0;e<t.length;e++)r[e]=Cache.get(t[e]);return r}async _mapLoadToResolve(e,t){let r=Object.values(e),n=Object.keys(e),a=(this._backgroundLoader.active=!1,await this.loader.load(r,t)),s=(this._backgroundLoader.active=!0,{});return r.forEach((e,t)=>{var r=a[e.src],i=[e.src];e.alias&&i.push(...e.alias),s[n[t]]=r,Cache.set(i,r)}),s}async unload(e){this._initialized||await this.init();e=convertToList(e).map(e=>"string"!=typeof e?e.src:e),e=this.resolver.resolve(e);await this._unloadFromResolved(e)}async unloadBundle(e){this._initialized||await this.init(),e=convertToList(e);let t=this.resolver.resolveBundle(e),r=Object.keys(t).map(e=>this._unloadFromResolved(t[e]));await Promise.all(r)}async _unloadFromResolved(e){e=Object.values(e);e.forEach(e=>{Cache.remove(e.src)}),await this.loader.unload(e)}async _detectFormats(e){let r=[];e.preferredFormats&&(r=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(var t of e.detections)e.skipDetections||await t.test()?r=await t.add(r):e.skipDetections||(r=await t.remove(r));return r=r.filter((e,t)=>r.indexOf(e)===t)}get detections(){return this._detections}get preferWorkers(){return loadTextures.config.preferWorkers}set preferWorkers(e){deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(r){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(e=>e in r).forEach(e=>{t.config[e]=r[e]})})}}let Assets=new AssetsClass,cacheTextureArray=(extensions$1.handleByList(ExtensionType.LoadParser,Assets.loader.parsers).handleByList(ExtensionType.ResolveParser,Assets.resolver.parsers).handleByList(ExtensionType.CacheParser,Assets.cache.parsers).handleByList(ExtensionType.DetectionParser,Assets.detections),{extension:ExtensionType.CacheParser,test:e=>Array.isArray(e)&&e.every(e=>e instanceof Texture),getCacheableAssets:(e,t)=>{let i={};return e.forEach(r=>{t.forEach((e,t)=>{i[r+(0===t?"":t+1)]=e})}),i}});async function testImageFormat(r){if("Image"in globalThis)return new Promise(e=>{var t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{var e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}extensions$1.add(cacheTextureArray);let detectAvif={extension:{type:ExtensionType.DetectionParser,priority:1},test:async()=>testImageFormat("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter(e=>"avif"!==e)},detectWebp=(extensions$1.add(detectAvif),{extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testImageFormat("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter(e=>"webp"!==e)}),imageFormats=(extensions$1.add(detectWebp),["png","jpg","jpeg"]),detectDefaults={extension:{type:ExtensionType.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...imageFormats],remove:async e=>e.filter(e=>!imageFormats.includes(e))},inWorker=(extensions$1.add(detectDefaults),"WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope);function testVideoFormat(e){return!inWorker&&""!==document.createElement("video").canPlayType(e)}let detectWebm={extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter(e=>"webm"!==e)},detectMp4=(extensions$1.add(detectWebm),{extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter(e=>"mp4"!==e&&"m4v"!==e)}),detectOgv=(extensions$1.add(detectMp4),{extension:{type:ExtensionType.DetectionParser,priority:0},test:async()=>testVideoFormat("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter(e=>"ogv"!==e)}),resolveTextureUrl=(extensions$1.add(detectOgv),{extension:ExtensionType.ResolveParser,test:loadTextures.test,parse:e=>{var t;return{resolution:parseFloat((null==(t=settings.RETINA_PREFIX.exec(e))?void 0:t[1])??"1"),format:path.extname(e).slice(1),src:e}}});extensions$1.add(resolveTextureUrl);var INTERNAL_FORMATS=(e=>(e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e))(INTERNAL_FORMATS||{});let INTERNAL_FORMAT_TO_BYTES_PER_PIXEL={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1,36492:1,36493:1,36494:1,36495:1},storedGl,extensions;function getCompressedTextureExtensions(){extensions={s3tc:storedGl.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:storedGl.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:storedGl.getExtension("WEBGL_compressed_texture_etc"),etc1:storedGl.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:storedGl.getExtension("WEBGL_compressed_texture_pvrtc")||storedGl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:storedGl.getExtension("WEBGL_compressed_texture_atc"),astc:storedGl.getExtension("WEBGL_compressed_texture_astc"),bptc:storedGl.getExtension("EXT_texture_compression_bptc")}}let detectCompressedTextures={extension:{type:ExtensionType.DetectionParser,priority:2},test:async()=>{var e=settings.ADAPTER.createCanvas().getContext("webgl");return!!e&&(storedGl=e,!0)},add:async e=>{extensions||getCompressedTextureExtensions();var t,r=[];for(t in extensions)extensions[t]&&r.push(t);return[...r,...e]},remove:async e=>(extensions||getCompressedTextureExtensions(),e.filter(e=>!(e in extensions)))};extensions$1.add(detectCompressedTextures);class BlobResource extends BufferResource{constructor(e,t={width:1,height:1,autoLoad:!0}){let r,i;super(i="string"==typeof e?(r=e,new Uint8Array):(r=null,e),t),this.origin=r,this.buffer=i?new ViewableBuffer(i):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==t.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load||(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new ViewableBuffer(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this)),this._load)}}class CompressedTextureResource extends BlobResource{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=CompressedTextureResource._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||CompressedTextureResource._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,r){var i=e.gl;if(!e.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let e=0,t=this.levels;e<t;e++){var{levelID:n,levelWidth:a,levelHeight:s,levelBuffer:o}=this._levelBuffers[e];i.compressedTexImage2D(i.TEXTURE_2D,n,this.format,a,s,0,o)}return!0}onBlobLoaded(){this._levelBuffers=CompressedTextureResource._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(33776<=e&&e<=33779)return"s3tc";if(35916<=e&&e<=35919)return"s3tc_sRGB";if(37488<=e&&e<=37497)return"etc";if(35840<=e&&e<=35843)return"pvrtc";if(36196===e)return"etc1";if(35986===e||35987===e||34798===e)return"atc";if(36492<=e&&e<=36495)return"bptc";if(37808===e)return"astc";throw new Error("Invalid (compressed) texture format given: "+e)}static _createLevelBuffers(t,r,i,n,a,e,s){var o=new Array(i);let l=t.byteOffset,u=e,c=s,h=u+n-1&~(n-1),d=c+a-1&~(a-1),p=h*d*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[r];for(let e=0;e<i;e++)o[e]={levelID:e,levelWidth:1<i?u:h,levelHeight:1<i?c:d,levelBuffer:new Uint8Array(t.buffer,l,p)},l+=p,u=u>>1||1,c=c>>1||1,h=u+n-1&~(n-1),d=c+a-1&~(a-1),p=h*d*INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[r];return o}}let DDS_MAGIC_SIZE=4,DDS_HEADER_SIZE=124,DDS_HEADER_PF_SIZE=32,DDS_HEADER_DX10_SIZE=20,DDS_MAGIC=542327876,DDS_FIELDS={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},DDS_PF_FIELDS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},DDS_DX10_FIELDS={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},PF_FLAGS=1,DDPF_ALPHA=2,DDPF_FOURCC=4,DDPF_RGB=64,DDPF_YUV=512,DDPF_LUMINANCE=131072,FOURCC_DXT1=827611204,FOURCC_DXT3=861165636,FOURCC_DXT5=894720068,FOURCC_DX10=808540228,DDS_RESOURCE_MISC_TEXTURECUBE=4,FOURCC_TO_FORMAT={[FOURCC_DXT1]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,[FOURCC_DXT3]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,[FOURCC_DXT5]:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT},DXGI_TO_FORMAT={70:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:INTERNAL_FORMATS.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,96:INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,95:INTERNAL_FORMATS.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,98:INTERNAL_FORMATS.COMPRESSED_RGBA_BPTC_UNORM_EXT,99:INTERNAL_FORMATS.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT};function parseDDS(o){var l=new Uint32Array(o);if(l[0]!==DDS_MAGIC)throw new Error("Invalid DDS file magic word");let e=new Uint32Array(o,0,DDS_HEADER_SIZE/Uint32Array.BYTES_PER_ELEMENT),u=e[DDS_FIELDS.HEIGHT],c=e[DDS_FIELDS.WIDTH],h=e[DDS_FIELDS.MIPMAP_COUNT],d=new Uint32Array(o,DDS_FIELDS.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,DDS_HEADER_PF_SIZE/Uint32Array.BYTES_PER_ELEMENT),t=d[PF_FLAGS];if(t&DDPF_FOURCC){var p=d[DDS_PF_FIELDS.FOURCC];if(p!==FOURCC_DX10)return p=FOURCC_TO_FORMAT[p],m=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,m=new Uint8Array(o,m),[new CompressedTextureResource(m,{format:p,width:c,height:u,levels:h})];let e=DDS_MAGIC_SIZE+DDS_HEADER_SIZE,t=new Uint32Array(l.buffer,e,DDS_HEADER_DX10_SIZE/Uint32Array.BYTES_PER_ELEMENT),r=t[DDS_DX10_FIELDS.DXGI_FORMAT],i=t[DDS_DX10_FIELDS.RESOURCE_DIMENSION],n=t[DDS_DX10_FIELDS.MISC_FLAG],a=t[DDS_DX10_FIELDS.ARRAY_SIZE],s=DXGI_TO_FORMAT[r];if(void 0===s)throw new Error("DDSParser cannot parse texture data with DXGI format "+r);if(n===DDS_RESOURCE_MISC_TEXTURECUBE)throw new Error("DDSParser does not support cubemap textures");if(6===i)throw new Error("DDSParser does not supported 3D texture data");var f=new Array,m=DDS_MAGIC_SIZE+DDS_HEADER_SIZE+DDS_HEADER_DX10_SIZE;if(1===a)f.push(new Uint8Array(o,m));else{var g=INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[s];let t=0,r=c,i=u;for(let e=0;e<h;e++){var v=Math.max(1,r+3&-4),y=Math.max(1,i+3&-4);t+=v*y*g,r>>>=1,i>>>=1}let n=m;for(let e=0;e<a;e++)f.push(new Uint8Array(o,n,t)),n+=t}return f.map(e=>new CompressedTextureResource(e,{format:s,width:c,height:u,levels:h}))}throw t&DDPF_RGB?new Error("DDSParser does not support uncompressed texture data."):t&DDPF_YUV?new Error("DDSParser does not supported YUV uncompressed texture data."):t&DDPF_LUMINANCE?new Error("DDSParser does not support single-channel (lumninance) texture data!"):t&DDPF_ALPHA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}let FILE_IDENTIFIER=[171,75,84,88,32,49,49,187,13,10,26,10],ENDIANNESS=67305985,KTX_FIELDS={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},FILE_HEADER_SIZE=64,TYPES_TO_BYTES_PER_COMPONENT={[TYPES.UNSIGNED_BYTE]:1,[TYPES.UNSIGNED_SHORT]:2,[TYPES.INT]:4,[TYPES.UNSIGNED_INT]:4,[TYPES.FLOAT]:4,[TYPES.HALF_FLOAT]:8},FORMATS_TO_COMPONENTS={[FORMATS.RGBA]:4,[FORMATS.RGB]:3,[FORMATS.RG]:2,[FORMATS.RED]:1,[FORMATS.LUMINANCE]:1,[FORMATS.LUMINANCE_ALPHA]:2,[FORMATS.ALPHA]:1},TYPES_TO_BYTES_PER_PIXEL={[TYPES.UNSIGNED_SHORT_4_4_4_4]:2,[TYPES.UNSIGNED_SHORT_5_5_5_1]:2,[TYPES.UNSIGNED_SHORT_5_6_5]:2};function parseKTX(e,n,t=!1){var a=new DataView(n);if(!validate(e,a))return null;let s=a.getUint32(KTX_FIELDS.ENDIANNESS,!0)===ENDIANNESS,o=a.getUint32(KTX_FIELDS.GL_TYPE,s),i=a.getUint32(KTX_FIELDS.GL_FORMAT,s),r=a.getUint32(KTX_FIELDS.GL_INTERNAL_FORMAT,s),l=a.getUint32(KTX_FIELDS.PIXEL_WIDTH,s),u=a.getUint32(KTX_FIELDS.PIXEL_HEIGHT,s)||1,c=a.getUint32(KTX_FIELDS.PIXEL_DEPTH,s)||1,h=a.getUint32(KTX_FIELDS.NUMBER_OF_ARRAY_ELEMENTS,s)||1,d=a.getUint32(KTX_FIELDS.NUMBER_OF_FACES,s),p=a.getUint32(KTX_FIELDS.NUMBER_OF_MIPMAP_LEVELS,s),f=a.getUint32(KTX_FIELDS.BYTES_OF_KEY_VALUE_DATA,s);if(0===u||1!==c)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==h)throw new Error("WebGL does not support array textures");var e=l+3&-4,m=u+3&-4,g=new Array(h);let v=l*u;0===o&&(v=e*m);let y;if(void 0===(y=0!==o?TYPES_TO_BYTES_PER_COMPONENT[o]?TYPES_TO_BYTES_PER_COMPONENT[o]*FORMATS_TO_COMPONENTS[i]:TYPES_TO_BYTES_PER_PIXEL[o]:INTERNAL_FORMAT_TO_BYTES_PER_PIXEL[r]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");t=t?parseKvData(a,f,s):null;let _=v*y,b=l,x=u,S=e,T=m,E=FILE_HEADER_SIZE+f;for(let i=0;i<p;i++){var C=a.getUint32(E,s);let r=E+4;for(let t=0;t<h;t++){let e=g[t];(e=e||(g[t]=new Array(p)))[i]={levelID:i,levelWidth:1<p||0!==o?b:S,levelHeight:1<p||0!==o?x:T,levelBuffer:new Uint8Array(n,r,_)},r+=_}E=(E+=C+4)%4!=0?E+4-E%4:E,b=b>>1||1,x=x>>1||1,S=b+4-1&-4,T=x+4-1&-4,_=S*T*y}return 0!==o?{uncompressed:g.map(e=>{let t=e[0].levelBuffer,r=!1;return o===TYPES.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):o===TYPES.UNSIGNED_INT?(r=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):o===TYPES.INT&&(r=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new BufferResource(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:o,format:r?convertFormatToInteger(i):i}}),kvData:t}:{compressed:g.map(e=>new CompressedTextureResource(null,{format:r,width:l,height:u,levels:p,levelBuffers:e})),kvData:t}}function validate(e,t){for(let e=0;e<FILE_IDENTIFIER.length;e++)if(t.getUint8(e)!==FILE_IDENTIFIER[e])return!1;return!0}function convertFormatToInteger(e){switch(e){case FORMATS.RGBA:return FORMATS.RGBA_INTEGER;case FORMATS.RGB:return FORMATS.RGB_INTEGER;case FORMATS.RG:return FORMATS.RG_INTEGER;case FORMATS.RED:return FORMATS.RED_INTEGER;default:return e}}function parseKvData(t,r,i){var n=new Map;let a=0;for(;a<r;){var s=t.getUint32(FILE_HEADER_SIZE+a,i),o=FILE_HEADER_SIZE+a+4,l=3-(s+3)%4;if(0===s||s>r-a)break;let e=0;for(;e<s&&0!==t.getUint8(o+e);e++);if(-1===e)break;var u=(new TextDecoder).decode(new Uint8Array(t.buffer,o,e)),c=new DataView(t.buffer,o+e+1,s-e-1);n.set(u,c),a+=4+s+l}return n}let loadDDS={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadDDS",test(e){return checkExtension(e,".dds")},async load(t,r,i){var e=parseDDS(await(await settings.ADAPTER.fetch(t)).arrayBuffer()).map(e=>createTexture(new BaseTexture(e,{mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(t),...r.data}),i,t));return 1===e.length?e[0]:e},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}},loadKTX=(extensions$1.add(loadDDS),{extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.High},name:"loadKTX",test(e){return checkExtension(e,".ktx")},async load(t,e,r){let i=await(await settings.ADAPTER.fetch(t)).arrayBuffer(),{compressed:n,uncompressed:a,kvData:s}=parseKTX(t,i),o=n??a,l={mipmap:MIPMAP_MODES.OFF,alphaMode:ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,resolution:getResolutionOfUrl(t),...e.data},u=o.map(e=>{o===a&&Object.assign(l,{type:e.type,format:e.format});e=e.resource??e,e=new BaseTexture(e,l);return e.ktxKeyValueData=s,createTexture(e,r,t)});return 1===u.length?u[0]:u},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}}),resolveCompressedTextureUrl=(extensions$1.add(loadKTX),{extension:ExtensionType.ResolveParser,test:e=>{e=path.extname(e).slice(1);return["basis","ktx","dds"].includes(e)},parse:t=>{var e,r=path.extname(t).slice(1);if("ktx"===r){var i=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx",".bptc.ktx"];if(i.some(e=>t.endsWith(e)))return{resolution:parseFloat((null==(e=settings.RETINA_PREFIX.exec(t))?void 0:e[1])??"1"),format:i.find(e=>t.endsWith(e)),src:t}}return{resolution:parseFloat((null==(e=settings.RETINA_PREFIX.exec(t))?void 0:e[1])??"1"),format:r,src:t}}}),TEMP_RECT=(extensions$1.add(resolveCompressedTextureUrl),new Rectangle),BYTES_PER_PIXEL=4,_Extract=class _Extract2{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){var e=null==(e=this.renderer)?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,r,i){var n=new Image;return n.src=await this.base64(e,t,r,i),n}async base64(e,t,n,r){let a=this.canvas(e,r);if(void 0!==a.toBlob)return new Promise((r,i)=>{a.toBlob(t=>{if(t){let e=new FileReader;e.onload=()=>r(e.result),e.onerror=i,e.readAsDataURL(t)}else i(new Error("ICanvas.toBlob failed!"))},t,n)});if(void 0!==a.toDataURL)return a.toDataURL(t,n);if(void 0===a.convertToBlob)throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented");{let i=await a.convertToBlob({type:t,quality:n});return new Promise((e,t)=>{let r=new FileReader;r.onload=()=>e(r.result),r.onerror=t,r.readAsDataURL(i)})}}canvas(e,t){var{pixels:e,width:t,height:r,flipY:i,premultipliedAlpha:n}=this._rawPixels(e,t),i=(i&&_Extract2._flipY(e,t,r),n&&_Extract2._unpremultiplyAlpha(e),new CanvasRenderTarget(t,r,1)),n=new ImageData(new Uint8ClampedArray(e.buffer),t,r);return i.context.putImageData(n,0,0),i.canvas}pixels(e,t){var{pixels:e,width:t,height:r,flipY:i,premultipliedAlpha:n}=this._rawPixels(e,t);return i&&_Extract2._flipY(e,t,r),n&&_Extract2._unpremultiplyAlpha(e),e}_rawPixels(e,t){var r=this.renderer;if(!r)throw new Error("The Extract has already been destroyed");let i,n=!1,a=!1,s,o=!1;e&&(e instanceof RenderTexture?s=e:(s=r.generateTexture(e,{region:t,resolution:r.resolution,multisample:r.multisample}),o=!0,t&&(TEMP_RECT.width=t.width,TEMP_RECT.height=t.height,t=TEMP_RECT)));var e=r.gl,l=(s?(i=s.baseTexture.resolution,t=t??s.frame,n=!1,a=0<s.baseTexture.alphaMode&&s.baseTexture.format===FORMATS.RGBA,o||(r.renderTexture.bind(s),(l=s.framebuffer.glFramebuffers[r.CONTEXT_UID]).blitFramebuffer&&r.framebuffer.bind(l.blitFramebuffer))):(i=r.resolution,t||((t=TEMP_RECT).width=r.width/i,t.height=r.height/i),n=!0,a=this._rendererPremultipliedAlpha,r.renderTexture.bind()),Math.max(Math.round(t.width*i),1)),r=Math.max(Math.round(t.height*i),1),u=new Uint8Array(BYTES_PER_PIXEL*l*r);return e.readPixels(Math.round(t.x*i),Math.round(t.y*i),l,r,e.RGBA,e.UNSIGNED_BYTE,u),o&&null!=s&&s.destroy(!0),{pixels:u,width:l,height:r,flipY:n,premultipliedAlpha:a}}destroy(){this.renderer=null}static _flipY(t,e,r){var i=e<<2,n=r>>1,a=new Uint8Array(i);for(let e=0;e<n;e++){var s=e*i,o=(r-e-1)*i;a.set(t.subarray(s,s+i)),t.copyWithin(s,o,o+i),t.set(a,o)}}static _unpremultiplyAlpha(t){var r=(t=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t).length;for(let e=0;e<r;e+=4){var i=t[e+3];0!==i&&(i=255.001/i,t[e]=t[e]*i+.5,t[e+1]=t[e+1]*i+.5,t[e+2]=t[e+2]*i+.5)}}},Extract=(_Extract.extension={name:"extract",type:ExtensionType.RendererSystem},_Extract),buildCircle=(extensions$1.add(Extract),{build(e){var a=e.points;let s,o,l,u,c,h;if(e.type===SHAPES.CIRC?(p=e.shape,s=p.x,o=p.y,c=h=p.radius,l=u=0):e.type===SHAPES.ELIP?(p=e.shape,s=p.x,o=p.y,c=p.width,h=p.height,l=u=0):(e=(p=e.shape).width/2,f=p.height/2,s=p.x+e,o=p.y+f,c=h=Math.max(0,Math.min(p.radius,Math.min(e,f))),l=e-c,u=f-h),0<=c&&0<=h&&0<=l&&0<=u){var d=Math.ceil(2.3*Math.sqrt(c+h)),p=8*d+(l?4:0)+(u?4:0);if(0!=(a.length=p))if(0===d)a.length=8,a[0]=a[6]=s+l,a[1]=a[3]=o+u,a[2]=a[4]=s-l,a[5]=a[7]=o-u;else{let t=0,r=4*d+(l?2:0)+2,i=r,n=p;var e=l+c,f=u,p=s+e,e=s-e,m=o+f;a[t++]=p,a[t++]=m,a[--r]=m,a[--r]=e,u&&(m=o-f,a[i++]=e,a[i++]=m,a[--n]=m,a[--n]=p);for(let e=1;e<d;e++){var g=Math.PI/2*(e/d),v=l+Math.cos(g)*c,g=u+Math.sin(g)*h,y=s+v,v=s-v,_=o+g,g=o-g;a[t++]=y,a[t++]=_,a[--r]=_,a[--r]=v,a[i++]=v,a[i++]=g,a[--n]=g,a[--n]=y}f=l,e=u+h,m=s+f,p=s-f,f=o+e,e=o-e;a[t++]=m,a[t++]=f,a[--n]=e,a[--n]=m,l&&(a[t++]=p,a[t++]=f,a[--n]=e,a[--n]=p)}}else a.length=0},triangulate(i,n){var a=i.points,s=n.points,o=n.indices;if(0!==a.length){let t=s.length/2;var l=t;let e,r;r=i.type!==SHAPES.RREC?(n=i.shape,e=n.x,n.y):(n=i.shape,e=n.x+n.width/2,n.y+n.height/2);n=i.matrix;s.push(i.matrix?n.a*e+n.c*r+n.tx:e,i.matrix?n.b*e+n.d*r+n.ty:r),t++,s.push(a[0],a[1]);for(let e=2;e<a.length;e+=2)s.push(a[e],a[e+1]),o.push(t++,l,t);o.push(l+1,l,t)}}});function fixOrientation(n,t=!1){var a=n.length;if(!(a<6)){let i=0;for(let e=0,t=n[a-2],r=n[a-1];e<a;e+=2){var s=n[e],o=n[e+1];i+=(s-t)*(o+r),t=s,r=o}if(!t&&0<i||t&&i<=0){t=a/2;for(let e=t+t%2;e<a;e+=2){var r=a-e-2,l=a-e-1,u=e,c=e+1;[n[r],n[u]]=[n[u],n[r]],[n[l],n[c]]=[n[c],n[l]]}}}}let buildPoly={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points;var i=e.holes,n=t.points,a=t.indices;if(6<=r.length){fixOrientation(r,!1);var s=[];for(let e=0;e<i.length;e++){var o=i[e];fixOrientation(o.points,!0),s.push(r.length/2),r=r.concat(o.points)}var l=earcut$1(r,s,2);if(l){var u=n.length/2;for(let e=0;e<l.length;e+=3)a.push(l[e]+u),a.push(l[e+1]+u),a.push(l[e+2]+u);for(let e=0;e<r.length;e++)n.push(r[e])}}}},buildRectangle={build(e){var t=e.shape,r=t.x,i=t.y,n=t.width,t=t.height,e=e.points;(e.length=0)<=n&&0<=t&&e.push(r,i,r+n,i,r+n,i+t,r,i+t)},triangulate(e,t){var r,e=e.points,i=t.points;0!==e.length&&(r=i.length/2,i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,1+r,2+r,1+r,2+r,3+r))}},buildRoundedRectangle={build(e){buildCircle.build(e)},triangulate(e,t){buildCircle.triangulate(e,t)}};var LINE_JOIN=(e=>(e.MITER="miter",e.BEVEL="bevel",e.ROUND="round",e))(LINE_JOIN||{}),LINE_CAP=(e=>(e.BUTT="butt",e.ROUND="round",e.SQUARE="square",e))(LINE_CAP||{});let curves={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},GRAPHICS_CURVES=curves;class ArcUtils{static curveTo(e,t,r,i,n,a){var s,o,l,u,c=a[a.length-2],h=a[a.length-1]-t,c=c-e,i=i-t,r=r-e,d=Math.abs(h*r-c*i);return d<1e-8||0===n?(a[a.length-2]===e&&a[a.length-1]===t||a.push(e,t),null):(a=h*h+c*c,l=i*i+r*r,u=h*i+c*r,a=(s=n*Math.sqrt(a)/d)*u/a,l=r*(s+(u=(d=n*Math.sqrt(l)/d)*u/l)),u=i*(s+u),{cx:(o=s*r+d*c)+e,cy:(e=s*i+d*h)+t,radius:n,startAngle:Math.atan2(h*(d+a)-e,c*(d+a)-o),endAngle:Math.atan2(u-e,l-o),anticlockwise:r*h<c*i})}static arc(e,t,r,i,n,a,s,o,l){var s=s-a,u=curves._segmentsCount(Math.abs(s)*n,40*Math.ceil(Math.abs(s)/PI_2)),c=s/(2*u),h=2*c,d=Math.cos(c),p=Math.sin(c),f=u-1,m=f%1/f;for(let e=0;e<=f;++e){var g=c+a+h*(e+m*e),v=Math.cos(g),g=-Math.sin(g);l.push((d*v+p*g)*n+r,(d*-g+p*v)*n+i)}}}class BatchPart{constructor(){this.reset()}begin(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class BezierUtils{static curveLength(t,r,i,n,a,s,o,l){let u=0,c,h,d,p,f,m,g,v,y,_,b=t,x=r;for(let e=1;e<=10;++e)g=(m=(f=(p=1-(c=e/10))*p)*p)*t+3*f*c*i+3*p*(h=c*c)*a+(d=h*c)*o,v=m*r+3*f*c*n+3*p*h*s+d*l,y=b-g,_=x-v,b=g,x=v,u+=Math.sqrt(y*y+_*_);return u}static curveTo(r,i,n,a,s,o,l){var u,c,h,d,p,f=l[l.length-2],m=l[l.length-1],g=(l.length-=2,curves._segmentsCount(BezierUtils.curveLength(f,m,r,i,n,a,s,o)));l.push(f,m);for(let e=1,t;e<=g;++e)t=e/g,l.push((h=(c=(u=1-t)*u)*u)*f+3*c*t*r+3*u*(d=t*t)*n+(p=d*t)*s,h*m+3*c*t*i+3*u*d*a+p*o)}}function square(e,t,r,i,n,a,s,o){let l,u;u=s?(l=i,-r):(l=-i,r);s=e-r*n+l,n=t-i*n+u,e=e+r*a+l,r=t+i*a+u;return o.push(s,n,e,r),2}function round(r,i,e,t,n,a,s,o){var l=e-r,u=t-i;let c=Math.atan2(l,u),h=Math.atan2(n-r,a-i);o&&c<h?c+=2*Math.PI:!o&&c>h&&(h+=2*Math.PI);var d=c,p=h-c,f=Math.abs(p),m=Math.sqrt(l*l+u*u),g=1+(15*f*Math.sqrt(m)/Math.PI>>0),v=p/g;if(d+=v,o){s.push(r,i,e,t);for(let e=1,t=d;e<g;e++,t+=v)s.push(r,i,r+Math.sin(t)*m,i+Math.cos(t)*m);s.push(r,i,n,a)}else{s.push(e,t,r,i);for(let e=1,t=d;e<g;e++,t+=v)s.push(r+Math.sin(t)*m,i+Math.cos(t)*m,r,i);s.push(n,a,r,i)}return 2*g}function buildNonNativeLine(e,p){var f=e.shape;let m=e.points||f.points.slice();var g=p.closePointEps;if(0!==m.length){var v=e.lineStyle,e=new Point(m[0],m[1]),y=new Point(m[m.length-2],m[m.length-1]),f=f.type!==SHAPES.POLY||f.closeStroke,g=Math.abs(e.x-y.x)<g&&Math.abs(e.y-y.y)<g,_=(f&&(m=m.slice(),g&&(m.pop(),m.pop(),y.set(m[m.length-2],m[m.length-1])),g=.5*(e.x+y.x),y=.5*(y.y+e.y),m.unshift(g,y),m.push(g,y)),p.points),b=m.length/2;let t=m.length;var x=_.length/2,S=v.width/2,T=S*S,E=v.miterLimit*v.miterLimit;let r=m[0],i=m[1],n=m[2],a=m[3],s=0,o=0,l=-(i-a),u=r-n,c=0,h=0,d=Math.sqrt(l*l+u*u);l/=d,u/=d,l*=S,u*=S;var e=v.alignment,C=2*(1-e),A=2*e;f||(v.cap===LINE_CAP.ROUND?t+=round(r-l*(C-A)*.5,i-u*(C-A)*.5,r-l*C,i-u*C,r+l*A,i+u*A,_,!0)+2:v.cap===LINE_CAP.SQUARE&&(t+=square(r,i,l,u,C,A,!0,_))),_.push(r-l*C,i-u*C,r+l*A,i+u*A);for(let e=1;e<b-1;++e){r=m[2*(e-1)],i=m[2*(e-1)+1],n=m[2*e],a=m[2*e+1],s=m[2*(e+1)],o=m[2*(e+1)+1],l=-(i-a),u=r-n,d=Math.sqrt(l*l+u*u),l/=d,u/=d,l*=S,u*=S,c=-(a-o),h=n-s,c=c/(d=Math.sqrt(c*c+h*h))*S,h=h/d*S;var w=n-r,P=i-a,M=n-s,I=o-a,D=w*M+P*I,R=P*M-I*w,k=R<0;if(Math.abs(R)<.001*Math.abs(D))_.push(n-l*C,a-u*C,n+l*A,a+u*A),0<=D&&(v.join===LINE_JOIN.ROUND?t+=round(n,a,n-l*C,a-u*C,n-c*C,a-h*C,_,!1)+4:t+=2,_.push(n-c*A,a-h*A,n+c*C,a+h*C));else{var D=(-l+r)*(-u+a)-(-l+n)*(-u+i),O=(-c+s)*(-h+a)-(-c+n)*(-h+o),F=(w*O-M*D)/R,D=(I*D-P*O)/R,O=(F-n)*(F-n)+(D-a)*(D-a),$=n+(F-n)*C,B=a+(D-a)*C,L=n-(F-n)*A,N=a-(D-a)*A,R=Math.min(w*w+P*P,M*M+I*I),F=k?C:A;let e=v.join;if(e===LINE_JOIN.MITER&&E<O/T&&(e=LINE_JOIN.BEVEL),O<=R+F*F*T)switch(e){case LINE_JOIN.MITER:_.push($,B,L,N);break;case LINE_JOIN.BEVEL:k?_.push($,B,n+l*A,a+u*A,$,B,n+c*A,a+h*A):_.push(n-l*C,a-u*C,L,N,n-c*C,a-h*C,L,N),t+=2;break;case LINE_JOIN.ROUND:k?(_.push($,B,n+l*A,a+u*A),t+=round(n,a,n+l*A,a+u*A,n+c*A,a+h*A,_,!0)+4,_.push($,B,n+c*A,a+h*A)):(_.push(n-l*C,a-u*C,L,N),t+=round(n,a,n-l*C,a-u*C,n-c*C,a-h*C,_,!1)+4,_.push(n-c*C,a-h*C,L,N))}else{switch(_.push(n-l*C,a-u*C,n+l*A,a+u*A),e){case LINE_JOIN.MITER:k?_.push(L,N,L,N):_.push($,B,$,B),t+=2;break;case LINE_JOIN.ROUND:t+=k?round(n,a,n+l*A,a+u*A,n+c*A,a+h*A,_,!0)+2:round(n,a,n-l*C,a-u*C,n-c*C,a-h*C,_,!1)+2}_.push(n-c*C,a-h*C,n+c*A,a+h*A),t+=2}}}r=m[2*(b-2)],i=m[2*(b-2)+1],n=m[2*(b-1)],a=m[2*(b-1)+1],l=-(i-a),u=r-n,d=Math.sqrt(l*l+u*u),l/=d,u/=d,l*=S,u*=S,_.push(n-l*C,a-u*C,n+l*A,a+u*A),f||(v.cap===LINE_CAP.ROUND?t+=round(n-l*(C-A)*.5,a-u*(C-A)*.5,n-l*C,a-u*C,n+l*A,a+u*A,_,!1)+2:v.cap===LINE_CAP.SQUARE&&(t+=square(n,a,l,u,C,A,!1,_)));var G=p.indices,z=curves.epsilon*curves.epsilon;for(let e=x;e<t+x-2;++e)r=_[2*e],i=_[2*e+1],n=_[2*(e+1)],a=_[2*(e+1)+1],s=_[2*(e+2)],o=_[2*(e+2)+1],Math.abs(r*(a-o)+n*(o-i)+s*(i-a))<z||G.push(e,e+1,e+2)}}function buildNativeLine(t,r){let i=0;var n=t.shape,a=t.points||n.points,t=n.type!==SHAPES.POLY||n.closeStroke;if(0!==a.length){var s=r.points,o=r.indices,l=a.length/2,n=s.length/2;let e=n;for(s.push(a[0],a[1]),i=1;i<l;i++)s.push(a[2*i],a[2*i+1]),o.push(e,e+1),e++;t&&o.push(e,n)}}function buildLine(e,t){(e.lineStyle.native?buildNativeLine:buildNonNativeLine)(e,t)}class QuadraticUtils{static curveLength(e,t,r,i,n,a){var n=e-2*r+n,a=t-2*i+a,r=2*r-2*e,e=2*i-2*t,i=4*(n*n+a*a),t=4*(n*r+a*e),n=r*r+e*e,a=2*Math.sqrt(i+t+n),r=Math.sqrt(i),e=2*i*r,s=2*Math.sqrt(n),o=t/r;return(e*a+r*t*(a-s)+(4*n*i-t*t)*Math.log((2*r+o+a)/(o+s)))/(4*e)}static curveTo(t,r,i,n,a){var s=a[a.length-2],o=a[a.length-1],l=curves._segmentsCount(QuadraticUtils.curveLength(s,o,t,r,i,n));for(let e=1;e<=l;++e){var u,c=e/l;a.push((u=s+(t-s)*c)+(t+(i-t)*c-u)*c,(u=o+(r-o)*c)+(r+(n-r)*c-u)*c)}}}let FILL_COMMANDS={[SHAPES.POLY]:buildPoly,[SHAPES.CIRC]:buildCircle,[SHAPES.ELIP]:buildCircle,[SHAPES.RECT]:buildRectangle,[SHAPES.RREC]:buildRoundedRectangle},BATCH_POOL=[],DRAW_CALL_POOL=[];class GraphicsData{constructor(e,t=null,r=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=i,this.type=e.type}clone(){return new GraphicsData(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}let tmpPoint=new Point,_GraphicsGeometry=class _GraphicsGeometry2 extends BatchGeometry{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Bounds,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0;for(let e=this.textureIds.length=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[e]);for(let e=this.drawCalls.length=0;e<this.batches.length;e++){var t=this.batches[e];t.reset(),BATCH_POOL.push(t)}this.batches.length=0}clear(){return 0<this.graphicsData.length&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){e=new GraphicsData(e,t,r,i);return this.graphicsData.push(e),this.dirty++,this}drawHole(e,t=null){return this.graphicsData.length?(e=new GraphicsData(e,null,null,t),t=this.graphicsData[this.graphicsData.length-1],e.lineStyle=t.lineStyle,t.holes.push(e),this.dirty++,this):null}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){var r=this.graphicsData;for(let e=0;e<r.length;++e){var i=r[e];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,tmpPoint):tmpPoint.copyFrom(t),i.shape.contains(tmpPoint.x,tmpPoint.y))){let t=!1;if(i.holes)for(let e=0;e<i.holes.length;e++)if(i.holes[e].shape.contains(tmpPoint.x,tmpPoint.y)){t=!0;break}if(!t)return!0}}return!1}updateBatches(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var i=this.uvs,n=this.graphicsData;let t=null,r=null;0<this.batches.length&&(t=this.batches[this.batches.length-1],r=t.style);for(let e=this.shapeIndex;e<n.length;e++){this.shapeIndex++;var a=n[e],s=a.fillStyle,o=a.lineStyle;FILL_COMMANDS[a.type].build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(s.visible||o.visible)&&this.processHoles(a.holes);for(let e=0;e<2;e++){var l,u,c,h=0===e?s:o;h.visible&&(c=h.texture.baseTexture,l=this.indices.length,u=this.points.length/2,c.wrapMode=WRAP_MODES.REPEAT,0===e?this.processFill(a):this.processLine(a),0!=(c=this.points.length/2-u))&&(t&&!this._compareStyles(r,h)&&(t.end(l,u),t=null),t||((t=BATCH_POOL.pop()||new BatchPart).begin(h,l,u),this.batches.push(t),r=h),this.addUvs(this.points,i,h.texture,u,c,h.matrix))}}var e=this.indices.length,d=this.points.length/2;t&&t.end(e,d),0===this.batches.length?this.batchable=!0:(e=65535<d,this.indicesUint16&&this.indices.length===this.indicesUint16.length&&e==2<this.indicesUint16.BYTES_PER_ELEMENT?this.indicesUint16.set(this.indices):this.indicesUint16=new(e?Uint32Array:Uint16Array)(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls())}}else this.batchable=!0}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){var r=this.graphicsData[e],i=r.fillStyle,r=r.lineStyle;if(i&&!i.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);var r=this.batches;for(let e=0,t=r.length;e<t;e++){var i=r[e];for(let e=0;e<i.size;e++){var n=i.start+e;this.indicesUint16[n]=this.indicesUint16[n]-i.attribStart}}}isBatchable(){if(131070<this.points.length)return!1;var t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*_GraphicsGeometry2.BATCHABLE_SIZE}buildDrawCalls(){let t=++BaseTexture._globalBatch;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),DRAW_CALL_POOL.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds;let n=DRAW_CALL_POOL.pop(),a=(n||((n=new BatchDrawCall).texArray=new BatchTextureArray),n.texArray.count=0,n.start=0,n.size=0,n.type=DRAW_MODES.TRIANGLES,0),s=null,o,l=!1,u=DRAW_MODES.TRIANGLES,c=0;this.drawCalls.push(n);for(let e=0;e<this.batches.length;e++){var h=this.batches[e],d=h.style,p=d.texture.baseTexture;l!==!!d.native&&(l=!!d.native,u=l?DRAW_MODES.LINES:DRAW_MODES.TRIANGLES,s=null,a=8,t++),s!==p&&(s=p)._batchEnabled!==t&&(8===a&&(t++,(a=0)<n.size&&((n=DRAW_CALL_POOL.pop())||((n=new BatchDrawCall).texArray=new BatchTextureArray),this.drawCalls.push(n)),n.start=c,n.size=0,n.texArray.count=0,n.type=u),p.touched=1,p._batchEnabled=t,p._batchLocation=a,p.wrapMode=WRAP_MODES.REPEAT,n.texArray.elements[n.texArray.count++]=p,a++),n.size+=h.size,c+=h.size,o=p._batchLocation,this.addColors(r,d.color,d.alpha,h.attribSize,h.attribStart),this.addTextureIds(i,o,h.attribSize,h.attribStart)}BaseTexture._globalBatch=t,this.packAttributes()}packAttributes(){var t=this.points,r=this.uvs,i=this.colors,n=this.textureIds,e=new ArrayBuffer(3*t.length*4),a=new Float32Array(e),s=new Uint32Array(e);let o=0;for(let e=0;e<t.length/2;e++)a[o++]=t[2*e],a[o++]=t[2*e+1],a[o++]=r[2*e],a[o++]=r[2*e+1],s[o++]=i[e],a[o++]=n[e];this._buffer.update(e),this._indexBuffer.update(this.indicesUint16)}processFill(e){(e.holes.length?buildPoly:FILL_COMMANDS[e.type]).triangulate(e,this)}processLine(t){buildLine(t,this);for(let e=0;e<t.holes.length;e++)buildLine(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){var r=t[e];FILL_COMMANDS[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){var e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,r){for(let e=0;e<t.length/2;e++){var i=t[2*e],n=t[2*e+1];t[2*e]=r.a*i+r.c*n+r.tx,t[2*e+1]=r.b*i+r.d*n+r.ty}}addColors(t,e,r,i,n=0){var e=Color.shared.setValue(e).toLittleEndianNumber(),a=Color.shared.setValue(e).toPremultiplied(r);t.length=Math.max(t.length,n+i);for(let e=0;e<i;e++)t[n+e]=a}addTextureIds(t,r,i,n=0){t.length=Math.max(t.length,n+i);for(let e=0;e<i;e++)t[n+e]=r}addUvs(r,i,e,n,t,a=null){let s=0;for(var o,l=i.length,u=e.frame;s<t;){let e=r[2*(n+s)],t=r[2*(n+s)+1];a&&(o=a.a*e+a.c*t+a.tx,t=a.b*e+a.d*t+a.ty,e=o),s++,i.push(e/u.width,t/u.height)}var c=e.baseTexture;(u.width<c.width||u.height<c.height)&&this.adjustUvs(i,e,l,t)}adjustUvs(t,e,r,i){var n=e.baseTexture,a=r+2*i,i=e.frame,s=i.width/n.width,o=i.height/n.height;let l=i.x/i.width,u=i.y/i.height,c=Math.floor(t[r]+1e-6),h=Math.floor(t[r+1]+1e-6);for(let e=r+2;e<a;e+=2)c=Math.min(c,Math.floor(t[e]+1e-6)),h=Math.min(h,Math.floor(t[e+1]+1e-6));l-=c,u-=h;for(let e=r;e<a;e+=2)t[e]=(t[e]+l)*s,t[e+1]=(t[e+1]+u)*o}},GraphicsGeometry=(_GraphicsGeometry.BATCHABLE_SIZE=100,_GraphicsGeometry);class FillStyle{constructor(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){var e=new FillStyle;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=Texture.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class LineStyle extends FillStyle{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}clone(){var e=new LineStyle;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=LINE_CAP.BUTT,this.join=LINE_JOIN.MITER,this.miterLimit=10}}let DEFAULT_SHADERS={},_Graphics=class _Graphics2 extends Container{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new FillStyle,this._lineStyle=new LineStyle,this._matrix=null,this._holeMode=!1,this.state=State.for2d(),this._geometry=e||new GraphicsGeometry,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Color(16777215),this.blendMode=BLEND_MODES.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new _Graphics2(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,i=.5,n=!1){return this.lineTextureStyle(e="number"==typeof e?{width:e,color:t,alpha:r,alignment:i,native:n}:e)}lineTextureStyle(e){var t={width:0,texture:Texture.WHITE,color:null!=e&&e.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:LINE_CAP.BUTT,join:LINE_JOIN.MITER,miterLimit:10},t=(e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly(),0<e.width&&0<e.alpha);return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:t},e)):this._lineStyle.reset(),this}startPoly(){var e,t;this.currentPath?(e=this.currentPath.points,2<(t=this.currentPath.points.length)&&(this.drawShape(this.currentPath),this.currentPath=new Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))):(this.currentPath=new Polygon,this.currentPath.closeStroke=!1)}finishPoly(){this.currentPath&&(2<this.currentPath.points.length?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points;return r[r.length-2]===e&&r[r.length-1]===t||r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),QuadraticUtils.curveTo(e,t,r,i,n),this}bezierCurveTo(e,t,r,i,n,a){return this._initCurve(),BezierUtils.curveTo(e,t,r,i,n,a,this.currentPath.points),this}arcTo(e,t,r,i,n){this._initCurve(e,t);var a=this.currentPath.points,e=ArcUtils.curveTo(e,t,r,i,n,a);return e&&({cx:t,cy:r,radius:i,startAngle:n,endAngle:a,anticlockwise:e}=e,this.arc(t,r,i,n,a,e)),this}arc(t,r,i,n,a,s=!1){if(n!==a&&(!s&&a<=n?a+=PI_2:s&&n<=a&&(n+=PI_2),a-n!=0)){var o,l,u=t+Math.cos(n)*i,c=r+Math.sin(n)*i,h=this._geometry.closePointEps;let e=this.currentPath?this.currentPath.points:null;e?(o=Math.abs(e[e.length-2]-u),l=Math.abs(e[e.length-1]-c),o<h&&l<h||e.push(u,c)):(this.moveTo(u,c),e=this.currentPath.points),ArcUtils.arc(u,c,t,r,i,n,a,s,e)}return this}beginFill(e=0,t){return this.beginTextureFill({texture:Texture.WHITE,color:e,alpha:t})}normalizeColor(e){var t=Color.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){var t={texture:Texture.WHITE,color:16777215,matrix:null},t=(e=Object.assign(t,e),this.normalizeColor(e),this.currentPath&&this.startPoly(),0<e.alpha);return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:t},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new Rectangle(e,t,r,i))}drawRoundedRect(e,t,r,i,n){return this.drawShape(new RoundedRectangle(e,t,r,i,n))}drawCircle(e,t,r){return this.drawShape(new Circle(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new Ellipse(e,t,r,i))}drawPolygon(...e){let t,r=!0;var i=e[0],i=(t=i.points?(r=i.closeStroke,i.points):Array.isArray(e[0])?e[0]:e,new Polygon(t));return i.closeStroke=r,this.drawShape(i),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){var e=this._geometry.graphicsData;return!(1!==e.length||e[0].shape.type!==SHAPES.RECT||e[0].matrix||e[0].holes.length||e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();var t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){var t=this._geometry,r=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let e=0;e<i;e++){var n=t.batches[e],a=n.style.color,s=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),s={vertexData:s,blendMode:r,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:o,_batchRGB:Color.shared.setValue(a).toRgbArray(),_tintRGB:a,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[e]=s}}_renderBatched(r){if(this.batches.length){r.batch.setObjectRenderer(r.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,t=this.batches.length;e<t;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,r.plugins[this.pluginName].render(i)}}}_renderDirect(r){var e=this._resolveDirectShader(r),i=this._geometry,t=this.worldAlpha,n=e.uniforms,a=i.drawCalls;n.translationMatrix=this.transform.worldTransform,Color.shared.setValue(this._tintColor).premultiply(t).toArray(n.tint),r.shader.bind(e),r.geometry.bind(i,e),r.state.set(this.state);for(let e=0,t=a.length;e<t;e++)this._renderDrawCallDirect(r,i.drawCalls[e])}_renderDrawCallDirect(t,e){var{texArray:r,type:e,size:i,start:n}=e,a=r.count;for(let e=0;e<a;e++)t.texture.bind(r.elements[e],e);t.geometry.draw(e,i,n)}_resolveDirectShader(e){let t=this.shader;var r=this.pluginName;if(!t){if(!DEFAULT_SHADERS[r]){var i=e.plugins[r].maxTextures,n=new Int32Array(i);for(let e=0;e<i;e++)n[e]=e;var a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Matrix,default:UniformGroup.from({uSamplers:n},!0)},e=e.plugins[r]._shader.program;DEFAULT_SHADERS[r]=new Shader(e,a)}t=DEFAULT_SHADERS[r]}return t}_calculateBounds(){this.finishPoly();var e,t,r,i=this._geometry;i.graphicsData.length&&({minX:i,minY:e,maxX:t,maxY:r}=i.bounds,this._bounds.addFrame(this.transform,i,e,t,r))}containsPoint(e){return this.worldTransform.applyInverse(e,_Graphics2._TEMP_POINT),this._geometry.containsPoint(_Graphics2._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){var t=this.batches[e];t._tintRGB=Color.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;var e=this.transform.worldTransform,r=e.a,i=e.b,n=e.c,a=e.d,s=e.tx,o=e.ty,l=this._geometry.points,u=this.vertexData;let t=0;for(let e=0;e<l.length;e+=2){var c=l[e],h=l[e+1];u[t++]=r*c+n*h+s,u[t++]=a*h+i*c+o}}}closePath(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}},Graphics=(_Graphics.curves=curves,_Graphics._TEMP_POINT=new Point,_Graphics),graphicsUtils={buildPoly:buildPoly,buildCircle:buildCircle,buildRectangle:buildRectangle,buildRoundedRectangle:buildRoundedRectangle,buildLine:buildLine,ArcUtils:ArcUtils,BezierUtils:BezierUtils,QuadraticUtils:QuadraticUtils,BatchPart:BatchPart,FILL_COMMANDS:FILL_COMMANDS,BATCH_POOL:BATCH_POOL,DRAW_CALL_POOL:DRAW_CALL_POOL};class MeshBatchUvs{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID||(this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID,e=this.uvBuffer.data,this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++)}}let tempPoint$1=new Point,tempPolygon=new Polygon,_Mesh=class _Mesh2 extends Container{constructor(e,t,r,i=DRAW_MODES.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||State.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=settings.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount)&&this._geometry.dispose(),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(e){var t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===DRAW_MODES.TRIANGLES&&t.length<2*_Mesh2.BATCHABLE_SIZE?this._renderToBatch(e):this._renderDefault(e)}_renderDefault(e){var t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){var t=this.geometry,r=this.shader,t=(r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture,this.material.pluginName);e.batch.setObjectRenderer(e.plugins[t]),e.plugins[t].render(this)}calculateVertices(){var e=this.geometry.buffers[0],t=e.data,e=e._updateID;if(e!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));var r=this.transform.worldTransform,i=r.a,n=r.b,a=r.c,s=r.d,o=r.tx,l=r.ty,u=this.vertexData;for(let e=0;e<u.length/2;e++){var c=t[2*e],h=t[2*e+1];u[2*e]=i*c+a*h+o,u[2*e+1]=n*c+s*h+l}if(this._roundPixels){var d=settings.RESOLUTION;for(let e=0;e<u.length;++e)u[e]=Math.round(u[e]*d)/d}this.vertexDirty=e}}calculateUvs(){var e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new MeshBatchUvs(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(this.getBounds().contains(e.x,e.y)){this.worldTransform.applyInverse(e,tempPoint$1);var t=this.geometry.getBuffer("aVertexPosition").data,r=tempPolygon.points,i=this.geometry.getIndex().data,n=i.length,a=4===this.drawMode?3:1;for(let e=0;e+2<n;e+=a){var s=2*i[e],o=2*i[e+1],l=2*i[e+2];if(r[0]=t[s],r[1]=t[1+s],r[2]=t[o],r[3]=t[1+o],r[4]=t[l],r[5]=t[1+l],tempPolygon.contains(tempPoint$1.x,tempPoint$1.y))return!0}}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}},Mesh=(_Mesh.BATCHABLE_SIZE=100,_Mesh);class MeshGeometry extends Geometry{constructor(e,t,r){super();e=new Buffer$2(e),t=new Buffer$2(t,!0),r=new Buffer$2(r,!0,!0);this.addAttribute("aVertexPosition",e,2,!1,TYPES.FLOAT).addAttribute("aTextureCoord",t,2,!1,TYPES.FLOAT).addIndex(r),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var fragment$s=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,vertex$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class MeshMaterial extends Shader{constructor(e,t){var r={uSampler:e,alpha:1,uTextureMatrix:Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};(t=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},t)).uniforms&&Object.assign(r,t.uniforms),super(t.program||Program.from(vertex$1,fragment$s),r),this._colorDirty=!1,this.uvMatrix=new TextureMatrix(e),this.batchable=void 0===t.program,this.pluginName=t.pluginName,this._tintColor=new Color(t.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=t.alpha}get texture(){return this.uniforms.uSampler}set texture(e){this.uniforms.uSampler!==e&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!e.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=e,this.uvMatrix.texture=e)}set alpha(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(e){e!==this.tint&&(this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){var e;this._colorDirty&&(this._colorDirty=!1,e=this.texture.baseTexture.alphaMode,Color.shared.setValue(this._tintColor).premultiply(this._alpha,e).toArray(this.uniforms.uColor)),this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class PlaneGeometry extends MeshGeometry{constructor(e=100,t=100,r=10,i=10){super(),this.segWidth=r,this.segHeight=i,this.width=e,this.height=t,this.build()}build(){var t=this.segWidth*this.segHeight,r=[],i=[],n=[],a=this.segWidth-1,s=this.segHeight-1,o=this.width/a,l=this.height/s;for(let e=0;e<t;e++){var u=e%this.segWidth,c=e/this.segWidth|0;r.push(u*o,c*l),i.push(u/a,c/s)}var h=a*s;for(let e=0;e<h;e++){var d=e%a,p=e/a|0,f=p*this.segWidth+d,m=p*this.segWidth+d+1,g=(1+p)*this.segWidth+d,p=(1+p)*this.segWidth+d+1;n.push(f,m,g,m,p,g)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}}class RopeGeometry extends MeshGeometry{constructor(e=200,t,r=0){super(new Float32Array(4*t.length),new Float32Array(4*t.length),new Uint16Array(6*(t.length-1))),this.points=t,this._width=e,this.textureScale=r,this.build()}get width(){return this._width}build(){var n=this.points;if(n){var e=this.getBuffer("aVertexPosition"),a=this.getBuffer("aTextureCoord"),s=this.getIndex();if(!(n.length<1)){e.data.length/4!==n.length&&(e.data=new Float32Array(4*n.length),a.data=new Float32Array(4*n.length),s.data=new Uint16Array(6*(n.length-1)));var o=a.data,l=s.data;o[0]=0,o[1]=0,o[2]=0,o[3]=1;let t=0,r=n[0];var u=this._width*this.textureScale,c=n.length;for(let e=0;e<c;e++){var h,d,p=4*e;0<this.textureScale?(d=r.x-n[e].x,h=r.y-n[e].y,d=Math.sqrt(d*d+h*h),r=n[e],t+=d/u):t=e/(c-1),o[p]=t,o[1+p]=0,o[2+p]=t,o[3+p]=1}let i=0;for(let e=0;e<c-1;e++){var f=2*e;l[i++]=f,l[i++]=1+f,l[i++]=2+f,l[i++]=2+f,l[i++]=1+f,l[i++]=3+f}a.update(),s.update(),this.updateVertices()}}}updateVertices(){var a=this.points;if(!(a.length<1)){let t=a[0],r,i=0,n=0;var s=this.buffers[0].data,o=a.length,l=0<this.textureScale?this.textureScale*this._width/2:this._width/2;for(let e=0;e<o;e++){var u=a[e],c=4*e,h=(r=e<a.length-1?a[e+1]:u,n=-(r.x-t.x),i=r.y-t.y,Math.sqrt(i*i+n*n));h<1e-6?(i=0,n=0):(i/=h,n/=h,i*=l,n*=l),s[c]=u.x+i,s[1+c]=u.y+n,s[2+c]=u.x-i,s[3+c]=u.y-n,t=u}this.buffers[0].update()}}update(){0<this.textureScale?this.build():this.updateVertices()}}class SimplePlane extends Mesh{constructor(e,t,r){super(new PlaneGeometry(e.width,e.height,t,r),new MeshMaterial(Texture.WHITE)),this.texture=e,this.autoResize=!0}textureUpdated(){this._textureID=this.shader.texture._updateID;var e=this.geometry,{width:t,height:r}=this.shader.texture;!this.autoResize||e.width===t&&e.height===r||(e.width=this.shader.texture.width,e.height=this.shader.texture.height,e.build())}set texture(e){this.shader.texture!==e&&(this.shader.texture=e,this._textureID=-1,e.baseTexture.valid?this.textureUpdated():e.once("update",this.textureUpdated,this))}get texture(){return this.shader.texture}_render(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),super._render(e)}destroy(e){this.shader.texture.off("update",this.textureUpdated,this),super.destroy(e)}}let DEFAULT_BORDER_SIZE=10;class NineSlicePlane extends SimplePlane{constructor(e,t,r,i,n){var a,s,o,l;super(Texture.WHITE,4,4),this._origWidth=e.orig.width,this._origHeight=e.orig.height,this._width=this._origWidth,this._height=this._origHeight,this._leftWidth=t??(null==(a=e.defaultBorders)?void 0:a.left)??DEFAULT_BORDER_SIZE,this._rightWidth=i??(null==(s=e.defaultBorders)?void 0:s.right)??DEFAULT_BORDER_SIZE,this._topHeight=r??(null==(o=e.defaultBorders)?void 0:o.top)??DEFAULT_BORDER_SIZE,this._bottomHeight=n??(null==(l=e.defaultBorders)?void 0:l.bottom)??DEFAULT_BORDER_SIZE,this.texture=e}textureUpdated(){this._textureID=this.shader.texture._updateID,this._refresh()}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}updateHorizontalVertices(){var e=this.vertices,t=this._getMinScale();e[9]=e[11]=e[13]=e[15]=this._topHeight*t,e[17]=e[19]=e[21]=e[23]=this._height-this._bottomHeight*t,e[25]=e[27]=e[29]=e[31]=this._height}updateVerticalVertices(){var e=this.vertices,t=this._getMinScale();e[2]=e[10]=e[18]=e[26]=this._leftWidth*t,e[4]=e[12]=e[20]=e[28]=this._width-this._rightWidth*t,e[6]=e[14]=e[22]=e[30]=this._width}_getMinScale(){var e=this._leftWidth+this._rightWidth,e=this._width>e?1:this._width/e,t=this._topHeight+this._bottomHeight,t=this._height>t?1:this._height/t;return Math.min(e,t)}get width(){return this._width}set width(e){this._width=e,this._refresh()}get height(){return this._height}set height(e){this._height=e,this._refresh()}get leftWidth(){return this._leftWidth}set leftWidth(e){this._leftWidth=e,this._refresh()}get rightWidth(){return this._rightWidth}set rightWidth(e){this._rightWidth=e,this._refresh()}get topHeight(){return this._topHeight}set topHeight(e){this._topHeight=e,this._refresh()}get bottomHeight(){return this._bottomHeight}set bottomHeight(e){this._bottomHeight=e,this._refresh()}_refresh(){var e=this.texture,t=this.geometry.buffers[1].data,e=(this._origWidth=e.orig.width,this._origHeight=e.orig.height,1/this._origWidth),r=1/this._origHeight;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1,t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[9]=t[11]=t[13]=t[15]=r*this._topHeight,t[17]=t[19]=t[21]=t[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()}}class SimpleMesh extends Mesh{constructor(e=Texture.EMPTY,t,r,i,n){t=new MeshGeometry(t,r,i),t.getBuffer("aVertexPosition").static=!1,r=new MeshMaterial(e);super(t,r,null,n),this.autoUpdate=!0}get vertices(){return this.geometry.getBuffer("aVertexPosition").data}set vertices(e){this.geometry.getBuffer("aVertexPosition").data=e}_render(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),super._render(e)}}class SimpleRope extends Mesh{constructor(e,t,r=0){var t=new RopeGeometry(e.height,t,r),i=new MeshMaterial(e);0<r&&(e.baseTexture.wrapMode=WRAP_MODES.REPEAT),super(t,i),this.autoUpdate=!0}_render(e){var t=this.geometry;!this.autoUpdate&&t._width===this.shader.texture.height||(t._width=this.shader.texture.height,t.update()),super._render(e)}}class ParticleContainer extends Container{constructor(e=1500,t,r=16384,i=!1){super();16384<r&&(r=16384),this._properties=[!1,!0,!1,!1,!1],this._maxSize=e,this._batchSize=r,this._buffers=null,this._bufferUpdateIDs=[],this._updateID=0,this.interactiveChildren=!1,this.blendMode=BLEND_MODES.NORMAL,this.autoResize=i,this.roundPixels=!0,this.baseTexture=null,this.setProperties(t),this._tintColor=new Color(0),this.tintRgb=new Float32Array(3),this.tint=16777215}setProperties(e){e&&(this._properties[0]="vertices"in e||"scale"in e?!!e.vertices||!!e.scale:this._properties[0],this._properties[1]="position"in e?!!e.position:this._properties[1],this._properties[2]="rotation"in e?!!e.rotation:this._properties[2],this._properties[3]="uvs"in e?!!e.uvs:this._properties[3],this._properties[4]="tint"in e||"alpha"in e?!!e.tint||!!e.alpha:this._properties[4])}updateTransform(){this.displayObjectUpdateTransform()}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintColor.toRgbArray(this.tintRgb)}render(e){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid)||this.baseTexture.once("update",()=>this.onChildrenChange(0)),e.batch.setObjectRenderer(e.plugins.particle),e.plugins.particle.render(this))}onChildrenChange(e){for(var t=Math.floor(e/this._batchSize);this._bufferUpdateIDs.length<t;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[t]=++this._updateID}dispose(){if(this._buffers){for(let e=0;e<this._buffers.length;++e)this._buffers[e].destroy();this._buffers=null}}destroy(e){super.destroy(e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}class ParticleBuffer{constructor(t,r,e){this.geometry=new Geometry,this.indexBuffer=null,this.size=e,this.dynamicProperties=[],this.staticProperties=[];for(let e=0;e<t.length;++e){var i={attributeName:(i=t[e]).attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||TYPES.FLOAT,offset:i.offset};(r[e]?this.dynamicProperties:this.staticProperties).push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){var t=this.geometry;let r=0;this.indexBuffer=new Buffer$2(createIndicesForQuads(this.size),!0,!0),t.addIndex(this.indexBuffer);for(let e=this.dynamicStride=0;e<this.dynamicProperties.length;++e){var i=this.dynamicProperties[e];i.offset=r,r+=i.size,this.dynamicStride+=i.size}var e=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(e),this.dynamicDataUint32=new Uint32Array(e),this.dynamicBuffer=new Buffer$2(this.dynamicData,!1,!1);let n=0;for(let e=this.staticStride=0;e<this.staticProperties.length;++e){var a=this.staticProperties[e];a.offset=n,n+=a.size,this.staticStride+=a.size}e=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(e),this.staticDataUint32=new Uint32Array(e),this.staticBuffer=new Buffer$2(this.staticData,!0,!1);for(let e=0;e<this.dynamicProperties.length;++e){var s=this.dynamicProperties[e];t.addAttribute(s.attributeName,this.dynamicBuffer,0,s.type===TYPES.UNSIGNED_BYTE,s.type,4*this.dynamicStride,4*s.offset)}for(let e=0;e<this.staticProperties.length;++e){var o=this.staticProperties[e];t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===TYPES.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)}}uploadDynamic(t,r,i){for(let e=0;e<this.dynamicProperties.length;e++){var n=this.dynamicProperties[e];n.uploadFunction(t,r,i,n.type===TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,r,i){for(let e=0;e<this.staticProperties.length;e++){var n=this.staticProperties[e];n.uploadFunction(t,r,i,n.type===TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var fragment$r=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,vertex=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ParticleRenderer extends ObjectRenderer{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new Matrix,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:TYPES.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Shader.from(vertex,fragment$r,{}),this.state=State.for2d()}render(a){var s=a.children,e=a._maxSize,o=a._batchSize,l=this.renderer;let u=s.length;if(0!==u){u>e&&!a.autoResize&&(u=e);let i=a._buffers;i=i||(a._buffers=this.generateBuffers(a));var e=s[0]._texture.baseTexture,t=0<e.alphaMode,c=(this.state.blendMode=correctBlendMode(a.blendMode,t),l.state.set(this.state),l.gl),r=a.worldTransform.copyTo(this.tempMatrix);r.prepend(l.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=r.toArray(!0),this.shader.uniforms.uColor=Color.shared.setValue(a.tintRgb).premultiply(a.worldAlpha,t).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=e,this.renderer.shader.bind(this.shader);let n=!1;for(let t=0,r=0;t<u;t+=o,r+=1){let e=u-t;e>o&&(e=o),r>=i.length&&i.push(this._generateOneMoreBuffer(a));var h=i[r],d=(h.uploadDynamic(s,t,e),a._bufferUpdateIDs[r]||0);(n=n||h._updateID<d)&&(h._updateID=a._updateID,h.uploadStatic(s,t,e)),l.geometry.bind(h.geometry),c.drawElements(c.TRIANGLES,6*e,c.UNSIGNED_SHORT,0)}}}generateBuffers(e){var t=[],r=e._maxSize,i=e._batchSize,n=e._properties;for(let e=0;e<r;e+=i)t.push(new ParticleBuffer(this.properties,n,i));return t}_generateOneMoreBuffer(e){var t=e._batchSize,e=e._properties;return new ParticleBuffer(this.properties,e,t)}uploadVertices(t,r,i,n,a,s){let o=0,l=0,u=0,c=0;for(let e=0;e<i;++e){var h=t[r+e],d=h._texture,p=h.scale.x,f=h.scale.y,m=d.trim,d=d.orig;m?(l=m.x-h.anchor.x*d.width,o=l+m.width,c=m.y-h.anchor.y*d.height,u=c+m.height):(o=d.width*(1-h.anchor.x),l=d.width*-h.anchor.x,u=d.height*(1-h.anchor.y),c=d.height*-h.anchor.y),n[s]=l*p,n[s+1]=c*f,n[s+a]=o*p,n[s+a+1]=c*f,n[s+2*a]=o*p,n[s+2*a+1]=u*f,n[s+3*a]=l*p,n[s+3*a+1]=u*f,s+=4*a}}uploadPosition(t,r,i,n,a,s){for(let e=0;e<i;e++){var o=t[r+e].position;n[s]=o.x,n[s+1]=o.y,n[s+a]=o.x,n[s+a+1]=o.y,n[s+2*a]=o.x,n[s+2*a+1]=o.y,n[s+3*a]=o.x,n[s+3*a+1]=o.y,s+=4*a}}uploadRotation(t,r,i,n,a,s){for(let e=0;e<i;e++){var o=t[r+e].rotation;n[s]=o,n[s+a]=o,n[s+2*a]=o,n[s+3*a]=o,s+=4*a}}uploadUvs(t,r,i,n,a,s){for(let e=0;e<i;++e){var o=t[r+e]._texture._uvs;o?(n[s]=o.x0,n[s+1]=o.y0,n[s+a]=o.x1,n[s+a+1]=o.y1,n[s+2*a]=o.x2,n[s+2*a+1]=o.y2,n[s+3*a]=o.x3,n[s+3*a+1]=o.y3):(n[s]=0,n[s+1]=0,n[s+a]=0,n[s+a+1]=0,n[s+2*a]=0,n[s+2*a+1]=0,n[s+3*a]=0,n[s+3*a+1]=0),s+=4*a}}uploadTint(t,r,i,n,a,s){for(let e=0;e<i;++e){var o=t[r+e],o=Color.shared.setValue(o._tintRGB).toPremultiplied(o.alpha,0<o.texture.baseTexture.alphaMode);n[s]=o,n[s+a]=o,n[s+2*a]=o,n[s+3*a]=o,s+=4*a}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ParticleRenderer.extension={name:"particle",type:ExtensionType.RendererPlugin},extensions$1.add(ParticleRenderer);var TEXT_GRADIENT=(e=>(e[e.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",e[e.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",e))(TEXT_GRADIENT||{});let contextSettings={willReadFrequently:!0},_TextMetrics=class _TextMetrics2{static get experimentalLetterSpacingSupported(){let e=_TextMetrics2._experimentalLetterSpacingSupported;var t;return void 0!==e&&(t=settings.ADAPTER.getCanvasRenderingContext2D().prototype,e=_TextMetrics2._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t),e}constructor(e,t,r,i,n,a,s,o,l){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=a,this.lineHeight=s,this.maxLineWidth=o,this.fontProperties=l}static measureText(e,t,r,i=_TextMetrics2._canvas){r=r??t.wordWrap;var n=t.toFontString(),a=_TextMetrics2.measureFont(n),s=(0===a.fontSize&&(a.fontSize=t.fontSize,a.ascent=t.fontSize),i.getContext("2d",contextSettings)),o=(s.font=n,(r?_TextMetrics2.wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/)),l=new Array(o.length);let u=0;for(let e=0;e<o.length;e++){var c=_TextMetrics2._measureText(o[e],t.letterSpacing,s);l[e]=c,u=Math.max(u,c)}let h=u+t.strokeThickness;t.dropShadow&&(h+=t.dropShadowDistance);n=t.lineHeight||a.fontSize+t.strokeThickness;let d=Math.max(n,a.fontSize+2*t.strokeThickness)+t.leading+(o.length-1)*(n+t.leading);return t.dropShadow&&(d+=t.dropShadowDistance),new _TextMetrics2(e,t,h,d,o,l,n+t.leading,u,a)}static _measureText(e,t,r){let i=!1,n=(_TextMetrics2.experimentalLetterSpacingSupported&&(_TextMetrics2.experimentalLetterSpacing?(r.letterSpacing=t+"px",r.textLetterSpacing=t+"px",i=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px")),r.measureText(e).width);return 0<n&&(i?n-=t:n+=(_TextMetrics2.graphemeSegmenter(e).length-1)*t),n}static wordWrap(e,a,t=_TextMetrics2._canvas){var s=t.getContext("2d",contextSettings);let o=0,l="",u="";var c=Object.create(null),{letterSpacing:h,whiteSpace:t}=a,r=_TextMetrics2.collapseSpaces(t),i=_TextMetrics2.collapseNewlines(t);let d=!r;var p=a.wordWrapWidth+h,f=_TextMetrics2.tokenize(e);for(let e=0;e<f.length;e++){let n=f[e];if(_TextMetrics2.isNewline(n)){if(!i){u+=_TextMetrics2.addLine(l),d=!r,l="",o=0;continue}n=" "}if(r){var m=_TextMetrics2.isBreakingSpace(n),g=_TextMetrics2.isBreakingSpace(l[l.length-1]);if(m&&g)continue}m=_TextMetrics2.getFromCache(n,h,c,s);if(p<m)if(""!==l&&(u+=_TextMetrics2.addLine(l),l="",o=0),_TextMetrics2.canBreakWords(n,a.breakWords)){var v=_TextMetrics2.wordWrapSplit(n);for(let i=0;i<v.length;i++){let e=v[i],t=e,r=1;for(;v[i+r];){var y=v[i+r];if(_TextMetrics2.canBreakChars(t,y,n,i,a.breakWords))break;e+=y,t=y,r++}i+=r-1;var _=_TextMetrics2.getFromCache(e,h,c,s);_+o>p&&(u+=_TextMetrics2.addLine(l),d=!1,l="",o=0),l+=e,o+=_}}else{0<l.length&&(u+=_TextMetrics2.addLine(l),l="",o=0);g=e===f.length-1;u+=_TextMetrics2.addLine(n,!g),d=!1,l="",o=0}else m+o>p&&(d=!1,u+=_TextMetrics2.addLine(l),l="",o=0),(0<l.length||!_TextMetrics2.isBreakingSpace(n)||d)&&(l+=n,o+=m)}return u+=_TextMetrics2.addLine(l,!1)}static addLine(e,t=!0){return e=_TextMetrics2.trimRight(e),e=t?e+`
`:e}static getFromCache(e,t,r,i){let n=r[e];return"number"!=typeof n&&(n=_TextMetrics2._measureText(e,t,i)+t,r[e]=n),n}static collapseSpaces(e){return"normal"===e||"pre-line"===e}static collapseNewlines(e){return"normal"===e}static trimRight(t){if("string"!=typeof t)return"";for(let e=t.length-1;0<=e;e--){var r=t[e];if(!_TextMetrics2.isBreakingSpace(r))break;t=t.slice(0,-1)}return t}static isNewline(e){return"string"==typeof e&&_TextMetrics2._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return"string"==typeof e&&_TextMetrics2._breakingSpaces.includes(e.charCodeAt(0))}static tokenize(t){var r=[];let i="";if("string"==typeof t){for(let e=0;e<t.length;e++){var n=t[e],a=t[e+1];_TextMetrics2.isBreakingSpace(n,a)||_TextMetrics2.isNewline(n)?(""!==i&&(r.push(i),i=""),r.push(n)):i+=n}""!==i&&r.push(i)}return r}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,n){return!0}static wordWrapSplit(e){return _TextMetrics2.graphemeSegmenter(e)}static measureFont(i){if(_TextMetrics2._fonts[i])return _TextMetrics2._fonts[i];var n={ascent:0,descent:0,fontSize:0},a=_TextMetrics2._canvas,s=_TextMetrics2._context,o=(s.font=i,_TextMetrics2.METRICS_STRING+_TextMetrics2.BASELINE_SYMBOL),l=Math.ceil(s.measureText(o).width),u=Math.ceil(s.measureText(_TextMetrics2.BASELINE_SYMBOL).width),c=Math.ceil(_TextMetrics2.HEIGHT_MULTIPLIER*u),u=u*_TextMetrics2.BASELINE_MULTIPLIER|0;if(0!==l&&0!==c){a.width=l,a.height=c,s.fillStyle="#f00",s.fillRect(0,0,l,c),s.font=i,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,u);var h=s.getImageData(0,0,l,c).data,a=h.length,d=4*l;let e=0,t=0,r=!1;for(e=0;e<u;++e){for(let e=0;e<d;e+=4)if(255!==h[t+e]){r=!0;break}if(r)break;t+=d}for(n.ascent=u-e,t=a-d,r=!1,e=c;e>u;--e){for(let e=0;e<d;e+=4)if(255!==h[t+e]){r=!0;break}if(r)break;t-=d}n.descent=e-u,n.fontSize=n.ascent+n.descent}return _TextMetrics2._fonts[i]=n}static clearMetrics(e=""){e?delete _TextMetrics2._fonts[e]:_TextMetrics2._fonts={}}static get _canvas(){var t;if(!_TextMetrics2.__canvas){let e;try{var r=new OffscreenCanvas(0,0);if(null!=(t=r.getContext("2d",contextSettings))&&t.measureText)return _TextMetrics2.__canvas=r;e=settings.ADAPTER.createCanvas()}catch{e=settings.ADAPTER.createCanvas()}e.width=e.height=10,_TextMetrics2.__canvas=e}return _TextMetrics2.__canvas}static get _context(){return _TextMetrics2.__context||(_TextMetrics2.__context=_TextMetrics2._canvas.getContext("2d",contextSettings)),_TextMetrics2.__context}},TextMetrics=(_TextMetrics.METRICS_STRING="|ÉqÅ",_TextMetrics.BASELINE_SYMBOL="M",_TextMetrics.BASELINE_MULTIPLIER=1.4,_TextMetrics.HEIGHT_MULTIPLIER=2,_TextMetrics.graphemeSegmenter=(()=>{if("function"!=typeof(null==Intl?void 0:Intl.Segmenter))return e=>[...e];{let t=new Intl.Segmenter;return e=>[...t.segment(e)].map(e=>e.segment)}})(),_TextMetrics.experimentalLetterSpacing=!1,_TextMetrics._fonts={},_TextMetrics._newlines=[10,13],_TextMetrics._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],_TextMetrics),genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],_TextStyle=class _TextStyle2{constructor(e){this.styleID=0,this.reset(),deepCopyProperties(this,e,e)}clone(){var e={};return deepCopyProperties(e,this,_TextStyle2.defaultStyle),new _TextStyle2(e)}reset(){deepCopyProperties(this,_TextStyle2.defaultStyle,_TextStyle2.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){e=getColor(e);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){e=getColor(e);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){areArraysEqual(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){e=getColor(e);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){var e="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize;let r=this.fontFamily;for(let t=(r=Array.isArray(this.fontFamily)?r:this.fontFamily.split(",")).length-1;0<=t;t--){let e=r[t].trim();/([\"\'])[^\'\"]+\1/.test(e)||genericFontFamilies.includes(e)||(e=`"${e}"`),r[t]=e}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} `+r.join(",")}},TextStyle=(_TextStyle.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:TEXT_GRADIENT.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100},_TextStyle);function getColor(e){let t=Color.shared,r=e=>{e=t.setValue(e);return 1===e.alpha?e.toHex():e.toRgbaString()};return Array.isArray(e)?e.map(r):r(e)}function areArraysEqual(t,r){if(!Array.isArray(t)||!Array.isArray(r)||t.length!==r.length)return!1;for(let e=0;e<t.length;++e)if(t[e]!==r[e])return!1;return!0}function deepCopyProperties(e,t,r){for(var i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}let defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_Text=class _Text2 extends Sprite{constructor(e,t,r){let i=!1;r||(r=settings.ADAPTER.createCanvas(),i=!0),r.width=3,r.height=3;var n=Texture.from(r);n.orig=new Rectangle,n.trim=new Rectangle,super(n),this._ownCanvas=i,this.canvas=r,this.context=r.getContext("2d",{willReadFrequently:!0}),this._resolution=_Text2.defaultResolution??settings.RESOLUTION,this._autoResolution=_Text2.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return TextMetrics.experimentalLetterSpacing}static set experimentalLetterSpacing(e){deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),TextMetrics.experimentalLetterSpacing=e}updateText(e){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!e){this._font=this._style.toFontString();var a=this.context,s=TextMetrics.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),e=s.width,o=s.height,l=s.lines,u=s.lineHeight,c=s.lineWidths,h=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,e)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+2*n.padding)*this._resolution),a.scale(this._resolution,this._resolution),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.font=this._font,a.lineWidth=n.strokeThickness,a.textBaseline=n.textBaseline,a.lineJoin=n.lineJoin,a.miterLimit=n.miterLimit;let r,i;var t=n.dropShadow?2:1;for(let e=0;e<t;++e){var p,f,m=n.dropShadow&&0===e,g=m?Math.ceil(Math.max(1,o)+2*n.padding):0,v=g*this._resolution;m?(a.fillStyle="black",a.strokeStyle="black",m=n.dropShadowColor,p=n.dropShadowBlur*this._resolution,f=n.dropShadowDistance*this._resolution,a.shadowColor=Color.shared.setValue(m).setAlpha(n.dropShadowAlpha).toRgbaString(),a.shadowBlur=p,a.shadowOffsetX=Math.cos(n.dropShadowAngle)*f,a.shadowOffsetY=Math.sin(n.dropShadowAngle)*f+v):(a.fillStyle=this._generateFillStyle(n,l,s),a.strokeStyle=n.stroke,a.shadowColor="black",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0);let t=(u-d.fontSize)/2;u-d.fontSize<0&&(t=0);for(let e=0;e<l.length;e++)r=n.strokeThickness/2,i=n.strokeThickness/2+e*u+d.ascent+t,"right"===n.align?r+=h-c[e]:"center"===n.align&&(r+=(h-c[e])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(l[e],r+n.padding,i+n.padding-g,!0),n.fill&&this.drawLetterSpacing(l[e],r+n.padding,i+n.padding-g)}this.updateTexture()}}drawLetterSpacing(t,r,a,s=!1){var o=this._style.letterSpacing;let e=!1;if(TextMetrics.experimentalLetterSpacingSupported&&(TextMetrics.experimentalLetterSpacing?(this.context.letterSpacing=o+"px",this.context.textLetterSpacing=o+"px",e=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===o||e)s?this.context.strokeText(t,r,a):this.context.fillText(t,r,a);else{let e=r;var l=TextMetrics.graphemeSegmenter(t);let i=this.context.measureText(t).width,n;for(let r=0;r<l.length;++r){var u=l[r];s?this.context.strokeText(u,e,a):this.context.fillText(u,e,a);let t="";for(let e=r+1;e<l.length;++e)t+=l[e];n=this.context.measureText(t).width,e+=i-n+o,i=n}}}updateTexture(){var e=this.canvas,t=(this._style.trim&&(t=trimCanvas(e)).data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0)),this._texture),r=this._style,r=r.trim?0:r.padding,i=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-2*r,t.orig.height=t._frame.height-2*r,this._onTextureUpdate(),i.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),-1===this._textureID&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,r,n){var t=e.fill;if(!Array.isArray(t))return t;if(1===t.length)return t[0];let a;var i=e.dropShadow?e.dropShadowDistance:0,s=e.padding||0,o=this.canvas.width/this._resolution-i-2*s,l=this.canvas.height/this._resolution-i-2*s,u=t.slice(),c=e.fillGradientStops.slice();if(!c.length){var h=u.length+1;for(let e=1;e<h;++e)c.push(e/h)}if(u.unshift(t[0]),c.unshift(0),u.push(t[t.length-1]),c.push(1),e.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){a=this.context.createLinearGradient(o/2,s,o/2,l+s);var d=n.fontProperties.fontSize+e.strokeThickness;for(let t=0;t<r.length;t++){var p=n.lineHeight*(t-1)+d,f=n.lineHeight*t;let i=f;0<t&&f<p&&(i=(f+p)/2);p=f+d,f=n.lineHeight*(t+1);let e=p;var m=((e=t+1<r.length&&f<p?(p+f)/2:e)-i)/l;for(let r=0;r<u.length;r++){let e=0,t=(e="number"==typeof c[r]?c[r]:r/u.length,Math.min(1,Math.max(0,i/l+e*m)));t=Number(t.toFixed(5)),a.addColorStop(t,u[r])}}}else{a=this.context.createLinearGradient(s,l/2,o+s,l/2);var g=u.length+1;let r=1;for(let t=0;t<u.length;t++){let e;e="number"==typeof c[t]?c[t]:r/g,a.addColorStop(e,u[t]),r++}}return a}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},defaultDestroyOptions,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);var t=sign$1(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);var t=sign$1(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){(e=e||{})instanceof TextStyle?this._style=e:this._style=new TextStyle(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}},Text=(_Text.defaultAutoResolution=!0,_Text);class CountLimiter{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return 0<this.itemsLeft--}}function findMultipleBaseTextures(t,r){let e,i=!1;if(null!=(e=null==t?void 0:t._textures)&&e.length)for(let e=0;e<t._textures.length;e++){var n;t._textures[e]instanceof Texture&&(n=t._textures[e].baseTexture,r.includes(n)||(r.push(n),i=!0))}return i}function findBaseTexture(e,t){return e.baseTexture instanceof BaseTexture&&(e=e.baseTexture,t.includes(e)||t.push(e),!0)}function findTexture(e,t){return!!(e._texture&&e._texture instanceof Texture)&&(e=e._texture.baseTexture,t.includes(e)||t.push(e),!0)}function drawText(e,t){return t instanceof Text&&(t.updateText(!0),!0)}function calculateTextStyle(e,t){return t instanceof TextStyle&&(t=t.toFontString(),TextMetrics.measureFont(t),!0)}function findText(e,t){return e instanceof Text&&(t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e),e=e._texture.baseTexture,t.includes(e)||t.push(e),!0)}function findTextStyle(e,t){return e instanceof TextStyle&&(t.includes(e)||t.push(e),!0)}let _BasePrepare=class _BasePrepare2{constructor(e){this.limiter=new CountLimiter(_BasePrepare2.uploadsPerFrame),this.renderer=e,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(findText),this.registerFindHook(findTextStyle),this.registerFindHook(findMultipleBaseTextures),this.registerFindHook(findBaseTexture),this.registerFindHook(findTexture),this.registerUploadHook(drawText),this.registerUploadHook(calculateTextStyle)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var i=this.queue[0];let r=!1;if(i&&!i._destroyed)for(let e=0,t=this.uploadHooks.length;e<t;e++)if(this.uploadHooks[e](this.uploadHookHelper,i)){this.queue.shift(),r=!0;break}r||this.queue.shift()}if(this.queue.length)Ticker.system.addOnce(this.tick,this,UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var r=this.completes.slice(0);for(let e=this.completes.length=0,t=r.length;e<t;e++)r[e]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(r){for(let e=0,t=this.addHooks.length;e<t&&!this.addHooks[e](r,this.queue);e++);if(r instanceof Container)for(let e=r.children.length-1;0<=e;e--)this.add(r.children[e]);return this}destroy(){this.ticking&&Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}},BasePrepare=(_BasePrepare.uploadsPerFrame=4,_BasePrepare);function uploadBaseTextures(e,t){return t instanceof BaseTexture&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function uploadGraphics(t,e){if(!(e instanceof Graphics))return!1;var r=e.geometry,i=(e.finishPoly(),r.updateBatches(),r).batches;for(let e=0;e<i.length;e++){var n=i[e].style.texture;n&&uploadBaseTextures(t,n.baseTexture)}return r.batchable||t.geometry.bind(r,e._resolveDirectShader(t)),!0}function findGraphics(e,t){return e instanceof Graphics&&(t.push(e),!0)}Object.defineProperties(settings,{UPLOADS_PER_FRAME:{get(){return BasePrepare.uploadsPerFrame},set(e){deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),BasePrepare.uploadsPerFrame=e}}});class Prepare extends BasePrepare{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(findGraphics),this.registerUploadHook(uploadBaseTextures),this.registerUploadHook(uploadGraphics)}}Prepare.extension={name:"prepare",type:ExtensionType.RendererSystem},extensions$1.add(Prepare);class TimeLimiter{constructor(e){this.maxMilliseconds=e,this.frameStart=0}beginFrame(){this.frameStart=Date.now()}allowedToUpload(){return Date.now()-this.frameStart<this.maxMilliseconds}}class AnimatedSprite extends Sprite{constructor(e,t=!0){super(e[0]instanceof Texture?e[0]:e[0].texture),this._textures=null,this._durations=null,this._autoUpdate=t,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=e}stop(){this._playing&&(this._playing=!1,this._autoUpdate)&&this._isConnectedToTicker&&(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Ticker.shared.add(this.update,this,UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(e){this.stop(),this.currentFrame=e}gotoAndPlay(e){this.currentFrame=e,this.play()}update(t){if(this._playing){var r=this.animationSpeed*t,e=this.currentFrame;if(null!==this._durations){let e=this._currentTime%1*this._durations[this.currentFrame];for(e+=r/60*1e3;e<0;)this._currentTime--,e+=this._durations[this.currentFrame];var i=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);e>=this._durations[this.currentFrame];)e-=this._durations[this.currentFrame]*i,this._currentTime+=i;this._currentTime+=e/this._durations[this.currentFrame]}else this._currentTime+=r;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):e!==this.currentFrame&&(this.loop&&this.onLoop&&(0<this.animationSpeed&&this.currentFrame<e||this.animationSpeed<0&&this.currentFrame>e)&&this.onLoop(),this.updateTexture())}}updateTexture(){var e=this.currentFrame;this._previousFrame!==e&&(this._previousFrame=e,this._texture=this._textures[e],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange)&&this.onFrameChange(this.currentFrame)}destroy(e){this.stop(),super.destroy(e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){var r=[];for(let e=0;e<t.length;++e)r.push(Texture.from(t[e]));return new AnimatedSprite(r)}static fromImages(t){var r=[];for(let e=0;e<t.length;++e)r.push(Texture.from(t[e]));return new AnimatedSprite(r)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof Texture)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let e=Math.floor(this._currentTime)%this._textures.length;return e<0&&(e+=this._textures.length),e}set currentFrame(e){if(e<0||e>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${e}, expected to be between 0 and totalFrames ${this.totalFrames}.`);var t=this.currentFrame;this._currentTime=e,t!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))}}let tempPoint=new Point;class TilingSprite extends Sprite{constructor(e,t=100,r=100){super(e),this.tileTransform=new Transform,this._width=t,this._height=r,this.uvMatrix=this.texture.uvMatrix||new TextureMatrix(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}get clampMargin(){return this.uvMatrix.clampMargin}set clampMargin(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)}get tileScale(){return this.tileTransform.scale}set tileScale(e){this.tileTransform.scale.copyFrom(e)}get tilePosition(){return this.tileTransform.position}set tilePosition(e){this.tileTransform.position.copyFrom(e)}_onTextureUpdate(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215}_render(e){var t=this._texture;t&&t.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))}_calculateBounds(){var e=this._width*-this._anchor._x,t=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,t,r,i)}getLocalBounds(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Rectangle),e=this._localBoundsRect),this._bounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,tempPoint);var e=this._width,t=this._height,r=-e*this.anchor._x;if(tempPoint.x>=r&&tempPoint.x<r+e){r=-t*this.anchor._y;if(tempPoint.y>=r&&tempPoint.y<r+t)return!0}return!1}destroy(e){super.destroy(e),this.tileTransform=null,this.uvMatrix=null}static from(e,t){e=e instanceof Texture?e:Texture.from(e,t);return new TilingSprite(e,t.width,t.height)}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}}var gl2FragmentSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,gl2VertexSrc=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gl1FragmentSrc=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,gl1VertexSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,fragmentSimpleSrc=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;let tempMat=new Matrix;class TilingSpriteRenderer extends ObjectRenderer{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new QuadUv,this.state=State.for2d()}contextChange(){var e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=Shader.from(gl1VertexSrc,fragmentSimpleSrc,t),this.shader=1<e.context.webGLVersion?Shader.from(gl2VertexSrc,gl2FragmentSrc,t):Shader.from(gl1VertexSrc,gl1FragmentSrc,t)}render(e){var t=this.renderer,r=this.quad;let i=r.vertices;i[0]=i[6]=e._width*-e.anchor.x,i[1]=i[3]=e._height*-e.anchor.y,i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);var n=e.uvRespectAnchor?e.anchor.x:0,a=e.uvRespectAnchor?e.anchor.y:0,n=((i=r.uvs)[0]=i[6]=-n,i[1]=i[3]=-a,i[2]=i[4]=1-n,i[5]=i[7]=1-a,r.invalidate(),e._texture),a=n.baseTexture,s=0<a.alphaMode,o=e.tileTransform.localTransform,l=e.uvMatrix;let u=a.isPowerOfTwo&&n.frame.width===a.width&&n.frame.height===a.height;u&&(a._glTextures[t.CONTEXT_UID]?u=a.wrapMode!==WRAP_MODES.CLAMP:a.wrapMode===WRAP_MODES.CLAMP&&(a.wrapMode=WRAP_MODES.REPEAT));var a=u?this.simpleShader:this.shader,c=n.width,h=n.height,d=e._width,p=e._height;tempMat.set(o.a*c/d,o.b*c/p,o.c*h/d,o.d*h/p,o.tx/d,o.ty/p),tempMat.invert(),u?tempMat.prepend(l.mapCoord):(a.uniforms.uMapCoord=l.mapCoord.toArray(!0),a.uniforms.uClampFrame=l.uClampFrame,a.uniforms.uClampOffset=l.uClampOffset),a.uniforms.uTransform=tempMat.toArray(!0),a.uniforms.uColor=Color.shared.setValue(e.tint).premultiply(e.worldAlpha,s).toArray(a.uniforms.uColor),a.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),a.uniforms.uSampler=n,t.shader.bind(a),t.geometry.bind(r),this.state.blendMode=correctBlendMode(e.blendMode,s),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}TilingSpriteRenderer.extension={name:"tilingSprite",type:ExtensionType.RendererPlugin},extensions$1.add(TilingSpriteRenderer);let _Spritesheet=class _Spritesheet2{constructor(e,t,r){this.linkedSheets=[];var{texture:t,data:r,resolutionFilename:e=null,cachePrefix:i=""}=e=e instanceof BaseTexture||e instanceof Texture?{texture:e,data:t,resolutionFilename:r}:e,i=(this.cachePrefix=i,this._texture=t instanceof Texture?t:null,this.baseTexture=t instanceof BaseTexture?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=r,this.baseTexture.resource);this.resolution=this._updateResolution(e||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){var t=this.data.meta.scale;let r=getResolutionOfUrl(e,null);return 1!==(r=null===r?"number"==typeof t?t:parseFloat(t??"1"):r)&&this.baseTexture.setResolution(r),r}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=_Spritesheet2.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;for(var r=_Spritesheet2.BATCH_SIZE;t-e<r&&t<this._frameKeys.length;){var i=this._frameKeys[t],n=this._frames[i],a=n.frame;if(a){let e=null,t=null;var s=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,s=new Rectangle(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);e=n.rotated?new Rectangle(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):new Rectangle(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(t=new Rectangle(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new Texture(this.baseTexture,e,s,t,n.rotated?2:0,n.anchor,n.borders),Texture.addToCache(this.textures[i],this.cachePrefix+i.toString())}t++}}_processAnimations(){var t,r=this.data.animations||{};for(t in r){this.animations[t]=[];for(let e=0;e<r[t].length;e++){var i=r[t][e];this.animations[t].push(this.textures[i])}}}_parseComplete(){var e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*_Spritesheet2.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*_Spritesheet2.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(var t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(null!=(e=this._texture)&&e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}},Spritesheet=(_Spritesheet.BATCH_SIZE=1e3,_Spritesheet),validImages=["jpg","png","jpeg","avif","webp"];function getCacheableAssets(e,i,t){let n={};if(e.forEach(e=>{n[e]=i}),Object.keys(i.textures).forEach(e=>{n[""+i.cachePrefix+e]=i.textures[e]}),!t){let r=path.dirname(e[0]);i.linkedSheets.forEach((e,t)=>{Object.assign(n,getCacheableAssets([r+"/"+i.data.meta.related_multi_packs[t]],e,!0))})}return n}let spritesheetAsset={extension:ExtensionType.Asset,cache:{test:e=>e instanceof Spritesheet,getCacheableAssets:(e,t)=>getCacheableAssets(e,t,!1)},resolver:{test:e=>{var e=e.split("?")[0].split("."),t=e.pop(),e=e.pop();return"json"===t&&validImages.includes(e)},parse:e=>{var t,r=e.split(".");return{resolution:parseFloat((null==(t=settings.RETINA_PREFIX.exec(e))?void 0:t[1])??"1"),format:r[r.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},async testParse(e,t){return".json"===path.extname(t.src).toLowerCase()&&!!e.frames},async parse(e,t,r){var i,{texture:n,imageFilename:a,cachePrefix:s}=(null==t?void 0:t.data)??{};let o=path.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let l,u=(l=n&&n.baseTexture?n:(n=copySearchParams(o+(a??e.meta.image),t.src),(await r.load([n]))[n]),new Spritesheet({texture:l.baseTexture,data:e,resolutionFilename:t.src,cachePrefix:s}));await u.parse();n=null==(a=null==e?void 0:e.meta)?void 0:a.related_multi_packs;if(Array.isArray(n)){var c,h,d=[];for(c of n)"string"!=typeof c||(h=o+c,null!=(i=t.data)&&i.ignoreMultiPack)||(h=copySearchParams(h,t.src),d.push(r.load({src:h,data:{ignoreMultiPack:!0}})));s=await Promise.all(d);(u.linkedSheets=s).forEach(t=>{t.linkedSheets=[u].concat(u.linkedSheets.filter(e=>e!==t))})}return u},unload(e){e.destroy(!0)}}};extensions$1.add(spritesheetAsset);class BitmapFontData{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class TextFormat{static test(e){return"string"==typeof e&&e.startsWith("info face=")}static parse(e){var t,r=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(t in r){var n,a=r[t].match(/^[a-z]+/gm)[0],s=r[t].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(n in s){var l=s[n].split("="),u=l[0],l=l[1].replace(/"/gm,""),c=parseFloat(l),l=isNaN(c)?l:c;o[u]=l}i[a].push(o)}let h=new BitmapFontData;return i.info.forEach(e=>h.info.push({face:e.face,size:parseInt(e.size,10)})),i.common.forEach(e=>h.common.push({lineHeight:parseInt(e.lineHeight,10)})),i.page.forEach(e=>h.page.push({id:parseInt(e.id,10),file:e.file})),i.char.forEach(e=>h.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)})),i.kerning.forEach(e=>h.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)})),i.distanceField.forEach(e=>h.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType})),h}}class XMLFormat{static test(e){var t=e;return"string"!=typeof e&&"getElementsByTagName"in e&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")}static parse(e){var t=new BitmapFontData,r=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),n=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),s=e.getElementsByTagName("kerning"),o=e.getElementsByTagName("distanceField");for(let e=0;e<r.length;e++)t.info.push({face:r[e].getAttribute("face"),size:parseInt(r[e].getAttribute("size"),10)});for(let e=0;e<i.length;e++)t.common.push({lineHeight:parseInt(i[e].getAttribute("lineHeight"),10)});for(let e=0;e<n.length;e++)t.page.push({id:parseInt(n[e].getAttribute("id"),10)||0,file:n[e].getAttribute("file")});for(let e=0;e<a.length;e++){var l=a[e];t.char.push({id:parseInt(l.getAttribute("id"),10),page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xoffset:parseInt(l.getAttribute("xoffset"),10),yoffset:parseInt(l.getAttribute("yoffset"),10),xadvance:parseInt(l.getAttribute("xadvance"),10)})}for(let e=0;e<s.length;e++)t.kerning.push({first:parseInt(s[e].getAttribute("first"),10),second:parseInt(s[e].getAttribute("second"),10),amount:parseInt(s[e].getAttribute("amount"),10)});for(let e=0;e<o.length;e++)t.distanceField.push({fieldType:o[e].getAttribute("fieldType"),distanceRange:parseInt(o[e].getAttribute("distanceRange"),10)});return t}}class XMLStringFormat{static test(e){return!("string"!=typeof e||!e.includes("<font>"))&&XMLFormat.test(settings.ADAPTER.parseXML(e))}static parse(e){return XMLFormat.parse(settings.ADAPTER.parseXML(e))}}let formats=[TextFormat,XMLFormat,XMLStringFormat];function autoDetectFormat(t){for(let e=0;e<formats.length;e++)if(formats[e].test(t))return formats[e];return null}function generateFillStyle(e,t,i,r,n,a){var s=i.fill;if(!Array.isArray(s))return s;if(1===s.length)return s[0];let o;var l=i.dropShadow?i.dropShadowDistance:0,u=i.padding||0,c=e.width/r-l-2*u,h=e.height/r-l-2*u,d=s.slice(),p=i.fillGradientStops.slice();if(!p.length){var f=d.length+1;for(let e=1;e<f;++e)p.push(e/f)}if(d.unshift(s[0]),p.unshift(0),d.push(s[s.length-1]),p.push(1),i.fillGradientType===TEXT_GRADIENT.LINEAR_VERTICAL){o=t.createLinearGradient(c/2,u,c/2,h+u);let r=0;var m=(a.fontProperties.fontSize+i.strokeThickness)/h;for(let e=0;e<n.length;e++){var g=a.lineHeight*e;for(let t=0;t<d.length;t++){let e=0;var v=g/h+(e="number"==typeof p[t]?p[t]:t/d.length)*m,v=Math.max(r,v),v=Math.min(v,1);o.addColorStop(v,d[t]),r=v}}}else{o=t.createLinearGradient(u,h/2,c+u,h/2);var y=d.length+1;let r=1;for(let t=0;t<d.length;t++){let e;e="number"==typeof p[t]?p[t]:r/y,o.addColorStop(e,d[t]),r++}}return o}function drawGlyph(e,t,r,i,n,a,s){var o,l=r.text,u=r.fontProperties,i=(t.translate(i,n),t.scale(a,a),s.strokeThickness/2),n=-s.strokeThickness/2;t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=generateFillStyle(e,t,s,a,[l],r),t.strokeStyle=s.stroke,s.dropShadow?(e=s.dropShadowColor,o=s.dropShadowBlur*a,a=s.dropShadowDistance*a,t.shadowColor=Color.shared.setValue(e).setAlpha(s.dropShadowAlpha).toRgbaString(),t.shadowBlur=o,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*a,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*a):(t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),s.stroke&&s.strokeThickness&&t.strokeText(l,i,n+r.lineHeight-u.descent),s.fill&&t.fillText(l,i,n+r.lineHeight-u.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function extractCharCode(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}function splitTextToCharacters(e){return Array.from?Array.from(e):e.split("")}function resolveCharacters(r){var i=[];for(let e=0,t=(r="string"==typeof r?[r]:r).length;e<t;e++){var n=r[e];if(Array.isArray(n)){if(2!==n.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);var a=n[0].charCodeAt(0),s=n[1].charCodeAt(0);if(s<a)throw new Error("[BitmapFont]: Invalid character range.");for(let e=a,t=s;e<=t;e++)i.push(String.fromCharCode(e))}else i.push(...splitTextToCharacters(n))}if(0===i.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return i}let _BitmapFont=class _BitmapFont2{constructor(t,r,e){var[i]=t.info,[n]=t.common,[a]=t.page,[s]=t.distanceField,o=getResolutionOfUrl(a.file),l={};this._ownsTextures=e,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/o,this.chars={},this.pageTextures=l;for(let e=0;e<t.page.length;e++){var{id:u,file:c}=t.page[e];l[u]=r instanceof Array?r[e]:r[c],null!=s&&s.fieldType&&"none"!==s.fieldType&&(l[u].baseTexture.alphaMode=ALPHA_MODES.NO_PREMULTIPLIED_ALPHA,l[u].baseTexture.mipmap=MIPMAP_MODES.OFF)}for(let e=0;e<t.char.length;e++){var{id:h,page:d}=t.char[e],{x:p,y:f,width:m,height:g,xoffset:v,yoffset:y,xadvance:_}=t.char[e],p=(p/=o,f/=o,m/=o,g/=o,v/=o,y/=o,_/=o,new Rectangle(p+l[d].frame.x/o,f+l[d].frame.y/o,m,g));this.chars[h]={xOffset:v,yOffset:y,xAdvance:_,kerning:{},texture:new Texture(l[d].baseTexture,p),page:d}}for(let e=0;e<t.kerning.length;e++){var{first:b,second:x,amount:S}=t.kerning[e];b/=o,x/=o,S/=o,this.chars[x]&&(this.chars[x].kerning[b]=S)}this.distanceFieldRange=null==s?void 0:s.distanceRange,this.distanceFieldType=(null==(a=null==s?void 0:s.fieldType)?void 0:a.toLowerCase())??"none"}destroy(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(e,t,r){let i;if(e instanceof BitmapFontData)i=e;else{var n=autoDetectFormat(e);if(!n)throw new Error("Unrecognized data format for font.");i=n.parse(e)}t instanceof Texture&&(t=[t]);n=new _BitmapFont2(i,t,r);return _BitmapFont2.available[n.font]=n}static uninstall(e){var t=_BitmapFont2.available[e];if(!t)throw new Error(`No font found named '${e}'`);t.destroy(),delete _BitmapFont2.available[e]}static from(e,t,r){if(!e)throw new Error("[BitmapFont] Property `name` is required.");let{chars:i,padding:n,resolution:a,textureWidth:s,textureHeight:o,...l}=Object.assign({},_BitmapFont2.defaultOptions,r),u=resolveCharacters(i),c=t instanceof TextStyle?t:new TextStyle(t),h=s,d=new BitmapFontData,p=(d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize},0),f=0,m,g,v,y=0;var _=[];for(let e=0;e<u.length;e++){m||((m=settings.ADAPTER.createCanvas()).width=s,m.height=o,g=m.getContext("2d"),v=new BaseTexture(m,{resolution:a,...l}),_.push(new Texture(v)),d.page.push({id:_.length-1,file:""}));var b=u[e],x=TextMetrics.measureText(b,c,!1,m),S=x.width,T=Math.ceil(x.height),E=Math.ceil(("italic"===c.fontStyle?2:1)*S);if(f>=o-T*a){if(0===f)throw new Error(`[BitmapFont] textureHeight ${o}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${b}')`);--e,m=null,g=null,v=null,f=0,p=0,y=0}else if(y=Math.max(T+x.fontProperties.descent,y),E*a+p>=h){if(0===p)throw new Error(`[BitmapFont] textureWidth ${s}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${b}')`);--e,f+=y*a,f=Math.ceil(f),p=0,y=0}else{drawGlyph(m,g,x,p,f,a,c);b=extractCharCode(x.text);d.char.push({id:b,page:_.length-1,x:p/a,y:f/a,width:E,height:T,xoffset:0,yoffset:0,xadvance:S-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),p+=(E+2*n)*a,p=Math.ceil(p)}}if(null==r||!r.skipKerning)for(let e=0,t=u.length;e<t;e++){var C=u[e];for(let e=0;e<t;e++){var A=u[e],w=g.measureText(C).width,P=g.measureText(A).width,w=g.measureText(C+A).width-(w+P);w&&d.kerning.push({first:extractCharCode(C),second:extractCharCode(A),amount:w})}}t=new _BitmapFont2(d,_,!0);return void 0!==_BitmapFont2.available[e]&&_BitmapFont2.uninstall(e),_BitmapFont2.available[e]=t}},BitmapFont=(_BitmapFont.ALPHA=[["a","z"],["A","Z"]," "],_BitmapFont.NUMERIC=[["0","9"]],_BitmapFont.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],_BitmapFont.ASCII=[[" ","~"]],_BitmapFont.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:_BitmapFont.ALPHANUMERIC},_BitmapFont.available={},_BitmapFont);var msdfFrag=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,msdfVert=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;let pageMeshDataDefaultPageMeshData=[],pageMeshDataMSDFPageMeshData=[],charRenderDataPool=[],_BitmapText=class _BitmapText2 extends Container{constructor(e,t={}){super();var{align:t,tint:r,maxWidth:i,letterSpacing:n,fontName:a,fontSize:s}=Object.assign({},_BitmapText2.styleDefaults,t);if(!BitmapFont.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=t,this._tintColor=new Color(r),this._font=void 0,this._fontName=a,this._fontSize=s,this.text=e,this._maxWidth=i,this._maxLineHeight=0,this._letterSpacing=n,this._anchor=new ObservablePoint(()=>{this.dirty=!0},this,0,0),this._roundPixels=settings.ROUND_PIXELS,this.dirty=!0,this._resolution=settings.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var i=BitmapFont.available[this._fontName],e=this.fontSize,r=e/i.size,t=new Point,n=[],a=[],s=[],o=splitTextToCharacters(this._text.replace(/(?:\r\n|\r)/g,`
`)||" "),$=this._maxWidth*i.size/e,B="none"===i.distanceFieldType?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;let l=null,u=0,c=0,h=0,d=-1,p=0,f=0,m=0,g=0;for(let e=0;e<o.length;e++){var v,y=o[e],_=extractCharCode(y);(/(?:\s)/.test(y)&&(d=e,p=u,g++),"\r"===y||y===`
`)?(a.push(u),s.push(-1),c=Math.max(c,u),++h,++f,t.x=0,t.y+=i.lineHeight,l=null,g=0):(y=i.chars[_])&&(l&&y.kerning[l]&&(t.x+=y.kerning[l]),(v=charRenderDataPool.pop()||{texture:Texture.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Point}).texture=y.texture,v.line=h,v.charCode=_,v.position.x=Math.round(t.x+y.xOffset+this._letterSpacing/2),v.position.y=Math.round(t.y+y.yOffset),v.prevSpaces=g,n.push(v),u=v.position.x+Math.max(y.xAdvance-y.xOffset,y.texture.orig.width),t.x+=y.xAdvance+this._letterSpacing,m=Math.max(m,y.yOffset+y.texture.height),l=_,-1!==d)&&0<$&&t.x>$&&(++f,removeItems(n,1+d-f,1+e-d),e=d,d=-1,a.push(p),s.push(0<n.length?n[n.length-1].prevSpaces:0),c=Math.max(c,p),h++,t.x=0,t.y+=i.lineHeight,l=null,g=0)}var e=o[o.length-1],L=("\r"!==e&&e!==`
`&&(/(?:\s)/.test(e)&&(u=p),a.push(u),c=Math.max(c,u),s.push(-1)),[]);for(let t=0;t<=h;t++){let e=0;"right"===this._align?e=c-a[t]:"center"===this._align?e=(c-a[t])/2:"justify"===this._align&&(e=s[t]<0?0:(c-a[t])/s[t]),L.push(e)}var N,G,z=n.length,b={},x=[],S=this._activePagesMeshData;B.push(...S);for(let e=0;e<z;e++){var U=n[e].texture,T=U.baseTexture.uid;if(!b[T]){let r=B.pop();if(!r){var E=new MeshGeometry;let e,t;t="none"===i.distanceFieldType?(e=new MeshMaterial(Texture.EMPTY),BLEND_MODES.NORMAL):(e=new MeshMaterial(Texture.EMPTY,{program:Program.from(msdfVert,msdfFrag),uniforms:{uFWidth:0}}),BLEND_MODES.NORMAL_NPM);E=new Mesh(E,e);E.blendMode=t,r={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:E,vertices:null,uvs:null,indices:null}}r.index=0,r.indexCount=0,r.vertexCount=0,r.uvsCount=0,r.total=0;E=this._textureCache;E[T]=E[T]||new Texture(U.baseTexture),r.mesh.texture=E[T],r.mesh.tint=this._tintColor.value,x.push(r),b[T]=r}b[T].total++}for(let e=0;e<S.length;e++)x.includes(S[e])||this.removeChild(S[e].mesh);for(let e=0;e<x.length;e++)x[e].mesh.parent!==this&&this.addChild(x[e].mesh);for(N in this._activePagesMeshData=x,b){var C=b[N],A=C.total;if(!((null==(j=C.indices)?void 0:j.length)>6*A)||C.vertices.length<2*Mesh.BATCHABLE_SIZE)C.vertices=new Float32Array(8*A),C.uvs=new Float32Array(8*A),C.indices=new Uint16Array(6*A);else{var j=C.total,V=C.vertices;for(let e=4*j*2;e<V.length;e++)V[e]=0}C.mesh.size=6*A}for(let t=0;t<z;t++){var w=n[t];let e=w.position.x+L[w.line]*("justify"===this._align?w.prevSpaces:1);var P=(e=this._roundPixels?Math.round(e):e)*r,M=w.position.y*r,w=w.texture,I=b[w.baseTexture.uid],D=w.frame,w=w._uvs,R=I.index++;I.indices[6*R+0]=0+4*R,I.indices[6*R+1]=1+4*R,I.indices[6*R+2]=2+4*R,I.indices[6*R+3]=0+4*R,I.indices[6*R+4]=2+4*R,I.indices[6*R+5]=3+4*R,I.vertices[8*R+0]=P,I.vertices[8*R+1]=M,I.vertices[8*R+2]=P+D.width*r,I.vertices[8*R+3]=M,I.vertices[8*R+4]=P+D.width*r,I.vertices[8*R+5]=M+D.height*r,I.vertices[8*R+6]=P,I.vertices[8*R+7]=M+D.height*r,I.uvs[8*R+0]=w.x0,I.uvs[8*R+1]=w.y0,I.uvs[8*R+2]=w.x1,I.uvs[8*R+3]=w.y1,I.uvs[8*R+4]=w.x2,I.uvs[8*R+5]=w.y2,I.uvs[8*R+6]=w.x3,I.uvs[8*R+7]=w.y3}for(G in this._textWidth=c*r,this._textHeight=(t.y+i.lineHeight)*r,b){var k=b[G];if(0!==this.anchor.x||0!==this.anchor.y){let t=0;var O=this._textWidth*this.anchor.x,F=this._textHeight*this.anchor.y;for(let e=0;e<k.total;e++)k.vertices[t++]-=O,k.vertices[t++]-=F,k.vertices[t++]-=O,k.vertices[t++]-=F,k.vertices[t++]-=O,k.vertices[t++]-=F,k.vertices[t++]-=O,k.vertices[t++]-=F}this._maxLineHeight=m*r;var H=k.mesh.geometry.getBuffer("aVertexPosition"),W=k.mesh.geometry.getBuffer("aTextureCoord"),Y=k.mesh.geometry.getIndex();H.data=k.vertices,W.data=k.uvs,Y.data=k.indices,H.update(),W.update(),Y.update()}for(let e=0;e<n.length;e++)charRenderDataPool.push(n[e]);this._font=i,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var{distanceFieldRange:t,distanceFieldType:r,size:i}=BitmapFont.available[this._fontName];if("none"!==r){var n,{a:r,b:a,c:s,d:o}=this.worldTransform,r=Math.sqrt(r*r+a*a),a=Math.sqrt(s*s+o*o),l=(Math.abs(r)+Math.abs(a))/2,u=this.fontSize/i,c=e._view.resolution;for(n of this._activePagesMeshData)n.mesh.shader.uniforms.uFWidth=l*t*u*c}super._render(e)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){var e=BitmapFont.available[this._fontName];if(!e)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==e&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.dirty=!0)}get fontName(){return this._fontName}set fontName(e){if(!BitmapFont.available[e])throw new Error(`Missing BitmapFont "${e}"`);this._fontName!==e&&(this._fontName=e,this.dirty=!0)}get fontSize(){return this._fontSize??BitmapFont.available[this._fontName].size}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)}get anchor(){return this._anchor}set anchor(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}destroy(e){let t=this._textureCache,r="none"===BitmapFont.available[this._fontName].distanceFieldType?pageMeshDataDefaultPageMeshData:pageMeshDataMSDFPageMeshData;r.push(...this._activePagesMeshData);for(var i of this._activePagesMeshData)this.removeChild(i.mesh);for(var n in this._activePagesMeshData=[],r.filter(e=>t[e.mesh.texture.baseTexture.uid]).forEach(e=>{e.mesh.texture=Texture.EMPTY}),t)t[n].destroy(),delete t[n];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(e)}},BitmapText=(_BitmapText.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},_BitmapText),validExtensions=[".xml",".fnt"],loadBitmapFont={extension:{type:ExtensionType.LoadParser,priority:LoaderParserPriority.Normal},name:"loadBitmapFont",test(e){return validExtensions.includes(path.extname(e).toLowerCase())},async testParse(e){return TextFormat.test(e)||XMLStringFormat.test(e)},async parse(e,t,r){var e=(TextFormat.test(e)?TextFormat:XMLStringFormat).parse(e),i=t.src,n=e.page,a=[];for(let e=0;e<n.length;++e){var s=n[e].file,s=path.join(path.dirname(i),s),s=copySearchParams(s,i);a.push(s)}let o=await r.load(a),l=a.map(e=>o[e]);return BitmapFont.install(e,l,!0)},async load(e,t){return(await settings.ADAPTER.fetch(e)).text()},unload(e){e.destroy()}},_HTMLTextStyle=(extensions$1.add(loadBitmapFont),class _HTMLTextStyle2 extends TextStyle{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(r){return new _HTMLTextStyle2(Object.keys(_HTMLTextStyle2.defaultOptions).reduce((e,t)=>({...e,[t]:r[t]}),{}))}cleanFonts(){0<this._fonts.length&&(this._fonts.forEach(e=>{URL.revokeObjectURL(e.src),e.refs--,0===e.refs&&(e.fontFace&&document.fonts.delete(e.fontFace),delete _HTMLTextStyle2.availableFonts[e.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(r,i={}){let n=_HTMLTextStyle2.availableFonts;var e;return n[r]?(e=n[r],this._fonts.push(e),e.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()):settings.ADAPTER.fetch(r).then(e=>e.blob()).then(async n=>new Promise((e,t)=>{let r=URL.createObjectURL(n),i=new FileReader;i.onload=()=>e([r,i.result]),i.onerror=t,i.readAsDataURL(n)})).then(async([e,t])=>{e=Object.assign({family:path.basename(r,path.extname(r)),weight:"normal",style:"normal",display:"auto",src:e,dataSrc:t,refs:1,originalUrl:r,fontFace:null},i),n[r]=e,this._fonts.push(e),this.styleID++,t=new FontFace(e.family,`url(${e.src})`,{weight:e.weight,style:e.style,display:e.display});await(e.fontFace=t).load(),document.fonts.add(t),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){e=e.filter(e=>!this._overrides.includes(e));0<e.length&&(this._overrides.push(...e),this.styleID++)}removeOverride(...e){let t=e.filter(e=>this._overrides.includes(e));0<t.length&&(this._overrides=this._overrides.filter(e=>!t.includes(e)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block","color: "+this.normalizeColor(this.fill),`font-size: ${this.fontSize}px`,"font-family: "+this.fontFamily,"font-weight: "+this.fontWeight,"font-style: "+this.fontStyle,"font-variant: "+this.fontVariant,`letter-spacing: ${this.letterSpacing}px`,"text-align: "+this.align,`padding: ${this.padding}px`,"white-space: "+this.whiteSpace,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?["word-wrap: "+(this.breakWords?"break-all":"break-word"),`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,"-webkit-text-stroke-color: "+this.normalizeColor(this.stroke),`text-stroke-width: ${this.strokeThickness}px`,"text-stroke-color: "+this.normalizeColor(this.stroke),"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style};
                font-display: ${t.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return"number"==typeof(e=Array.isArray(e)?rgb2hex(e):e)?hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor);var t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance),t=(e.startsWith("#")&&t<1&&(e+=(255*t|0).toString(16).padStart(2,"0")),r+`px ${i}px`);return 0<this.dropShadowBlur?`text-shadow: ${t} ${this.dropShadowBlur}px `+e:`text-shadow: ${t} `+e}reset(){Object.assign(this,_HTMLTextStyle2.defaultOptions)}onBeforeDraw(){var e=this.fontsDirty;return this.fontsDirty=!1,this.isSafari&&0<this._fonts.length&&e?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){var e=settings.ADAPTER.getNavigator().userAgent;return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){}get fillGradientType(){return super.fillGradientType}set miterLimit(e){}get miterLimit(){return super.miterLimit}set trim(e){}get trim(){return super.trim}set textBaseline(e){}get textBaseline(){return super.textBaseline}set leading(e){}get leading(){return super.leading}set lineJoin(e){}get lineJoin(){return super.lineJoin}}),HTMLTextStyle=(_HTMLTextStyle.availableFonts={},_HTMLTextStyle.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100},_HTMLTextStyle),_HTMLText=class _HTMLText2 extends Sprite{constructor(e="",t={}){super(Texture.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;var r=new Image,i=Texture.from(r,{scaleMode:settings.SCALE_MODE,resourceOptions:{autoLoad:!1}}),i=(i.orig=new Rectangle,i.trim=new Rectangle,this.texture=i,"http://www.w3.org/2000/svg"),n="http://www.w3.org/1999/xhtml",a=document.createElementNS(i,"svg"),i=document.createElementNS(i,"foreignObject"),s=document.createElementNS(n,"div"),n=document.createElementNS(n,"style");i.setAttribute("width","10000"),i.setAttribute("height","10000"),i.style.overflow="hidden",a.appendChild(i),this.maxWidth=_HTMLText2.defaultMaxWidth,this.maxHeight=_HTMLText2.defaultMaxHeight,this._domElement=s,this._styleElement=n,this._svgRoot=a,this._foreignObject=i,this._foreignObject.appendChild(n),this._foreignObject.appendChild(s),this._image=r,this._loadImage=new Image,this._autoResolution=_HTMLText2.defaultAutoResolution,this._resolution=_HTMLText2.defaultResolution??settings.RESOLUTION,this.text=e,this.style=t}measureText(e){var{text:e,style:t,resolution:r}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e),i=(Object.assign(this._domElement,{innerHTML:e,style:t.toCSS(r)}),this._styleElement.textContent=t.toGlobalCSS(),document.body.appendChild(this._svgRoot),this._domElement.getBoundingClientRect()),{width:i,height:n}=(this._svgRoot.remove(),i),i=(i>this.maxWidth||this.maxHeight,Math.min(this.maxWidth,Math.ceil(i))),n=Math.min(this.maxHeight,Math.ceil(n));return this._svgRoot.setAttribute("width",i.toString()),this._svgRoot.setAttribute("height",n.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),t!==this._style&&(Object.assign(this._domElement,{style:null==(e=this._style)?void 0:e.toCSS(r)}),this._styleElement.textContent=null==(e=this._style)?void 0:e.toGlobalCSS()),{width:i+2*t.padding,height:n+2*t.padding}}async updateText(e=!0){let{style:i,_image:n,_loadImage:a}=this;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),this.dirty||!e){var{width:e,height:t}=this.measureText();n.width=a.width=Math.ceil(Math.max(1,e)),n.height=a.height=Math.ceil(Math.max(1,t)),this._updateID++;let r=this._updateID;await new Promise(e=>{a.onload=async()=>{r<this._updateID||(await i.onBeforeDraw(),n.src=a.src,a.onload=null,a.src="",this.updateTexture()),e()};var t=(new XMLSerializer).serializeToString(this._svgRoot);a.src="data:image/svg+xml;charset=utf8,"+encodeURIComponent(t)})}}get source(){return this._image}updateTexture(){var{style:e,texture:t,_image:r,resolution:i}=this,e=e.padding,n=t.baseTexture;t.trim.width=t._frame.width=r.width/i,t.trim.height=t._frame.height=r.height/i,t.trim.x=-e,t.trim.y=-e,t.orig.width=t._frame.width-2*e,t.orig.height=t._frame.height-2*e,this._onTextureUpdate(),n.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},_HTMLText2.defaultDestroyOptions,e),super.destroy(e);this.ownsStyle&&null!=(e=this._style)&&e.cleanFonts(),(this._style=null)!=(e=this._svgRoot)&&e.remove(),(this._svgRoot=null)!=(e=this._domElement)&&e.remove(),(this._domElement=null)!=(e=this._foreignObject)&&e.remove(),(this._foreignObject=null)!=(e=this._styleElement)&&e.remove(),this._styleElement=null,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=null,this._image.src="",this._image=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);var t=sign$1(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);var t=sign$1(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&((e=e||{})instanceof HTMLTextStyle?(this.ownsStyle=!1,this._style=e):e instanceof TextStyle?(this.ownsStyle=!0,this._style=HTMLTextStyle.from(e)):(this.ownsStyle=!0,this._style=new HTMLTextStyle(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(""===e||null==e?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}},HTMLText=(_HTMLText.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},_HTMLText.defaultMaxWidth=2024,_HTMLText.defaultMaxHeight=2024,_HTMLText.defaultAutoResolution=!0,_HTMLText),PIXI=Object.freeze(Object.defineProperty({__proto__:null,ALPHA_MODES:ALPHA_MODES,AbstractMultiResource:AbstractMultiResource,AccessibilityManager:AccessibilityManager,AlphaFilter:AlphaFilter,AnimatedSprite:AnimatedSprite,Application:Application,ArrayResource:ArrayResource,Assets:Assets,AssetsClass:AssetsClass,Attribute:Attribute,BLEND_MODES:BLEND_MODES,BUFFER_BITS:BUFFER_BITS,BUFFER_TYPE:BUFFER_TYPE,BackgroundSystem:BackgroundSystem,BaseImageResource:BaseImageResource,BasePrepare:BasePrepare,BaseRenderTexture:BaseRenderTexture,BaseTexture:BaseTexture,BatchDrawCall:BatchDrawCall,BatchGeometry:BatchGeometry,BatchRenderer:BatchRenderer,BatchShaderGenerator:BatchShaderGenerator,BatchSystem:BatchSystem,BatchTextureArray:BatchTextureArray,BitmapFont:BitmapFont,BitmapFontData:BitmapFontData,BitmapText:BitmapText,BlobResource:BlobResource,BlurFilter:BlurFilter,BlurFilterPass:BlurFilterPass,Bounds:Bounds,BrowserAdapter:BrowserAdapter,Buffer:Buffer$2,BufferResource:BufferResource,BufferSystem:BufferSystem,CLEAR_MODES:CLEAR_MODES,COLOR_MASK_BITS:COLOR_MASK_BITS,Cache:Cache,CanvasResource:CanvasResource,Circle:Circle,Color:Color,ColorMatrixFilter:ColorMatrixFilter,CompressedTextureResource:CompressedTextureResource,Container:Container,ContextSystem:ContextSystem,CountLimiter:CountLimiter,CubeResource:CubeResource,DEG_TO_RAD:DEG_TO_RAD,DRAW_MODES:DRAW_MODES,DisplacementFilter:DisplacementFilter,DisplayObject:DisplayObject,ENV:ENV,Ellipse:Ellipse,EventBoundary:EventBoundary,EventSystem:EventSystem,ExtensionType:ExtensionType,Extract:Extract,FORMATS:FORMATS,FORMATS_TO_COMPONENTS:FORMATS_TO_COMPONENTS,FXAAFilter:FXAAFilter,FederatedDisplayObject:FederatedDisplayObject,FederatedEvent:FederatedEvent,FederatedMouseEvent:FederatedMouseEvent,FederatedPointerEvent:FederatedPointerEvent,FederatedWheelEvent:FederatedWheelEvent,FillStyle:FillStyle,Filter:Filter,FilterState:FilterState,FilterSystem:FilterSystem,Framebuffer:Framebuffer,FramebufferSystem:FramebufferSystem,GC_MODES:GC_MODES,GLFramebuffer:GLFramebuffer,GLProgram:GLProgram,GLTexture:GLTexture,GRAPHICS_CURVES:GRAPHICS_CURVES,GenerateTextureSystem:GenerateTextureSystem,Geometry:Geometry,GeometrySystem:GeometrySystem,Graphics:Graphics,GraphicsData:GraphicsData,GraphicsGeometry:GraphicsGeometry,HTMLText:HTMLText,HTMLTextStyle:HTMLTextStyle,IGLUniformData:IGLUniformData,INSTALLED:INSTALLED,INTERNAL_FORMATS:INTERNAL_FORMATS,INTERNAL_FORMAT_TO_BYTES_PER_PIXEL:INTERNAL_FORMAT_TO_BYTES_PER_PIXEL,ImageBitmapResource:ImageBitmapResource,ImageResource:ImageResource,LINE_CAP:LINE_CAP,LINE_JOIN:LINE_JOIN,LineStyle:LineStyle,LoaderParserPriority:LoaderParserPriority,MASK_TYPES:MASK_TYPES,MIPMAP_MODES:MIPMAP_MODES,MSAA_QUALITY:MSAA_QUALITY,MaskData:MaskData,MaskSystem:MaskSystem,Matrix:Matrix,Mesh:Mesh,MeshBatchUvs:MeshBatchUvs,MeshGeometry:MeshGeometry,MeshMaterial:MeshMaterial,MultisampleSystem:MultisampleSystem,NineSlicePlane:NineSlicePlane,NoiseFilter:NoiseFilter,ObjectRenderer:ObjectRenderer,ObjectRendererSystem:ObjectRendererSystem,ObservablePoint:ObservablePoint,PI_2:PI_2,PRECISION:PRECISION,ParticleContainer:ParticleContainer,ParticleRenderer:ParticleRenderer,PlaneGeometry:PlaneGeometry,PluginSystem:PluginSystem,Point:Point,Polygon:Polygon,Prepare:Prepare,Program:Program,ProjectionSystem:ProjectionSystem,Quad:Quad,QuadUv:QuadUv,RAD_TO_DEG:RAD_TO_DEG,RENDERER_TYPE:RENDERER_TYPE,Rectangle:Rectangle,RenderTexture:RenderTexture,RenderTexturePool:RenderTexturePool,RenderTextureSystem:RenderTextureSystem,Renderer:Renderer,ResizePlugin:ResizePlugin,Resource:Resource,RopeGeometry:RopeGeometry,RoundedRectangle:RoundedRectangle,Runner:Runner,SAMPLER_TYPES:SAMPLER_TYPES,SCALE_MODES:SCALE_MODES,SHAPES:SHAPES,SVGResource:SVGResource,ScissorSystem:ScissorSystem,Shader:Shader,ShaderSystem:ShaderSystem,SimpleMesh:SimpleMesh,SimplePlane:SimplePlane,SimpleRope:SimpleRope,Sprite:Sprite,SpriteMaskFilter:SpriteMaskFilter,Spritesheet:Spritesheet,StartupSystem:StartupSystem,State:State,StateSystem:StateSystem,StencilSystem:StencilSystem,SystemManager:SystemManager,TARGETS:TARGETS,TEXT_GRADIENT:TEXT_GRADIENT,TYPES:TYPES,TYPES_TO_BYTES_PER_COMPONENT:TYPES_TO_BYTES_PER_COMPONENT,TYPES_TO_BYTES_PER_PIXEL:TYPES_TO_BYTES_PER_PIXEL,TemporaryDisplayObject:TemporaryDisplayObject,Text:Text,TextFormat:TextFormat,TextMetrics:TextMetrics,TextStyle:TextStyle,Texture:Texture,TextureGCSystem:TextureGCSystem,TextureMatrix:TextureMatrix,TextureSystem:TextureSystem,TextureUvs:TextureUvs,Ticker:Ticker,TickerPlugin:TickerPlugin,TilingSprite:TilingSprite,TilingSpriteRenderer:TilingSpriteRenderer,TimeLimiter:TimeLimiter,Transform:Transform,TransformFeedback:TransformFeedback,TransformFeedbackSystem:TransformFeedbackSystem,UPDATE_PRIORITY:UPDATE_PRIORITY,UniformGroup:UniformGroup,VERSION:VERSION,VideoResource:VideoResource,ViewSystem:ViewSystem,ViewableBuffer:ViewableBuffer,WRAP_MODES:WRAP_MODES,XMLFormat:XMLFormat,XMLStringFormat:XMLStringFormat,accessibleTarget:accessibleTarget,autoDetectFormat:autoDetectFormat,autoDetectRenderer:autoDetectRenderer,autoDetectResource:autoDetectResource,cacheTextureArray:cacheTextureArray,checkDataUrl:checkDataUrl,checkExtension:checkExtension,checkMaxIfStatementsInShader:checkMaxIfStatementsInShader,convertToList:convertToList,copySearchParams:copySearchParams,createStringVariations:createStringVariations,createTexture:createTexture,createUBOElements:createUBOElements,curves:curves,defaultFilterVertex:defaultFilterVertex,defaultVertex:defaultVertex,detectAvif:detectAvif,detectCompressedTextures:detectCompressedTextures,detectDefaults:detectDefaults,detectMp4:detectMp4,detectOgv:detectOgv,detectWebm:detectWebm,detectWebp:detectWebp,extensions:extensions$1,filters:filters$2,generateProgram:generateProgram,generateUniformBufferSync:generateUniformBufferSync,getFontFamilyName:getFontFamilyName,getTestContext:getTestContext,getUBOData:getUBOData,graphicsUtils:graphicsUtils,groupD8:groupD8,isMobile:isMobile,isSingleItem:isSingleItem,loadBitmapFont:loadBitmapFont,loadDDS:loadDDS,loadImageBitmap:loadImageBitmap,loadJson:loadJson,loadKTX:loadKTX,loadSVG:loadSVG,loadTextures:loadTextures,loadTxt:loadTxt,loadVideo:loadVideo,loadWebFont:loadWebFont,parseDDS:parseDDS,parseKTX:parseKTX,resolveCompressedTextureUrl:resolveCompressedTextureUrl,resolveTextureUrl:resolveTextureUrl,settings:settings,spritesheetAsset:spritesheetAsset,uniformParsers:uniformParsers,unsafeEvalSupported:unsafeEvalSupported,utils:index},Symbol.toStringTag,{value:"Module"}));var pubsub$1={exports:{}},pubsubExports=(pubsub$1.exports,((e,t)=>{function o(e,t,r){try{e(t,r)}catch(e){setTimeout((i=e,function(){throw i}),0)}var i}function l(e,t,r){e(t,r)}function u(e,t,r,i){var n,a=d[t],s=i?l:o;if(Object.prototype.hasOwnProperty.call(d,t))for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&s(a[n],e,r)}function c(e){e=String(e);return Boolean(Object.prototype.hasOwnProperty.call(d,e)&&(e=>{for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1})(d[e]))}function r(e,t,r,i){e="symbol"==typeof e?e.toString():e;a=t,s=i;var n,a,s,t=function(){var e=String(n),t=e.lastIndexOf(".");for(u(n,n,a,s);-1!==t;)t=(e=e.substr(0,t)).lastIndexOf("."),u(n,e,a,s);u(n,p,a,s)};return!!(e=>{for(var t=String(e),r=c(t)||c(p),i=t.lastIndexOf(".");!r&&-1!==i;)i=(t=t.substr(0,i)).lastIndexOf("."),r=c(t);return r})(n=e)&&(!0===r?t():setTimeout(t,0),!0)}var i,h,d,n,p,a;i="object"==typeof window&&window||commonjsGlobal,a={},i.PubSub?a=i.PubSub:(i.PubSub=a,d={},n=-1,p="*",(h=a).publish=function(e,t){return r(e,t,!1,h.immediateExceptions)},h.publishSync=function(e,t){return r(e,t,!0,h.immediateExceptions)},h.subscribe=function(e,t){if("function"!=typeof t)return!1;e="symbol"==typeof e?e.toString():e,Object.prototype.hasOwnProperty.call(d,e)||(d[e]={});var r="uid_"+String(++n);return d[e][r]=t,r},h.subscribeAll=function(e){return h.subscribe(p,e)},h.subscribeOnce=function(e,t){var r=h.subscribe(e,function(){h.unsubscribe(r),t.apply(this,arguments)});return h},h.clearAllSubscriptions=function(){d={}},h.clearSubscriptions=function(e){for(var t in d)Object.prototype.hasOwnProperty.call(d,t)&&0===t.indexOf(e)&&delete d[t]},h.countSubscriptions=function(e){var t,r,i=0;for(t in d)if(Object.prototype.hasOwnProperty.call(d,t)&&0===t.indexOf(e)){for(r in d[t])i++;break}return i},h.getSubscriptions=function(e){var t,r=[];for(t in d)Object.prototype.hasOwnProperty.call(d,t)&&0===t.indexOf(e)&&r.push(t);return r},h.unsubscribe=function(e){var t,r,i,n="string"==typeof e&&(Object.prototype.hasOwnProperty.call(d,e)||(e=>{for(var t in d)if(Object.prototype.hasOwnProperty.call(d,t)&&0===t.indexOf(e))return!0;return!1})(e)),a=!n&&"string"==typeof e,s="function"==typeof e,o=!1;if(!n){for(t in d)if(Object.prototype.hasOwnProperty.call(d,t)){if(r=d[t],a&&r[e]){delete r[e],o=e;break}if(s)for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&r[i]===e&&(delete r[i],o=!0)}return o}h.clearSubscriptions(e)}),(t=void 0!==e&&e.exports?e.exports=a:t).PubSub=a,e.exports=t=a})(pubsub$1,pubsub$1.exports),pubsub$1.exports);let pubsub=getDefaultExportFromCjs(pubsubExports);function useSyncPixiElement(r,a,s,o){let e=a.store,l=6,t=(o&&void 0===o.scale&&(o.scale=1),t=>{i(t,r),e.captionContainer.children.forEach(e=>{r.name!==e.name&&i(t,e)})}),i=(i,n)=>{var e=(s.forEach(e=>{switch(e){case"x":case"y":n.position[e]=toNum(i[e]||0,l);break;case"alpha":n.alpha=toNum(i[e]??1,l);break;case"rotation":n[e]=toNum(i[e]||0,l);break;case"width":case"height":var t=n.children.find(e=>"element"===e.name),r=o?o.scale:1;t[e]=toNum(i[e]||0,l)*r}}),o).flipx,{width:e,height:t}=(void 0===e||n.scaleFlipXLock||(n.scale.x=e?-1:1),n.getLocalBounds());n.pivot.set(toNum(e/2,l),toNum(t/2,l)),null!=(e=a.animateRef)&&e.current&&null!=(t=a.animateRef)&&t.current.update(a.relativeTime??0)},n=o?o.style:null;var u=o?o.flipx:null;return reactExports.useEffect(()=>{n&&("caption"===(null==o?void 0:o.type)?t(n):i(n,r))},[null==n?void 0:n.x,null==n?void 0:n.y,null==n?void 0:n.alpha,null==n?void 0:n.height,null==n?void 0:n.width,null==n?void 0:n.rotation,u,null==o?void 0:o.scale,null==o?void 0:o.cropSize]),reactExports.useEffect(()=>{o&&(r.name=null==o?void 0:o.id),r.elementData=o,r.visible=a.visible,a.hide&&(r.visible=!1),"editor"===e.env&&pubsub.publish(e.events.VISIBLE_CONTROL,{visible:a.visible,elementId:null==o?void 0:o.id})},[a.visible,a.hide]),reactExports.useEffect(()=>{a.lock?r.interactive=!1:r.interactive=!0},[a.lock]),reactExports.useEffect(()=>{if(a.parent)return a.parent.addChild(r),()=>{r.destroy({children:0!==r.children.length})}},[]),[i,t]}function ContainerElement(t){let{visible:e,scale:r,sortableChildren:i,sortChildrenUpdate:n,placeholderGraphics:a,backgroundColor:s,store:o,trackIndex:l}=t,u=reactExports.useMemo(()=>{var e=new Container;return t.name&&(e.name=t.name),e},[]),c=("body"===t.name&&(o.bodyContainer=u),"caption"===t.name&&(o.captionContainer=u),reactExports.useEffect(()=>{u.zIndex=config.MAX_TRACKINDEX-l},[l]),reactExports.useEffect(()=>{void 0!==r&&u.scale.set(r)},[r]),reactExports.useEffect(()=>{i&&(u.sortableChildren=!0,u.sortDirty=!0)},[n]),{width:o.data.width,height:o.data.height});reactExports.useEffect(()=>{var e;a&&((e=u.children.find(e=>"placeholderGraphics"===e.name))?(e.clear(),e.lineStyle(1,0,1e-5,1),e.drawRect(c.width/2,c.height/2,c.width,c.height),e.endFill(),e.pivot.set(c.width/2,c.height/2)):((e=new Graphics).lineStyle(1,0,1e-5,1),e.drawRect(c.width/2,c.height/2,c.width,c.height),e.endFill(),e.pivot.set(c.width/2,c.height/2),e.name="placeholderGraphics",u.addChild(e))),s&&((e=u.children.find(e=>"backgroundColor"===e.name))?(e.clear(),e.beginFill(s),e.drawRect(c.width/2,c.height/2,c.width,c.height),e.endFill(),e.pivot.set(c.width/2,c.height/2)):((e=new Graphics).beginFill(s),e.drawRect(c.width/2,c.height/2,c.width,c.height),e.endFill(),e.pivot.set(c.width/2,c.height/2),e.name="backgroundColor",u.addChild(e)))},[a,s,c.width,c.height]),useSyncPixiElement(u,{parent:t.parent,style:{x:t.x||0,y:t.y||0,alpha:1},visible:e,hide:t.hide,lock:t.lock,store:t.store},["x","y"]);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:childrenInjectProps({parent:u},t.children)})}var root$2=_root,now$2=function(){return root$2.Date.now()},now_1=now$2,reWhitespace=/\s/;function trimmedEndIndex$1(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var _trimmedEndIndex=trimmedEndIndex$1,trimmedEndIndex=_trimmedEndIndex,reTrimStart=/^\s+/;function baseTrim$1(e){return e&&e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,"")}var _baseTrim=baseTrim$1,baseTrim=_baseTrim,isObject$6=isObject_1,isSymbol$1=isSymbol_1,NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber$1(e){if("number"==typeof e)return e;if(isSymbol$1(e))return NAN;if(isObject$6(e)&&(t="function"==typeof e.valueOf?e.valueOf():e,e=isObject$6(t)?t+"":t),"string"!=typeof e)return 0===e?e:+e;e=baseTrim(e);var t=reIsBinary.test(e);return t||reIsOctal.test(e)?freeParseInt(e.slice(2),t?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_1=toNumber$1,isObject$5=isObject_1,now$1=now_1,toNumber=toNumber_1,FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin=Math.min;function debounce(i,r,e){var n,a,s,o,l,u,c=0,h=!1,d=!1,t=!0;if("function"!=typeof i)throw new TypeError(FUNC_ERROR_TEXT$1);function p(e){var t=n,r=a;return n=a=void 0,c=e,o=i.apply(r,t)}function f(e){var t=e-u;return void 0===u||r<=t||t<0||d&&s<=e-c}function m(){var e,t=now$1();if(f(t))return g(t);l=setTimeout(m,(e=r-((t=t)-u),d?nativeMin(e,s-(t-c)):e))}function g(e){return l=void 0,t&&n?p(e):(n=a=void 0,o)}function v(){var e=now$1(),t=f(e);if(n=arguments,a=this,u=e,t){if(void 0===l)return c=e=u,l=setTimeout(m,r),h?p(e):o;if(d)return clearTimeout(l),l=setTimeout(m,r),p(u)}return void 0===l&&(l=setTimeout(m,r)),o}return r=toNumber(r)||0,isObject$5(e)&&(h=!!e.leading,d="maxWait"in e,s=d?nativeMax$1(toNumber(e.maxWait)||0,r):s,t="trailing"in e?!!e.trailing:t),v.cancel=function(){void 0!==l&&clearTimeout(l),n=u=a=l=void(c=0)},v.flush=function(){return void 0===l?o:g(now$1())},v}var debounce_1=debounce;let debounce$1=getDefaultExportFromCjs(debounce_1),pow=Math.pow,sqrt=Math.sqrt,sin=Math.sin,cos=Math.cos,PI=Math.PI,c1=1.70158,c2=1.525*c1,c3=c1+1,c4=2*PI/3,c5=2*PI/4.5,bounceOut=function(e){var t=7.5625;return e<1/2.75?t*e*e:e<2/2.75?t*(e-=1.5/2.75)*e+.75:e<2.5/2.75?t*(e-=2.25/2.75)*e+.9375:t*(e-=2.625/2.75)*e+.984375},easingsFunctions={linear:e=>e,easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-pow(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-pow(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-pow(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-pow(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-pow(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-pow(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-pow(-2*e+2,5)/2},easeInSine:function(e){return 1-cos(e*PI/2)},easeOutSine:function(e){return sin(e*PI/2)},easeInOutSine:function(e){return-(cos(PI*e)-1)/2},easeInExpo:function(e){return 0===e?0:pow(2,10*e-10)},easeOutExpo:function(e){return 1===e?1:1-pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:e<.5?pow(2,20*e-10)/2:(2-pow(2,-20*e+10))/2},easeInCirc:function(e){return 1-sqrt(1-pow(e,2))},easeOutCirc:function(e){return sqrt(1-pow(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-sqrt(1-pow(2*e,2)))/2:(sqrt(1-pow(-2*e+2,2))+1)/2},easeInBack:function(e){return c3*e*e*e-c1*e*e},easeOutBack:function(e){return 1+c3*pow(e-1,3)+c1*pow(e-1,2)},easeInOutBack:function(e){return e<.5?pow(2*e,2)*(2*(c2+1)*e-c2)/2:(pow(2*e-2,2)*((c2+1)*(2*e-2)+c2)+2)/2},easeInElastic:function(e){return 0===e?0:1===e?1:-pow(2,10*e-10)*sin((10*e-10.75)*c4)},easeOutElastic:function(e){return 0===e?0:1===e?1:pow(2,-10*e)*sin((10*e-.75)*c4)+1},easeInOutElastic:function(e){return 0===e?0:1===e?1:e<.5?-(pow(2,20*e-10)*sin((20*e-11.125)*c5))/2:pow(2,-20*e+10)*sin((20*e-11.125)*c5)/2+1},easeInBounce:function(e){return 1-bounceOut(1-e)},easeOutBounce:bounceOut,easeInOutBounce:function(e){return e<.5?(1-bounceOut(1-2*e))/2:(1+bounceOut(2*e-1))/2}};function getNowFrame(e){var{animateStatusFrames:i,time:n,duration:e,getStyleValue:a}=e;let s=null;if(i.length){var t=i.length,o=toJS(i[t-1]);o.time=e;for(let r=0;r<t+1;r++){var l=i[r]||o;if(n<=l.time){let e=i[r-1];e=e||l;var u,c=l.time-e.time==0?0:(n-e.time)/(l.time-e.time);let t=c;e.ease&&(t=easingsFunctions[e.ease](c)),l&&e&&(u={translateX:0,translateY:0,rotation:0,scaleX:1,scaleY:1,skewX:0,skewY:0},a?(e.width=e.width??a("width"),e.height=e.height??a("height"),e.alpha=e.alpha??a("alpha"),l.width=l.width??a("width"),l.height=l.height??a("height"),l.alpha=l.alpha??a("alpha")):(e.width=e.width,e.height=e.height,e.alpha=e.alpha,l.width=l.width,l.height=l.height,l.alpha=l.alpha),e.transform=Object.assign({...u},e.transform),l.transform=Object.assign({...u},l.transform),s={width:(l.width-e.width)*t+e.width,height:(l.height-e.height)*t+e.height,alpha:(l.alpha-e.alpha)*c+e.alpha,transform:{translateX:(l.transform.translateX-e.transform.translateX)*t+e.transform.translateX,translateY:(l.transform.translateY-e.transform.translateY)*t+e.transform.translateY,rotation:(l.transform.rotation-e.transform.rotation)*t+e.transform.rotation,scaleX:(l.transform.scaleX-e.transform.scaleX)*t+e.transform.scaleX,scaleY:(l.transform.scaleY-e.transform.scaleY)*t+e.transform.scaleY,skewX:(l.transform.skewX-e.transform.skewX)*t+e.transform.skewX,skewY:(l.transform.skewY-e.transform.skewY)*t+e.transform.skewY}});break}}}return s}function Animate(e,t){let{elementData:n,pixiElem:r,linkPixiElems:a,relativeTime:i}=e,s=reactExports.useRef([]),o=reactExports.useRef(null),l=reactExports.useRef({});return reactExports.useEffect(()=>{let i=e=>{var t=n.style;return t?"alpha"===e&&void 0===t.alpha?1:t[e]??0:0},t=(e,t)=>{var r=n.flipx;e.nowStatus=t,e.width=t.width+i("width"),e.height=t.width+i("height"),e.alpha=t.alpha*i("alpha"),e.position.x=t.transform.translateX+i("x"),e.position.y=t.transform.translateY+i("y"),e.rotation=t.transform.rotation+i("rotation"),e.scale.x=t.transform.scaleX*(r?-1:1),e.scale.y=t.transform.scaleY,e.skew.x=t.transform.skewX+0,e.skew.y=t.transform.skewY+0};l.current={update(e){o.current=getNowFrame({animateStatusFrames:s.current,time:e,duration:n.duration,getStyleValue:i}),o.current&&(t(r,o.current),a)&&a.forEach(e=>{t(e,o.current)})}}},[]),reactExports.useImperativeHandle(t,()=>({getNowStatusFrame:()=>({...o.current}),update:e=>{var t;null!=(t=l.current)&&t.update(e)}})),reactExports.useEffect(()=>{var e;return e=n.animates,s.current=[],e&&e.length&&e.sort((e,t)=>e.start-t.start).forEach(e=>{let{duration:r,start:i,ease:n}=e;e.frames.forEach(e=>{var t=e.progress*r+i;s.current.push({time:t,id:createID(),ease:n,transform:{...e.transform},alpha:e.alpha,width:e.width,height:e.height,_dirty:createID()})})}),setTimeout(()=>{var e;null!=(e=l.current)&&e.update(i||0)},0),()=>{delete r.nowStatus}},[n.animates,n._animationDirty]),reactExports.useEffect(()=>{var e;null!==i?null!=(e=l.current)&&e.update(i):o.current=null},[i,n.animates,n._dirty]),null}let Animate$1=reactExports.forwardRef(Animate);function ControlElment(e){let t=e.element,r=(void 0===t.scale&&(t.scale=1),e.scale);var{x:i=0,y:n=0,width:a=0,height:s=0,rotation:o=0}=t.style,l=e.isCaption?config.MAX_TRACKINDEX+100:e.store.zIndexObjects[t.id];reactExports.useEffect(()=>(e.store.cacheControlElementIds.includes(t.id)&&e.store.updateControl("triggerNoCallback",[t.id]),()=>{e.store.updateControl("triggerNoCallback",[])}),[t._dirty]);let u="initial",c=(e.visible||(u="none"),e.hide&&(u="none"),e.lock&&(u="none"),t.mask);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{"data-pixi":"sprite","data-elementid":t.id,"data-scale":t.scale,"data-trackindex":e.trackIndex,style:{opacity:e.visible?1:0,pointerEvents:u,position:"absolute",zIndex:l,top:0,left:0,width:a*r*t.scale,height:s*r*t.scale,transform:`translate(${(i-a*t.scale/2)*r}px, ${(n-s*t.scale/2)*r}px) rotate(${180*o/Math.PI}deg)`},children:c&&jsxRuntimeExports.jsx("div",{"data-maskid":t.id,style:{position:"absolute",top:0,left:0,width:(c.width||0)*r,height:(c.height||0)*r,transformOrigin:"center",transform:`translate(${(c.x-(c.width||0)/2)*r}px, ${(c.y-(c.height||0)/2)*r}px) rotate(${180*(c.rotation||0)/Math.PI}deg)`}})})})}var glTransitions=[{name:"Bounce",paramsTypes:{shadow_colour:"vec4",shadow_height:"float",bounces:"float"},defaultParams:{shadow_colour:[0,0,0,.6],shadow_height:.075,bounces:3},glsl:"// Author: Adrian Purser\n// License: MIT\n\nuniform vec4 shadow_colour; // = vec4(0.,0.,0.,.6)\nuniform float shadow_height; // = 0.075\nuniform float bounces; // = 3.0\n\nconst float PI = 3.14159265358;\n\nvec4 transition (vec2 uv) {\n  float time = progress;\n  float stime = sin(time * PI / 2.);\n  float phase = time * PI * bounces;\n  float y = (abs(cos(phase))) * (1.0 - stime);\n  float d = uv.y - y;\n  return mix(\n    mix(\n      getToColor(uv),\n      shadow_colour,\n      step(d, shadow_height) * (1. - mix(\n        ((d / shadow_height) * shadow_colour.a) + (1.0 - shadow_colour.a),\n        1.0,\n        smoothstep(0.95, 1., progress) // fade-out the shadow at the end\n      ))\n    ),\n    getFromColor(vec2(uv.x, uv.y + (1.0 - y))),\n    step(d, 0.0)\n  );\n}\n",author:"Adrian Purser",license:"MIT",createdAt:"Fri, 10 Nov 2017 17:01:45 +0000",updatedAt:"Sat, 11 Nov 2017 08:50:40 +0100"},{name:"BowTieHorizontal",paramsTypes:{},defaultParams:{},glsl:"// Author: huynx\n// License: MIT\n\nvec2 bottom_left = vec2(0.0, 1.0);\nvec2 bottom_right = vec2(1.0, 1.0);\nvec2 top_left = vec2(0.0, 0.0);\nvec2 top_right = vec2(1.0, 0.0);\nvec2 center = vec2(0.5, 0.5);\n\nfloat check(vec2 p1, vec2 p2, vec2 p3)\n{\n  return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);\n}\n\nbool PointInTriangle (vec2 pt, vec2 p1, vec2 p2, vec2 p3)\n{\n    bool b1, b2, b3;\n    b1 = check(pt, p1, p2) < 0.0;\n    b2 = check(pt, p2, p3) < 0.0;\n    b3 = check(pt, p3, p1) < 0.0;\n    return ((b1 == b2) && (b2 == b3));\n}\n\nbool in_left_triangle(vec2 p){\n  vec2 vertex1, vertex2, vertex3;\n  vertex1 = vec2(progress, 0.5);\n  vertex2 = vec2(0.0, 0.5-progress);\n  vertex3 = vec2(0.0, 0.5+progress);\n  if (PointInTriangle(p, vertex1, vertex2, vertex3))\n  {\n    return true;\n  }\n  return false;\n}\n\nbool in_right_triangle(vec2 p){\n  vec2 vertex1, vertex2, vertex3;\n  vertex1 = vec2(1.0-progress, 0.5);\n  vertex2 = vec2(1.0, 0.5-progress);\n  vertex3 = vec2(1.0, 0.5+progress);\n  if (PointInTriangle(p, vertex1, vertex2, vertex3))\n  {\n    return true;\n  }\n  return false;\n}\n\nfloat blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt)\n{\n  vec2 lineDir = bot1 - top;\n  vec2 perpDir = vec2(lineDir.y, -lineDir.x);\n  vec2 dirToPt1 = bot1 - testPt;\n  float dist1 = abs(dot(normalize(perpDir), dirToPt1));\n  \n  lineDir = bot2 - top;\n  perpDir = vec2(lineDir.y, -lineDir.x);\n  dirToPt1 = bot2 - testPt;\n  float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);\n  \n  if (min_dist < 0.005) {\n    return min_dist / 0.005;\n  }\n  else  {\n    return 1.0;\n  };\n}\n\n\nvec4 transition (vec2 uv) {\n  if (in_left_triangle(uv))\n  {\n    if (progress < 0.1)\n    {\n      return getFromColor(uv);\n    }\n    if (uv.x < 0.5)\n    {\n      vec2 vertex1 = vec2(progress, 0.5);\n      vec2 vertex2 = vec2(0.0, 0.5-progress);\n      vec2 vertex3 = vec2(0.0, 0.5+progress);\n      return mix(\n        getFromColor(uv),\n        getToColor(uv),\n        blur_edge(vertex2, vertex3, vertex1, uv)\n      );\n    }\n    else\n    {\n      if (progress > 0.0)\n      {\n        return getToColor(uv);\n      }\n      else\n      {\n        return getFromColor(uv);\n      }\n    }    \n  }\n  else if (in_right_triangle(uv))\n  {\n    if (uv.x >= 0.5)\n    {\n      vec2 vertex1 = vec2(1.0-progress, 0.5);\n      vec2 vertex2 = vec2(1.0, 0.5-progress);\n      vec2 vertex3 = vec2(1.0, 0.5+progress);\n      return mix(\n        getFromColor(uv),\n        getToColor(uv),\n        blur_edge(vertex2, vertex3, vertex1, uv)\n      );  \n    }\n    else\n    {\n      return getFromColor(uv);\n    }\n  }\n  else {\n    return getFromColor(uv);\n  }\n}",author:"huynx",license:"MIT",createdAt:"Sat, 24 Mar 2018 12:54:26 +0100",updatedAt:"Sat, 24 Mar 2018 12:54:26 +0100"},{name:"BowTieVertical",paramsTypes:{},defaultParams:{},glsl:"// Author: huynx\r\n// License: MIT\r\n\r\nfloat check(vec2 p1, vec2 p2, vec2 p3)\r\n{\r\n  return (p1.x - p3.x) * (p2.y - p3.y) - (p2.x - p3.x) * (p1.y - p3.y);\r\n}\r\n\r\nbool PointInTriangle (vec2 pt, vec2 p1, vec2 p2, vec2 p3)\r\n{\r\n    bool b1, b2, b3;\r\n    b1 = check(pt, p1, p2) < 0.0;\r\n    b2 = check(pt, p2, p3) < 0.0;\r\n    b3 = check(pt, p3, p1) < 0.0;\r\n    return ((b1 == b2) && (b2 == b3));\r\n}\r\n\r\nbool in_top_triangle(vec2 p){\r\n  vec2 vertex1, vertex2, vertex3;\r\n  vertex1 = vec2(0.5, progress);\r\n  vertex2 = vec2(0.5-progress, 0.0);\r\n  vertex3 = vec2(0.5+progress, 0.0);\r\n  if (PointInTriangle(p, vertex1, vertex2, vertex3))\r\n  {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nbool in_bottom_triangle(vec2 p){\r\n  vec2 vertex1, vertex2, vertex3;\r\n  vertex1 = vec2(0.5, 1.0 - progress);\r\n  vertex2 = vec2(0.5-progress, 1.0);\r\n  vertex3 = vec2(0.5+progress, 1.0);\r\n  if (PointInTriangle(p, vertex1, vertex2, vertex3))\r\n  {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfloat blur_edge(vec2 bot1, vec2 bot2, vec2 top, vec2 testPt)\r\n{\r\n  vec2 lineDir = bot1 - top;\r\n  vec2 perpDir = vec2(lineDir.y, -lineDir.x);\r\n  vec2 dirToPt1 = bot1 - testPt;\r\n  float dist1 = abs(dot(normalize(perpDir), dirToPt1));\r\n  \r\n  lineDir = bot2 - top;\r\n  perpDir = vec2(lineDir.y, -lineDir.x);\r\n  dirToPt1 = bot2 - testPt;\r\n  float min_dist = min(abs(dot(normalize(perpDir), dirToPt1)), dist1);\r\n  \r\n  if (min_dist < 0.005) {\r\n    return min_dist / 0.005;\r\n  }\r\n  else  {\r\n    return 1.0;\r\n  };\r\n}\r\n\r\n\r\nvec4 transition (vec2 uv) {\r\n  if (in_top_triangle(uv))\r\n  {\r\n    if (progress < 0.1)\r\n    {\r\n      return getFromColor(uv);\r\n    }\r\n    if (uv.y < 0.5)\r\n    {\r\n      vec2 vertex1 = vec2(0.5, progress);\r\n      vec2 vertex2 = vec2(0.5-progress, 0.0);\r\n      vec2 vertex3 = vec2(0.5+progress, 0.0);\r\n      return mix(\r\n        getFromColor(uv),\r\n        getToColor(uv),\r\n        blur_edge(vertex2, vertex3, vertex1, uv)\r\n      );\r\n    }\r\n    else\r\n    {\r\n      if (progress > 0.0)\r\n      {\r\n        return getToColor(uv);\r\n      }\r\n      else\r\n      {\r\n        return getFromColor(uv);\r\n      }\r\n    }    \r\n  }\r\n  else if (in_bottom_triangle(uv))\r\n  {\r\n    if (uv.y >= 0.5)\r\n    {\r\n      vec2 vertex1 = vec2(0.5, 1.0-progress);\r\n      vec2 vertex2 = vec2(0.5-progress, 1.0);\r\n      vec2 vertex3 = vec2(0.5+progress, 1.0);\r\n      return mix(\r\n        getFromColor(uv),\r\n        getToColor(uv),\r\n        blur_edge(vertex2, vertex3, vertex1, uv)\r\n      );  \r\n    }\r\n    else\r\n    {\r\n      return getFromColor(uv);\r\n    }\r\n  }\r\n  else {\r\n    return getFromColor(uv);\r\n  }\r\n}",author:"huynx",license:"MIT",createdAt:"Tue, 27 Mar 2018 10:07:54 +0700",updatedAt:"Tue, 27 Mar 2018 10:07:54 +0700"},{name:"ButterflyWaveScrawler",paramsTypes:{amplitude:"float",waves:"float",colorSeparation:"float"},defaultParams:{amplitude:1,waves:30,colorSeparation:.3},glsl:"// Author: mandubian\n// License: MIT\nuniform float amplitude; // = 1.0\nuniform float waves; // = 30.0\nuniform float colorSeparation; // = 0.3\nfloat PI = 3.14159265358979323846264;\nfloat compute(vec2 p, float progress, vec2 center) {\nvec2 o = p*sin(progress * amplitude)-center;\n// horizontal vector\nvec2 h = vec2(1., 0.);\n// butterfly polar function (don't ask me why this one :))\nfloat theta = acos(dot(o, h)) * waves;\nreturn (exp(cos(theta)) - 2.*cos(4.*theta) + pow(sin((2.*theta - PI) / 24.), 5.)) / 10.;\n}\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy;\n  float inv = 1. - progress;\n  vec2 dir = p - vec2(.5);\n  float dist = length(dir);\n  float disp = compute(p, progress, vec2(0.5, 0.5)) ;\n  vec4 texTo = getToColor(p + inv*disp);\n  vec4 texFrom = vec4(\n  getFromColor(p + progress*disp*(1.0 - colorSeparation)).r,\n  getFromColor(p + progress*disp).g,\n  getFromColor(p + progress*disp*(1.0 + colorSeparation)).b,\n  1.0);\n  return texTo*progress + texFrom*inv;\n}\n",author:"mandubian",license:"MIT",createdAt:"Thu, 1 Jun 2017 11:47:17 +0200",updatedAt:"Thu, 1 Jun 2017 11:47:17 +0200"},{name:"CircleCrop",paramsTypes:{bgcolor:"vec4"},defaultParams:{bgcolor:[0,0,0,1]},glsl:"// License: MIT\n// Author: fkuteken\n// ported by gre from https://gist.github.com/fkuteken/f63e3009c1143950dee9063c3b83fb88\n\nuniform vec4 bgcolor; // = vec4(0.0, 0.0, 0.0, 1.0)\n\nvec2 ratio2 = vec2(1.0, 1.0 / ratio);\nfloat s = pow(2.0 * abs(progress - 0.5), 3.0);\n\nvec4 transition(vec2 p) {\n  float dist = length((vec2(p) - 0.5) * ratio2);\n  return mix(\n    progress < 0.5 ? getFromColor(p) : getToColor(p), // branching is ok here as we statically depend on progress uniform (branching won't change over pixels)\n    bgcolor,\n    step(s, dist)\n  );\n}\n",license:"MIT",author:"fkuteken",createdAt:"Mon, 12 Jun 2017 12:52:34 +0800",updatedAt:"Mon, 12 Jun 2017 12:52:34 +0800"},{name:"ColourDistance",paramsTypes:{power:"float"},defaultParams:{power:5},glsl:"// License: MIT\n// Author: P-Seebauer\n// ported by gre from https://gist.github.com/P-Seebauer/2a5fa2f77c883dd661f9\n\nuniform float power; // = 5.0\n\nvec4 transition(vec2 p) {\n  vec4 fTex = getFromColor(p);\n  vec4 tTex = getToColor(p);\n  float m = step(distance(fTex, tTex), progress);\n  return mix(\n    mix(fTex, tTex, m),\n    tTex,\n    pow(progress, power)\n  );\n}\n",license:"MIT",author:"P-Seebauer",createdAt:"Mon, 12 Jun 2017 12:57:42 +0800",updatedAt:"Mon, 12 Jun 2017 12:57:42 +0800"},{name:"CrazyParametricFun",paramsTypes:{a:"float",b:"float",amplitude:"float",smoothness:"float"},defaultParams:{a:4,b:1,amplitude:120,smoothness:.1},glsl:"// Author: mandubian\n// License: MIT\n\nuniform float a; // = 4\nuniform float b; // = 1\nuniform float amplitude; // = 120\nuniform float smoothness; // = 0.1\n\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy;\n  vec2 dir = p - vec2(.5);\n  float dist = length(dir);\n  float x = (a - b) * cos(progress) + b * cos(progress * ((a / b) - 1.) );\n  float y = (a - b) * sin(progress) - b * sin(progress * ((a / b) - 1.));\n  vec2 offset = dir * vec2(sin(progress  * dist * amplitude * x), sin(progress * dist * amplitude * y)) / smoothness;\n  return mix(getFromColor(p + offset), getToColor(p), smoothstep(0.2, 1.0, progress));\n}\n",author:"mandubian",license:"MIT",createdAt:"Thu, 1 Jun 2017 13:03:12 +0200",updatedAt:"Thu, 1 Jun 2017 13:03:12 +0200"},{name:"CrossZoom",paramsTypes:{strength:"float"},defaultParams:{strength:.4},glsl:"// License: MIT\n// Author: rectalogic\n// ported by gre from https://gist.github.com/rectalogic/b86b90161503a0023231\n\n// Converted from https://github.com/rectalogic/rendermix-basic-effects/blob/master/assets/com/rendermix/CrossZoom/CrossZoom.frag\n// Which is based on https://github.com/evanw/glfx.js/blob/master/src/filters/blur/zoomblur.js\n// With additional easing functions from https://github.com/rectalogic/rendermix-basic-effects/blob/master/assets/com/rendermix/Easing/Easing.glsllib\n\nuniform float strength; // = 0.4\n\nconst float PI = 3.141592653589793;\n\nfloat Linear_ease(in float begin, in float change, in float duration, in float time) {\n    return change * time / duration + begin;\n}\n\nfloat Exponential_easeInOut(in float begin, in float change, in float duration, in float time) {\n    if (time == 0.0)\n        return begin;\n    else if (time == duration)\n        return begin + change;\n    time = time / (duration / 2.0);\n    if (time < 1.0)\n        return change / 2.0 * pow(2.0, 10.0 * (time - 1.0)) + begin;\n    return change / 2.0 * (-pow(2.0, -10.0 * (time - 1.0)) + 2.0) + begin;\n}\n\nfloat Sinusoidal_easeInOut(in float begin, in float change, in float duration, in float time) {\n    return -change / 2.0 * (cos(PI * time / duration) - 1.0) + begin;\n}\n\nfloat rand (vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec3 crossFade(in vec2 uv, in float dissolve) {\n    return mix(getFromColor(uv).rgb, getToColor(uv).rgb, dissolve);\n}\n\nvec4 transition(vec2 uv) {\n    vec2 texCoord = uv.xy / vec2(1.0).xy;\n\n    // Linear interpolate center across center half of the image\n    vec2 center = vec2(Linear_ease(0.25, 0.5, 1.0, progress), 0.5);\n    float dissolve = Exponential_easeInOut(0.0, 1.0, 1.0, progress);\n\n    // Mirrored sinusoidal loop. 0->strength then strength->0\n    float strength = Sinusoidal_easeInOut(0.0, strength, 0.5, progress);\n\n    vec3 color = vec3(0.0);\n    float total = 0.0;\n    vec2 toCenter = center - texCoord;\n\n    /* randomize the lookup values to hide the fixed number of samples */\n    float offset = rand(uv);\n\n    for (float t = 0.0; t <= 40.0; t++) {\n        float percent = (t + offset) / 40.0;\n        float weight = 4.0 * (percent - percent * percent);\n        color += crossFade(texCoord + toCenter * percent * strength, dissolve) * weight;\n        total += weight;\n    }\n    return vec4(color / total, 1.0);\n}\n",license:"MIT",author:"rectalogic",createdAt:"Mon, 12 Jun 2017 12:33:07 +0800",updatedAt:"Mon, 12 Jun 2017 12:33:07 +0800"},{name:"Directional",paramsTypes:{direction:"vec2"},defaultParams:{direction:[0,1]},glsl:"// Author: Gaëtan Renaudeau\n// License: MIT\n\nuniform vec2 direction; // = vec2(0.0, 1.0)\n\nvec4 transition (vec2 uv) {\n  vec2 p = uv + progress * sign(direction);\n  vec2 f = fract(p);\n  return mix(\n    getToColor(f),\n    getFromColor(f),\n    step(0.0, p.y) * step(p.y, 1.0) * step(0.0, p.x) * step(p.x, 1.0)\n  );\n}\n",author:"Gaëtan Renaudeau",license:"MIT",createdAt:"Thu, 19 Apr 2018 12:20:29 +0200",updatedAt:"Thu, 19 Apr 2018 12:20:29 +0200"},{name:"DoomScreenTransition",paramsTypes:{bars:"int",amplitude:"float",noise:"float",frequency:"float",dripScale:"float"},defaultParams:{bars:30,amplitude:2,noise:.1,frequency:.5,dripScale:.5},glsl:'// Author: Zeh Fernando\n// License: MIT\n\n\n// Transition parameters --------\n\n// Number of total bars/columns\nuniform int bars; // = 30\n\n// Multiplier for speed ratio. 0 = no variation when going down, higher = some elements go much faster\nuniform float amplitude; // = 2\n\n// Further variations in speed. 0 = no noise, 1 = super noisy (ignore frequency)\nuniform float noise; // = 0.1\n\n// Speed variation horizontally. the bigger the value, the shorter the waves\nuniform float frequency; // = 0.5\n\n// How much the bars seem to "run" from the middle of the screen first (sticking to the sides). 0 = no drip, 1 = curved drip\nuniform float dripScale; // = 0.5\n\n\n// The code proper --------\n\nfloat rand(int num) {\n  return fract(mod(float(num) * 67123.313, 12.0) * sin(float(num) * 10.3) * cos(float(num)));\n}\n\nfloat wave(int num) {\n  float fn = float(num) * frequency * 0.1 * float(bars);\n  return cos(fn * 0.5) * cos(fn * 0.13) * sin((fn+10.0) * 0.3) / 2.0 + 0.5;\n}\n\nfloat drip(int num) {\n  return sin(float(num) / float(bars - 1) * 3.141592) * dripScale;\n}\n\nfloat pos(int num) {\n  return (noise == 0.0 ? wave(num) : mix(wave(num), rand(num), noise)) + (dripScale == 0.0 ? 0.0 : drip(num));\n}\n\nvec4 transition(vec2 uv) {\n  int bar = int(uv.x * (float(bars)));\n  float scale = 1.0 + pos(bar) * amplitude;\n  float phase = progress * scale;\n  float posY = uv.y / vec2(1.0).y;\n  vec2 p;\n  vec4 c;\n  if (phase + posY < 1.0) {\n    p = vec2(uv.x, uv.y + mix(0.0, vec2(1.0).y, phase)) / vec2(1.0).xy;\n    c = getFromColor(p);\n  } else {\n    p = uv.xy / vec2(1.0).xy;\n    c = getToColor(p);\n  }\n\n  // Finally, apply the color\n  return c;\n}\n',author:"Zeh Fernando",license:"MIT",createdAt:"Tue, 30 May 2017 09:39:09 -0700",updatedAt:"Tue, 30 May 2017 09:39:09 -0700"},{name:"Dreamy",paramsTypes:{},defaultParams:{},glsl:"// Author: mikolalysenko\n// License: MIT\n\nvec2 offset(float progress, float x, float theta) {\n  float phase = progress*progress + progress + theta;\n  float shifty = 0.03*progress*cos(10.0*(progress+x));\n  return vec2(0, shifty);\n}\nvec4 transition(vec2 p) {\n  return mix(getFromColor(p + offset(progress, p.x, 0.0)), getToColor(p + offset(1.0-progress, p.x, 3.14)), progress);\n}\n",author:"mikolalysenko",license:"MIT",createdAt:"Mon, 12 Jun 2017 12:27:38 +0800",updatedAt:"Mon, 12 Jun 2017 12:27:38 +0800"},{name:"DreamyZoom",paramsTypes:{rotation:"float",scale:"float"},defaultParams:{rotation:6,scale:1.2},glsl:"// Author: Zeh Fernando\n// License: MIT\n\n// Definitions --------\n#define DEG2RAD 0.03926990816987241548078304229099 // 1/180*PI\n\n\n// Transition parameters --------\n\n// In degrees\nuniform float rotation; // = 6\n\n// Multiplier\nuniform float scale; // = 1.2\n\n\n// The code proper --------\n\nvec4 transition(vec2 uv) {\n  // Massage parameters\n  float phase = progress < 0.5 ? progress * 2.0 : (progress - 0.5) * 2.0;\n  float angleOffset = progress < 0.5 ? mix(0.0, rotation * DEG2RAD, phase) : mix(-rotation * DEG2RAD, 0.0, phase);\n  float newScale = progress < 0.5 ? mix(1.0, scale, phase) : mix(scale, 1.0, phase);\n  \n  vec2 center = vec2(0, 0);\n\n  // Calculate the source point\n  vec2 assumedCenter = vec2(0.5, 0.5);\n  vec2 p = (uv.xy - vec2(0.5, 0.5)) / newScale * vec2(ratio, 1.0);\n\n  // This can probably be optimized (with distance())\n  float angle = atan(p.y, p.x) + angleOffset;\n  float dist = distance(center, p);\n  p.x = cos(angle) * dist / ratio + 0.5;\n  p.y = sin(angle) * dist + 0.5;\n  vec4 c = progress < 0.5 ? getFromColor(p) : getToColor(p);\n\n  // Finally, apply the color\n  return c + (progress < 0.5 ? mix(0.0, 1.0, phase) : mix(1.0, 0.0, phase));\n}\n",author:"Zeh Fernando",license:"MIT",createdAt:"Tue, 30 May 2017 10:44:06 -0700",updatedAt:"Tue, 30 May 2017 10:44:06 -0700"},{name:"GlitchDisplace",paramsTypes:{},defaultParams:{},glsl:"// Author: Matt DesLauriers\n// License: MIT\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\nfloat voronoi( in vec2 x ) {\n    vec2 p = floor( x );\n    vec2 f = fract( x );\n    float res = 8.0;\n    for( float j=-1.; j<=1.; j++ )\n    for( float i=-1.; i<=1.; i++ ) {\n        vec2  b = vec2( i, j );\n        vec2  r = b - f + random( p + b );\n        float d = dot( r, r );\n        res = min( res, d );\n    }\n    return sqrt( res );\n}\n\nvec2 displace(vec4 tex, vec2 texCoord, float dotDepth, float textureDepth, float strength) {\n    float b = voronoi(.003 * texCoord + 2.0);\n    float g = voronoi(0.2 * texCoord);\n    float r = voronoi(texCoord - 1.0);\n    vec4 dt = tex * 1.0;\n    vec4 dis = dt * dotDepth + 1.0 - tex * textureDepth;\n\n    dis.x = dis.x - 1.0 + textureDepth*dotDepth;\n    dis.y = dis.y - 1.0 + textureDepth*dotDepth;\n    dis.x *= strength;\n    dis.y *= strength;\n    vec2 res_uv = texCoord ;\n    res_uv.x = res_uv.x + dis.x - 0.0;\n    res_uv.y = res_uv.y + dis.y;\n    return res_uv;\n}\n\nfloat ease1(float t) {\n  return t == 0.0 || t == 1.0\n    ? t\n    : t < 0.5\n      ? +0.5 * pow(2.0, (20.0 * t) - 10.0)\n      : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;\n}\nfloat ease2(float t) {\n  return t == 1.0 ? t : 1.0 - pow(2.0, -10.0 * t);\n}\n\n\n\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy;\n  vec4 color1 = getFromColor(p);\n  vec4 color2 = getToColor(p);\n  vec2 disp = displace(color1, p, 0.33, 0.7, 1.0-ease1(progress));\n  vec2 disp2 = displace(color2, p, 0.33, 0.5, ease2(progress));\n  vec4 dColor1 = getToColor(disp);\n  vec4 dColor2 = getFromColor(disp2);\n  float val = ease1(progress);\n  vec3 gray = vec3(dot(min(dColor2, dColor1).rgb, vec3(0.299, 0.587, 0.114)));\n  dColor2 = vec4(gray, 1.0);\n  dColor2 *= 2.0;\n  color1 = mix(color1, dColor2, smoothstep(0.0, 0.5, progress));\n  color2 = mix(color2, dColor1, smoothstep(1.0, 0.5, progress));\n  return mix(color1, color2, val);\n  //gl_FragColor = mix(gl_FragColor, dColor, smoothstep(0.0, 0.5, progress));\n  \n   //gl_FragColor = mix(texture2D(from, p), texture2D(to, p), progress);\n}\n",author:"Matt DesLauriers",license:"MIT",createdAt:"Tue, 30 May 2017 14:53:04 -0400",updatedAt:"Tue, 30 May 2017 14:53:04 -0400"},{name:"GlitchMemories",paramsTypes:{},defaultParams:{},glsl:"// author: Gunnar Roth\n// based on work from natewave\n// license: MIT\nvec4 transition(vec2 p) {\n  vec2 block = floor(p.xy / vec2(16));\n  vec2 uv_noise = block / vec2(64);\n  uv_noise += floor(vec2(progress) * vec2(1200.0, 3500.0)) / vec2(64);\n  vec2 dist = progress > 0.0 ? (fract(uv_noise) - 0.5) * 0.3 *(1.0 -progress) : vec2(0.0);\n  vec2 red = p + dist * 0.2;\n  vec2 green = p + dist * .3;\n  vec2 blue = p + dist * .5;\n\n  return vec4(mix(getFromColor(red), getToColor(red), progress).r,mix(getFromColor(green), getToColor(green), progress).g,mix(getFromColor(blue), getToColor(blue), progress).b,1.0);\n}\n\n",author:"Gunnar Roth",license:"MIT",createdAt:"Wed, 21 Feb 2018 00:52:15 +0100",updatedAt:"Wed, 21 Feb 2018 19:32:02 +0100"},{name:"GridFlip",paramsTypes:{size:"ivec2",pause:"float",dividerWidth:"float",bgcolor:"vec4",randomness:"float"},defaultParams:{size:[4,4],pause:.1,dividerWidth:.05,bgcolor:[0,0,0,1],randomness:.1},glsl:"// License: MIT\n// Author: TimDonselaar\n// ported by gre from https://gist.github.com/TimDonselaar/9bcd1c4b5934ba60087bdb55c2ea92e5\n\nuniform ivec2 size; // = ivec2(4)\nuniform float pause; // = 0.1\nuniform float dividerWidth; // = 0.05\nuniform vec4 bgcolor; // = vec4(0.0, 0.0, 0.0, 1.0)\nuniform float randomness; // = 0.1\n \nfloat rand (vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nfloat getDelta(vec2 p) {\n  vec2 rectanglePos = floor(vec2(size) * p);\n  vec2 rectangleSize = vec2(1.0 / vec2(size).x, 1.0 / vec2(size).y);\n  float top = rectangleSize.y * (rectanglePos.y + 1.0);\n  float bottom = rectangleSize.y * rectanglePos.y;\n  float left = rectangleSize.x * rectanglePos.x;\n  float right = rectangleSize.x * (rectanglePos.x + 1.0);\n  float minX = min(abs(p.x - left), abs(p.x - right));\n  float minY = min(abs(p.y - top), abs(p.y - bottom));\n  return min(minX, minY);\n}\n\nfloat getDividerSize() {\n  vec2 rectangleSize = vec2(1.0 / vec2(size).x, 1.0 / vec2(size).y);\n  return min(rectangleSize.x, rectangleSize.y) * dividerWidth;\n}\n\nvec4 transition(vec2 p) {\n  if(progress < pause) {\n    float currentProg = progress / pause;\n    float a = 1.0;\n    if(getDelta(p) < getDividerSize()) {\n      a = 1.0 - currentProg;\n    }\n    return mix(bgcolor, getFromColor(p), a);\n  }\n  else if(progress < 1.0 - pause){\n    if(getDelta(p) < getDividerSize()) {\n      return bgcolor;\n    } else {\n      float currentProg = (progress - pause) / (1.0 - pause * 2.0);\n      vec2 q = p;\n      vec2 rectanglePos = floor(vec2(size) * q);\n      \n      float r = rand(rectanglePos) - randomness;\n      float cp = smoothstep(0.0, 1.0 - r, currentProg);\n    \n      float rectangleSize = 1.0 / vec2(size).x;\n      float delta = rectanglePos.x * rectangleSize;\n      float offset = rectangleSize / 2.0 + delta;\n      \n      p.x = (p.x - offset)/abs(cp - 0.5)*0.5 + offset;\n      vec4 a = getFromColor(p);\n      vec4 b = getToColor(p);\n      \n      float s = step(abs(vec2(size).x * (q.x - delta) - 0.5), abs(cp - 0.5));\n      return mix(bgcolor, mix(b, a, step(cp, 0.5)), s);\n    }\n  }\n  else {\n    float currentProg = (progress - 1.0 + pause) / pause;\n    float a = 1.0;\n    if(getDelta(p) < getDividerSize()) {\n      a = currentProg;\n    }\n    return mix(bgcolor, getToColor(p), a);\n  }\n}\n",license:"MIT",author:"TimDonselaar",createdAt:"Mon, 12 Jun 2017 11:32:51 +0800",updatedAt:"Mon, 12 Jun 2017 11:32:51 +0800"},{name:"InvertedPageCurl",paramsTypes:{},defaultParams:{},glsl:'// author: Hewlett-Packard\n// license: BSD 3 Clause\n// Adapted by Sergey Kosarevsky from:\n// http://rectalogic.github.io/webvfx/examples_2transition-shader-pagecurl_8html-example.html\n\n/*\nCopyright (c) 2010 Hewlett-Packard Development Company, L.P. All rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n   * Redistributions of source code must retain the above copyright\n     notice, this list of conditions and the following disclaimer.\n   * Redistributions in binary form must reproduce the above\n     copyright notice, this list of conditions and the following disclaimer\n     in the documentation and/or other materials provided with the\n     distribution.\n   * Neither the name of Hewlett-Packard nor the names of its\n     contributors may be used to endorse or promote products derived from\n     this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\nin vec2 texCoord;\n*/\n\nconst float MIN_AMOUNT = -0.16;\nconst float MAX_AMOUNT = 1.5;\nfloat amount = progress * (MAX_AMOUNT - MIN_AMOUNT) + MIN_AMOUNT;\n\nconst float PI = 3.141592653589793;\n\nconst float scale = 512.0;\nconst float sharpness = 3.0;\n\nfloat cylinderCenter = amount;\n// 360 degrees * amount\nfloat cylinderAngle = 2.0 * PI * amount;\n\nconst float cylinderRadius = 1.0 / PI / 2.0;\n\nvec3 hitPoint(float hitAngle, float yc, vec3 point, mat3 rrotation)\n{\n        float hitPoint = hitAngle / (2.0 * PI);\n        point.y = hitPoint;\n        return rrotation * point;\n}\n\nvec4 antiAlias(vec4 color1, vec4 color2, float distanc)\n{\n        distanc *= scale;\n        if (distanc < 0.0) return color2;\n        if (distanc > 2.0) return color1;\n        float dd = pow(1.0 - distanc / 2.0, sharpness);\n        return ((color2 - color1) * dd) + color1;\n}\n\nfloat distanceToEdge(vec3 point)\n{\n        float dx = abs(point.x > 0.5 ? 1.0 - point.x : point.x);\n        float dy = abs(point.y > 0.5 ? 1.0 - point.y : point.y);\n        if (point.x < 0.0) dx = -point.x;\n        if (point.x > 1.0) dx = point.x - 1.0;\n        if (point.y < 0.0) dy = -point.y;\n        if (point.y > 1.0) dy = point.y - 1.0;\n        if ((point.x < 0.0 || point.x > 1.0) && (point.y < 0.0 || point.y > 1.0)) return sqrt(dx * dx + dy * dy);\n        return min(dx, dy);\n}\n\nvec4 seeThrough(float yc, vec2 p, mat3 rotation, mat3 rrotation)\n{\n        float hitAngle = PI - (acos(yc / cylinderRadius) - cylinderAngle);\n        vec3 point = hitPoint(hitAngle, yc, rotation * vec3(p, 1.0), rrotation);\n        if (yc <= 0.0 && (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0))\n        {\n            return getToColor(p);\n        }\n\n        if (yc > 0.0) return getFromColor(p);\n\n        vec4 color = getFromColor(point.xy);\n        vec4 tcolor = vec4(0.0);\n\n        return antiAlias(color, tcolor, distanceToEdge(point));\n}\n\nvec4 seeThroughWithShadow(float yc, vec2 p, vec3 point, mat3 rotation, mat3 rrotation)\n{\n        float shadow = distanceToEdge(point) * 30.0;\n        shadow = (1.0 - shadow) / 3.0;\n\n        if (shadow < 0.0) shadow = 0.0; else shadow *= amount;\n\n        vec4 shadowColor = seeThrough(yc, p, rotation, rrotation);\n        shadowColor.r -= shadow;\n        shadowColor.g -= shadow;\n        shadowColor.b -= shadow;\n\n        return shadowColor;\n}\n\nvec4 backside(float yc, vec3 point)\n{\n        vec4 color = getFromColor(point.xy);\n        float gray = (color.r + color.b + color.g) / 15.0;\n        gray += (8.0 / 10.0) * (pow(1.0 - abs(yc / cylinderRadius), 2.0 / 10.0) / 2.0 + (5.0 / 10.0));\n        color.rgb = vec3(gray);\n        return color;\n}\n\nvec4 behindSurface(vec2 p, float yc, vec3 point, mat3 rrotation)\n{\n        float shado = (1.0 - ((-cylinderRadius - yc) / amount * 7.0)) / 6.0;\n        shado *= 1.0 - abs(point.x - 0.5);\n\n        yc = (-cylinderRadius - cylinderRadius - yc);\n\n        float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n        point = hitPoint(hitAngle, yc, point, rrotation);\n\n        if (yc < 0.0 && point.x >= 0.0 && point.y >= 0.0 && point.x <= 1.0 && point.y <= 1.0 && (hitAngle < PI || amount > 0.5))\n        {\n                shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / (71.0 / 100.0));\n                shado *= pow(-yc / cylinderRadius, 3.0);\n                shado *= 0.5;\n        }\n        else\n        {\n                shado = 0.0;\n        }\n        return vec4(getToColor(p).rgb - shado, 1.0);\n}\n\nvec4 transition(vec2 p) {\n\n  const float angle = 100.0 * PI / 180.0;\n        float c = cos(-angle);\n        float s = sin(-angle);\n\n        mat3 rotation = mat3( c, s, 0,\n                                                                -s, c, 0,\n                                                                -0.801, 0.8900, 1\n                                                                );\n        c = cos(angle);\n        s = sin(angle);\n\n        mat3 rrotation = mat3(\tc, s, 0,\n                                                                        -s, c, 0,\n                                                                        0.98500, 0.985, 1\n                                                                );\n\n        vec3 point = rotation * vec3(p, 1.0);\n\n        float yc = point.y - cylinderCenter;\n\n        if (yc < -cylinderRadius)\n        {\n                // Behind surface\n                return behindSurface(p,yc, point, rrotation);\n        }\n\n        if (yc > cylinderRadius)\n        {\n                // Flat surface\n                return getFromColor(p);\n        }\n\n        float hitAngle = (acos(yc / cylinderRadius) + cylinderAngle) - PI;\n\n        float hitAngleMod = mod(hitAngle, 2.0 * PI);\n        if ((hitAngleMod > PI && amount < 0.5) || (hitAngleMod > PI/2.0 && amount < 0.0))\n        {\n                return seeThrough(yc, p, rotation, rrotation);\n        }\n\n        point = hitPoint(hitAngle, yc, point, rrotation);\n\n        if (point.x < 0.0 || point.y < 0.0 || point.x > 1.0 || point.y > 1.0)\n        {\n                return seeThroughWithShadow(yc, p, point, rotation, rrotation);\n        }\n\n        vec4 color = backside(yc, point);\n\n        vec4 otherColor;\n        if (yc < 0.0)\n        {\n                float shado = 1.0 - (sqrt(pow(point.x - 0.5, 2.0) + pow(point.y - 0.5, 2.0)) / 0.71);\n                shado *= pow(-yc / cylinderRadius, 3.0);\n                shado *= 0.5;\n                otherColor = vec4(0.0, 0.0, 0.0, shado);\n        }\n        else\n        {\n                otherColor = getFromColor(p);\n        }\n\n        color = antiAlias(color, otherColor, cylinderRadius - abs(yc));\n\n        vec4 cl = seeThroughWithShadow(yc, p, point, rotation, rrotation);\n        float dist = distanceToEdge(point);\n\n        return antiAlias(color, cl, dist);\n}\n',author:"Hewlett-Packard",license:"BSD 3 Clause",createdAt:"Wed, 21 Feb 2018 01:13:49 +0100",updatedAt:"Wed, 21 Feb 2018 16:00:02 +0100"},{name:"LinearBlur",paramsTypes:{intensity:"float"},defaultParams:{intensity:.1},glsl:"// author: gre\n// license: MIT\nuniform float intensity; // = 0.1\nconst int passes = 6;\n\nvec4 transition(vec2 uv) {\n    vec4 c1 = vec4(0.0);\n    vec4 c2 = vec4(0.0);\n\n    float disp = intensity*(0.5-distance(0.5, progress));\n    for (int xi=0; xi<passes; xi++)\n    {\n        float x = float(xi) / float(passes) - 0.5;\n        for (int yi=0; yi<passes; yi++)\n        {\n            float y = float(yi) / float(passes) - 0.5;\n            vec2 v = vec2(x,y);\n            float d = disp;\n            c1 += getFromColor( uv + d*v);\n            c2 += getToColor( uv + d*v);\n        }\n    }\n    c1 /= float(passes*passes);\n    c2 /= float(passes*passes);\n    return mix(c1, c2, progress);\n}\n",author:"gre",license:"MIT",createdAt:"Fri, 23 Feb 2018 15:18:22 +0100",updatedAt:"Fri, 23 Feb 2018 15:18:22 +0100"},{name:"Mosaic",paramsTypes:{endx:"int",endy:"int"},defaultParams:{endx:2,endy:-1},glsl:"// License: MIT\n// Author: Xaychru\n// ported by gre from https://gist.github.com/Xaychru/130bb7b7affedbda9df5\n\n#define PI 3.14159265358979323\n#define POW2(X) X*X\n#define POW3(X) X*X*X\nuniform int endx; // = 2\nuniform int endy; // = -1\n\nfloat Rand(vec2 v) {\n  return fract(sin(dot(v.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\nvec2 Rotate(vec2 v, float a) {\n  mat2 rm = mat2(cos(a), -sin(a),\n                 sin(a), cos(a));\n  return rm*v;\n}\nfloat CosInterpolation(float x) {\n  return -cos(x*PI)/2.+.5;\n}\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy - .5;\n  vec2 rp = p;\n  float rpr = (progress*2.-1.);\n  float z = -(rpr*rpr*2.) + 3.;\n  float az = abs(z);\n  rp *= az;\n  rp += mix(vec2(.5, .5), vec2(float(endx) + .5, float(endy) + .5), POW2(CosInterpolation(progress)));\n  vec2 mrp = mod(rp, 1.);\n  vec2 crp = rp;\n  bool onEnd = int(floor(crp.x))==endx&&int(floor(crp.y))==endy;\n  if(!onEnd) {\n    float ang = float(int(Rand(floor(crp))*4.))*.5*PI;\n    mrp = vec2(.5) + Rotate(mrp-vec2(.5), ang);\n  }\n  if(onEnd || Rand(floor(crp))>.5) {\n    return getToColor(mrp);\n  } else {\n    return getFromColor(mrp);\n  }\n}\n",license:"MIT",author:"Xaychru",createdAt:"Mon, 12 Jun 2017 10:26:51 +0800",updatedAt:"Mon, 12 Jun 2017 10:26:51 +0800"},{name:"PolkaDotsCurtain",paramsTypes:{dots:"float",center:"vec2"},defaultParams:{dots:20,center:[0,0]},glsl:"// author: bobylito\n// license: MIT\nconst float SQRT_2 = 1.414213562373;\nuniform float dots;// = 20.0;\nuniform vec2 center;// = vec2(0, 0);\n\nvec4 transition(vec2 uv) {\n  bool nextImage = distance(fract(uv * dots), vec2(0.5, 0.5)) < ( progress / distance(uv, center));\n  return nextImage ? getToColor(uv) : getFromColor(uv);\n}\n",author:"bobylito",license:"MIT",createdAt:"Tue, 20 Feb 2018 23:41:45 +0100",updatedAt:"Tue, 20 Feb 2018 23:41:45 +0100"},{name:"Radial",paramsTypes:{smoothness:"float"},defaultParams:{smoothness:1},glsl:"// License: MIT\n// Author: Xaychru\n// ported by gre from https://gist.github.com/Xaychru/ce1d48f0ce00bb379750\n\nuniform float smoothness; // = 1.0\n\nconst float PI = 3.141592653589;\n\nvec4 transition(vec2 p) {\n  vec2 rp = p*2.-1.;\n  return mix(\n    getToColor(p),\n    getFromColor(p),\n    smoothstep(0., smoothness, atan(rp.y,rp.x) - (progress-.5) * PI * 2.5)\n  );\n}\n",license:"MIT",author:"Xaychru",createdAt:"Mon, 12 Jun 2017 10:36:24 +0800",updatedAt:"Mon, 12 Jun 2017 10:36:24 +0800"},{name:"SimpleZoom",paramsTypes:{zoom_quickness:"float"},defaultParams:{zoom_quickness:.8},glsl:"// Author: 0gust1\n// License: MIT\n\nuniform float zoom_quickness; // = 0.8\nfloat nQuick = clamp(zoom_quickness,0.2,1.0);\n\nvec2 zoom(vec2 uv, float amount) {\n  return 0.5 + ((uv - 0.5) * (1.0-amount));\t\n}\n\nvec4 transition (vec2 uv) {\n  return mix(\n    getFromColor(zoom(uv, smoothstep(0.0, nQuick, progress))),\n    getToColor(uv),\n   smoothstep(nQuick-0.2, 1.0, progress)\n  );\n}",author:"0gust1",license:"MIT",createdAt:"Tue, 6 Mar 2018 00:43:47 +0100",updatedAt:"Tue, 6 Mar 2018 00:43:47 +0100"},{name:"StereoViewer",paramsTypes:{zoom:"float",corner_radius:"float"},defaultParams:{zoom:.88,corner_radius:.22},glsl:`// Tunable parameters
// How much to zoom (out) for the effect ~ 0.5 - 1.0
uniform float zoom; // = 0.88
// Corner radius as a fraction of the image height
uniform float corner_radius;  // = 0.22

// author: Ted Schundler
// license: BSD 2 Clause
// Free for use and modification by anyone with credit

// Copyright (c) 2016, Theodore K Schundler
// All rights reserved.

// Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

// 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

// 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

///////////////////////////////////////////////////////////////////////////////
// Stereo Viewer Toy Transition                                              //
//                                                                           //
// Inspired by ViewMaster / Image3D image viewer devices.                    //
// This effect is similar to what you see when you press the device's lever. //
// There is a quick zoom in / out to make the transition 'valid' for GLSL.io //
///////////////////////////////////////////////////////////////////////////////

const vec4 black = vec4(0.0, 0.0, 0.0, 1.0);
const vec2 c00 = vec2(0.0, 0.0); // the four corner points
const vec2 c01 = vec2(0.0, 1.0);
const vec2 c11 = vec2(1.0, 1.0);
const vec2 c10 = vec2(1.0, 0.0);

// Check if a point is within a given corner
bool in_corner(vec2 p, vec2 corner, vec2 radius) {
  // determine the direction we want to be filled
  vec2 axis = (c11 - corner) - corner;

  // warp the point so we are always testing the bottom left point with the
  // circle centered on the origin
  p = p - (corner + axis * radius);
  p *= axis / radius;
  return (p.x > 0.0 && p.y > -1.0) || (p.y > 0.0 && p.x > -1.0) || dot(p, p) < 1.0;
}

// Check all four corners
// return a float for v2 for anti-aliasing?
bool test_rounded_mask(vec2 p, vec2 corner_size) {
  return
      in_corner(p, c00, corner_size) &&
      in_corner(p, c01, corner_size) &&
      in_corner(p, c10, corner_size) &&
      in_corner(p, c11, corner_size);
}

// Screen blend mode - https://en.wikipedia.org/wiki/Blend_modes
// This more closely approximates what you see than linear blending
vec4 screen(vec4 a, vec4 b) {
  return 1.0 - (1.0 - a) * (1.0 -b);
}

// Given RGBA, find a value that when screened with itself
// will yield the original value.
vec4 unscreen(vec4 c) {
  return 1.0 - sqrt(1.0 - c);
}

// Grab a pixel, only if it isn't masked out by the rounded corners
vec4 sample_with_corners_from(vec2 p, vec2 corner_size) {
  p = (p - 0.5) / zoom + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return unscreen(getFromColor(p));
}

vec4 sample_with_corners_to(vec2 p, vec2 corner_size) {
  p = (p - 0.5) / zoom + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return unscreen(getToColor(p));
}

// special sampling used when zooming - extra zoom parameter and don't unscreen
vec4 simple_sample_with_corners_from(vec2 p, vec2 corner_size, float zoom_amt) {
  p = (p - 0.5) / (1.0 - zoom_amt + zoom * zoom_amt) + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return getFromColor(p);
}

vec4 simple_sample_with_corners_to(vec2 p, vec2 corner_size, float zoom_amt) {
  p = (p - 0.5) / (1.0 - zoom_amt + zoom * zoom_amt) + 0.5;
  if (!test_rounded_mask(p, corner_size)) {
    return black;
  }
  return getToColor(p);
}

// Basic 2D affine transform matrix helpers
// These really shouldn't be used in a fragment shader - I should work out the
// the math for a translate & rotate function as a pair of dot products instead

mat3 rotate2d(float angle, float ratio) {
  float s = sin(angle);
  float c = cos(angle);
  return mat3(
    c, s ,0.0,
    -s, c, 0.0,
    0.0, 0.0, 1.0);
}

mat3 translate2d(float x, float y) {
  return mat3(
    1.0, 0.0, 0,
    0.0, 1.0, 0,
    -x, -y, 1.0);
}

mat3 scale2d(float x, float y) {
  return mat3(
    x, 0.0, 0,
    0.0, y, 0,
    0, 0, 1.0);
}

// Split an image and rotate one up and one down along off screen pivot points
vec4 get_cross_rotated(vec3 p3, float angle, vec2 corner_size, float ratio) {
  angle = angle * angle; // easing
  angle /= 2.4; // works out to be a good number of radians

  mat3 center_and_scale = translate2d(-0.5, -0.5) * scale2d(1.0, ratio);
  mat3 unscale_and_uncenter = scale2d(1.0, 1.0/ratio) * translate2d(0.5,0.5);
  mat3 slide_left = translate2d(-2.0,0.0);
  mat3 slide_right = translate2d(2.0,0.0);
  mat3 rotate = rotate2d(angle, ratio);

  mat3 op_a = center_and_scale * slide_right * rotate * slide_left * unscale_and_uncenter;
  mat3 op_b = center_and_scale * slide_left * rotate * slide_right * unscale_and_uncenter;

  vec4 a = sample_with_corners_from((op_a * p3).xy, corner_size);
  vec4 b = sample_with_corners_from((op_b * p3).xy, corner_size);

  return screen(a, b);
}

// Image stays put, but this time move two masks
vec4 get_cross_masked(vec3 p3, float angle, vec2 corner_size, float ratio) {
  angle = 1.0 - angle;
  angle = angle * angle; // easing
  angle /= 2.4;

  vec4 img;

  mat3 center_and_scale = translate2d(-0.5, -0.5) * scale2d(1.0, ratio);
  mat3 unscale_and_uncenter = scale2d(1.0 / zoom, 1.0 / (zoom * ratio)) * translate2d(0.5,0.5);
  mat3 slide_left = translate2d(-2.0,0.0);
  mat3 slide_right = translate2d(2.0,0.0);
  mat3 rotate = rotate2d(angle, ratio);

  mat3 op_a = center_and_scale * slide_right * rotate * slide_left * unscale_and_uncenter;
  mat3 op_b = center_and_scale * slide_left * rotate * slide_right * unscale_and_uncenter;

  bool mask_a = test_rounded_mask((op_a * p3).xy, corner_size);
  bool mask_b = test_rounded_mask((op_b * p3).xy, corner_size);

  if (mask_a || mask_b) {
    img = sample_with_corners_to(p3.xy, corner_size);
    return screen(mask_a ? img : black, mask_b ? img : black);
  } else {
    return black;
  }
}

vec4 transition(vec2 uv) {
  float a;
  vec2 p=uv.xy/vec2(1.0).xy;
  vec3 p3 = vec3(p.xy, 1.0); // for 2D matrix transforms

  // corner is warped to represent to size after mapping to 1.0, 1.0
  vec2 corner_size = vec2(corner_radius / ratio, corner_radius);

  if (progress <= 0.0) {
    // 0.0: start with the base frame always
    return getFromColor(p);
  } else if (progress < 0.1) {
    // 0.0-0.1: zoom out and add rounded corners
    a = progress / 0.1;
    return  simple_sample_with_corners_from(p, corner_size * a, a);
  } else if (progress < 0.48) {
    // 0.1-0.48: Split original image apart
    a = (progress - 0.1)/0.38;
    return get_cross_rotated(p3, a, corner_size, ratio);
  } else if (progress < 0.9) {
    // 0.48-0.52: black
    // 0.52 - 0.9: unmask new image
    return get_cross_masked(p3, (progress - 0.52)/0.38, corner_size, ratio);
  } else if (progress < 1.0) {
    // zoom out and add rounded corners
    a = (1.0 - progress) / 0.1;
    return simple_sample_with_corners_to(p, corner_size * a, a);
  } else {
    // 1.0 end with base frame
    return getToColor(p);
  }
}
`,author:"Ted Schundler",license:"BSD 2 Clause",createdAt:"Tue, 20 Feb 2018 23:20:29 +0100",updatedAt:"Wed, 21 Feb 2018 15:42:00 +0100"},{name:"Swirl",paramsTypes:{},defaultParams:{},glsl:"// License: MIT\n// Author: Sergey Kosarevsky\n// ( http://www.linderdaum.com )\n// ported by gre from https://gist.github.com/corporateshark/cacfedb8cca0f5ce3f7c\n\nvec4 transition(vec2 UV)\n{\n\tfloat Radius = 1.0;\n\n\tfloat T = progress;\n\n\tUV -= vec2( 0.5, 0.5 );\n\n\tfloat Dist = length(UV);\n\n\tif ( Dist < Radius )\n\t{\n\t\tfloat Percent = (Radius - Dist) / Radius;\n\t\tfloat A = ( T <= 0.5 ) ? mix( 0.0, 1.0, T/0.5 ) : mix( 1.0, 0.0, (T-0.5)/0.5 );\n\t\tfloat Theta = Percent * Percent * A * 8.0 * 3.14159;\n\t\tfloat S = sin( Theta );\n\t\tfloat C = cos( Theta );\n\t\tUV = vec2( dot(UV, vec2(C, -S)), dot(UV, vec2(S, C)) );\n\t}\n\tUV += vec2( 0.5, 0.5 );\n\n\tvec4 C0 = getFromColor(UV);\n\tvec4 C1 = getToColor(UV);\n\n\treturn mix( C0, C1, T );\n}\n",license:"MIT",author:"Sergey Kosarevsky",createdAt:"Mon, 12 Jun 2017 12:38:27 +0800",updatedAt:"Mon, 12 Jun 2017 12:38:27 +0800"},{name:"WaterDrop",paramsTypes:{amplitude:"float",speed:"float"},defaultParams:{amplitude:30,speed:30},glsl:"// author: Paweł Płóciennik\n// license: MIT\nuniform float amplitude; // = 30\nuniform float speed; // = 30\n\nvec4 transition(vec2 p) {\n  vec2 dir = p - vec2(.5);\n  float dist = length(dir);\n\n  if (dist > progress) {\n    return mix(getFromColor( p), getToColor( p), progress);\n  } else {\n    vec2 offset = dir * sin(dist * amplitude - progress * speed);\n    return mix(getFromColor( p + offset), getToColor( p), progress);\n  }\n}\n",author:"Paweł Płóciennik",license:"MIT",createdAt:"Wed, 21 Feb 2018 19:37:15 +0100",updatedAt:"Wed, 21 Feb 2018 19:37:15 +0100"},{name:"ZoomInCircles",paramsTypes:{},defaultParams:{},glsl:"// License: MIT\n// Author: dycm8009\n// ported by gre from https://gist.github.com/dycm8009/948e99b1800e81ad909a\n\nvec2 zoom(vec2 uv, float amount) {\n  return 0.5 + ((uv - 0.5) * amount);\t\n}\n\nvec2 ratio2 = vec2(1.0, 1.0 / ratio);\n\nvec4 transition(vec2 uv) {\n  // TODO: some timing are hardcoded but should be one or many parameters\n  // TODO: should also be able to configure how much circles\n  // TODO: if() branching should be avoided when possible, prefer use of step() & other functions\n  vec2 r = 2.0 * ((vec2(uv.xy) - 0.5) * ratio2);\n  float pro = progress / 0.8;\n  float z = pro * 0.2;\n  float t = 0.0;\n  if (pro > 1.0) {\n    z = 0.2 + (pro - 1.0) * 5.;\n    t = clamp((progress - 0.8) / 0.07, 0.0, 1.0);\n  }\n  if (length(r) < 0.5+z) {\n    // uv = zoom(uv, 0.9 - 0.1 * pro);\n  }\n  else if (length(r) < 0.8+z*1.5) {\n    uv = zoom(uv, 1.0 - 0.15 * pro);\n    t = t * 0.5;\n  }\n  else if (length(r) < 1.2+z*2.5) {\n    uv = zoom(uv, 1.0 - 0.2 * pro);\n    t = t * 0.2;\n  }\n  else {\n    uv = zoom(uv, 1.0 - 0.25 * pro);\n  }\n  return mix(getFromColor(uv), getToColor(uv), t);\n}\n",license:"MIT",author:"dycm8009",createdAt:"Mon, 12 Jun 2017 11:24:34 +0800",updatedAt:"Mon, 12 Jun 2017 11:24:34 +0800"},{name:"angular",paramsTypes:{startingAngle:"float"},defaultParams:{startingAngle:90},glsl:"// Author: Fernando Kuteken\n// License: MIT\n\n#define PI 3.141592653589\n\nuniform float startingAngle; // = 90;\n\nvec4 transition (vec2 uv) {\n  \n  float offset = startingAngle * PI / 180.0;\n  float angle = atan(uv.y - 0.5, uv.x - 0.5) + offset;\n  float normalizedAngle = (angle + PI) / (2.0 * PI);\n  \n  normalizedAngle = normalizedAngle - floor(normalizedAngle);\n\n  return mix(\n    getFromColor(uv),\n    getToColor(uv),\n    step(normalizedAngle, progress)\n    );\n}\n",author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"burn",paramsTypes:{color:"vec3"},defaultParams:{color:[.9,.4,.2]},glsl:"// author: gre\n// License: MIT\nuniform vec3 color /* = vec3(0.9, 0.4, 0.2) */;\nvec4 transition (vec2 uv) {\n  return mix(\n    getFromColor(uv) + vec4(progress*color, 1.0),\n    getToColor(uv) + vec4((1.0-progress)*color, 1.0),\n    progress\n  );\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"cannabisleaf",paramsTypes:{},defaultParams:{},glsl:"// Author: @Flexi23\n// License: MIT\n\n// inspired by http://www.wolframalpha.com/input/?i=cannabis+curve\n\nvec4 transition (vec2 uv) {\n  if(progress == 0.0){\n    return getFromColor(uv);\n  }\n  vec2 leaf_uv = (uv - vec2(0.5))/10./pow(progress,3.5);\n\tleaf_uv.y += 0.35;\n\tfloat r = 0.18;\n\tfloat o = atan(leaf_uv.y, leaf_uv.x);\n  return mix(getFromColor(uv), getToColor(uv), 1.-step(1. - length(leaf_uv)+r*(1.+sin(o))*(1.+0.9 * cos(8.*o))*(1.+0.1*cos(24.*o))*(0.9+0.05*cos(200.*o)), 1.));\n}\n",author:"@Flexi23",license:"MIT",createdAt:"Thu, 1 Jun 2017 15:58:58 +0200",updatedAt:"Thu, 1 Jun 2017 15:58:58 +0200"},{name:"circle",paramsTypes:{center:"vec2",backColor:"vec3"},defaultParams:{center:[.5,.5],backColor:[.1,.1,.1]},glsl:"// Author: Fernando Kuteken\n// License: MIT\n\nuniform vec2 center; // = vec2(0.5, 0.5);\nuniform vec3 backColor; // = vec3(0.1, 0.1, 0.1);\n\nvec4 transition (vec2 uv) {\n  \n  float distance = length(uv - center);\n  float radius = sqrt(8.0) * abs(progress - 0.5);\n  \n  if (distance > radius) {\n    return vec4(backColor, 1.0);\n  }\n  else {\n    if (progress < 0.5) return getFromColor(uv);\n    else return getToColor(uv);\n  }\n}\n",author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"circleopen",paramsTypes:{smoothness:"float",opening:"bool"},defaultParams:{smoothness:.3,opening:!0},glsl:"// author: gre\n// License: MIT\nuniform float smoothness; // = 0.3\nuniform bool opening; // = true\n\nconst vec2 center = vec2(0.5, 0.5);\nconst float SQRT_2 = 1.414213562373;\n\nvec4 transition (vec2 uv) {\n  float x = opening ? progress : 1.-progress;\n  float m = smoothstep(-smoothness, 0.0, SQRT_2*distance(center, uv) - x*(1.+smoothness));\n  return mix(getFromColor(uv), getToColor(uv), opening ? 1.-m : m);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"colorphase",paramsTypes:{fromStep:"vec4",toStep:"vec4"},defaultParams:{fromStep:[0,.2,.4,0],toStep:[.6,.8,1,1]},glsl:"// Author: gre\n// License: MIT\n\n// Usage: fromStep and toStep must be in [0.0, 1.0] range \n// and all(fromStep) must be < all(toStep)\n\nuniform vec4 fromStep; // = vec4(0.0, 0.2, 0.4, 0.0)\nuniform vec4 toStep; // = vec4(0.6, 0.8, 1.0, 1.0)\n\nvec4 transition (vec2 uv) {\n  vec4 a = getFromColor(uv);\n  vec4 b = getToColor(uv);\n  return mix(a, b, smoothstep(fromStep, toStep, vec4(progress)));\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"crosshatch",paramsTypes:{center:"vec2",threshold:"float",fadeEdge:"float"},defaultParams:{center:[.5,.5],threshold:3,fadeEdge:.1},glsl:"// License: MIT\n// Author: pthrasher\n// adapted by gre from https://gist.github.com/pthrasher/04fd9a7de4012cbb03f6\n\nuniform vec2 center; // = vec2(0.5)\nuniform float threshold; // = 3.0\nuniform float fadeEdge; // = 0.1\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\nvec4 transition(vec2 p) {\n  float dist = distance(center, p) / threshold;\n  float r = progress - min(rand(vec2(p.y, 0.0)), rand(vec2(0.0, p.x)));\n  return mix(getFromColor(p), getToColor(p), mix(0.0, mix(step(dist, r), 1.0, smoothstep(1.0-fadeEdge, 1.0, progress)), smoothstep(0.0, fadeEdge, progress)));    \n}\n",license:"MIT",author:"pthrasher",createdAt:"Mon, 12 Jun 2017 10:02:12 +0800",updatedAt:"Mon, 12 Jun 2017 10:02:12 +0800"},{name:"crosswarp",paramsTypes:{},defaultParams:{},glsl:"// Author: Eke Péter <peterekepeter@gmail.com>\n// License: MIT\nvec4 transition(vec2 p) {\n  float x = progress;\n  x=smoothstep(.0,1.0,(x*2.0+p.x-1.0));\n  return mix(getFromColor((p-.5)*(1.-x)+.5), getToColor((p-.5)*x+.5), x);\n}\n",author:"Eke Péter <peterekepeter@gmail.com>",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"cube",paramsTypes:{persp:"float",unzoom:"float",reflection:"float",floating:"float"},defaultParams:{persp:.7,unzoom:.3,reflection:.4,floating:3},glsl:"// Author: gre\n// License: MIT\nuniform float persp; // = 0.7\nuniform float unzoom; // = 0.3\nuniform float reflection; // = 0.4\nuniform float floating; // = 3.0\n\nvec2 project (vec2 p) {\n  return p * vec2(1.0, -1.2) + vec2(0.0, -floating/100.);\n}\n\nbool inBounds (vec2 p) {\n  return all(lessThan(vec2(0.0), p)) && all(lessThan(p, vec2(1.0)));\n}\n\nvec4 bgColor (vec2 p, vec2 pfr, vec2 pto) {\n  vec4 c = vec4(0.0, 0.0, 0.0, 1.0);\n  pfr = project(pfr);\n  // FIXME avoid branching might help perf!\n  if (inBounds(pfr)) {\n    c += mix(vec4(0.0), getFromColor(pfr), reflection * mix(1.0, 0.0, pfr.y));\n  }\n  pto = project(pto);\n  if (inBounds(pto)) {\n    c += mix(vec4(0.0), getToColor(pto), reflection * mix(1.0, 0.0, pto.y));\n  }\n  return c;\n}\n\n// p : the position\n// persp : the perspective in [ 0, 1 ]\n// center : the xcenter in [0, 1] \\ 0.5 excluded\nvec2 xskew (vec2 p, float persp, float center) {\n  float x = mix(p.x, 1.0-p.x, center);\n  return (\n    (\n      vec2( x, (p.y - 0.5*(1.0-persp) * x) / (1.0+(persp-1.0)*x) )\n      - vec2(0.5-distance(center, 0.5), 0.0)\n    )\n    * vec2(0.5 / distance(center, 0.5) * (center<0.5 ? 1.0 : -1.0), 1.0)\n    + vec2(center<0.5 ? 0.0 : 1.0, 0.0)\n  );\n}\n\nvec4 transition(vec2 op) {\n  float uz = unzoom * 2.0*(0.5-distance(0.5, progress));\n  vec2 p = -uz*0.5+(1.0+uz) * op;\n  vec2 fromP = xskew(\n    (p - vec2(progress, 0.0)) / vec2(1.0-progress, 1.0),\n    1.0-mix(progress, 0.0, persp),\n    0.0\n  );\n  vec2 toP = xskew(\n    p / vec2(progress, 1.0),\n    mix(pow(progress, 2.0), 1.0, persp),\n    1.0\n  );\n  // FIXME avoid branching might help perf!\n  if (inBounds(fromP)) {\n    return getFromColor(fromP);\n  }\n  else if (inBounds(toP)) {\n    return getToColor(toP);\n  }\n  return bgColor(op, fromP, toP);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"directionalwarp",paramsTypes:{direction:"vec2"},defaultParams:{direction:[-1,1]},glsl:"// Author: pschroen\n// License: MIT\n\nuniform vec2 direction; // = vec2(-1.0, 1.0)\n\nconst float smoothness = 0.5;\nconst vec2 center = vec2(0.5, 0.5);\n\nvec4 transition (vec2 uv) {\n  vec2 v = normalize(direction);\n  v /= abs(v.x) + abs(v.y);\n  float d = v.x * center.x + v.y * center.y;\n  float m = 1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d - 0.5 + progress * (1.0 + smoothness)));\n  return mix(getFromColor((uv - 0.5) * (1.0 - m) + 0.5), getToColor((uv - 0.5) * m + 0.5), m);\n}\n",author:"pschroen",license:"MIT",createdAt:"Wed, 13 Dec 2017 12:08:49 -0500",updatedAt:"Wed, 13 Dec 2017 12:08:49 -0500"},{name:"directionalwipe",paramsTypes:{direction:"vec2",smoothness:"float"},defaultParams:{direction:[1,-1],smoothness:.5},glsl:"// Author: gre\n// License: MIT\n\nuniform vec2 direction; // = vec2(1.0, -1.0)\nuniform float smoothness; // = 0.5\n \nconst vec2 center = vec2(0.5, 0.5);\n \nvec4 transition (vec2 uv) {\n  vec2 v = normalize(direction);\n  v /= abs(v.x)+abs(v.y);\n  float d = v.x * center.x + v.y * center.y;\n  float m =\n    (1.0-step(progress, 0.0)) * // there is something wrong with our formula that makes m not equals 0.0 with progress is 0.0\n    (1.0 - smoothstep(-smoothness, 0.0, v.x * uv.x + v.y * uv.y - (d-0.5+progress*(1.+smoothness))));\n  return mix(getFromColor(uv), getToColor(uv), m);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"displacement",paramsTypes:{displacementMap:"sampler2D",strength:"float"},defaultParams:{displacementMap:null,strength:.5},glsl:"// Author: Travis Fischer\n// License: MIT\n//\n// Adapted from a Codrops article by Robin Delaporte\n// https://tympanus.net/Development/DistortionHoverEffect\n\nuniform sampler2D displacementMap;\n\nuniform float strength; // = 0.5\n\nvec4 transition (vec2 uv) {\n  float displacement = texture2D(displacementMap, uv).r * strength;\n\n  vec2 uvFrom = vec2(uv.x + progress * displacement, uv.y);\n  vec2 uvTo = vec2(uv.x - (1.0 - progress) * displacement, uv.y);\n\n  return mix(\n    getFromColor(uvFrom),\n    getToColor(uvTo),\n    progress\n  );\n}\n",author:"Travis Fischer",license:"MIT",createdAt:"Tue, 10 Apr 2018 23:03:38 -0400",updatedAt:"Tue, 10 Apr 2018 23:03:38 -0400"},{name:"doorway",paramsTypes:{reflection:"float",perspective:"float",depth:"float"},defaultParams:{reflection:.4,perspective:.4,depth:3},glsl:"// author: gre\n// License: MIT \nuniform float reflection; // = 0.4\nuniform float perspective; // = 0.4\nuniform float depth; // = 3\n\nconst vec4 black = vec4(0.0, 0.0, 0.0, 1.0);\nconst vec2 boundMin = vec2(0.0, 0.0);\nconst vec2 boundMax = vec2(1.0, 1.0);\n\nbool inBounds (vec2 p) {\n  return all(lessThan(boundMin, p)) && all(lessThan(p, boundMax));\n}\n\nvec2 project (vec2 p) {\n  return p * vec2(1.0, -1.2) + vec2(0.0, -0.02);\n}\n\nvec4 bgColor (vec2 p, vec2 pto) {\n  vec4 c = black;\n  pto = project(pto);\n  if (inBounds(pto)) {\n    c += mix(black, getToColor(pto), reflection * mix(1.0, 0.0, pto.y));\n  }\n  return c;\n}\n\n\nvec4 transition (vec2 p) {\n  vec2 pfr = vec2(-1.), pto = vec2(-1.);\n  float middleSlit = 2.0 * abs(p.x-0.5) - progress;\n  if (middleSlit > 0.0) {\n    pfr = p + (p.x > 0.5 ? -1.0 : 1.0) * vec2(0.5*progress, 0.0);\n    float d = 1.0/(1.0+perspective*progress*(1.0-middleSlit));\n    pfr.y -= d/2.;\n    pfr.y *= d;\n    pfr.y += d/2.;\n  }\n  float size = mix(1.0, depth, 1.-progress);\n  pto = (p + vec2(-0.5, -0.5)) * vec2(size, size) + vec2(0.5, 0.5);\n  if (inBounds(pfr)) {\n    return getFromColor(pfr);\n  }\n  else if (inBounds(pto)) {\n    return getToColor(pto);\n  }\n  else {\n    return bgColor(p, pto);\n  }\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"fade",paramsTypes:{},defaultParams:{},glsl:"// author: gre\n// license: MIT\n\nvec4 transition (vec2 uv) {\n  return mix(\n    getFromColor(uv),\n    getToColor(uv),\n    progress\n  );\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"fadecolor",paramsTypes:{color:"vec3",colorPhase:"float"},defaultParams:{color:[0,0,0],colorPhase:.4},glsl:"// author: gre\n// License: MIT\nuniform vec3 color;// = vec3(0.0)\nuniform float colorPhase/* = 0.4 */; // if 0.0, there is no black phase, if 0.9, the black phase is very important\nvec4 transition (vec2 uv) {\n  return mix(\n    mix(vec4(color, 1.0), getFromColor(uv), smoothstep(1.0-colorPhase, 0.0, progress)),\n    mix(vec4(color, 1.0), getToColor(uv), smoothstep(    colorPhase, 1.0, progress)),\n    progress);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"fadegrayscale",paramsTypes:{intensity:"float"},defaultParams:{intensity:.3},glsl:"// Author: gre\n// License: MIT\n\nuniform float intensity; // = 0.3; // if 0.0, the image directly turn grayscale, if 0.9, the grayscale transition phase is very important\n \nvec3 grayscale (vec3 color) {\n  return vec3(0.2126*color.r + 0.7152*color.g + 0.0722*color.b);\n}\n \nvec4 transition (vec2 uv) {\n  vec4 fc = getFromColor(uv);\n  vec4 tc = getToColor(uv);\n  return mix(\n    mix(vec4(grayscale(fc.rgb), 1.0), fc, smoothstep(1.0-intensity, 0.0, progress)),\n    mix(vec4(grayscale(tc.rgb), 1.0), tc, smoothstep(    intensity, 1.0, progress)),\n    progress);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"flyeye",paramsTypes:{size:"float",zoom:"float",colorSeparation:"float"},defaultParams:{size:.04,zoom:50,colorSeparation:.3},glsl:"// Author: gre\n// License: MIT\nuniform float size; // = 0.04\nuniform float zoom; // = 50.0\nuniform float colorSeparation; // = 0.3\n\nvec4 transition(vec2 p) {\n  float inv = 1. - progress;\n  vec2 disp = size*vec2(cos(zoom*p.x), sin(zoom*p.y));\n  vec4 texTo = getToColor(p + inv*disp);\n  vec4 texFrom = vec4(\n    getFromColor(p + progress*disp*(1.0 - colorSeparation)).r,\n    getFromColor(p + progress*disp).g,\n    getFromColor(p + progress*disp*(1.0 + colorSeparation)).b,\n    1.0);\n  return texTo*progress + texFrom*inv;\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"heart",paramsTypes:{},defaultParams:{},glsl:"// Author: gre\n// License: MIT\n\nfloat inHeart (vec2 p, vec2 center, float size) {\n  if (size==0.0) return 0.0;\n  vec2 o = (p-center)/(1.6*size);\n  float a = o.x*o.x+o.y*o.y-0.3;\n  return step(a*a*a, o.x*o.x*o.y*o.y*o.y);\n}\nvec4 transition (vec2 uv) {\n  return mix(\n    getFromColor(uv),\n    getToColor(uv),\n    inHeart(uv, vec2(0.5, 0.4), progress)\n  );\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"hexagonalize",paramsTypes:{steps:"int",horizontalHexagons:"float"},defaultParams:{steps:50,horizontalHexagons:20},glsl:"// Author: Fernando Kuteken\n// License: MIT\n// Hexagonal math from: http://www.redblobgames.com/grids/hexagons/\n\nuniform int steps; // = 50;\nuniform float horizontalHexagons; //= 20;\n\nstruct Hexagon {\n  float q;\n  float r;\n  float s;\n};\n\nHexagon createHexagon(float q, float r){\n  Hexagon hex;\n  hex.q = q;\n  hex.r = r;\n  hex.s = -q - r;\n  return hex;\n}\n\nHexagon roundHexagon(Hexagon hex){\n  \n  float q = floor(hex.q + 0.5);\n  float r = floor(hex.r + 0.5);\n  float s = floor(hex.s + 0.5);\n\n  float deltaQ = abs(q - hex.q);\n  float deltaR = abs(r - hex.r);\n  float deltaS = abs(s - hex.s);\n\n  if (deltaQ > deltaR && deltaQ > deltaS)\n    q = -r - s;\n  else if (deltaR > deltaS)\n    r = -q - s;\n  else\n    s = -q - r;\n\n  return createHexagon(q, r);\n}\n\nHexagon hexagonFromPoint(vec2 point, float size) {\n  \n  point.y /= ratio;\n  point = (point - 0.5) / size;\n  \n  float q = (sqrt(3.0) / 3.0) * point.x + (-1.0 / 3.0) * point.y;\n  float r = 0.0 * point.x + 2.0 / 3.0 * point.y;\n\n  Hexagon hex = createHexagon(q, r);\n  return roundHexagon(hex);\n  \n}\n\nvec2 pointFromHexagon(Hexagon hex, float size) {\n  \n  float x = (sqrt(3.0) * hex.q + (sqrt(3.0) / 2.0) * hex.r) * size + 0.5;\n  float y = (0.0 * hex.q + (3.0 / 2.0) * hex.r) * size + 0.5;\n  \n  return vec2(x, y * ratio);\n}\n\nvec4 transition (vec2 uv) {\n  \n  float dist = 2.0 * min(progress, 1.0 - progress);\n  dist = steps > 0 ? ceil(dist * float(steps)) / float(steps) : dist;\n  \n  float size = (sqrt(3.0) / 3.0) * dist / horizontalHexagons;\n  \n  vec2 point = dist > 0.0 ? pointFromHexagon(hexagonFromPoint(uv, size), size) : uv;\n\n  return mix(getFromColor(point), getToColor(point), progress);\n  \n}\n",author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 21:55:47 -0300",updatedAt:"Tue, 30 May 2017 21:55:47 -0300"},{name:"kaleidoscope",paramsTypes:{speed:"float",angle:"float",power:"float"},defaultParams:{speed:1,angle:1,power:1.5},glsl:"// Author: nwoeanhinnogaehr\n// License: MIT\n\nuniform float speed; // = 1.0;\nuniform float angle; // = 1.0;\nuniform float power; // = 1.5;\n\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy;\n  vec2 q = p;\n  float t = pow(progress, power)*speed;\n  p = p -0.5;\n  for (int i = 0; i < 7; i++) {\n    p = vec2(sin(t)*p.x + cos(t)*p.y, sin(t)*p.y - cos(t)*p.x);\n    t += angle;\n    p = abs(mod(p, 2.0) - 1.0);\n  }\n  abs(mod(p, 1.0));\n  return mix(\n    mix(getFromColor(q), getToColor(q), progress),\n    mix(getFromColor(p), getToColor(p), progress), 1.0 - 2.0*abs(progress - 0.5));\n}\n",author:"nwoeanhinnogaehr",license:"MIT",createdAt:"Wed, 31 May 2017 21:48:26 -0400",updatedAt:"Wed, 31 May 2017 21:48:26 -0400"},{name:"luma",paramsTypes:{luma:"sampler2D"},defaultParams:{luma:null},glsl:"// Author: gre\n// License: MIT\n\nuniform sampler2D luma;\n\nvec4 transition(vec2 uv) {\n  return mix(\n    getToColor(uv),\n    getFromColor(uv),\n    step(progress, texture2D(luma, uv).r)\n  );\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"luminance_melt",paramsTypes:{direction:"bool",l_threshold:"float",above:"bool"},defaultParams:{direction:!0,l_threshold:.8,above:!1},glsl:"// Author: 0gust1\n// License: MIT\n//My own first transition — based on crosshatch code (from pthrasher), using  simplex noise formula (copied and pasted)\n//-> cooler with high contrasted images (isolated dark subject on light background f.e.)\n//TODO : try to rebase it on DoomTransition (from zeh)?\n//optimizations :\n//luminance (see http://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color#answer-596241)\n// Y = (R+R+B+G+G+G)/6\n//or Y = (R+R+R+B+G+G+G+G)>>3 \n\n\n//direction of movement :  0 : up, 1, down\nuniform bool direction; // = 1 \n//luminance threshold\nuniform float l_threshold; // = 0.8 \n//does the movement takes effect above or below luminance threshold ?\nuniform bool above; // = false \n\n\n//Random function borrowed from everywhere\nfloat rand(vec2 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n\n// Simplex noise :\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : MIT  \n//               2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n// \n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n  {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n// First corner\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n// Other corners\n  vec2 i1;\n  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n  //i1.y = 1.0 - i1.x;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  // x0 = x0 - 0.0 + 0.0 * C.xx ;\n  // x1 = x0 - i1 + 1.0 * C.xx ;\n  // x2 = x0 - 1.0 + 2.0 * C.xx ;\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n// Permutations\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n\t\t+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n// Normalise gradients implicitly by scaling m\n// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n// Compute final noise value at P\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n// Simplex noise -- end\n\nfloat luminance(vec4 color){\n  //(0.299*R + 0.587*G + 0.114*B)\n  return color.r*0.299+color.g*0.587+color.b*0.114;\n}\n\nvec2 center = vec2(1.0, direction);\n\nvec4 transition(vec2 uv) {\n  vec2 p = uv.xy / vec2(1.0).xy;\n  if (progress == 0.0) {\n    return getFromColor(p);\n  } else if (progress == 1.0) {\n    return getToColor(p);\n  } else {\n    float x = progress;\n    float dist = distance(center, p)- progress*exp(snoise(vec2(p.x, 0.0)));\n    float r = x - rand(vec2(p.x, 0.1));\n    float m;\n    if(above){\n     m = dist <= r && luminance(getFromColor(p))>l_threshold ? 1.0 : (progress*progress*progress);\n    }\n    else{\n     m = dist <= r && luminance(getFromColor(p))<l_threshold ? 1.0 : (progress*progress*progress);  \n    }\n    return mix(getFromColor(p), getToColor(p), m);    \n  }\n}\n",author:"0gust1",license:"MIT",createdAt:"Wed, 24 Jan 2018 19:02:32 +0100",updatedAt:"Wed, 24 Jan 2018 19:02:32 +0100"},{name:"morph",paramsTypes:{strength:"float"},defaultParams:{strength:.1},glsl:"// Author: paniq\n// License: MIT\nuniform float strength; // = 0.1\n\nvec4 transition(vec2 p) {\n  vec4 ca = getFromColor(p);\n  vec4 cb = getToColor(p);\n  \n  vec2 oa = (((ca.rg+ca.b)*0.5)*2.0-1.0);\n  vec2 ob = (((cb.rg+cb.b)*0.5)*2.0-1.0);\n  vec2 oc = mix(oa,ob,0.5)*strength;\n  \n  float w0 = progress;\n  float w1 = 1.0-w0;\n  return mix(getFromColor(p+oc*w0), getToColor(p-oc*w1), progress);\n}\n",author:"paniq",license:"MIT",createdAt:"Thu, 10 Aug 2017 00:27:36 +0200",updatedAt:"Thu, 10 Aug 2017 00:32:01 +0200"},{name:"multiply_blend",paramsTypes:{},defaultParams:{},glsl:"// Author: Fernando Kuteken\n// License: MIT\n\nvec4 blend(vec4 a, vec4 b) {\n  return a * b;\n}\n\nvec4 transition (vec2 uv) {\n  \n  vec4 blended = blend(getFromColor(uv), getToColor(uv));\n  \n  if (progress < 0.5)\n    return mix(getFromColor(uv), blended, 2.0 * progress);\n  else\n    return mix(blended, getToColor(uv), 2.0 * progress - 1.0);\n}\n\n",author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"perlin",paramsTypes:{scale:"float",smoothness:"float",seed:"float"},defaultParams:{scale:4,smoothness:.01,seed:12.9898},glsl:"// Author: Rich Harris\n// License: MIT\n\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform float scale; // = 4.0\nuniform float smoothness; // = 0.01\n\nuniform float seed; // = 12.9898\n\n// http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nfloat random(vec2 co)\n{\n    highp float a = seed;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\n// 2D Noise based on Morgan McGuire @morgan3d\n// https://www.shadertoy.com/view/4dS3Wd\nfloat noise (in vec2 st) {\n    vec2 i = floor(st);\n    vec2 f = fract(st);\n\n    // Four corners in 2D of a tile\n    float a = random(i);\n    float b = random(i + vec2(1.0, 0.0));\n    float c = random(i + vec2(0.0, 1.0));\n    float d = random(i + vec2(1.0, 1.0));\n\n    // Smooth Interpolation\n\n    // Cubic Hermine Curve.  Same as SmoothStep()\n    vec2 u = f*f*(3.0-2.0*f);\n    // u = smoothstep(0.,1.,f);\n\n    // Mix 4 coorners porcentages\n    return mix(a, b, u.x) +\n            (c - a)* u.y * (1.0 - u.x) +\n            (d - b) * u.x * u.y;\n}\n\nvec4 transition (vec2 uv) {\n  vec4 from = getFromColor(uv);\n  vec4 to = getToColor(uv);\n  float n = noise(uv * scale);\n  \n  float p = mix(-smoothness, 1.0 + smoothness, progress);\n  float lower = p - smoothness;\n  float higher = p + smoothness;\n  \n  float q = smoothstep(lower, higher, n);\n  \n  return mix(\n    from,\n    to,\n    1.0 - q\n  );\n}\n",author:"Rich Harris",license:"MIT",createdAt:"Tue, 23 Jan 2018 21:35:10 -0500",updatedAt:"Wed, 24 Jan 2018 07:35:04 -0500"},{name:"pinwheel",paramsTypes:{speed:"float"},defaultParams:{speed:2},glsl:"// Author: Mr Speaker\n// License: MIT\n\nuniform float speed; // = 2.0;\n\nvec4 transition(vec2 uv) {\n  \n  vec2 p = uv.xy / vec2(1.0).xy;\n  \n  float circPos = atan(p.y - 0.5, p.x - 0.5) + progress * speed;\n  float modPos = mod(circPos, 3.1415 / 4.);\n  float signed = sign(progress - modPos);\n  \n  return mix(getToColor(p), getFromColor(p), step(signed, 0.5));\n  \n}\n",author:"Mr Speaker",license:"MIT",createdAt:"Tue, 30 May 2017 09:04:31 -0400",updatedAt:"Tue, 30 May 2017 09:04:31 -0400"},{name:"pixelize",paramsTypes:{squaresMin:"ivec2",steps:"int"},defaultParams:{squaresMin:[20,20],steps:50},glsl:"// Author: gre\n// License: MIT\n// forked from https://gist.github.com/benraziel/c528607361d90a072e98\n\nuniform ivec2 squaresMin/* = ivec2(20) */; // minimum number of squares (when the effect is at its higher level)\nuniform int steps /* = 50 */; // zero disable the stepping\n\nfloat d = min(progress, 1.0 - progress);\nfloat dist = steps>0 ? ceil(d * float(steps)) / float(steps) : d;\nvec2 squareSize = 2.0 * dist / vec2(squaresMin);\n\nvec4 transition(vec2 uv) {\n  vec2 p = dist>0.0 ? (floor(uv / squareSize) + 0.5) * squareSize : uv;\n  return mix(getFromColor(p), getToColor(p), progress);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Wed, 31 May 2017 10:58:26 +0200"},{name:"polar_function",paramsTypes:{segments:"int"},defaultParams:{segments:5},glsl:"// Author: Fernando Kuteken\n// License: MIT\n\n#define PI 3.14159265359\n\nuniform int segments; // = 5;\n\nvec4 transition (vec2 uv) {\n  \n  float angle = atan(uv.y - 0.5, uv.x - 0.5) - 0.5 * PI;\n  float normalized = (angle + 1.5 * PI) * (2.0 * PI);\n  \n  float radius = (cos(float(segments) * angle) + 4.0) / 4.0;\n  float difference = length(uv - vec2(0.5, 0.5));\n  \n  if (difference > radius * progress)\n    return getFromColor(uv);\n  else\n    return getToColor(uv);\n}\n",author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"randomsquares",paramsTypes:{size:"ivec2",smoothness:"float"},defaultParams:{size:[10,10],smoothness:.5},glsl:"// Author: gre\n// License: MIT\n\nuniform ivec2 size; // = ivec2(10, 10)\nuniform float smoothness; // = 0.5\n \nfloat rand (vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 transition(vec2 p) {\n  float r = rand(floor(vec2(size) * p));\n  float m = smoothstep(0.0, -smoothness, r - (progress * (1.0 + smoothness)));\n  return mix(getFromColor(p), getToColor(p), m);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"ripple",paramsTypes:{amplitude:"float",speed:"float"},defaultParams:{amplitude:100,speed:50},glsl:"// Author: gre\n// License: MIT\nuniform float amplitude; // = 100.0\nuniform float speed; // = 50.0\n\nvec4 transition (vec2 uv) {\n  vec2 dir = uv - vec2(.5);\n  float dist = length(dir);\n  vec2 offset = dir * (sin(progress * dist * amplitude - progress * speed) + .5) / 30.;\n  return mix(\n    getFromColor(uv + offset),\n    getToColor(uv),\n    smoothstep(0.2, 1.0, progress)\n  );\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 15:15:27 +0200",updatedAt:"Tue, 30 May 2017 15:15:27 +0200"},{name:"rotate_scale_fade",paramsTypes:{center:"vec2",rotations:"float",scale:"float",backColor:"vec4"},defaultParams:{center:[.5,.5],rotations:1,scale:8,backColor:[.15,.15,.15,1]},glsl:"// Author: Fernando Kuteken\n// License: MIT\n\n#define PI 3.14159265359\n\nuniform vec2 center; // = vec2(0.5, 0.5);\nuniform float rotations; // = 1;\nuniform float scale; // = 8;\nuniform vec4 backColor; // = vec4(0.15, 0.15, 0.15, 1.0);\n\nvec4 transition (vec2 uv) {\n  \n  vec2 difference = uv - center;\n  vec2 dir = normalize(difference);\n  float dist = length(difference);\n  \n  float angle = 2.0 * PI * rotations * progress;\n  \n  float c = cos(angle);\n  float s = sin(angle);\n  \n  float currentScale = mix(scale, 1.0, 2.0 * abs(progress - 0.5));\n  \n  vec2 rotatedDir = vec2(dir.x  * c - dir.y * s, dir.x * s + dir.y * c);\n  vec2 rotatedUv = center + rotatedDir * dist / currentScale;\n  \n  if (rotatedUv.x < 0.0 || rotatedUv.x > 1.0 ||\n      rotatedUv.y < 0.0 || rotatedUv.y > 1.0)\n    return backColor;\n    \n  return mix(getFromColor(rotatedUv), getToColor(rotatedUv), progress);\n}\n",author:"Fernando Kuteken",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"squareswire",paramsTypes:{squares:"ivec2",direction:"vec2",smoothness:"float"},defaultParams:{squares:[10,10],direction:[1,-.5],smoothness:1.6},glsl:"// Author: gre\n// License: MIT\n \nuniform ivec2 squares;// = ivec2(10,10)\nuniform vec2 direction;// = vec2(1.0, -0.5)\nuniform float smoothness; // = 1.6\n\nconst vec2 center = vec2(0.5, 0.5);\nvec4 transition (vec2 p) {\n  vec2 v = normalize(direction);\n  v /= abs(v.x)+abs(v.y);\n  float d = v.x * center.x + v.y * center.y;\n  float offset = smoothness;\n  float pr = smoothstep(-offset, 0.0, v.x * p.x + v.y * p.y - (d-0.5+progress*(1.+offset)));\n  vec2 squarep = fract(p*vec2(squares));\n  vec2 squaremin = vec2(pr/2.0);\n  vec2 squaremax = vec2(1.0 - pr/2.0);\n  float a = (1.0 - step(progress, 0.0)) * step(squaremin.x, squarep.x) * step(squaremin.y, squarep.y) * step(squarep.x, squaremax.x) * step(squarep.y, squaremax.y);\n  return mix(getFromColor(p), getToColor(p), a);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"squeeze",paramsTypes:{colorSeparation:"float"},defaultParams:{colorSeparation:.04},glsl:"// Author: gre\n// License: MIT\n \nuniform float colorSeparation; // = 0.04\n \nvec4 transition (vec2 uv) {\n  float y = 0.5 + (uv.y-0.5) / (1.0-progress);\n  if (y < 0.0 || y > 1.0) {\n     return getToColor(uv);\n  }\n  else {\n    vec2 fp = vec2(uv.x, y);\n    vec2 off = progress * vec2(0.0, colorSeparation);\n    vec4 c = getFromColor(fp);\n    vec4 cn = getFromColor(fp - off);\n    vec4 cp = getFromColor(fp + off);\n    return vec4(cn.r, c.g, cp.b, c.a);\n  }\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"swap",paramsTypes:{reflection:"float",perspective:"float",depth:"float"},defaultParams:{reflection:.4,perspective:.2,depth:3},glsl:"// Author: gre\n// License: MIT\n// General parameters\nuniform float reflection; // = 0.4\nuniform float perspective; // = 0.2\nuniform float depth; // = 3.0\n \nconst vec4 black = vec4(0.0, 0.0, 0.0, 1.0);\nconst vec2 boundMin = vec2(0.0, 0.0);\nconst vec2 boundMax = vec2(1.0, 1.0);\n \nbool inBounds (vec2 p) {\n  return all(lessThan(boundMin, p)) && all(lessThan(p, boundMax));\n}\n \nvec2 project (vec2 p) {\n  return p * vec2(1.0, -1.2) + vec2(0.0, -0.02);\n}\n \nvec4 bgColor (vec2 p, vec2 pfr, vec2 pto) {\n  vec4 c = black;\n  pfr = project(pfr);\n  if (inBounds(pfr)) {\n    c += mix(black, getFromColor(pfr), reflection * mix(1.0, 0.0, pfr.y));\n  }\n  pto = project(pto);\n  if (inBounds(pto)) {\n    c += mix(black, getToColor(pto), reflection * mix(1.0, 0.0, pto.y));\n  }\n  return c;\n}\n \nvec4 transition(vec2 p) {\n  vec2 pfr, pto = vec2(-1.);\n \n  float size = mix(1.0, depth, progress);\n  float persp = perspective * progress;\n  pfr = (p + vec2(-0.0, -0.5)) * vec2(size/(1.0-perspective*progress), size/(1.0-size*persp*p.x)) + vec2(0.0, 0.5);\n \n  size = mix(1.0, depth, 1.-progress);\n  persp = perspective * (1.-progress);\n  pto = (p + vec2(-1.0, -0.5)) * vec2(size/(1.0-perspective*(1.0-progress)), size/(1.0-size*persp*(0.5-p.x))) + vec2(1.0, 0.5);\n\n  if (progress < 0.5) {\n    if (inBounds(pfr)) {\n      return getFromColor(pfr);\n    }\n    if (inBounds(pto)) {\n      return getToColor(pto);\n    }  \n  }\n  if (inBounds(pto)) {\n    return getToColor(pto);\n  }\n  if (inBounds(pfr)) {\n    return getFromColor(pfr);\n  }\n  return bgColor(p, pfr, pto);\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Sun, 18 Feb 2018 17:45:50 +0100"},{name:"undulatingBurnOut",paramsTypes:{smoothness:"float",center:"vec2",color:"vec3"},defaultParams:{smoothness:.03,center:[.5,.5],color:[0,0,0]},glsl:"// License: MIT\n// Author: pthrasher\n// adapted by gre from https://gist.github.com/pthrasher/8e6226b215548ba12734\n\nuniform float smoothness; // = 0.03\nuniform vec2 center; // = vec2(0.5)\nuniform vec3 color; // = vec3(0.0)\n\nconst float M_PI = 3.14159265358979323846;\n\nfloat quadraticInOut(float t) {\n  float p = 2.0 * t * t;\n  return t < 0.5 ? p : -p + (4.0 * t) - 1.0;\n}\n\nfloat getGradient(float r, float dist) {\n  float d = r - dist;\n  return mix(\n    smoothstep(-smoothness, 0.0, r - dist * (1.0 + smoothness)),\n    -1.0 - step(0.005, d),\n    step(-0.005, d) * step(d, 0.01)\n  );\n}\n\nfloat getWave(vec2 p){\n  vec2 _p = p - center; // offset from center\n  float rads = atan(_p.y, _p.x);\n  float degs = degrees(rads) + 180.0;\n  vec2 range = vec2(0.0, M_PI * 30.0);\n  vec2 domain = vec2(0.0, 360.0);\n  float ratio = (M_PI * 30.0) / 360.0;\n  degs = degs * ratio;\n  float x = progress;\n  float magnitude = mix(0.02, 0.09, smoothstep(0.0, 1.0, x));\n  float offset = mix(40.0, 30.0, smoothstep(0.0, 1.0, x));\n  float ease_degs = quadraticInOut(sin(degs));\n  float deg_wave_pos = (ease_degs * magnitude) * sin(x * offset);\n  return x + deg_wave_pos;\n}\n\nvec4 transition(vec2 p) {\n  float dist = distance(center, p);\n  float m = getGradient(getWave(p), dist);\n  vec4 cfrom = getFromColor(p);\n  vec4 cto = getToColor(p);\n  return mix(mix(cfrom, cto, m), mix(cfrom, vec4(color, 1.0), 0.75), step(m, -2.0));\n}\n",license:"MIT",author:"pthrasher",createdAt:"Mon, 12 Jun 2017 10:23:37 +0800",updatedAt:"Mon, 12 Jun 2017 10:23:37 +0800"},{name:"wind",paramsTypes:{size:"float"},defaultParams:{size:.2},glsl:"// Author: gre\n// License: MIT\n\n// Custom parameters\nuniform float size; // = 0.2\n\nfloat rand (vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvec4 transition (vec2 uv) {\n  float r = rand(vec2(0, uv.y));\n  float m = smoothstep(0.0, -size, uv.x*(1.0-size) + size*r - (progress * (1.0 + size)));\n  return mix(\n    getFromColor(uv),\n    getToColor(uv),\n    m\n  );\n}\n",author:"gre",license:"MIT",createdAt:"Tue, 30 May 2017 14:26:44 +0200",updatedAt:"Tue, 30 May 2017 14:26:44 +0200"},{name:"windowblinds",paramsTypes:{},defaultParams:{},glsl:"// Author: Fabien Benetou\n// License: MIT\n\nvec4 transition (vec2 uv) {\n  float t = progress;\n  \n  if (mod(floor(uv.y*100.*progress),2.)==0.)\n    t*=2.-.5;\n  \n  return mix(\n    getFromColor(uv),\n    getToColor(uv),\n    mix(t, progress, smoothstep(0.8, 1.0, progress))\n  );\n}\n",author:"Fabien Benetou",license:"MIT",createdAt:"Wed, 31 May 2017 14:11:48 +0200",updatedAt:"Wed, 31 May 2017 14:11:48 +0200"},{name:"windowslice",paramsTypes:{count:"float",smoothness:"float"},defaultParams:{count:10,smoothness:.5},glsl:"// Author: gre\n// License: MIT\n\nuniform float count; // = 10.0\nuniform float smoothness; // = 0.5\n\nvec4 transition (vec2 p) {\n  float pr = smoothstep(-smoothness, 0.0, p.x - progress * (1.0 + smoothness));\n  float s = step(pr, fract(count * p.x));\n  return mix(getFromColor(p), getToColor(p), s);\n}\n",author:"gre",license:"MIT",createdAt:"Wed, 28 Mar 2018 17:23:26 +0200",updatedAt:"Wed, 28 Mar 2018 17:23:26 +0200"},{name:"wipeDown",paramsTypes:{},defaultParams:{},glsl:"// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n  vec2 p=uv.xy/vec2(1.0).xy;\n  vec4 a=getFromColor(p);\n  vec4 b=getToColor(p);\n  return mix(a, b, step(1.0-p.y,progress));\n}\n",author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:26:01 -0500",updatedAt:"Thu, 2 Nov 2017 18:39:26 -0500"},{name:"wipeLeft",paramsTypes:{},defaultParams:{},glsl:"// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n  vec2 p=uv.xy/vec2(1.0).xy;\n  vec4 a=getFromColor(p);\n  vec4 b=getToColor(p);\n  return mix(a, b, step(1.0-p.x,progress));\n}\n",author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:26:28 -0500",updatedAt:"Fri, 3 Nov 2017 18:03:50 +0100"},{name:"wipeRight",paramsTypes:{},defaultParams:{},glsl:"// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n  vec2 p=uv.xy/vec2(1.0).xy;\n  vec4 a=getFromColor(p);\n  vec4 b=getToColor(p);\n  return mix(a, b, step(0.0+p.x,progress));\n}\n",author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:27:02 -0500",updatedAt:"Thu, 2 Nov 2017 18:40:22 -0500"},{name:"wipeUp",paramsTypes:{},defaultParams:{},glsl:"// Author: Jake Nelson\n// License: MIT\n\nvec4 transition(vec2 uv) {\n  vec2 p=uv.xy/vec2(1.0).xy;\n  vec4 a=getFromColor(p);\n  vec4 b=getToColor(p);\n  return mix(a, b, step(0.0+p.y,progress));\n}\n",author:"Jake Nelson",license:"MIT",createdAt:"Wed, 1 Nov 2017 15:24:36 -0500",updatedAt:"Thu, 2 Nov 2017 18:37:42 -0500"}];let transitions=getDefaultExportFromCjs(glTransitions);class TransitionFilter extends Filter{constructor(t){let e=t.coding;super(`attribute vec2 aVertexPosition;
    varying vec2 _uv;   // gl-transition
    uniform mat3 projectionMatrix;
    uniform vec4 inputSize;
    uniform vec4 outputFrame;
    varying vec2 vTextureCoord;

    vec4 filterVertexPosition( void )
    {
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;
    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
    _uv = vec2(0.5, 0.5) * (aVertexPosition+vec2(1.0, 1.0));    // gl-transition
    }`,`
    precision highp float;
    varying vec2 vTextureCoord;
    varying vec2 _uv;
    uniform sampler2D uSampler, to, from;
    uniform float progress;

    vec4 customTexture2D(sampler2D texture, vec2 uv) {
      uv.y = 1.0 - uv.y;
      vec2 vt = 0.5 + (uv - 0.5) * vec2(min(1.0, 1.0), min(1.0, 1.0));
      return texture2D(texture, vt);
    }

    vec4 getFromColor(vec2 uv){
      if (progress > 0.5) {
        return customTexture2D(from, uv);
      } else if (progress == 0.5) {
        return customTexture2D(from, uv);
      } else {
        return customTexture2D(uSampler, uv);
      }
    }
    vec4 getToColor(vec2 uv){
      if (progress > 0.5) {
        return customTexture2D(uSampler, uv);
      } else {
        return customTexture2D(to, uv);
      }
    }

    // gl-transition code here
    ${(e=t.tname?transitions.find(e=>e.name===t.tname):e).glsl}
    // gl-transition code end

    void main(){
      // 解决上下颠倒的问题
      vec2 vc = vec2(vTextureCoord.x, 1.0 - vTextureCoord.y);
      vec4 color = transition(vc);
      gl_FragColor = color;
    }`,{progress:0,to:t.to,from:t.from,...e.defaultParams,...t.options||{}}),this._params=void 0,this.id="",this._params=t}setTexture(e,t){this._params.from=e,this._params.to=t}set progress(e){e=Number(e.toFixed(2)),this.uniforms.progress=e,this.uniforms.to=.5<e?this._params.from:this._params.to}}function TransitionElement(e){let u=e.element,c=e.nextElement,{currentTime:t,transitionElement:h,store:d,trackIndex:p,env:f}=e,r=!1,i=(t>=u.startTime+u.duration-h.duration/2&&t<=u.startTime+u.duration+h.duration/2&&(r=!0),reactExports.useRef()),m=reactExports.useRef({});return reactExports.useEffect(()=>{"export"===f&&(d.elementReadyMark[u.id]="start");return(async()=>{let e,t,r,i,n=null,a=null;if(null!=(e=m.current.from)&&e.cav.remove(),null!=(t=m.current.from)&&t.fromTexture.destroy(),null!=(r=m.current.to)&&r.cav.remove(),null!=(i=m.current.to)&&i.fromTexture.destroy(),"video"===u.type){let e=null;var s=await createMediaTransitionCapture(e="export"===f?(o=d.resourceManage.getBlobURLBySourceId(u.resourceId),(s=document.createElement("video")).preload="auto",s.crossOrigin="Anonymous",s.autoplay=!1,s.src=o,s.setAttribute("playsinline",""),s.setAttribute("webkit-playsinline",""),await getVideoFrameAtTime(c.clipTime,s)):(o=d.resourceManage.getCacheBlobURLById(u.resourceId,p).target,o),u.clipTime+u.duration,{width:d.data.width,height:d.data.height},{x:u.style.x-u.style.width/2,y:u.style.y-u.style.height/2,width:u.style.width,height:u.style.height,rotation:u.style.rotation});n=Texture.from(s),m.current.from={cav:s,fromTexture:n}}else{var o=d.resourceManage.getCacheBlobURLById(u.resourceId,p),s=await createImageTransitionCapture(o,{width:d.data.width,height:d.data.height},{x:u.style.x-u.style.width/2,y:u.style.y-u.style.height/2,width:u.style.width,height:u.style.height,rotation:u.style.rotation});n=Texture.from(s),m.current.from={cav:s,fromTexture:n}}if("video"===c.type){let e=null;s=await createMediaTransitionCapture(e="export"===f?(o=d.resourceManage.getBlobURLBySourceId(c.resourceId),(s=document.createElement("video")).preload="auto",s.crossOrigin="Anonymous",s.autoplay=!1,s.src=o,s.setAttribute("playsinline",""),s.setAttribute("webkit-playsinline",""),await getVideoFrameAtTime(c.clipTime||0,s)):(o=d.resourceManage.getCacheBlobURLById(c.resourceId,p).target,o),c.clipTime,{width:d.data.width,height:d.data.height},{x:c.style.x-c.style.width/2,y:c.style.y-c.style.height/2,width:c.style.width,height:c.style.height,rotation:c.style.rotation});a=Texture.from(s),m.current.to={cav:s,fromTexture:n}}else{o=await createImageTransitionCapture(d.resourceManage.getCacheBlobURLById(c.resourceId,p),{width:d.data.width,height:d.data.height},{x:c.style.x-c.style.width/2,y:c.style.y-c.style.height/2,width:c.style.width,height:c.style.height,rotation:u.style.rotation});a=Texture.from(o),m.current.to={cav:o,fromTexture:n}}let l=new TransitionFilter({tname:h.transitionName,width:d.data.width,height:d.data.height,from:n,to:a});l.id=u.id;s=d.bodyContainer.children.find(e=>e.name==="trackIndex_"+p);return s&&(s.filters||(s.filters=[]),s.filters.find(e=>e.id===l.id)||s.filters.push(l)),l})().then(t=>{t.id=u.id,i.current=t;var e=d.bodyContainer.children.find(e=>e.name==="trackIndex_"+p);e&&(e.filters||(e.filters=[]),e.filters.find(e=>e.id===t.id)||e.filters.push(i.current)),"export"===f&&(d.elementReadyMark[u.id]="success")}).catch(e=>{"export"===f&&(d.elementReadyMark[u.id]="success")}),()=>{var e=d.bodyContainer.children.find(e=>e.name==="trackIndex_"+p);e&&(e.filters=(null==(e=e.filters)?void 0:e.filter(e=>e.id!==u.id))||[]),i.current&&m.current.to&&m.current.from&&(m.current={},i.current.destroy(),i.current=void 0)}},[e.dirty]),reactExports.useEffect(()=>{i.current&&(i.current.enabled=r)},[r,i.current]),r&&(e=Number((t-(u.startTime+u.duration)).toFixed(2)),r)&&i.current&&(i.current.uniforms.progress=(h.duration/2+e)/h.duration),null}var fragment$q="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;void main(){vec4 col=texture2D(uSampler,vTextureCoord.xy);vec3 color=col.rgb;float luminance=color.r*0.299+color.g*0.587+color.b*0.114;float mn=min(min(color.r,color.g),color.b);float mx=max(max(color.r,color.g),color.b);float sat=(1.0-(mx-mn))*(1.0-mx)*luminance*5.0;vec3 lightness=vec3((mn+mx)/2.0);color=mix(color,mix(color,lightness,-value),sat);gl_FragColor=vec4(mix(color,lightness,(1.0-lightness)*(1.0-value)/2.0*abs(value)),col.a);}",freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeGlobal$1=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")(),root$1=root,Symbol$1$1=root$1.Symbol,Symbol$2=Symbol$1$1,objectProto$d=Object.prototype,hasOwnProperty$a=objectProto$d.hasOwnProperty,nativeObjectToString$1=objectProto$d.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty$a.call(e,symToStringTag$1),r=e[symToStringTag$1];try{var i=!(e[symToStringTag$1]=void 0)}catch(e){}var n=nativeObjectToString$1.call(e);return i&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),n}var objectProto$c=Object.prototype,nativeObjectToString=objectProto$c.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:(symToStringTag&&symToStringTag in Object(e)?getRawTag:objectToString)(e)}function isObjectLike$2(e){return null!=e&&"object"==typeof e}var symbolTag$2="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike$2(e)&&baseGetTag(e)==symbolTag$2}function arrayMap(e,t){for(var r=-1,i=null==e?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var isArray$2=Array.isArray,isArray$1$1=isArray$2,INFINITY$1=1/0,symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){var t;return"string"==typeof e?e:isArray$1$1(e)?arrayMap(e,baseToString)+"":isSymbol(e)?symbolToString?symbolToString.call(e):"":"0"==(t=e+"")&&1/e==-INFINITY$1?"-0":t}function isObject$4(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(e){return!!isObject$4(e)&&((e=baseGetTag(e))==funcTag$2||e==genTag$1||e==asyncTag||e==proxyTag)}var coreJsData=root$1["__core-js_shared__"],coreJsData$1=coreJsData,maskSrcKey=(()=>{var e=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""})();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(null!=e){try{return funcToString$2.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$b=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$9=objectProto$b.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$9).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject$4(e)||isMasked(e))&&(isFunction$1(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?void 0:e[t]}function getNative(e,t){e=getValue(e,t);return baseIsNative(e)?e:void 0}var WeakMap$1=getNative(root$1,"WeakMap"),WeakMap$1$1=WeakMap$1,objectCreate$1=Object.create,baseCreate$2=(()=>{function t(){}return function(e){if(!isObject$4(e))return{};if(objectCreate$1)return objectCreate$1(e);t.prototype=e;e=new t;return t.prototype=void 0,e}})(),baseCreate$1$1=baseCreate$2;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function copyArray$2(e,t){var r=-1,i=e.length;for(t=t||Array(i);++r<i;)t[r]=e[r];return t}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(r){var i=0,n=0;return function(){var e=nativeNow(),t=HOT_SPAN-(e-n);if(n=e,0<t){if(++i>=HOT_COUNT)return arguments[0]}else i=0;return r.apply(void 0,arguments)}}function constant(e){return function(){return e}}var defineProperty=(()=>{try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}})(),defineProperty$1=defineProperty,baseSetToString=defineProperty$1?function(e,t){return defineProperty$1(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString$1),setToString$1=setToString;function arrayEach$2(e,t){for(var r=-1,i=null==e?0:e.length;++r<i&&!1!==t(e[r],r,e););return e}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$1:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&-1<e&&e%1==0&&e<t}function baseAssignValue$2(e,t,r){"__proto__"==t&&defineProperty$1?defineProperty$1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function eq$1(e,t){return e===t||e!=e&&t!=t}var objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty;function assignValue$3(e,t,r){var i=e[t];hasOwnProperty$8.call(e,t)&&eq$1(i,r)&&(void 0!==r||t in e)||baseAssignValue$2(e,t,r)}function copyObject$5(e,t,r,i){for(var n=!r,a=(r=r||{},-1),s=t.length;++a<s;){var o=t[a],l=i?i(r[o],e[o],o,r,e):void 0;(n?baseAssignValue$2:assignValue$3)(r,o,l=void 0===l?e[o]:l)}return r}var nativeMax=Math.max;function overRest(a,s,o){return s=nativeMax(void 0===s?a.length-1:s,0),function(){for(var e=arguments,t=-1,r=nativeMax(e.length-s,0),i=Array(r);++t<r;)i[t]=e[s+t];for(var t=-1,n=Array(s+1);++t<s;)n[t]=e[t];return n[s]=o(i),apply(a,this,n)}}var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER}function isArrayLike$1(e){return null!=e&&isLength(e.length)&&!isFunction$1(e)}var objectProto$9=Object.prototype;function isPrototype$2(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$9)}function baseTimes(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var argsTag$2="[object Arguments]";function baseIsArguments(e){return isObjectLike$2(e)&&baseGetTag(e)==argsTag$2}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty,propertyIsEnumerable$1=objectProto$8.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike$2(e)&&hasOwnProperty$7.call(e,"callee")&&!propertyIsEnumerable$1.call(e,"callee")},isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse,isBuffer$1$1=isBuffer$1,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$1="[object Function]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$3="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike$2(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary$2(t){return function(e){return t(e)}}typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag$1]=typedArrayTags[arrayBufferTag$2]=typedArrayTags[boolTag$2]=typedArrayTags[dataViewTag$3]=typedArrayTags[dateTag$2]=typedArrayTags[errorTag$1]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$4]=typedArrayTags[numberTag$2]=typedArrayTags[objectTag$3]=typedArrayTags[regexpTag$2]=typedArrayTags[setTag$4]=typedArrayTags[stringTag$2]=typedArrayTags[weakMapTag$2]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil$2=(()=>{try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e?e:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}})(),nodeUtil$1$1=nodeUtil$2,nodeIsTypedArray=nodeUtil$1$1&&nodeUtil$1$1.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary$2(nodeIsTypedArray):baseIsTypedArray,isTypedArray$1=isTypedArray,objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function arrayLikeKeys$1(e,t){var r,i=isArray$1$1(e),n=!i&&isArguments$1(e),a=!i&&!n&&isBuffer$1$1(e),s=!i&&!n&&!a&&isTypedArray$1(e),o=i||n||a||s,l=o?baseTimes(e.length,String):[],u=l.length;for(r in e)!t&&!hasOwnProperty$6.call(e,r)||o&&("length"==r||a&&("offset"==r||"parent"==r)||s&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||isIndex(r,u))||l.push(r);return l}function overArg$1(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg$1(Object.keys,Object),nativeKeys$1=nativeKeys,objectProto$6=Object.prototype,hasOwnProperty$5=objectProto$6.hasOwnProperty;function baseKeys(e){if(!isPrototype$2(e))return nativeKeys$1(e);var t,r=[];for(t in Object(e))hasOwnProperty$5.call(e,t)&&"constructor"!=t&&r.push(t);return r}function keys$2(e){return(isArrayLike$1(e)?arrayLikeKeys$1:baseKeys)(e)}function nativeKeysIn$2(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$5=Object.prototype,hasOwnProperty$4=objectProto$5.hasOwnProperty;function baseKeysIn$2(e){if(!isObject$4(e))return nativeKeysIn$2(e);var t,r=isPrototype$2(e),i=[];for(t in e)("constructor"!=t||!r&&hasOwnProperty$4.call(e,t))&&i.push(t);return i}function keysIn$4(e){return isArrayLike$1(e)?arrayLikeKeys$1(e,!0):baseKeysIn$2(e)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){var r;return!isArray$1$1(e)&&(!("number"!=(r=typeof e)&&"symbol"!=r&&"boolean"!=r&&null!=e&&!isSymbol(e))||reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t))}var nativeCreate=getNative(Object,"create"),nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e}var HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function hashGet(e){var t,r=this.__data__;return nativeCreate$1?(t=r[e])===HASH_UNDEFINED$1?void 0:t:hasOwnProperty$3.call(r,e)?r[e]:void 0}var objectProto$3=Object.prototype,hasOwnProperty$2$1=objectProto$3.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate$1?void 0!==t[e]:hasOwnProperty$2$1.call(t,e)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate$1&&void 0===t?HASH_UNDEFINED:t,this}function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq$1(e[r][0],t))return r;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,e=assocIndexOf(t,e);return!(e<0||(e==t.length-1?t.pop():splice.call(t,e,1),--this.size,0))}function listCacheGet(e){var t=this.__data__,e=assocIndexOf(t,e);return e<0?void 0:t[e][1]}function listCacheHas(e){return-1<assocIndexOf(this.__data__,e)}function listCacheSet(e,t){var r=this.__data__,i=assocIndexOf(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map"),Map$1$1=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1$1||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){e=e.__data__;return isKeyable(t)?e["string"==typeof t?"string":"hash"]:e.map}function mapCacheDelete(e){e=getMapData(this,e).delete(e);return this.size-=e?1:0,e}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT="Expected a function";function memoize(i,n){if("function"!=typeof i||null!=n&&"function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);function a(){var e=arguments,t=n?n.apply(this,e):e[0],r=a.cache;return r.has(t)?r.get(t):(e=i.apply(this,e),a.cache=r.set(t,e)||r,e)}return a.cache=new(memoize.Cache||MapCache),a}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var e=memoize(e,function(e){return t.size===MAX_MEMOIZE_SIZE&&t.clear(),e}),t=e.cache;return e}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(e){var n=[];return 46===e.charCodeAt(0)&&n.push(""),e.replace(rePropName,function(e,t,r,i){n.push(r?i.replace(reEscapeChar,"$1"):t||e)}),n}),stringToPath$1=stringToPath;function toString(e){return null==e?"":baseToString(e)}function castPath(e,t){return isArray$1$1(e)?e:isKey(e,t)?[e]:stringToPath$1(toString(e))}var INFINITY=1/0;function toKey(e){var t;return"string"==typeof e||isSymbol(e)?e:"0"==(t=e+"")&&1/e==-INFINITY?"-0":t}function baseGet(e,t){for(var r=0,i=(t=castPath(t,e)).length;null!=e&&r<i;)e=e[toKey(t[r++])];return r&&r==i?e:void 0}function arrayPush$1(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(e){return isArray$1$1(e)||isArguments$1(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}function baseFlatten(e,t,r,i,n){var a=-1,s=e.length;for(r=r||isFlattenable,n=n||[];++a<s;){var o=e[a];0<t&&r(o)?1<t?baseFlatten(o,t-1,r,i,n):arrayPush$1(n,o):i||(n[n.length]=o)}return n}function flatten(e){return(null==e?0:e.length)?baseFlatten(e,1):[]}function flatRest(e){return setToString$1(overRest(e,void 0,flatten),e+"")}var getPrototype$3=overArg$1(Object.getPrototypeOf,Object),getPrototype$1$1=getPrototype$3,objectTag$2="[object Object]",funcProto=Function.prototype,objectProto$2$1=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$1$1=objectProto$2$1.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(e){return!(!isObjectLike$2(e)||baseGetTag(e)!=objectTag$2)&&(null===(e=getPrototype$1$1(e))||"function"==typeof(e=hasOwnProperty$1$1.call(e,"constructor")&&e.constructor)&&e instanceof e&&funcToString.call(e)==objectCtorString)}function baseSlice(e,t,r){for(var i=-1,n=e.length,a=((r=n<r?n:r)<0&&(r+=n),n=r<(t=t<0?n<-t?0:n+t:t)?0:r-t>>>0,t>>>=0,Array(n));++i<n;)a[i]=e[i+t];return a}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,e=t.delete(e);return this.size=t.size,e}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var i=r.__data__;if(!Map$1$1||i.length<LARGE_ARRAY_SIZE-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(i)}return r.set(e,t),this.size=r.size,this}function Stack$1(e){e=this.__data__=new ListCache(e);this.size=e.size}function baseAssign$2(e,t){return e&&copyObject$5(t,keys$2(t),e)}function baseAssignIn$2(e,t){return e&&copyObject$5(t,keysIn$4(t),e)}Stack$1.prototype.clear=stackClear,Stack$1.prototype.delete=stackDelete,Stack$1.prototype.get=stackGet,Stack$1.prototype.has=stackHas,Stack$1.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer$1(e,t){return t?e.slice():(t=e.length,t=allocUnsafe?allocUnsafe(t):new e.constructor(t),e.copy(t),t)}function arrayFilter(e,t){for(var r=-1,i=null==e?0:e.length,n=0,a=[];++r<i;){var s=e[r];t(s,r,e)&&(a[n++]=s)}return a}function stubArray$1(){return[]}var objectProto$1$1=Object.prototype,propertyIsEnumerable=objectProto$1$1.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols$2=nativeGetSymbols$1?function(t){return null==t?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(e){return propertyIsEnumerable.call(t,e)}))}:stubArray$1,getSymbols$1$1=getSymbols$2;function copySymbols$2(e,t){return copyObject$5(e,getSymbols$1$1(e),t)}var nativeGetSymbols$2=Object.getOwnPropertySymbols,getSymbolsIn$3=nativeGetSymbols$2?function(e){for(var t=[];e;)arrayPush$1(t,getSymbols$1$1(e)),e=getPrototype$1$1(e);return t}:stubArray$1,getSymbolsIn$1$1=getSymbolsIn$3;function copySymbolsIn$2(e,t){return copyObject$5(e,getSymbolsIn$1$1(e),t)}function baseGetAllKeys$1(e,t,r){t=t(e);return isArray$1$1(e)?t:arrayPush$1(t,r(e))}function getAllKeys$1(e){return baseGetAllKeys$1(e,keys$2,getSymbols$1$1)}function getAllKeysIn$2(e){return baseGetAllKeys$1(e,keysIn$4,getSymbolsIn$1$1)}var DataView$1=getNative(root$1,"DataView"),DataView$1$1=DataView$1,Promise$1=getNative(root$1,"Promise"),Promise$2=Promise$1,Set$1=getNative(root$1,"Set"),Set$1$1=Set$1,mapTag$3="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$3="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=toSource(DataView$1$1),mapCtorString=toSource(Map$1$1),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$1$1),weakMapCtorString=toSource(WeakMap$1$1),getTag$3=baseGetTag,getTag$1$1=((DataView$1$1&&getTag$3(new DataView$1$1(new ArrayBuffer(1)))!=dataViewTag$2||Map$1$1&&getTag$3(new Map$1$1)!=mapTag$3||Promise$2&&getTag$3(Promise$2.resolve())!=promiseTag||Set$1$1&&getTag$3(new Set$1$1)!=setTag$3||WeakMap$1$1&&getTag$3(new WeakMap$1$1)!=weakMapTag$1)&&(getTag$3=function(e){var t=baseGetTag(e),e=t==objectTag$1?e.constructor:void 0,e=e?toSource(e):"";if(e)switch(e){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$3;case promiseCtorString:return promiseTag;case setCtorString:return setTag$3;case weakMapCtorString:return weakMapTag$1}return t}),getTag$3),objectProto$e=Object.prototype,hasOwnProperty$b=objectProto$e.hasOwnProperty;function initCloneArray$2(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$b.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Uint8Array$1$1=root$1.Uint8Array,Uint8Array$2=Uint8Array$1$1;function cloneArrayBuffer$4(e){var t=new e.constructor(e.byteLength);return new Uint8Array$2(t).set(new Uint8Array$2(e)),t}function cloneDataView$2(e,t){t=t?cloneArrayBuffer$4(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var reFlags$1=/\w*$/;function cloneRegExp$2(e){var t=new e.constructor(e.source,reFlags$1.exec(e));return t.lastIndex=e.lastIndex,t}var symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$2?symbolProto$2.valueOf:void 0;function cloneSymbol$2(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}function cloneTypedArray$2(e,t){t=t?cloneArrayBuffer$4(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var boolTag$1$1="[object Boolean]",dateTag$1$1="[object Date]",mapTag$2$1="[object Map]",numberTag$1$1="[object Number]",regexpTag$1$1="[object RegExp]",setTag$2$1="[object Set]",stringTag$1$1="[object String]",symbolTag$1$1="[object Symbol]",arrayBufferTag$1$1="[object ArrayBuffer]",dataViewTag$1$1="[object DataView]",float32Tag$1$1="[object Float32Array]",float64Tag$1$1="[object Float64Array]",int8Tag$1$1="[object Int8Array]",int16Tag$1$1="[object Int16Array]",int32Tag$1$1="[object Int32Array]",uint8Tag$1$1="[object Uint8Array]",uint8ClampedTag$1$1="[object Uint8ClampedArray]",uint16Tag$1$1="[object Uint16Array]",uint32Tag$1$1="[object Uint32Array]";function initCloneByTag$2(e,t,r){var i=e.constructor;switch(t){case arrayBufferTag$1$1:return cloneArrayBuffer$4(e);case boolTag$1$1:case dateTag$1$1:return new i(+e);case dataViewTag$1$1:return cloneDataView$2(e,r);case float32Tag$1$1:case float64Tag$1$1:case int8Tag$1$1:case int16Tag$1$1:case int32Tag$1$1:case uint8Tag$1$1:case uint8ClampedTag$1$1:case uint16Tag$1$1:case uint32Tag$1$1:return cloneTypedArray$2(e,r);case mapTag$2$1:return new i;case numberTag$1$1:case stringTag$1$1:return new i(e);case regexpTag$1$1:return cloneRegExp$2(e);case setTag$2$1:return new i;case symbolTag$1$1:return cloneSymbol$2(e)}}function initCloneObject$2(e){return"function"!=typeof e.constructor||isPrototype$2(e)?{}:baseCreate$1$1(getPrototype$1$1(e))}var mapTag$1$1="[object Map]";function baseIsMap$2(e){return isObjectLike$2(e)&&getTag$1$1(e)==mapTag$1$1}var nodeIsMap$1=nodeUtil$1$1&&nodeUtil$1$1.isMap,isMap$2=nodeIsMap$1?baseUnary$2(nodeIsMap$1):baseIsMap$2,isMap$1$1=isMap$2,setTag$1$1="[object Set]";function baseIsSet$2(e){return isObjectLike$2(e)&&getTag$1$1(e)==setTag$1$1}var nodeIsSet$1=nodeUtil$1$1&&nodeUtil$1$1.isSet,isSet$2=nodeIsSet$1?baseUnary$2(nodeIsSet$1):baseIsSet$2,isSet$1$1=isSet$2,CLONE_DEEP_FLAG$1$1=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$1$1=4,argsTag$3="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$3="[object Function]",genTag$2="[object GeneratorFunction]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",symbolTag$3="[object Symbol]",weakMapTag$3="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$3="[object Float32Array]",float64Tag$3="[object Float64Array]",int8Tag$3="[object Int8Array]",int16Tag$3="[object Int16Array]",int32Tag$3="[object Int32Array]",uint8Tag$3="[object Uint8Array]",uint8ClampedTag$3="[object Uint8ClampedArray]",uint16Tag$3="[object Uint16Array]",uint32Tag$3="[object Uint32Array]",cloneableTags$1={};function baseClone$2(r,i,n,e,t,a){var s,o=i&CLONE_DEEP_FLAG$1$1,l=i&CLONE_FLAT_FLAG$1,u=i&CLONE_SYMBOLS_FLAG$1$1;if(void 0===(s=n?t?n(r,e,t,a):n(r):s)){if(!isObject$4(r))return r;e=isArray$1$1(r);if(e){if(s=initCloneArray$2(r),!o)return copyArray$2(r,s)}else{var c=getTag$1$1(r),h=c==funcTag$3||c==genTag$2;if(isBuffer$1$1(r))return cloneBuffer$1(r,o);if(c==objectTag$4||c==argsTag$3||h&&!t){if(s=l||h?{}:initCloneObject$2(r),!o)return l?copySymbolsIn$2(r,baseAssignIn$2(s,r)):copySymbols$2(r,baseAssign$2(s,r))}else{if(!cloneableTags$1[c])return t?r:{};s=initCloneByTag$2(r,c,o)}}h=(a=a||new Stack$1).get(r);if(h)return h;a.set(r,s),isSet$1$1(r)?r.forEach(function(e){s.add(baseClone$2(e,i,n,e,r,a))}):isMap$1$1(r)&&r.forEach(function(e,t){s.set(t,baseClone$2(e,i,n,t,r,a))});var d=e?void 0:(u?l?getAllKeysIn$2:getAllKeys$1:l?keysIn$4:keys$2)(r);arrayEach$2(d||r,function(e,t){d&&(e=r[t=e]),assignValue$3(s,t,baseClone$2(e,i,n,t,r,a))})}return s}function last$1(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}function parent(e,t){return t.length<2?e:baseGet(e,baseSlice(t,0,-1))}function baseUnset(e,t){return null==(e=parent(e,t=castPath(t,e)))||delete e[toKey(last$1(t))]}function customOmitClone(e){return isPlainObject(e)?void 0:e}cloneableTags$1[argsTag$3]=cloneableTags$1[arrayTag$2]=cloneableTags$1[arrayBufferTag$3]=cloneableTags$1[dataViewTag$4]=cloneableTags$1[boolTag$3]=cloneableTags$1[dateTag$3]=cloneableTags$1[float32Tag$3]=cloneableTags$1[float64Tag$3]=cloneableTags$1[int8Tag$3]=cloneableTags$1[int16Tag$3]=cloneableTags$1[int32Tag$3]=cloneableTags$1[mapTag$5]=cloneableTags$1[numberTag$3]=cloneableTags$1[objectTag$4]=cloneableTags$1[regexpTag$3]=cloneableTags$1[setTag$5]=cloneableTags$1[stringTag$3]=cloneableTags$1[symbolTag$3]=cloneableTags$1[uint8Tag$3]=cloneableTags$1[uint8ClampedTag$3]=cloneableTags$1[uint16Tag$3]=cloneableTags$1[uint32Tag$3]=!0,cloneableTags$1[errorTag$2]=cloneableTags$1[funcTag$3]=cloneableTags$1[weakMapTag$3]=!1;var CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG$2=2,CLONE_SYMBOLS_FLAG$2=4,omit=flatRest(function(t,e){var r={};if(null!=t)for(var i=!1,n=(e=arrayMap(e,function(e){return e=castPath(e,t),i=i||1<e.length,e}),copyObject$5(t,getAllKeysIn$2(t),r),i&&(r=baseClone$2(r,CLONE_DEEP_FLAG$2|CLONE_FLAT_FLAG$2|CLONE_SYMBOLS_FLAG$2,customOmitClone)),e.length);n--;)baseUnset(r,e[n]);return r}),omit$1=omit;class ColorEffectsFilter extends Filter{constructor(...e){super(...e)}_getEffectArgs(){return Object.assign({},omit$1(this.uniforms,["uSampler","globals","filterGlobals","px","size","paletteMap","width","height","timer","m"]))}getEffectConfig(){return{name:this.effectName,type:this.effectType,args:this._getEffectArgs()}}}class Vibrance extends ColorEffectsFilter{constructor(e=0){super(null,fragment$q),this.effectName="vibrance",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e}}class Saturation extends ColorEffectsFilter{constructor(e=0){super(null,null),this.effectName="saturation",this.effectType="filter",this._colorMatrixFilter=new ColorMatrixFilter,this.value=e}apply(e,t,r,i,n){this._colorMatrixFilter.apply(e,t,r,i)}get value(){return this.uniforms.value}set value(e){var t=2*Number(e)/3+1,r=-.5*(t-1);this._colorMatrixFilter.matrix=[t,r,r,0,0,r,t,r,0,0,r,r,t,0,0,0,0,0,1,0],this.uniforms.value=e}}var fragment$p="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;void main(){vec4 color=texture2D(uSampler,vTextureCoord);color.r=clamp(color.r+value,0.0,1.0);color.b=clamp(color.b-value,0.0,1.0);gl_FragColor=color;}";class Temperature extends ColorEffectsFilter{constructor(e=0){super(null,fragment$p),this.effectName="temperature",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e/6}}var fragment$o="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;void main(){vec4 color=texture2D(uSampler,vTextureCoord);color.g=clamp(color.g+value,0.0,1.0);gl_FragColor=color;}";class Tint extends ColorEffectsFilter{constructor(e=0){super(null,fragment$o),this.effectName="tint",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e/6}}class Hue extends ColorEffectsFilter{constructor(e=0){super(null,null),this.effectName="hue",this.effectType="filter",this._colorMatrixFilter=new ColorMatrixFilter,this.value=e}apply(e,t,r,i,n){this._colorMatrixFilter.apply(e,t,r,i)}get value(){return this.uniforms.value}set value(e){this._colorMatrixFilter.reset(),this._colorMatrixFilter.hue(180*e,!0),this.uniforms.value=e}}class Brightness extends ColorEffectsFilter{constructor(e=0){super(null,null),this.effectName="brightness",this.effectType="filter",this._colorMatrixFilter=new ColorMatrixFilter,this.value=e}apply(e,t,r,i,n){this._colorMatrixFilter.apply(e,t,r,i)}get value(){return this.uniforms.value}set value(e){this._colorMatrixFilter.brightness(e+1,!1),this.uniforms.value=e}}var fragment$n="#define GLSLIFY 1\nprecision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;const float epsilon=0.000001;const float mx=1.0-epsilon;const mat3 matRGBtoROMM=mat3(0.5293459296226501,0.3300727903842926,0.14058130979537964,0.09837432950735092,0.8734610080718994,0.028164653107523918,0.01688321679830551,0.11767247319221497,0.8654443025588989);const mat3 matROMMtoRGB=mat3(2.0340757369995117,-0.727334201335907,-0.3067416846752167,-0.22881317138671875,1.2317301034927368,-0.0029169507324695587,-0.008569774217903614,-0.1532866358757019,1.1618564128875732);float ramp(in float t){t*=2.0;if(t>=1.0){t-=1.0;t=log(0.5)/log(0.5*(1.0-t)+0.9332*t);}return clamp(t,0.001,10.0);}vec3 rgb2hsv(in vec3 c){vec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);vec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));vec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));float d=q.x-min(q.w,q.y);float e=1.0e-10;return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)),d/(q.x+e),q.x);}vec3 hsv2rgb(in vec3 c){vec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);vec3 p=abs(fract(c.xxx+K.xyz)*6.0-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),c.y);}vec3 setHue(in vec3 res,in vec3 base){vec3 hsv=rgb2hsv(base);vec3 res_hsv=rgb2hsv(res);return hsv2rgb(vec3(hsv.x,res_hsv.y,res_hsv.z));}void main(){lowp vec4 col=texture2D(uSampler,vTextureCoord.xy);vec3 base=col.rgb*matRGBtoROMM;float a=abs(value)*col.a+epsilon;float v=pow(2.0,a*2.0+1.0)-2.0;float m=mx-exp(-v);vec3 res=(value>0.0)?(1.0-exp(-v*base))/m : log(1.0-base*m)/-v;res=mix(base,res,min(a*100.0,1.0));res=setHue(res,base);res=pow(res,vec3(ramp(1.0-(0.0*col.a+1.0)/2.0)));res=res*matROMMtoRGB;gl_FragColor=vec4(res,col.a);}";class Exposure extends ColorEffectsFilter{constructor(e=0){super(null,fragment$n),this.effectName="exposure",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e}}class Contrast extends ColorEffectsFilter{constructor(e=0){super(null,null),this.effectName="contrast",this.effectType="filter",this._colorMatrixFilter=new ColorMatrixFilter,this.value=e}apply(e,t,r,i,n){this._colorMatrixFilter.apply(e,t,r,i)}get value(){return this.uniforms.value}set value(e){this._colorMatrixFilter.contrast(e,!1),this.uniforms.value=e}}var fragment$m="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;void main(){float bval=value/255.0;float wval=(255.0/(255.0-value));vec3 color=texture2D(uSampler,vTextureCoord).rgb;color=color*wval-(bval*wval);gl_FragColor=vec4(color,texture2D(uSampler,vTextureCoord).a);}";class Black extends ColorEffectsFilter{constructor(e=0){super(null,fragment$m),this.effectName="black",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=127.5*e}}var fragment$l="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;void main(){float bval=0.0/255.0;float wval=(255.0/(value-255.0)*-1.0);vec3 color=texture2D(uSampler,vTextureCoord).rgb;color=color*wval-(bval*wval);gl_FragColor=vec4(color,texture2D(uSampler,vTextureCoord).a);}";class White extends ColorEffectsFilter{constructor(e=0){super(null,fragment$l),this.effectName="white",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=127.5*e}}var fragment$k="#define GLSLIFY 1\nprecision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;const float epsilon=0.000001;const float mx=1.0-epsilon;const float PI=3.1415926535897932384626433832795;const mat3 matRGBtoROMM=mat3(0.5293459296226501,0.3300727903842926,0.14058130979537964,0.09837432950735092,0.8734610080718994,0.028164653107523918,0.01688321679830551,0.11767247319221497,0.8654443025588989);const mat3 matROMMtoRGB=mat3(2.0340757369995117,-0.727334201335907,-0.3067416846752167,-0.22881317138671875,1.2317301034927368,-0.0029169507324695587,-0.008569774217903614,-0.1532866358757019,1.1618564128875732);float luma_romm(in vec3 color){return dot(color,vec3(0.242655,0.755158,0.002187));}float luma(in vec3 color){return dot(color,vec3(0.298839,0.586811,0.11435));}vec3 rgb2hsv(in vec3 c){vec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);vec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));vec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));float d=q.x-min(q.w,q.y);float e=1.0e-10;return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)),d/(q.x+e),q.x);}vec3 hsv2rgb(in vec3 c){vec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);vec3 p=abs(fract(c.xxx+K.xyz)*6.0-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),c.y);}vec3 setHue(in vec3 res,in vec3 base){vec3 hsv=rgb2hsv(base);vec3 res_hsv=rgb2hsv(res);return hsv2rgb(vec3(hsv.x,res_hsv.y,res_hsv.z));}float gaussian(in float x){return 1.0-exp(-PI*2.0*x*x);}void main(){lowp vec4 col=texture2D(uSampler,vTextureCoord.xy);lowp vec3 map=col.rgb;vec3 base=col.rgb*matRGBtoROMM;float base_lum=luma(col.rgb);float map_lum=luma_romm(map*matRGBtoROMM);float exposure=mix(value,0.0,1.0-map_lum)*col.a;float a=abs(exposure)*col.a+epsilon;float v=pow(2.0,a+1.0)-2.0;float m=mx-exp(-v);vec3 res=(exposure>0.0)?(1.0-exp(-v*base))/m : log(1.0-base*m)/-v;res=mix(base,res,min(a*100.0,1.0));res=setHue(res,base);res=res*matROMMtoRGB;gl_FragColor=vec4(res,col.a);}";class Highlights extends ColorEffectsFilter{constructor(e=0){super(null,fragment$k),this.effectName="highlights",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e}}class Shadows extends ColorEffectsFilter{constructor(e=0){super(null,fragment$k),this.effectName="shadows",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.value=-1*e}}var fragment$j="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform vec2 px;uniform float m[9];uniform float value;void main(void){vec4 c11=texture2D(uSampler,vTextureCoord-px);vec4 c12=texture2D(uSampler,vec2(vTextureCoord.x,vTextureCoord.y-px.y));vec4 c13=texture2D(uSampler,vec2(vTextureCoord.x+px.x,vTextureCoord.y-px.y));vec4 c21=texture2D(uSampler,vec2(vTextureCoord.x-px.x,vTextureCoord.y));vec4 c22=texture2D(uSampler,vTextureCoord);vec4 c23=texture2D(uSampler,vec2(vTextureCoord.x+px.x,vTextureCoord.y));vec4 c31=texture2D(uSampler,vec2(vTextureCoord.x-px.x,vTextureCoord.y+px.y));vec4 c32=texture2D(uSampler,vec2(vTextureCoord.x,vTextureCoord.y+px.y));vec4 c33=texture2D(uSampler,vTextureCoord+px);vec4 color=c11*m[0]+c12*m[1]+c13*m[2]+c21*m[3]+c22*m[4]+c23*m[5]+c31*m[6]+c32*m[7]+c33*m[8];gl_FragColor=color*value+(c22*(1.0-value));}";class Sharpen extends ColorEffectsFilter{constructor(e=0){super(null,fragment$j),this.effectName="sharpen",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.m=new Float32Array([-1,-1,-1,-1,9,-1,-1,-1,-1]),this.uniforms.px=[1/t,1/r],this.uniforms.value=e/2}}var fragment$i="#define GLSLIFY 1\nprecision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec2 px;float Lum(vec3 c){return 0.299*c.r+0.587*c.g+0.114*c.b;}float BlendOverlayf(float base,float blend){return(base<0.5 ?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend)));}vec3 BlendOverlay(vec3 base,vec3 blend){return vec3(BlendOverlayf(base.r,blend.r),BlendOverlayf(base.g,blend.g),BlendOverlayf(base.b,blend.b));}float BlendVividLightf(float base,float blend){float BlendColorBurnf=(((2.0*blend)==0.0)?(2.0*blend): max((1.0-((1.0-base)/(2.0*blend))),0.0));float BlendColorDodgef=(((2.0*(blend-0.5))==1.0)?(2.0*(blend-0.5)): min(base/(1.0-(2.0*(blend-0.5))),1.0));return((blend<0.5)? BlendColorBurnf : BlendColorDodgef);}vec3 BlendVividLight(vec3 base,vec3 blend){return vec3(BlendVividLightf(base.r,blend.r),BlendVividLightf(base.g,blend.g),BlendVividLightf(base.b,blend.b));}float normpdf(in float x,in float sigma){return 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;}vec3 blurMap(){const int mSize=11;const int kSize=(mSize-1)/2;float kernel[mSize];vec3 final_colour=vec3(0.0);float sigma=7.0;float Z=0.0;for(int j=0;j<=kSize;++j){kernel[kSize+j]=kernel[kSize-j]=normpdf(float(j),sigma);}for(int j=0;j<mSize;++j){Z+=kernel[j];}for(int i=-kSize;i<=kSize;++i){for(int j=-kSize;j<=kSize;++j){final_colour+=kernel[kSize+j]*kernel[kSize+i]*texture2D(uSampler,(vTextureCoord.xy+vec2(float(i),float(j))*px)).rgb;}}return vec3(final_colour/(Z*Z));}void main(){vec4 base4=texture2D(uSampler,vTextureCoord.xy);vec3 blurMap=blurMap();vec3 base=base4.rgb;float intensity=(value<0.0)?(value/2.0): value;float lum=Lum(base);vec3 col=vec3(lum);vec3 mask=vec3(1.0-pow(lum,1.8));vec3 layer=vec3(1.0-Lum(blurMap));vec3 detail=clamp(BlendVividLight(col,layer),0.0,1.0);vec3 inverse=mix(1.0-detail,detail,(intensity+1.0)/2.0);gl_FragColor=vec4(BlendOverlay(base,mix(vec3(0.5),inverse,mask)),base4.a);}";class Clarity extends ColorEffectsFilter{constructor(e=0){super(null,fragment$i),this.effectName="clarity",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.px=[1/t,1/r],this.uniforms.value=2*e}}var fragment$h="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform vec2 px;uniform float m[9];uniform float value;void main(void){vec4 c11=texture2D(uSampler,vTextureCoord-px);vec4 c12=texture2D(uSampler,vec2(vTextureCoord.x,vTextureCoord.y-px.y));vec4 c13=texture2D(uSampler,vec2(vTextureCoord.x+px.x,vTextureCoord.y-px.y));vec4 c21=texture2D(uSampler,vec2(vTextureCoord.x-px.x,vTextureCoord.y));vec4 c22=texture2D(uSampler,vTextureCoord);vec4 c23=texture2D(uSampler,vec2(vTextureCoord.x+px.x,vTextureCoord.y));vec4 c31=texture2D(uSampler,vec2(vTextureCoord.x-px.x,vTextureCoord.y+px.y));vec4 c32=texture2D(uSampler,vec2(vTextureCoord.x,vTextureCoord.y+px.y));vec4 c33=texture2D(uSampler,vTextureCoord+px);vec4 color=c11*m[0]+c12*m[1]+c13*m[2]+c21*m[3]+c22*m[4]+c23*m[5]+c31*m[6]+c32*m[7]+c33*m[8];gl_FragColor=color*value+(c22*(1.0-value));}";class Smooth extends ColorEffectsFilter{constructor(e=0){super(null,fragment$h),this.effectName="smooth",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.m=new Float32Array([1/16,.125,1/16,.125,.25,.125,1/16,.125,1/16]),this.uniforms.px=[1/t,1/r],this.uniforms.value=e}}class Blur extends ColorEffectsFilter{constructor(e=0){super(null,null),this.effectName="blur",this.effectType="filter",this._blurFilter=new BlurFilter,this.value=e}apply(e,t,r,i,n){this._blurFilter.apply(e,t,r,i)}get value(){return this.uniforms.value}set value(e){this._blurFilter.blur=10*e,this.uniforms.value=e}}var fragment$g="precision highp float;uniform sampler2D uSampler;varying vec2 vTextureCoord;uniform float width;uniform float height;uniform float value;uniform float timer;const float permTexUnit=1.0/256.0;const float permTexUnitHalf=0.5/256.0;float grainsize=1.8;float lumamount=1.0;vec4 rnm(in vec2 tc){float noise=sin(dot(tc+vec2(timer,timer),vec2(12.9898,78.233)))*43758.5453;float noiseR=fract(noise)*2.0-1.0;float noiseG=fract(noise*1.2154)*2.0-1.0;float noiseB=fract(noise*1.3453)*2.0-1.0;float noiseA=fract(noise*1.3647)*2.0-1.0;return vec4(noiseR,noiseG,noiseB,noiseA);}float fade(in float t){return t*t*t*(t*(t*6.0-15.0)+10.0);}float pnoise3D(in vec3 p){vec3 pi=permTexUnit*floor(p)+permTexUnitHalf;vec3 pf=fract(p);float perm00=rnm(pi.xy).a;vec3 grad000=rnm(vec2(perm00,pi.z)).rgb*4.0-1.0;float n000=dot(grad000,pf);vec3 grad001=rnm(vec2(perm00,pi.z+permTexUnit)).rgb*4.0-1.0;float n001=dot(grad001,pf-vec3(0.0,0.0,1.0));float perm01=rnm(pi.xy+vec2(0.0,permTexUnit)).a;vec3 grad010=rnm(vec2(perm01,pi.z)).rgb*4.0-1.0;float n010=dot(grad010,pf-vec3(0.0,1.0,0.0));vec3 grad011=rnm(vec2(perm01,pi.z+permTexUnit)).rgb*4.0-1.0;float n011=dot(grad011,pf-vec3(0.0,1.0,1.0));float perm10=rnm(pi.xy+vec2(permTexUnit,0.0)).a;vec3 grad100=rnm(vec2(perm10,pi.z)).rgb*4.0-1.0;float n100=dot(grad100,pf-vec3(1.0,0.0,0.0));vec3 grad101=rnm(vec2(perm10,pi.z+permTexUnit)).rgb*4.0-1.0;float n101=dot(grad101,pf-vec3(1.0,0.0,1.0));float perm11=rnm(pi.xy+vec2(permTexUnit,permTexUnit)).a;vec3 grad110=rnm(vec2(perm11,pi.z)).rgb*4.0-1.0;float n110=dot(grad110,pf-vec3(1.0,1.0,0.0));vec3 grad111=rnm(vec2(perm11,pi.z+permTexUnit)).rgb*4.0-1.0;float n111=dot(grad111,pf-vec3(1.0,1.0,1.0));vec4 n_x=mix(vec4(n000,n001,n010,n011),vec4(n100,n101,n110,n111),fade(pf.x));vec2 n_xy=mix(n_x.xy,n_x.zw,fade(pf.y));float n_xyz=mix(n_xy.x,n_xy.y,fade(pf.z));return n_xyz;}vec2 coordRot(in vec2 tc,in float angle){float aspect=width/height;float rotX=((tc.x*2.0-1.0)*aspect*cos(angle))-((tc.y*2.0-1.0)*sin(angle));float rotY=((tc.y*2.0-1.0)*cos(angle))+((tc.x*2.0-1.0)*aspect*sin(angle));rotX=((rotX/aspect)*0.5+0.5);rotY=rotY*0.5+0.5;return vec2(rotX,rotY);}void main(){vec3 rotOffset=vec3(1.425,3.892,5.835);vec2 rotCoordsR=coordRot(vTextureCoord,timer+rotOffset.x);vec3 noise=vec3(pnoise3D(vec3(rotCoordsR*vec2(width/grainsize,height/grainsize),0.0)));vec4 tex=texture2D(uSampler,vTextureCoord);vec3 col=tex.rgb;vec3 lumcoeff=vec3(0.299,0.587,0.114);float luminance=mix(0.0,dot(col,lumcoeff),lumamount);float lum=smoothstep(0.2,0.0,luminance);lum+=luminance;noise=mix(noise,vec3(0.0),pow(lum,4.0));col=col+noise*value;gl_FragColor=vec4(col,tex.w);}";class Grain extends ColorEffectsFilter{constructor(e=0){super(null,fragment$g),this.effectName="grain",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.width=t,this.uniforms.height=r,this.uniforms.timer=1,this.uniforms.value=e/10}}var fragment$f="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform float size;void main(){vec4 color=texture2D(uSampler,vTextureCoord);float dist=distance(vTextureCoord,vec2(0.5,0.5));float grd=smoothstep(0.8,size*0.799,dist*(value*0.6+size*2.0));color.rgb+=vec3(1.0,1.0,1.0)*(1.0-grd);gl_FragColor=color;}";class VignetteWhite extends ColorEffectsFilter{constructor(e=0){super(null,fragment$f),this.effectName="vignetteWhite",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.size=.25,this.uniforms.value=2*(e-.1)}}var fragment$e="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform float size;void main(){vec4 color=texture2D(uSampler,vTextureCoord);float dist=distance(vTextureCoord,vec2(0.5,0.5));color.rgb*=smoothstep(0.8,size*0.799,dist*(value*0.75+size*2.0));gl_FragColor=color;}";class VignetteBlack extends ColorEffectsFilter{constructor(e=0){super(null,fragment$e),this.effectName="vignetteBlack",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){this.uniforms.size=.25,this.uniforms.value=2*(e-.1)}}var fragment$d="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec2 px;float normpdf(in float x,in float sigma){return 0.39894*exp(-0.5*x*x/(sigma*sigma))/sigma;}vec3 blurMap(){const int mSize=11;const int kSize=(mSize-1)/2;float kernel[mSize];vec3 final_colour=vec3(0.0);float sigma=7.0;float Z=0.0;for(int j=0;j<=kSize;++j){kernel[kSize+j]=kernel[kSize-j]=normpdf(float(j),sigma);}for(int j=0;j<mSize;++j){Z+=kernel[j];}for(int i=-kSize;i<=kSize;++i){for(int j=-kSize;j<=kSize;++j){final_colour+=kernel[kSize+j]*kernel[kSize+i]*texture2D(uSampler,(vTextureCoord.xy+vec2(float(i),float(j))*px)).rgb;}}return vec3(final_colour/(Z*Z));}float luma(vec3 color){return dot(color,vec3(0.299,0.587,0.114));}void main(){vec4 base=texture2D(uSampler,vTextureCoord);vec3 color=blurMap();color=vec3(luma(color));color=vec3((base.r<=0.5)?(2.0*base.r*color.r):(1.0-2.0*(1.0-base.r)*(1.0-color.r)),(base.g<=0.5)?(2.0*base.g*color.g):(1.0-2.0*(1.0-base.g)*(1.0-color.g)),(base.b<=0.5)?(2.0*base.b*color.b):(1.0-2.0*(1.0-base.b)*(1.0-color.b)));gl_FragColor=mix(base,vec4(color,base.a),value);}";class Glamour extends ColorEffectsFilter{constructor(e=0){super(null,fragment$d),this.effectName="glamour",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.px=[1/t,1/r],this.uniforms.value=e}}var fragment$c="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec2 px;float thresh=.5;void main(){vec4 sum=vec4(0);int j=-2;for(int i=-2;i<=2;i++)sum+=texture2D(uSampler,vTextureCoord+vec2(i,j)*px);j=-1;for(int i=-2;i<=2;i++)sum+=texture2D(uSampler,vTextureCoord+vec2(i,j)*px);j=0;for(int i=-2;i<=2;i++)sum+=texture2D(uSampler,vTextureCoord+vec2(i,j)*px);j=1;for(int i=-2;i<=2;i++)sum+=texture2D(uSampler,vTextureCoord+vec2(i,j)*px);j=2;for(int i=-2;i<=2;i++)sum+=texture2D(uSampler,vTextureCoord+vec2(i,j)*px);sum/=25.0;gl_FragColor=texture2D(uSampler,vTextureCoord);if(length(sum)>thresh){gl_FragColor+=sum*value;}}";class Bloom extends ColorEffectsFilter{constructor(e=0){super(null,fragment$c),this.effectName="bloom",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.px=[1/t,1/r],this.uniforms.value=e}}var fragment$b="#define GLSLIFY 1;\nprecision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec2 size;float hazeMap(vec4 base){vec3 color=vec3(1.0,1.0,1.0);vec2 step=vec2(1.0/size.xy);const int patchRadius=1;for(int i=-patchRadius;i<=patchRadius;++i){for(int j=-patchRadius;j<=patchRadius;++j){vec2 uv=clamp(vTextureCoord+(vec2(i,j)*step),0.0,1.0);color=min(color,base.rgb);}}return min(color.r,min(color.g,color.b));}void main(){lowp vec4 base=texture2D(uSampler,vTextureCoord.xy);lowp float haze=hazeMap(base);float transmission=1.0-0.95*haze;const float A=0.95;const float t0=0.1;float t=mix(1.0,max(t0,transmission),value);vec3 J=(base.rgb-A)/t+A;gl_FragColor=vec4(J,base.a);}";class Dehaze extends ColorEffectsFilter{constructor(e=0){super(null,fragment$b),this.effectName="dehaze",this.effectType="filter",this.value=e}get value(){return this.uniforms.value}set value(e){var[t,r]=null!=(t=null==(t=null==(t=null==(t=this.uniforms)?void 0:t.filterGlobals)?void 0:t.uniforms)?void 0:t.inputSize)?t:[1920,1080];this.uniforms.size=[1/t,1/r],this.uniforms.value=e}}var fragment$a="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform sampler2D paletteMap;uniform float value;float luma(vec3 color){return dot(color,vec3(0.299,0.587,0.114));}void main(){lowp vec4 base=texture2D(uSampler,vTextureCoord.xy);float avg=luma(base.rgb);float r=texture2D(paletteMap,vec2(avg,0)).r;float g=texture2D(paletteMap,vec2(avg,0)).g;float b=texture2D(paletteMap,vec2(avg,0)).b;gl_FragColor=mix(base,vec4(r,g,b,base.a),value);}";class Toning extends ColorEffectsFilter{constructor(e=0,t="#ff2200",r="#ff00ff"){super(null,fragment$a),this.effectName="toning",this.effectType="filter",this._imageData=new ImageData(256,1),this.value=e,this.lightColor=t,this.darkColor=r}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.lightColor)),[i,n,a]=hex2rgb(string2hex(this.uniforms.darkColor)),s=this._imageData,e=(Toning.fillPaletteMap({value:this.uniforms.value,lightColor:{r:255*e,g:255*t,b:255*r},darkColor:{r:255*i,g:255*n,b:255*a}},s),new Uint8Array(Array.from(s.data)));this.uniforms.paletteMap=Texture.fromBuffer(e,e.length/4,1)}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}get lightColor(){return this.uniforms.lightColor}set lightColor(e){this.uniforms.lightColor=e,this.update()}get darkColor(){return this.uniforms.darkColor}set darkColor(e){this.uniforms.darkColor=e,this.update()}static fillPaletteMap(t,r){for(let e=0;e<256;++e){var i=e/255;r.data[4*e]=Math.round(t.lightColor.r*i+t.darkColor.r*(1-i)),r.data[4*e+1]=Math.round(t.lightColor.g*i+t.darkColor.g*(1-i)),r.data[4*e+2]=Math.round(t.lightColor.b*i+t.darkColor.b*(1-i))}}}var fragment$9="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendSoftLight(float base,float blend){return(blend<0.5)?(2.0*base*blend+base*base*(1.0-2.0*blend)):(sqrt(base)*(2.0*blend-1.0)+2.0*base*(1.0-blend));}vec3 blendSoftLight(vec3 base,vec3 blend){return vec3(blendSoftLight(base.r,blend.r),blendSoftLight(base.g,blend.g),blendSoftLight(base.b,blend.b));}vec3 blendSoftLight(vec3 base,vec3 blend,float opacity){return(blendSoftLight(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendSoftLight(base.rgb,color.rgb,value),base.a);}";class SoftLight extends Filter{constructor(e=0,t="#f20"){super(null,fragment$9),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$8="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendOverlay(float base,float blend){return base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));}vec3 blendOverlay(vec3 base,vec3 blend){return vec3(blendOverlay(base.r,blend.r),blendOverlay(base.g,blend.g),blendOverlay(base.b,blend.b));}vec3 blendHardLight(vec3 base,vec3 blend){return blendOverlay(blend,base);}vec3 blendHardLight(vec3 base,vec3 blend,float opacity){return(blendHardLight(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendHardLight(base.rgb,color.rgb,value),base.a);}";class HardLight extends Filter{constructor(e=0,t="#f20"){super(null,fragment$8),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$7="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendColorBurn(float base,float blend){return(blend==0.0)?blend:max((1.0-((1.0-base)/blend)),0.0);}float blendColorDodge(float base,float blend){return(blend==1.0)?blend:min(base/(1.0-blend),1.0);}float blendVividLight(float base,float blend){return(blend<0.5)?blendColorBurn(base,(2.0*blend)):blendColorDodge(base,(2.0*(blend-0.5)));}vec3 blendVividLight(vec3 base,vec3 blend){return vec3(blendVividLight(base.r,blend.r),blendVividLight(base.g,blend.g),blendVividLight(base.b,blend.b));}vec3 blendVividLight(vec3 base,vec3 blend,float opacity){return(blendVividLight(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendVividLight(base.rgb,color.rgb,value),base.a);}";class VividLight extends Filter{constructor(e=0,t="#f20"){super(null,fragment$7),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$6="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendOverlay(float base,float blend){return base<0.5?(2.0*base*blend):(1.0-2.0*(1.0-base)*(1.0-blend));}vec3 blendOverlay(vec3 base,vec3 blend){return vec3(blendOverlay(base.r,blend.r),blendOverlay(base.g,blend.g),blendOverlay(base.b,blend.b));}vec3 blendOverlay(vec3 base,vec3 blend,float opacity){return(blendOverlay(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendOverlay(base.rgb,color.rgb,value),base.a);}";class Overlay extends Filter{constructor(e=0,t="#f20"){super(null,fragment$6),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$5="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;vec3 blendMultiply(vec3 base,vec3 blend){return base*blend;}vec3 blendMultiply(vec3 base,vec3 blend,float opacity){return(blendMultiply(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendMultiply(base.rgb,color.rgb,value),base.a);}";class Multiply extends Filter{constructor(e=0,t="#f20"){super(null,fragment$5),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$4="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendColorDodge(float base,float blend){return(blend==1.0)?blend:min(base/(1.0-blend),1.0);}vec3 blendColorDodge(vec3 base,vec3 blend){return vec3(blendColorDodge(base.r,blend.r),blendColorDodge(base.g,blend.g),blendColorDodge(base.b,blend.b));}vec3 blendColorDodge(vec3 base,vec3 blend,float opacity){return(blendColorDodge(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendColorDodge(base.rgb,color.rgb,value),base.a);}";class ColorDodge extends Filter{constructor(e=0,t="#f20"){super(null,fragment$4),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$3="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendColorBurn(float base,float blend){return(blend==0.0)?blend:max((1.0-((1.0-base)/blend)),0.0);}vec3 blendColorBurn(vec3 base,vec3 blend){return vec3(blendColorBurn(base.r,blend.r),blendColorBurn(base.g,blend.g),blendColorBurn(base.b,blend.b));}vec3 blendColorBurn(vec3 base,vec3 blend,float opacity){return(blendColorBurn(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendColorBurn(base.rgb,color.rgb,value),base.a);}";class ColorBurn extends Filter{constructor(e=0,t="#f20"){super(null,fragment$3),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$2="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;float blendScreen(float base,float blend){return 1.0-((1.0-base)*(1.0-blend));}vec3 blendScreen(vec3 base,vec3 blend){return vec3(blendScreen(base.r,blend.r),blendScreen(base.g,blend.g),blendScreen(base.b,blend.b));}vec3 blendScreen(vec3 base,vec3 blend,float opacity){return(blendScreen(base,blend)*opacity+base*(1.0-opacity));}void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=vec4(blendScreen(base.rgb,color.rgb,value),base.a);}";class Screen extends Filter{constructor(e=0,t="#f20"){super(null,fragment$2),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}var fragment$1="precision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float value;uniform vec4 color;void main(){vec4 base=texture2D(uSampler,vTextureCoord.xy);gl_FragColor=mix(base,color,value);}";let Default$1=class Default2 extends Filter{constructor(e=0,t="#f20"){super(null,fragment$1),this.value=e,this.fillColor=t}update(){var[e,t,r]=hex2rgb(string2hex(this.uniforms.fillColor));this.uniforms.color=[e,t,r,1]}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}},fillMode={default:Default$1,screen:Screen,overlay:Overlay,multiply:Multiply,colorDodge:ColorDodge,colorBurn:ColorBurn,hardLight:HardLight,softLight:SoftLight,vividLight:VividLight};class Fill extends ColorEffectsFilter{constructor(e=0,t="#ff2200",r="softLight"){super(null,null),this.effectName="fill",this.effectType="filter",this._fillFilter=new fillMode[r],this.mode=r,this.value=e,this.fillColor=t}apply(e,t,r,i,n){this._fillFilter.apply(e,t,r,i)}update(){this._fillFilter.value=this.uniforms.value,this._fillFilter.fillColor=this.uniforms.fillColor}get mode(){return this.uniforms.mode}set mode(e){this._fillFilter=new fillMode[e],this.uniforms.mode=e,this.update()}get fillColor(){return this.uniforms.fillColor}set fillColor(e){this.uniforms.fillColor=e,this.update()}get value(){return this.uniforms.value}set value(e){this.uniforms.value=e,this.update()}}let presetConfig={flower:[{name:"vibrance",value:.2},{name:"saturation",value:.1},{name:"temperature",value:.1}],forest:[{name:"saturation",value:-.2},{name:"vibrance",value:1},{name:"clarity",value:.2},{name:"temperature",value:.16},{name:"tint",value:.2},{name:"curves",value:{preset:[[0,0,65,52,173,190,236,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}}],beach:[{name:"saturation",value:.2},{name:"vibrance",value:.2},{name:"curves",value:{preset:[[0,0,68,56,199,208,255,255],[0,0,255,255],[0,0,98,97,196,201,255,255],[0,0,87,85,201,182,255,255]]}},{name:"temperature",value:.1}],sham:[{name:"saturation",value:-.3},{name:"fill",value:{value:.3,mode:"overlay",fillColor:"#99ddff"}},{name:"curves",value:{preset:[[60,31,191,217],[0,0,120,134,255,255],[0,0,255,255],[0,0,120,144,255,255]]}}],stalker:[{name:"curves",value:{preset:[[62,64,190,191],[0,0,133,125,255,255],[0,0,54,65,209,208,255,255],[60,62,96,99,240,230,255,255]]}},{name:"contrast",value:.1},{name:"saturation",value:-.2}],shimmer:[{name:"temperature",value:-.2},{name:"tint",value:-.12},{name:"fill",value:{value:.12,mode:"screen",fillColor:"#be0bff"}},{name:"curves",value:{preset:[[8,23,244,227],[0,0,255,255],[0,0,131,124,255,255],[0,0,149,112,255,255]]}}],mold:[{name:"curves",value:{preset:[[65,64,233,233],[0,0,138,121,255,255],[0,0,60,75,184,184,255,255],[0,0,64,75,181,176,255,255]]}},{name:"contrast",value:.1},{name:"saturation",value:-.12}],style:[{name:"curves",value:{preset:[[0,0,73,74,191,177,235,221,255,255],[0,26,89,64,121,126,180,213,255,255],[0,0,71,50,190,210,255,255],[61,64,112,97,199,198,255,255]]}},{name:"vibrance",value:-.1},{name:"saturation",value:-.4},{name:"temperature",value:.1}],cement:[{name:"curves",value:{preset:[[0,0,73,74,191,177,235,221,255,255],[0,0,255,255],[0,0,60,54,198,210,255,255],[0,0,73,37,150,149,199,198,255,255]]}},{name:"vibrance",value:-.1},{name:"saturation",value:-.1}],sharp:[{name:"curves",value:{preset:[[0,0,42,20,199,218,224,246,255,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}},{name:"vibrance",value:.1},{name:"sharpen",value:.1},{name:"clarity",value:.1}],corn:[{name:"temperature",value:.1},{name:"vibrance",value:.3},{name:"contrast",value:.1},{name:"curves",value:{preset:[[0,0,66,78,255,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}}],morning:[{name:"tint",value:.18},{name:"temperature",value:.1},{name:"highlights",value:.08},{name:"levels",value:{minin:0,maxin:245,minout:0,maxout:255,midin:1,mid:.5}},{name:"curves",value:{preset:[[64,64,150,181,254,255],[0,0,122,138,255,255],[0,0,255,255],[0,0,255,255]]}},{name:"fill",value:{value:.2,mode:"overlay",fillColor:"#c27829"}}],ensalat:[{name:"highlights",value:.2},{name:"shadows",value:-.2},{name:"brightness",value:.1},{name:"levels",value:{minin:10,maxin:245,minout:0,maxout:255,midin:1,mid:.5}},{name:"curves",value:{preset:[[0,0,135,119,191,193,255,255],[0,0,255,255],[0,0,129,121,255,255],[0,0,255,255]]}},{name:"clarity",value:.2},{name:"sharpen",value:.15}],berry:[{name:"vibrance",value:.44},{name:"curves",value:{preset:[[0,0,62,66,121,135,255,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}},{name:"contrast",value:.2},{name:"highlights",value:.4},{name:"shadows",value:-.2},{name:"levels",value:{minin:20,maxin:255,minout:0,maxout:255,midin:1,mid:.5}}],gritty:[{name:"saturation",value:-.4},{name:"levels",value:{minin:20,maxin:255,minout:0,maxout:255,midin:1,mid:.5}},{name:"curves",value:{preset:[[0,0,50,33,128,112,190,215,255,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}},{name:"clarity",value:1},{name:"grain",value:.3}],sunny:[{name:"fill",value:{value:.2,mode:"overlay",fillColor:"#ffc260"}},{name:"temperature",value:.1},{name:"glamour",value:.4},{name:"clarity",value:.3}],film:[{name:"sharpen",value:.2},{name:"glamour",value:.5},{name:"grain",value:.5},{name:"highlights",value:-.2},{name:"shadows",value:-.2},{name:"saturation",value:-.2}],matte:[{name:"curves",value:{preset:[[0,50,38,56,79,82,152,153,255,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}},{name:"contrast",value:.12},{name:"saturation",value:-.1}],deep:[{name:"curves",value:{preset:[[0,0,117,99,191,198,255,255],[0,0,71,38,177,209,255,255],[0,0,236,255],[0,28,75,101,190,171,254,233]]}},{name:"saturation",value:-.3}],aladin:[{name:"curves",value:{preset:[[0,0,255,255],[0,52,87,99,255,255],[0,0,106,107,194,190,254,212],[0,0,166,129,254,142]]}}],amber:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,98,150,255,255],[0,0,138,117,255,255],[0,128,254,129]]}}],anne:[{name:"contrast",value:.25},{name:"curves",value:{preset:[[0,0,255,255],[0,0,78,66,135,171,255,255],[0,0,99,87,180,208,255,255],[0,0,94,93,171,161,255,255]]}}],antonio:[{name:"glamour",value:.8}],alex:[{name:"glamour",value:.6}],bob:[{name:"saturation",value:-.6},{name:"highlights",value:.5}],greg:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,74,50,181,198,255,255],[0,0,61,41,108,170,158,207,254,208],[0,0,83,56,168,204,255,255]]}}],hagrid:[{name:"vibrance",value:.9},{name:"saturation",value:.1},{name:"clarity",value:.5},{name:"shadows",value:-.3}],harry:[{name:"fill",value:{value:.7,mode:"overlay",fillColor:"#d6b277"}},{name:"grain",value:.5}],ivan:[{name:"fill",value:{value:.4,mode:"overlay",fillColor:"#ff0044"}},{name:"shadows",value:.15},{name:"levels",value:{minin:6,maxin:255,minout:0,maxout:255,midin:1,mid:.5}}],jean:[{name:"levels",value:{minin:56,maxin:233,minout:0,maxout:255,midin:1,mid:.5}},{name:"saturation",value:-1},{name:"tint",value:.1},{name:"exposure",value:.78},{name:"bloom",value:.1}],josh:[{name:"curves",value:{preset:[[0,0,78,52,175,207,255,255],[0,0,255,255],[0,0,255,255],[0,64,87,129,254,193]]}}],karen:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,89,144,255,255],[0,0,138,112,255,255],[0,0,162,88,255,255]]}}],lucas:[{name:"tint",value:1},{name:"saturation",value:-.85},{name:"contrast",value:.4},{name:"shadows",value:1},{name:"temperature",value:.1}],melissa:[{name:"curves",value:{preset:[[0,0,255,255],[0,62,255,255],[0,0,255,255],[0,61,254,193]]}}],peter:[{name:"curves",value:{preset:[[0,0,255,255],[0,6,31,20,65,26,87,51,195,190,254,230],[0,11,24,27,102,131,189,195,255,255],[0,40,126,148,254,177]]}}],salomon:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,83,50,177,213,255,255],[0,0,69,55,186,205,255,255],[11,56,254,212]]}},{name:"contrast",value:-.2}],sara:[{name:"vibrance",value:1},{name:"contrast",value:.1},{name:"highlights",value:.3}],sophia:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,140,116,222,254],[0,0,70,59,182,201,255,255],[0,29,252,227]]}},{name:"saturation",value:.3}],tony:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,92,42,218,252],[0,0,73,75,157,194,255,255],[0,27,254,227]]}}],agnes:[{name:"desaturate",value:1},{name:"contrast",value:.5}],conny:[{name:"saturation",value:-.55},{name:"temperature",value:.25},{name:"brightness",value:-.25},{name:"levels",value:{minin:14,maxin:233,minout:0,maxout:255,midin:1,mid:.5}},{name:"exposure",value:.35},{name:"highlights",value:-.9}],gordon:[{name:"desaturate",value:1},{name:"temperature",value:.7},{name:"tint",value:.3},{name:"saturation",value:-.2}],harrison:[{name:"toning",value:{value:1,lightColor:"#fff0d7",darkColor:"#301a18"}},{name:"grain",value:.2}],henry:[{name:"toning",value:{value:1,lightColor:"#fff0d7",darkColor:"#301a18"}},{name:"saturation",value:-.5}],logan:[{name:"glamour",value:.5},{name:"tint",value:.4},{name:"saturation",value:-.35},{name:"toning",value:{value:.8,lightColor:"#fff0d7",darkColor:"#301a18"}}],olay:[{name:"saturation",value:-1},{name:"grain",value:.5},{name:"vignette",value:.5}],porter:[{name:"saturation",value:-1},{name:"vignette",value:.4},{name:"levels",value:{minin:50,maxin:205,minout:0,maxout:255,midin:1,mid:.5}}],tom:[{name:"desaturate",value:1}],sampi:[{name:"toning",value:{value:1,lightColor:"#ffe4c4",darkColor:"#000000"}},{name:"levels",value:{minin:0,maxin:217,minout:0,maxout:255,midin:1,mid:.5}},{name:"temperature",value:.3}],vinny:[{name:"curves",value:{preset:[[0,0,133,111,255,255],[0,0,255,255],[0,0,255,255],[0,0,133,138,255,255]]}},{name:"vibrance",value:-1},{name:"saturation",value:1},{name:"temperature",value:.8},{name:"contrast",value:-.1},{name:"highlights",value:.1}],borg:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,94,66,227,255],[0,0,93,94,179,198,255,255],[0,19,254,228]]}},{name:"fill",value:{value:.1,mode:"default",fillColor:"#ccff00"}}],carl:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,93,64,227,255],[0,0,93,94,181,189,255,255],[0,19,254,228]]}},{name:"vignette",value:.3},{name:"contrast",value:.15},{name:"saturation",value:-.3}],coco:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,64,97,255,255],[0,0,142,122,255,255],[0,0,144,112,255,255]]}}],doris:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,78,48,177,209,255,255],[0,0,92,94,179,208,255,255],[0,52,254,215]]}},{name:"saturation",value:-.2}],doug:[{name:"curves",value:{preset:[[0,0,255,255],[0,64,255,255],[0,0,255,255],[1,64,252,193]]}}],earl:[{name:"vignette",value:.4},{name:"curves",value:{preset:[[0,0,255,255],[0,0,222,254],[0,47,223,254],[0,129,222,255]]}},{name:"fill",value:{value:.8,mode:"multiply",fillColor:"#f7daae"}}],kevin:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,75,164,126,212,255,255],[1,37,111,147,217,217],[73,80,149,111,200,173]]}},{name:"contrast",value:.15}],nash:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,221,255],[0,48,222,252],[0,129,226,255]]}},{name:"fill",value:{value:1,mode:"multiply",fillColor:"#f7daae"}},{name:"levels",value:{minin:0,maxin:225,minout:0,maxout:255,midin:1,mid:.5}}],stan:[{name:"curves",value:{preset:[[0,0,69,54,180,199,255,255],[0,117,64,158,147,185,208,228,255,255],[0,69,101,131,180,182,209,224,254,233],[1,87,83,110,168,149,215,145,254,184]]}}],sun:[{name:"fill",value:{value:.8,mode:"multiply",fillColor:"#fbf2a3"}},{name:"vignette",value:-.25}],"bd orange":[{name:"curves",value:{preset:[[1,34,43,43,77,70,97,108,138,158,173,184,223,208,254,231],[28,3,55,38,110,92,152,148,201,208,255,255],[0,0,62,55,193,189,255,255],[0,27,55,75,116,110,190,149,254,163]]}},{name:"grain",value:.33}],blues:[{name:"curves",value:{preset:[[0,0,255,255],[0,0,77,54,181,207,255,255],[0,0,73,51,180,209,255,255],[0,0,54,75,201,185,255,255]]}}],country:[{name:"curves",value:{preset:[[0,0,84,74,115,105,255,255],[0,0,73,80,93,124,255,255],[0,0,50,34,93,105,119,142,255,255],[0,0,85,85,125,112,255,255]]}}],lemonpell:[{name:"curves",value:{preset:[[0,36,80,84,156,190,255,255],[0,0,255,255],[0,0,103,105,158,176,255,255],[0,19,107,83,198,196,255,255]]}}],joyful:[{name:"vibrance",value:.3},{name:"saturation",value:.4},{name:"temperature",value:-.35},{name:"tint",value:.8},{name:"exposure",value:.3}],"tiny dc":[{name:"curves",value:{preset:[[0,0,255,255],[0,0,79,46,199,217,255,255],[9,1,110,126,254,232],[0,46,92,103,191,158,254,205]]}},{name:"grain",value:.3}],sheberios:[{name:"temperature",value:.5},{name:"saturation",value:.25}],superone:[{name:"toning",value:{value:.8,lightColor:"#ffd899",darkColor:"#4d0033"}},{name:"levels",value:{minin:50,maxin:175,minout:0,maxout:255,midin:1,mid:.5}}],tonola:[{name:"toning",value:{value:.8,lightColor:"#ddff99",darkColor:"#4d0033"}},{name:"levels",value:{minin:26,maxin:213,minout:0,maxout:255,midin:1,mid:.5}},{name:"saturation",value:.36},{name:"temperature",value:.22}],reddish:[{name:"toning",value:{value:.8,lightColor:"#ffd693",darkColor:"#6e2500"}},{name:"contrast",value:.3},{name:"highlights",value:1}],fellowing:[{name:"toning",value:{value:.8,lightColor:"#ffd899",darkColor:"#4d2f00"}},{name:"levels",value:{minin:24,maxin:203,minout:0,maxout:255,midin:1,mid:.5}},{name:"contrast",value:.14},{name:"saturation",value:.3},{name:"temperature",value:.18}],grassland:[{name:"toning",value:{value:.7,lightColor:"#ddff99",darkColor:"#004d19"}},{name:"levels",value:{minin:18,maxin:227,minout:0,maxout:255,midin:1,mid:.5}},{name:"contrast",value:.16}],springs:[{name:"toning",value:{value:1,lightColor:"#ddff99",darkColor:"#001a26"}},{name:"highlights",value:1},{name:"levels",value:{minin:40,maxin:155,minout:0,maxout:255,midin:1,mid:.5}},{name:"shadows",value:1}],justblues:[{name:"toning",value:{value:.79,lightColor:"#c6ecff",darkColor:"#1a004d"}},{name:"levels",value:{minin:16,maxin:189,minout:0,maxout:255,midin:1,mid:.5}},{name:"saturation",value:.2},{name:"contrast",value:.2}],bluesteel:[{name:"toning",value:{value:.8,lightColor:"#ffd899",darkColor:"#1a004d"}},{name:"levels",value:{minin:0,maxin:215,minout:12,maxout:255,midin:1,mid:.5}}],flowerpot:[{name:"toning",value:{value:.8,lightColor:"#ff99dd",darkColor:"#334d00"}},{name:"levels",value:{minin:22,maxin:215,minout:0,maxout:255,midin:1,mid:.5}},{name:"vignette",value:-.2}],stinker:[{name:"toning",value:{value:.8,lightColor:"#ffd899",darkColor:"#1a004d"}},{name:"levels",value:{minin:0,maxin:247,minout:8,maxout:255,midin:1,mid:.5}},{name:"brightness",value:.14},{name:"contrast",value:.4}],violiin:[{name:"contrast",value:.32},{name:"toning",value:{value:1,lightColor:"#c3a6ff",darkColor:"#210000"}},{name:"levels",value:{minin:22,maxin:223,minout:0,maxout:255,midin:1,mid:.5}},{name:"exposure",value:.22},{name:"brightness",value:.12}],blupur:[{name:"toning",value:{value:.8,lightColor:"#ff99dd",darkColor:"#074461"}},{name:"vibrance",value:.7},{name:"contrast",value:.3}],beyllo:[{name:"vibrance",value:1},{name:"saturation",value:1},{name:"temperature",value:-.55},{name:"tint",value:.1},{name:"levels",value:{minin:0,maxin:255,minout:24,maxout:249,midin:1,mid:.5}},{name:"toning",value:{value:.76,lightColor:"#ffd500",darkColor:"#7d0354"}},{name:"curves",value:{preset:[[0,0,255,255],[0,0,131,115,255,255],[0,0,136,128,255,255],[0,0,122,145,255,255]]}},{name:"vignette",value:.28}],wifortress:[{name:"toning",value:{value:1,lightColor:"#6cceff",darkColor:"#001a26"}},{name:"highlights",value:1},{name:"levels",value:{minin:40,maxin:155,minout:0,maxout:255,midin:1,mid:.5}},{name:"shadows",value:1}],vib:[{name:"vibrance",value:.1},{name:"saturation",value:.5},{name:"brightness",value:.1},{name:"temperature",value:.5},{name:"levels",value:{minin:12,maxin:253,minout:0,maxout:255,midin:1,mid:.5}},{name:"highlights",value:.2},{name:"curves",value:{preset:[[0,0,255,255],[0,0,70,80,198,181,255,255],[0,0,140,135,255,255],[0,0,74,96,200,172,255,255]]}},{name:"toning",value:{value:.07,lightColor:"#ffeed2",darkColor:"#360606"}},{name:"contrast",value:-.1}],ranguit:[{name:"saturation",value:.22},{name:"temperature",value:.96},{name:"tint",value:-.28},{name:"contrast",value:.14},{name:"brightness",value:-.2},{name:"levels",value:{minin:0,maxin:237,minout:56,maxout:255,midin:1,mid:.5}},{name:"toning",value:{value:.26,lightColor:"#ddff99",darkColor:"#292321"}}],rangeen:[{name:"vibrance",value:1},{name:"saturation",value:.46},{name:"temperature",value:.36},{name:"levels",value:{minin:0,maxin:251,minout:14,maxout:255,midin:1,mid:.5}},{name:"shadows",value:.34},{name:"highlights",value:.12},{name:"toning",value:{value:.12,lightColor:"#79ffe0",darkColor:"#f5166b"}},{name:"contrast",value:-.1},{name:"curves",value:{preset:[[0,0,144,152,255,255],[0,0,136,107,255,255],[0,0,115,102,255,255],[0,0,106,91,255,255]]}}],creamlow:[{name:"vibrance",value:.82},{name:"saturation",value:-.24},{name:"temperature",value:1},{name:"tint",value:.78},{name:"contrast",value:-.3},{name:"levels",value:{minin:40,maxin:247,minout:0,maxout:255,midin:1,mid:.5}},{name:"highlights",value:.64},{name:"toning",value:{value:.29,lightColor:"#ddff99",darkColor:"#912709"}},{name:"curves",value:{preset:[[0,0,5,13,78,83,172,162,255,255],[0,0,255,255],[0,0,131,120,255,255],[0,0,68,61,175,184,255,255]]}}],sven:[{name:"vibrance",value:.7},{name:"temperature",value:.5},{name:"tint",value:.3},{name:"exposure",value:.2},{name:"contrast",value:-.2},{name:"levels",value:{minin:4,maxin:255,minout:0,maxout:235,midin:1,mid:.5}},{name:"highlights",value:-.3},{name:"shadows",value:.3},{name:"grain",value:.3},{name:"vignette",value:.45}],yenely:[{name:"tint",value:.5},{name:"levels",value:{minin:0,maxin:235,minout:20,maxout:255,midin:1,mid:.5}},{name:"saturation",value:-.62},{name:"contrast",value:-.3},{name:"shadows",value:-.6},{name:"curves",value:{preset:[[0,0,148,105,255,255],[0,0,92,79,128,227,255,255],[0,0,74,103,119,172,255,255],[0,0,111,148,255,255]]}},{name:"highlights",value:1},{name:"brightness",value:.14},{name:"temperature",value:.3},{name:"vibrance",value:1},{name:"exposure",value:-.1}],ragwarm:[{name:"temperature",value:.62},{name:"levels",value:{minin:32,maxin:255,minout:0,maxout:243,midin:1,mid:.5}},{name:"highlights",value:-.14},{name:"vignette",value:.28},{name:"toning",value:{value:.07,lightColor:"#99ffbb",darkColor:"#15378f"}},{name:"curves",value:{preset:[[0,0,126,125,255,255],[0,0,255,255],[0,0,130,121,255,255],[0,0,138,124,255,255]]}}],greered:[{name:"vibrance",value:.32},{name:"temperature",value:.4},{name:"tint",value:-.5},{name:"brightness",value:.24},{name:"contrast",value:-.1},{name:"vignette",value:.31},{name:"shadows",value:.38}],danligter:[{name:"saturation",value:.86},{name:"temperature",value:-1},{name:"tint",value:-.92},{name:"brightness",value:.22},{name:"exposure",value:.22},{name:"contrast",value:.1},{name:"levels",value:{minin:0,maxin:239,minout:0,maxout:255,midin:1,mid:.5}},{name:"highlights",value:-.12},{name:"dehaze",value:-.12},{name:"toning",value:{value:.14,lightColor:"#ffd899",darkColor:"#00344d"}},{name:"curves",value:{preset:[[0,0,255,255],[0,0,96,115,162,194,255,255],[0,0,101,97,185,189,255,255],[0,0,144,130,222,228,255,255]]}}],trotto:[{name:"vibrance",value:1},{name:"saturation",value:-.34},{name:"temperature",value:1},{name:"tint",value:-.26},{name:"levels",value:{minin:24,maxin:229,minout:0,maxout:255,midin:1,mid:.5}},{name:"shadows",value:.14},{name:"dehaze",value:.38},{name:"toning",value:{value:.5,lightColor:"#46fa82",darkColor:"#bf5a20"}},{name:"curves",value:{preset:[[0,0,66,56,168,171,255,255],[0,0,68,77,191,179,255,255],[0,0,73,80,173,166,255,255],[0,0,82,110,171,185,255,255]]}},{name:"vignette",value:.14}],rasky:[{name:"vibrance",value:1},{name:"saturation",value:1},{name:"temperature",value:-.84},{name:"tint",value:.34},{name:"dehaze",value:.52},{name:"toning",value:{value:.39,lightColor:"#cbd420",darkColor:"#d9180a"}}],garage:[{name:"tint",value:.6},{name:"saturation",value:-.04},{name:"shadows",value:-1},{name:"grain",value:.42},{name:"glamour",value:.3}],travelster:[{name:"vibrance",value:.84},{name:"saturation",value:.66},{name:"contrast",value:.24},{name:"levels",value:{minin:62,maxin:255,minout:0,maxout:255,midin:1,mid:.5}},{name:"highlights",value:.62},{name:"shadows",value:-.3},{name:"curves",value:{preset:[[0,32,136,111,255,255],[0,0,149,161,255,255],[0,0,148,139,255,255],[0,0,99,173,164,213,255,255]]}},{name:"toning",value:{value:.3,lightColor:"#ffd899",darkColor:"#334d00"}},{name:"sharpen",value:.24},{name:"grain",value:.23},{name:"temperature",value:.72},{name:"vignette",value:.13}],strawberry:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#ff0000"}}],clementine:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#ff9e00"}}],pear:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#aaff00"}}],apple:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#00ff55"}}],blueberry:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#00aaff"}}],grapes:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#5500ff"}}],dragon:[{name:"fill",value:{value:.5,mode:"softLight",fillColor:"#ff00aa"}}],punch:[{name:"curves",value:{preset:[[0,0,80,64,173,193,255,255],[0,0,255,255],[0,0,255,255],[0,0,255,255]]}},{name:"vibrance",value:.5}],bright:[{name:"highlights",value:-.3},{name:"shadows",value:.5},{name:"levels",value:{minin:0,maxin:215,minout:10,maxout:255,midin:1,mid:.5}}],contrast:[{name:"contrast",value:.2},{name:"highlights",value:.2},{name:"levels",value:{minin:20,maxin:215,minout:0,maxout:255,midin:1,mid:.5}},{name:"shadows",value:.4}],vivid:[{name:"vibrance",value:.4},{name:"shadows",value:.25}],clairify:[{name:"clarity",value:.6},{name:"sharpen",value:.1},{name:"glamour",value:.2}]};class CanvasSQ{constructor(e=0,t=0){this.x=e,this.y=t}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}angleTo(e){let t=-(this.x-e.x),r=this.y-e.y,i=360-Math.atan2(r,t)*(180/Math.PI);return i<0&&(i+=360),360<i&&(i-=360),i}dot(e){return this.x*e.x+this.y*e.y}lengthSQ(){return this.dot(this)}length(){return Math.sqrt(this.lengthSQ())}hypot2(){return this.dot(this)}hypot(){return Math.hypot(this.x,this.y)}add(e){return e?e instanceof CanvasSQ?new CanvasSQ(this.x+e.x,this.y+e.y):new CanvasSQ(this.x+e,this.y+e):this}neg(e){return e instanceof CanvasSQ?new CanvasSQ(this.x-e.x,this.y-e.y):new CanvasSQ(this.x-e,this.y-e)}mul(e){return e instanceof CanvasSQ?new CanvasSQ(this.x*e.x,this.y*e.y):new CanvasSQ(this.x*e,this.y*e)}rotateAround(e,t){var r=Math.sin(t),t=Math.cos(t),i=this.x-e.x,n=this.y-e.y,a=i*r+n*t;return new CanvasSQ(i*t-n*r+e.x,a+e.y)}equalTo(e){return this.x===e.x&&this.y===e.y}clone(){return new CanvasSQ(this.x,this.y)}}class interpolate{constructor(e,t){var r,i,n,a,s,o,l,u,c,h,d,p;if(null!=e&&null!=t){for(u=e.length-1,a=[],h=[],l=[],c=[],d=[],i=[],r=[],n=[],o=[],s=0;0<=u?s<u:u<s;0<=u?s+=1:--s)a[s]=e[s+1]-e[s],o[s]=t[s+1]-t[s],s,0;for(s=1;1<=u?s<u:u<s;1<=u?s+=1:--s)h[s]=3/a[s]*(t[s+1]-t[s])-3/a[s-1]*(t[s]-t[s-1]);for(l[0]=1,d[c[0]=0]=0,s=1;1<=u?s<u:u<s;1<=u?s+=1:--s)l[s]=2*(e[s+1]-e[s-1])-a[s-1]*c[s-1],c[s]=a[s]/l[s],d[s]=(h[s]-a[s-1]*d[s-1])/l[s];for(l[u]=1,i[u]=d[u]=0,s=p=u-1;p<=0?s<=0:0<=s;p<=0?s+=1:--s)i[s]=d[s]-c[s]*i[s+1],r[s]=(t[s+1]-t[s])/a[s]-a[s]*(i[s+1]+2*i[s])/3,n[s]=(i[s+1]-i[s])/(3*a[s]);this.x=e.slice(0,1+u),this.a=t.slice(0,u),this.b=r,this.c=i.slice(0,u),this.d=n}}interpolate(e){for(var t,r,i=r=this.x.length-1;(r<=0?i<=0:0<=i)&&!(this.x[i]<=e);r<=0?i+=1:--i);return t=e-this.x[i],this.a[i]+this.b[i]*t+this.c[i]*Math.pow(t,2)+this.d[i]*Math.pow(t,3)}}var fragment="#define GLSLIFY 1\nprecision highp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform sampler2D paletteMap;void main(){lowp vec4 base=texture2D(uSampler,vTextureCoord.xy);float r=texture2D(paletteMap,vec2(base.r,0)).r;float g=texture2D(paletteMap,vec2(base.g,0)).g;float b=texture2D(paletteMap,vec2(base.b,0)).b;gl_FragColor=vec4(r,g,b,base.a);}";class Mapping extends Filter{constructor(e){super(null,fragment),this.paletteMap=e}get paletteMap(){return this.uniforms.paletteMap}set paletteMap(e){e=new Uint8Array(Array.from(e.data));this.uniforms.paletteMap=Texture.fromBuffer(e,e.length/4,1)}}class Curves extends Filter{constructor(e){super(null,null),this._imageData=new ImageData(256,1),this.options=e}apply(e,t,r,i,n){this._mapping.apply(e,t,r,i)}update(){var e=this._imageData;interpolateCanvas.fillPaletteMap(Curves.createCurveSet(this.uniforms.options),e),this.uniforms.paletteMap=e,this._mapping?this._mapping.paletteMap=this.uniforms.paletteMap:this._mapping=new Mapping(this.uniforms.paletteMap)}get options(){return this.uniforms.options}set options(e){this.uniforms.options=e,this.update()}static createCurveSet(t){var r=new Array,i=new Array,n=new Array,a=new Array;for(let e=0;e<t.preset[0].length;e+=2)r.push(new CanvasSQ(t.preset[0][e],t.preset[0][e+1]));for(let e=0;e<t.preset[1].length;e+=2)i.push(new CanvasSQ(t.preset[1][e],t.preset[1][e+1]));for(let e=0;e<t.preset[2].length;e+=2)n.push(new CanvasSQ(t.preset[2][e],t.preset[2][e+1]));for(let e=0;e<t.preset[3].length;e+=2)a.push(new CanvasSQ(t.preset[3][e],t.preset[3][e+1]));return new interpolateCanvas(1,r,i,n,a)}}class interpolateCanvas{constructor(e=255,t=[],r=[],i=[],n=[]){this.scale=e,this.rgb=t,this.red=r,this.green=i,this.blue=n,this.percent=1}static getInterpolation(e,t){for(var r=[],i=[],n=new Float32Array(256),a=0;a<t.length;a++)r.push(t[a].x*e),i.push(t[a].y*e);for(var s=new interpolate(r,i),o=0;o<Math.ceil(r[0]);o++)n[o]=i[0];for(o=Math.ceil(r[0]);o<Math.ceil(r[r.length-1]);o++)n[o]=s.interpolate(o);for(o=Math.ceil(r[r.length-1]);o<256;o++)n[o]=i[i.length-1];return n}static fillPaletteMap(t,r){var i=interpolateCanvas.getInterpolation(t.scale,t.rgb),n=interpolateCanvas.getInterpolation(t.scale,t.red),a=interpolateCanvas.getInterpolation(t.scale,t.green),s=interpolateCanvas.getInterpolation(t.scale,t.blue);for(let e=0;e<256;++e){var o=e-i[e];r.data[4*e]=e-Math.round((e-(n[e]-o))*t.percent),r.data[4*e+1]=e-Math.round((e-(a[e]-o))*t.percent),r.data[4*e+2]=e-Math.round((e-(s[e]-o))*t.percent)}}}class LevelMapping{constructor(e=0,t=255,r=0,i=255,n=1,a=.5){this.minin=e,this.maxin=t,this.minout=r,this.maxout=i,this.midin=n,this.mid=a,this.map=e=>(e=(e-this.minin)/(this.maxin-this.minin),e=Math.pow(e,this.midin),(e=this.minout+e*(this.maxout-this.minout))>this.maxout?e=this.maxout:e<this.minout&&(e=this.minout),Math.round(e))}reset(){this.minout=0,this.maxout=255,this.midin=1,this.minin=0,this.maxin=255,this.mid=.5}isFlat(){return Boolean(0==this.minout&&255==this.maxout&&.5==this.mid&&0==this.minin&&255==this.maxin)}setMid(e){this.mid=(e-this.minin)/(this.maxin-this.minin),this.midin=this.midToIn(this.mid)}midToIn(e){return Math.min(Math.max(Math.pow(9.99,2*e-1),.1),9.99)}static fillPaletteMap(t,r){for(let e=0;e<256;++e){var i=t.map(e);r.data[4*e]=i,r.data[4*e+1]=i,r.data[4*e+2]=i}}static fillRGBPaletteMap(t,r,i,n){for(let e=0;e<256;++e)n.data[4*e]=t?t.map(e):e,n.data[4*e+1]=r?r.map(e):e,n.data[4*e+2]=i?i.map(e):e}}class Levels extends Filter{constructor(e){super(null,null),this._imageData=new ImageData(256,1),this.options=e}apply(e,t,r,i,n){this._mapping.apply(e,t,r,i)}update(){var e=this._imageData;this.uniforms.paletteMap=e,LevelMapping.fillPaletteMap(this.uniforms.options,e),this._mapping?this._mapping.paletteMap=this.uniforms.paletteMap:this._mapping=new Mapping(this.uniforms.paletteMap)}get options(){return this.uniforms.options}set options(e){this.uniforms.options=e,this.update()}}class Preset extends ColorEffectsFilter{constructor(e){super(null,null),this.filtersArr=[],this.effectName=e,this.effectType="preset",this.filtersArr=presetConfig[e].map(e=>{var t,r,i;return"curves"===e.name?new Curves(e.value):"fill"===e.name?({value:r,fillColor:i,mode:t}=e.value,new filters$1[e.name](r,i,t)):"levels"===e.name?(r=e.value,i=new LevelMapping(Math.round(+r.minin),Math.round(255-(255-r.maxin))),new Levels(i)):"toning"===e.name?({value:t,lightColor:r,darkColor:i}=e.value,new filters$1[e.name](t,r,i)):"desaturate"===e.name?new filters$1.saturation(-1):"vignette"===e.name?e.value<0?new filters$1.vignetteWhite(e.value):new filters$1.vignetteBlack(Math.abs(e.value)):new filters$1[e.name](e.value)})}apply(t,r,e,i,n){var a,s=t.getFilterTexture(),o=[s];for(let e=0;e<this.filtersArr.length;e++)0===e?this.filtersArr[e].apply(t,r,s,1,n):(a=t.getFilterTexture(),o.push(a),this.filtersArr[e].apply(t,o[e-1],a,1));t.applyFilter(this,o[o.length-1],e,i),o.reverse().map(e=>{t.returnFilterTexture(e)})}}let filters$1={vibrance:Vibrance,saturation:Saturation,temperature:Temperature,tint:Tint,hue:Hue,brightness:Brightness,exposure:Exposure,contrast:Contrast,black:Black,white:White,highlights:Highlights,shadows:Shadows,sharpen:Sharpen,clarity:Clarity,smooth:Smooth,blur:Blur,grain:Grain,vignetteWhite:VignetteWhite,vignetteBlack:VignetteBlack,glamour:Glamour,bloom:Bloom,dehaze:Dehaze,toning:Toning,fill:Fill},effects=Object.freeze(Object.defineProperty({__proto__:null,Black:Black,Bloom:Bloom,Blur:Blur,Brightness:Brightness,Clarity:Clarity,Contrast:Contrast,Dehaze:Dehaze,Exposure:Exposure,Fill:Fill,Glamour:Glamour,Grain:Grain,Highlights:Highlights,Hue:Hue,Preset:Preset,Saturation:Saturation,Shadows:Shadows,Sharpen:Sharpen,Smooth:Smooth,Temperature:Temperature,Tint:Tint,Toning:Toning,Vibrance:Vibrance,VignetteBlack:VignetteBlack,VignetteWhite:VignetteWhite,White:White,filters:filters$1,presetConfig:presetConfig},Symbol.toStringTag,{value:"Module"}));function useElementFilter(i,e){reactExports.useEffect(()=>{if(e.filters){let r=i.filters||[];e.filters.forEach(t=>{var e=(i.filters||[]).find(e=>e.name===t.name);e?(Object.assign(e.uniforms,{...t.params}),e.enabled=t.enabled):((e=new effects[t.name]).name=t.name,Object.assign(e.uniforms,{...t.params}),e.enabled=t.enabled,r.push(e))}),i.filters=[...r]}else i.filters=[]},[e._filtersDirty])}let VertexShader$1=`
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    uniform mat3 projectionMatrix;
    varying vec2 vTextureCoord;
    void main(void){
        gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
    }
`,FragmentShader$1=`
precision mediump float;
uniform sampler2D uSampler;
uniform vec3 color;
uniform float videowidth;
uniform float videoheight;
uniform int filterType;
uniform float gridSize;
uniform float lightLevel;
uniform float emergence; // 羽化强度
varying vec2 vTextureCoord;

// 外边框xx
uniform vec4 filterClamp;
vec2 uThickness = vec2(-0.00390625, -0.00390625);
const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = 0.6283185;
float uAlpha = 1.0;
vec4 uColor = vec4(1.0,1.0,1.0,1.0);

float outlineMaxAlphaAtPos(vec2 pos) {
  if (uThickness.x == 0. || uThickness.y == 0.) {
      return 0.;
  }

  vec4 displacedColor;
  vec2 displacedPos;
  float maxAlpha = 0.;

  for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
      displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
      displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
      displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
      maxAlpha = max(maxAlpha, displacedColor.a);
  }

  return maxAlpha;
}

vec4 outlineMain(vec4 sourceColor) {
  vec4 contentColor = sourceColor * 1.0;
  float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
  vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
  return contentColor + outlineColor;
}
// END 外边框

float rgb2cb(float r, float g, float b){
  return 0.5 + -0.168736*r - 0.331264*g + 0.5*b;
}
float rgb2cr(float r, float g, float b){
  return 0.5 + 0.5*r - 0.418688*g - 0.081312*b;
}
float smoothclip(float low, float high, float x){
  if (x <= low){
    return 0.0;
  }
  if(x >= high){
    return 1.0;
  }
  return (x-low)/(high-low);
}
vec4 greenscreen(vec4 colora, float Cb_key, float Cr_key, float tola, float tolb, float clipBlack, float clipWhite){
  float cb = rgb2cb(colora.r,colora.g,colora.b);
  float cr = rgb2cr(colora.r,colora.g,colora.b);
  float alpha = distance(vec2(cb, cr), vec2(Cb_key, Cr_key));
  alpha = smoothclip(tola, tolb, alpha);

  float r = max(gl_FragColor.r - (1.0-alpha)*color.r, 0.0);
  float g = max(gl_FragColor.g - (1.0-alpha)*color.g, 0.0);
  float b = max(gl_FragColor.b - (1.0-alpha)*color.b, 0.0);

  // alpha < 0.5
  if(alpha < clipBlack){
    alpha = r = g = b = 0.0;
  } else {
    alpha = 1.0;
  }

  // alpha > 1.0
  if(alpha > clipWhite){
    alpha = 1.0;
  }

  return vec4(r,g,b,alpha);
}

float u_threshold=1.0;
float u_clipBlack=1.0;
float u_clipWhite=1.0;
void main()
{

  vec4 frag = texture2D(uSampler, vTextureCoord);

  gl_FragColor = frag;

  // 绿幕
  float tola = 0.0;
  float tolb = u_threshold/2.0;
  float cb_key = rgb2cb(color.r, color.g, color.b);
  float cr_key = rgb2cr(color.r, color.g, color.b);
  gl_FragColor = greenscreen(gl_FragColor, cb_key, cr_key, tola, tolb, u_clipBlack, u_clipWhite);

  // 去掉旋转后黑色的背景
  if(gl_FragColor.r == 0.0 && gl_FragColor.g == 0.0 && gl_FragColor.b == 0.0) {
    gl_FragColor.a = 0.0;
  }
    
  if(filterType==8) {
    // // 如果颜色不是完全黑色，则保留，否则设为透明
    // vec3 tColor = texture2D(uSampler, vTextureCoord.xy).rgb;
    // float colorDifference = distance(tColor, color);
    // if (colorDifference < emergence) {
    //   // iscard; // 丢弃完全黑色的片段
    //   // gl_FragColor = frag;
    //   gl_FragColor.a = 0.0;
    //   // frag.a = 0.0;
    // } else {
    //   gl_FragColor = frag;
    // }

    vec3 tColor = texture2D(uSampler, vTextureCoord.xy).rgb;
    float colorDifference = distance(tColor, color);
    float alpha = smoothstep(emergence - 0.1, emergence + 0.1, colorDifference);
    gl_FragColor.a *= alpha;
  }
}
`;class ScreenFilter extends Filter{constructor(e){e=Object.assign({color:[0,1,.0015176349176470587],filterType:0,lightLevel:.2,gridSize:.8,emergence:.1},e),super(VertexShader$1,FragmentShader$1,{...e}),this.id=""}setTexture(e){e.baseTexture.mipmap=MIPMAP_MODES.OFF,this.uniforms.texture=e}get filterType(){return this.uniforms.filterType}set filterType(e){this.uniforms.filterType=e}get lightLevel(){return this.uniforms.lightLevel}set lightLevel(e){this.uniforms.lightLevel=e}get gridSize(){return this.uniforms.gridSize}set gridSize(e){this.uniforms.gridSize=e}get emergence(){return this.uniforms.emergence}set emergence(e){this.uniforms.emergence=e}get color(){return this.uniforms.color}set color(e){this.uniforms.color=e}}ScreenFilter.filterType="ScreenFilterParams";var lib$1={},gif$1={},lib={},parse$1=(Object.defineProperty(lib,"__esModule",{value:!0}),lib.loop=lib.conditional=lib.parse=void 0,function t(r,e){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:n;return Array.isArray(e)?e.forEach(function(e){return t(r,e,n,a)}):"function"==typeof e?e(r,n,a,t):(i=Object.keys(e)[0],Array.isArray(e[i])?(a[i]={},t(r,e[i],n,a[i])):a[i]=e[i](r,n,a,t)),n}),conditional=(lib.parse=parse$1,function(n,a){return function(e,t,r,i){a(e,t,r)&&i(e,n,t,r)}}),loop=(lib.conditional=conditional,function(o,l){return function(e,t,r,i){for(var n=[],a=e.pos;l(e,t,r);){var s={};if(i(e,o,t,s),e.pos===a)break;a=e.pos,n.push(s)}return n}}),uint8=(lib.loop=loop,{}),buildStream=(Object.defineProperty(uint8,"__esModule",{value:!0}),uint8.readBits=uint8.readArray=uint8.readUnsigned=uint8.readString=uint8.peekBytes=uint8.readBytes=uint8.peekByte=uint8.readByte=uint8.buildStream=void 0,function(e){return{data:e,pos:0}}),readByte=(uint8.buildStream=buildStream,function(){return function(e){return e.data[e.pos++]}}),peekByte=(uint8.readByte=readByte,function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(e){return e.data[e.pos+t]}}),readBytes=(uint8.peekByte=peekByte,function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}}),peekBytes=(uint8.readBytes=readBytes,function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}}),readString=(uint8.peekBytes=peekBytes,function(t){return function(e){return Array.from(readBytes(t)(e)).map(function(e){return String.fromCharCode(e)}).join("")}}),readUnsigned=(uint8.readString=readString,function(t){return function(e){e=readBytes(2)(e);return t?(e[1]<<8)+e[0]:(e[0]<<8)+e[1]}}),readArray=(uint8.readUnsigned=readUnsigned,function(o,l){return function(e,t,r){for(var i="function"==typeof l?l(e,t,r):l,n=readBytes(o),a=new Array(i),s=0;s<i;s++)a[s]=n(e);return a}}),subBitsTotal=(uint8.readArray=readArray,function(e,t,r){for(var i=0,n=0;n<r;n++)i+=e[t+n]&&Math.pow(2,r-n-1);return i}),readBits=function(n){return function(e){for(var t=readByte()(e),i=new Array(8),r=0;r<8;r++)i[7-r]=!!(t&1<<r);return Object.keys(n).reduce(function(e,t){var r=n[t];return r.length?e[t]=subBitsTotal(i,r.index,r.length):e[t]=i[r.index],e},{})}},deinterlace$1=(uint8.readBits=readBits,(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=uint8,t={blocks:function(e){for(var t=[],r=e.data.length,i=0,n=(0,u.readByte)()(e);0!==n&&n;n=(0,u.readByte)()(e)){if(e.pos+n>=r){var a=r-e.pos;t.push((0,u.readBytes)(a)(e)),i+=a;break}t.push((0,u.readBytes)(n)(e)),i+=n}for(var s=new Uint8Array(i),o=0,l=0;l<t.length;l++)s.set(t[l],o),o+=t[l].length;return s}},r=(0,(s=lib).conditional)({gce:[{codes:(0,u.readBytes)(2)},{byteSize:(0,u.readByte)()},{extras:(0,u.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,u.readUnsigned)(!0)},{transparentColorIndex:(0,u.readByte)()},{terminator:(0,u.readByte)()}]},function(e){e=(0,u.peekBytes)(2)(e);return 33===e[0]&&249===e[1]}),i=(0,s.conditional)({image:[{code:(0,u.readByte)()},{descriptor:[{left:(0,u.readUnsigned)(!0)},{top:(0,u.readUnsigned)(!0)},{width:(0,u.readUnsigned)(!0)},{height:(0,u.readUnsigned)(!0)},{lct:(0,u.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,s.conditional)({lct:(0,u.readArray)(3,function(e,t,r){return Math.pow(2,r.descriptor.lct.size+1)})},function(e,t,r){return r.descriptor.lct.exists}),{data:[{minCodeSize:(0,u.readByte)()},t]}]},function(e){return 44===(0,u.peekByte)()(e)}),n=(0,s.conditional)({text:[{codes:(0,u.readBytes)(2)},{blockSize:(0,u.readByte)()},{preData:function(e,t,r){return(0,u.readBytes)(r.text.blockSize)(e)}},t]},function(e){e=(0,u.peekBytes)(2)(e);return 33===e[0]&&1===e[1]}),a=(0,s.conditional)({application:[{codes:(0,u.readBytes)(2)},{blockSize:(0,u.readByte)()},{id:function(e,t,r){return(0,u.readString)(r.blockSize)(e)}},t]},function(e){e=(0,u.peekBytes)(2)(e);return 33===e[0]&&255===e[1]}),t=(0,s.conditional)({comment:[{codes:(0,u.readBytes)(2)},t]},function(e){e=(0,u.peekBytes)(2)(e);return 33===e[0]&&254===e[1]}),s=[{header:[{signature:(0,u.readString)(3)},{version:(0,u.readString)(3)}]},{lsd:[{width:(0,u.readUnsigned)(!0)},{height:(0,u.readUnsigned)(!0)},{gct:(0,u.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,u.readByte)()},{pixelAspectRatio:(0,u.readByte)()}]},(0,s.conditional)({gct:(0,u.readArray)(3,function(e,t){return Math.pow(2,t.lsd.gct.size+1)})},function(e,t){return t.lsd.gct.exists}),{frames:(0,s.loop)([r,a,t,i,n],function(e){e=(0,u.peekByte)()(e);return 33===e||44===e})}];e.default=s})(gif$1),{}),deinterlace=(Object.defineProperty(deinterlace$1,"__esModule",{value:!0}),deinterlace$1.deinterlace=void 0,function(e,t){for(var r=new Array(e.length),i=e.length/t,n=[0,4,2,1],a=[8,8,4,2],s=0,o=0;o<4;o++)for(var l=n[o];l<i;l+=a[o]){c=u=void 0;var u=l,c=s;c=e.slice(c*t,(c+1)*t),r.splice.apply(r,[u*t,t].concat(c)),s++}return r}),lzw$1=(deinterlace$1.deinterlace=deinterlace,{}),lzw=(Object.defineProperty(lzw$1,"__esModule",{value:!0}),lzw$1.lzw=void 0,function(e,t,r){for(var i,n,a,s,o,l,u,c,h=r,d=new Array(r),p=new Array(4096),f=new Array(4096),m=new Array(4097),g=e,v=1<<g,y=1+v,_=2+v,b=-1,x=g+1,S=(1<<x)-1,T=0;T<v;T++)p[T]=0,f[T]=T;for(n=a=s=o=l=u=c=0;n<h;){if(0===l){if(s<x){a+=t[c]<<s,s+=8,c++;continue}if(T=a&S,a>>=x,s-=x,_<T||T==y)break;if(T==v){S=(1<<(x=g+1))-1,_=2+v,b=-1;continue}if(-1==b){m[l++]=f[T],o=b=T;continue}for((i=T)==_&&(m[l++]=o,T=b);v<T;)m[l++]=f[T],T=p[T];o=255&f[T],m[l++]=o,_<4096&&(p[_]=b,f[_]=o,0==(++_&S))&&_<4096&&(x++,S+=_),b=i}l--,d[u++]=m[l],n++}for(n=u;n<h;n++)d[n]=0;return d}),decompressFrames_1=(lzw$1.lzw=lzw,Object.defineProperty(lib$1,"__esModule",{value:!0}),lib$1.decompressFrames=lib$1.decompressFrame=parseGIF_1=lib$1.parseGIF=void 0),_gif=_interopRequireDefault(gif$1),_jsBinarySchemaParser=lib,_uint=uint8,_deinterlace=deinterlace$1,_lzw=lzw$1;function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var parseGIF=function(e){e=new Uint8Array(e);return(0,_jsBinarySchemaParser.parse)((0,_uint.buildStream)(e),_gif.default)},parseGIF_1=lib$1.parseGIF=parseGIF,generatePatch=function(e){for(var t=e.pixels.length,r=new Uint8ClampedArray(4*t),i=0;i<t;i++){var n=4*i,a=e.pixels[i],s=e.colorTable[a]||[0,0,0];r[n]=s[0],r[1+n]=s[1],r[2+n]=s[2],r[3+n]=a!==e.transparentIndex?255:0}return r},decompressFrame=function(e,t,r){var i,n;if(e.image)return n=(i=e.image).descriptor.width*i.descriptor.height,n=(0,_lzw.lzw)(i.data.minCodeSize,i.data.blocks,n),n={pixels:n=i.descriptor.lct.interlaced?(0,_deinterlace.deinterlace)(n,i.descriptor.width):n,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}},i.descriptor.lct&&i.descriptor.lct.exists?n.colorTable=i.lct:n.colorTable=t,e.gce&&(n.delay=10*(e.gce.delay||10),n.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven)&&(n.transparentIndex=e.gce.transparentColorIndex),r&&(n.patch=generatePatch(n)),n},decompressFrames=(lib$1.decompressFrame=decompressFrame,function(t,r){return t.frames.filter(function(e){return e.image}).map(function(e){return decompressFrame(e,t.gct,r)})});function toFrames(e,t,r){let i=null;var n,a=[],s=document.createElement("canvas"),o=s.getContext("2d",{willReadFrequently:!0}),l=document.createElement("canvas"),u=l.getContext("2d");s.width=r.lsd.width,s.height=r.lsd.height;for(n of e){var c=n.dims;i&&c.width==i.width&&c.height==i.height||(l.width=c.width,l.height=c.height,i=u.createImageData(c.width,c.height)),i.data.set(n.patch),u.putImageData(i,0,0),o.drawImage(l,c.left,c.top),"base64"===t?a.push(s.toDataURL()):(c=s.toDataURL(),a.push(c))}return a}decompressFrames_1=lib$1.decompressFrames=decompressFrames;let validateAndFix=e=>{let t=null;for(var r of e.frames)t=r.gce??t,"image"in r&&!("gce"in r)&&(r.gce=t)};async function gif2frames(e,t="base64"){var r,i,e=await(await fetch(e)).arrayBuffer(),e=parseGIF_1(e),n=(validateAndFix(e),e.frames[~~(e.frames.length/2)]||{gce:{delay:.1}}),a=decompressFrames_1(e,!0);try{return{gifArr:"base64"===t?toFrames(a,t,e):a,totalFrame:e.frames.length,delayFrame:n.gce&&n.gce.delay/100||.1,width:null==(r=e.lsd)?void 0:r.width,height:null==(i=e.lsd)?void 0:i.height}}catch(e){return null}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(e,t){var r;return t=t||{},(e=e||"")instanceof tinycolor?e:this instanceof tinycolor?(r=inputToRGB(e),this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||r.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),void(this._ok=r.ok)):new tinycolor(e,t)}function inputToRGB(e){var t,r={r:0,g:0,b:0},i=1,n=null,a=!1,s=!1,i=boundAlpha(i="object"==_typeof(e="string"==typeof e?stringInputToObject(e):e)&&(isValidCSSUnit(e.r)&&isValidCSSUnit(e.g)&&isValidCSSUnit(e.b)?(r=rgbToRgb(e.r,e.g,e.b),a=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.v)?(n=convertToPercentage(e.s),t=convertToPercentage(e.v),r=hsvToRgb(e.h,n,t),a=!0,s="hsv"):isValidCSSUnit(e.h)&&isValidCSSUnit(e.s)&&isValidCSSUnit(e.l)&&(n=convertToPercentage(e.s),t=convertToPercentage(e.l),r=hslToRgb(e.h,n,t),a=!0,s="hsl"),e.hasOwnProperty("a"))?e.a:i);return{ok:a,format:e.format||s,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:i}}function rgbToRgb(e,t,r){return{r:255*bound01(e,255),g:255*bound01(t,255),b:255*bound01(r,255)}}function rgbToHsl(e,t,r){e=bound01(e,255),t=bound01(t,255),r=bound01(r,255);var i,n=Math.max(e,t,r),a=Math.min(e,t,r),s=(n+a)/2;if(n==a)i=l=0;else{var o=n-a,l=.5<s?o/(2-n-a):o/(n+a);switch(n){case e:i=(t-r)/o+(t<r?6:0);break;case t:i=(r-e)/o+2;break;case r:i=(e-t)/o+4}i/=6}return{h:i,s:l,l:s}}function hslToRgb(e,t,r){var i,n,a;function s(e,t,r){return r<0&&(r+=1),1<r&&--r,r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}return e=bound01(e,360),t=bound01(t,100),r=bound01(r,100),0===t?i=n=a=r:(i=s(t=2*r-(r=r<.5?r*(1+t):r+t-r*t),r,e+1/3),n=s(t,r,e),a=s(t,r,e-1/3)),{r:255*i,g:255*n,b:255*a}}function rgbToHsv(e,t,r){e=bound01(e,255),t=bound01(t,255),r=bound01(r,255);var i,n=Math.max(e,t,r),a=Math.min(e,t,r),s=n,o=n-a,l=0===n?0:o/n;if(n==a)i=0;else{switch(n){case e:i=(t-r)/o+(t<r?6:0);break;case t:i=(r-e)/o+2;break;case r:i=(e-t)/o+4}i/=6}return{h:i,s:l,v:s}}function hsvToRgb(e,t,r){e=6*bound01(e,360),t=bound01(t,100),r=bound01(r,100);var i=Math.floor(e),e=e-i,n=r*(1-t),a=r*(1-e*t),e=r*(1-(1-e)*t),t=i%6;return{r:255*[r,a,n,n,e,r][t],g:255*[e,r,r,a,n,n][t],b:255*[n,n,e,r,r,a][t]}}function rgbToHex(e,t,r,i){e=[pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16))];return i&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function rgbaToHex(e,t,r,i,n){e=[pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(convertDecimalToHex(i))];return n&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)&&e[3].charAt(0)==e[3].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0)+e[3].charAt(0):e.join("")}function rgbaToArgbHex(e,t,r,i){return[pad2(convertDecimalToHex(i)),pad2(Math.round(e).toString(16)),pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16))].join("")}function _desaturate(e,t){t=0===t?0:t||10;e=tinycolor(e).toHsl();return e.s-=t/100,e.s=clamp01(e.s),tinycolor(e)}function _saturate(e,t){t=0===t?0:t||10;e=tinycolor(e).toHsl();return e.s+=t/100,e.s=clamp01(e.s),tinycolor(e)}function _greyscale(e){return tinycolor(e).desaturate(100)}function _lighten(e,t){t=0===t?0:t||10;e=tinycolor(e).toHsl();return e.l+=t/100,e.l=clamp01(e.l),tinycolor(e)}function _brighten(e,t){t=0===t?0:t||10;e=tinycolor(e).toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(-t/100*255))),e.g=Math.max(0,Math.min(255,e.g-Math.round(-t/100*255))),e.b=Math.max(0,Math.min(255,e.b-Math.round(-t/100*255))),tinycolor(e)}function _darken(e,t){t=0===t?0:t||10;e=tinycolor(e).toHsl();return e.l-=t/100,e.l=clamp01(e.l),tinycolor(e)}function _spin(e,t){e=tinycolor(e).toHsl(),t=(e.h+t)%360;return e.h=t<0?360+t:t,tinycolor(e)}function _complement(e){e=tinycolor(e).toHsl();return e.h=(e.h+180)%360,tinycolor(e)}function polyad(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var r=tinycolor(e).toHsl(),i=[tinycolor(e)],n=360/t,a=1;a<t;a++)i.push(tinycolor({h:(r.h+a*n)%360,s:r.s,l:r.l}));return i}function _splitcomplement(e){var t=tinycolor(e).toHsl(),r=t.h;return[tinycolor(e),tinycolor({h:(r+72)%360,s:t.s,l:t.l}),tinycolor({h:(r+216)%360,s:t.s,l:t.l})]}function _analogous(e,t,r){t=t||6,r=r||30;var i=tinycolor(e).toHsl(),n=360/r,a=[tinycolor(e)];for(i.h=(i.h-(n*t>>1)+720)%360;--t;)i.h=(i.h+n)%360,a.push(tinycolor(i));return a}function _monochromatic(e,t){t=t||6;for(var e=tinycolor(e).toHsv(),r=e.h,i=e.s,n=e.v,a=[],s=1/t;t--;)a.push(tinycolor({h:r,s:i,v:n})),n=(n+s)%1;return a}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e=this.toRgb(),t=e.r/255,r=e.g/255,e=e.b/255,t=t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4),r=r<=.03928?r/12.92:Math.pow((.055+r)/1.055,2.4),e=e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4);return.2126*t+.7152*r+.0722*e},setAlpha:function(e){return this._a=boundAlpha(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=rgbToHsv(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=rgbToHsv(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),e=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+r+"%, "+e+"%)":"hsva("+t+", "+r+"%, "+e+"%, "+this._roundA+")"},toHsl:function(){var e=rgbToHsl(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=rgbToHsl(this._r,this._g,this._b),t=Math.round(360*e.h),r=Math.round(100*e.s),e=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+r+"%, "+e+"%)":"hsla("+t+", "+r+"%, "+e+"%, "+this._roundA+")"},toHex:function(e){return rgbToHex(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return rgbaToHex(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*bound01(this._r,255))+"%",g:Math.round(100*bound01(this._g,255))+"%",b:Math.round(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%)":"rgba("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),r=t;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+t+",endColorstr="+(r=e?"#"+rgbaToArgbHex((t=tinycolor(e))._r,t._g,t._b,t._a):r)+")"},toString:function(e){var t=!!e,r=(e=e||this._format,!1),i=this._a<1&&0<=this._a;return t||!i||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),(r="hsv"===e?this.toHsvString():r)||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(e,t){e=e.apply(null,[this].concat([].slice.call(t)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(_lighten,arguments)},brighten:function(){return this._applyModification(_brighten,arguments)},darken:function(){return this._applyModification(_darken,arguments)},desaturate:function(){return this._applyModification(_desaturate,arguments)},saturate:function(){return this._applyModification(_saturate,arguments)},greyscale:function(){return this._applyModification(_greyscale,arguments)},spin:function(){return this._applyModification(_spin,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(_analogous,arguments)},complement:function(){return this._applyCombination(_complement,arguments)},monochromatic:function(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(_splitcomplement,arguments)},triad:function(){return this._applyCombination(polyad,[3])},tetrad:function(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(e,t){if("object"==_typeof(e)){var r,i={};for(r in e)e.hasOwnProperty(r)&&(i[r]="a"===r?e[r]:convertToPercentage(e[r]));e=i}return tinycolor(e,t)},tinycolor.equals=function(e,t){return!(!e||!t)&&tinycolor(e).toRgbString()==tinycolor(t).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},tinycolor.mix=function(e,t,r){r=0===r?0:r||50;e=tinycolor(e).toRgb(),t=tinycolor(t).toRgb(),r/=100;return tinycolor({r:(t.r-e.r)*r+e.r,g:(t.g-e.g)*r+e.g,b:(t.b-e.b)*r+e.b,a:(t.a-e.a)*r+e.a})},tinycolor.readability=function(e,t){e=tinycolor(e),t=tinycolor(t);return(Math.max(e.getLuminance(),t.getLuminance())+.05)/(Math.min(e.getLuminance(),t.getLuminance())+.05)},tinycolor.isReadable=function(e,t,r){var i=tinycolor.readability(e,t),n=!1,e=validateWCAG2Parms(r);switch(e.level+e.size){case"AAsmall":case"AAAlarge":n=4.5<=i;break;case"AAlarge":n=3<=i;break;case"AAAsmall":n=7<=i}return n},tinycolor.mostReadable=function(e,t,r){for(var i,n=null,a=0,s=(r=r||{}).includeFallbackColors,o=r.level,l=r.size,u=0;u<t.length;u++)a<(i=tinycolor.readability(e,t[u]))&&(a=i,n=tinycolor(t[u]));return tinycolor.isReadable(e,n,{level:o,size:l})||!s?n:(r.includeFallbackColors=!1,tinycolor.mostReadable(e,["#fff","#000"],r))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names);function flip(e){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[e[t]]=t);return r}function boundAlpha(e){return e=parseFloat(e),e=isNaN(e)||e<0||1<e?1:e}function bound01(e,t){var r=isPercentage(e=isOnePointZero(e)?"100%":e);return e=Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function clamp01(e){return Math.min(1,Math.max(0,e))}function parseIntFromHex(e){return parseInt(e,16)}function isOnePointZero(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function isPercentage(e){return"string"==typeof e&&-1!=e.indexOf("%")}function pad2(e){return 1==e.length?"0"+e:""+e}function convertToPercentage(e){return e=e<=1?100*e+"%":e}function convertDecimalToHex(e){return Math.round(255*parseFloat(e)).toString(16)}function convertHexToDecimal(e){return parseIntFromHex(e)/255}var matchers=(()=>{var e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",t="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",r="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+t),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+t),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+t),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}})();function isValidCSSUnit(e){return!!matchers.CSS_UNIT.exec(e)}function stringInputToObject(e){e=e.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var t,r=!1;if(names[e])e=names[e],r=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=matchers.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=matchers.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=matchers.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=matchers.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=matchers.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=matchers.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=matchers.hex8.exec(e))?{r:parseIntFromHex(t[1]),g:parseIntFromHex(t[2]),b:parseIntFromHex(t[3]),a:convertHexToDecimal(t[4]),format:r?"name":"hex8"}:(t=matchers.hex6.exec(e))?{r:parseIntFromHex(t[1]),g:parseIntFromHex(t[2]),b:parseIntFromHex(t[3]),format:r?"name":"hex"}:(t=matchers.hex4.exec(e))?{r:parseIntFromHex(t[1]+""+t[1]),g:parseIntFromHex(t[2]+""+t[2]),b:parseIntFromHex(t[3]+""+t[3]),a:convertHexToDecimal(t[4]+""+t[4]),format:r?"name":"hex8"}:!!(t=matchers.hex3.exec(e))&&{r:parseIntFromHex(t[1]+""+t[1]),g:parseIntFromHex(t[2]+""+t[2]),b:parseIntFromHex(t[3]+""+t[3]),format:r?"name":"hex"}}function validateWCAG2Parms(e){var t;return{level:t="AA"!==(t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==t?"AA":t,size:t="small"!==(t=(e.size||"small").toLowerCase())&&"large"!==t?"small":t}}function useScreen(t,r,i){var e;return reactExports.useEffect(()=>{var e;t.matting&&r&&(r.enabled=t.matting.enabled,r.filterType=t.matting.filterType,r.gridSize=t.matting.gridSize,r.lightLevel=t.matting.lightLevel,r.emergence=t.matting.emergence,r.scale=i,e=tinycolor(t.matting.color).toRgb(),r.color=[e.r/255,e.g/255,e.b/255])},[t.matting,null==(e=t.matting)?void 0:e.enabled,null==(e=t.matting)?void 0:e.filterType,null==(e=t.matting)?void 0:e.gridSize,null==(e=t.matting)?void 0:e.lightLevel,null==(e=t.matting)?void 0:e.color,null==(e=t.matting)?void 0:e.emergence,i]),[r]}function useMask(a,r,s,e){let t,i,n,o,l,u,c,h,d,p=reactExports.useRef(),f=reactExports.useRef(),m=reactExports.useRef(),g=reactExports.useRef(),v=reactExports.useRef(),[y,_]=reactExports.useMemo(()=>{if(a.mask){var e,t;f.current||((e=document.createElement("canvas")).width=a.style.width,e.height=a.style.height,t=(f.current=e).getContext("2d"),(m.current=t).fillStyle="#0000ff",t.fillRect(0,0,e.width,e.height),t=Sprite.from(f.current),(v.current=t).width=a.style.width,t.height=a.style.height,t.anchor.set(.5),t.position.x=t.width/2,t.position.y=t.height/2,t.name="mask",r.addChild(t)),"export"===s.env&&(s.elementReadyMark[a.id+"_mask"]="start");let n=r=>new Promise(e=>{let t=new Image;t.src=r,t.onload=function(){g.current=t,"export"===s.env&&(s.elementReadyMark[a.id+"_mask"]="success"),e(null)}});return[v.current,async()=>{if(!g.current){var e=s.resourceManage.getResouceById(a.mask.resourceId);if(!e)return void(s.elementReadyMark[a.id+"_mask"]="success");await n(e.url)}var t,r,e=f.current,i=m.current;i.fillStyle="#0000ff",i.fillRect(0,0,e.width,e.height),a.mask&&(i.filter=`blur(${a.mask.blur||0}px)`,void 0===a.mask.alpha&&(a.mask.alpha=1),i.globalAlpha=a.mask.alpha,(e={width:a.mask.width,height:a.mask.height}).x=a.mask.x-e.width/2,e.y=a.mask.y-e.height/2,t=e.x+a.mask.width/2,r=e.y+a.mask.height/2,i.translate(t,r),i.rotate(a.mask.rotation||0),i.drawImage(g.current,e.x-t,e.y-r,e.width,e.height),i.rotate(-(a.mask.rotation||0)),i.translate(-t,-r),v.current)&&v.current.texture&&null!=(e=v.current.texture.baseTexture)&&e.update()},n]}return f.current&&(f.current.width=0,f.current.height=0,f.current.remove(),f.current=void 0),[null,null,null]},[null==(t=a.mask)?void 0:t.resourceId]);reactExports.useEffect(()=>{_&&(g.current="",_())},[null==(i=a.mask)?void 0:i.resourceId]),reactExports.useEffect(()=>{var e,t;f.current&&_&&(e=p.current,a.mask&&e&&(t=a.style.width/e.elementWidth,a.mask.width=t*e.width,a.mask.height=t*e.height,a.mask.x=t*e.x,a.mask.y=t*e.y,a.mask.rotation=e.rotation||0),_())},[a.style.width,a.style.height]),reactExports.useEffect(()=>{a.mask&&_&&_()},[null==(n=a.mask)?void 0:n.x,null==(o=a.mask)?void 0:o.y,null==(l=a.mask)?void 0:l.width,null==(u=a.mask)?void 0:u.height,null==(c=a.mask)?void 0:c.rotation,null==(h=a.mask)?void 0:h.alpha,null==(d=a.mask)?void 0:d.blur]),reactExports.useEffect(()=>(pubsub.subscribe(s.events.CONTROL_CHANGE_START+"."+a.id,()=>{p.current={...a.mask||{},elementWidth:a.style.width}}),pubsub.subscribe(s.events.CONTROL_CHANGE_END+"."+a.id,()=>{p.current=null}),()=>{s.controlModeType="editElement",pubsub.unsubscribe(s.events.CONTROL_CHANGE_START+"."+a.id),pubsub.unsubscribe(s.events.CONTROL_CHANGE_END+"."+a.id),f.current&&(f.current.width=0,f.current.height=0,f.current.remove())}),[]),reactExports.useEffect(()=>{var e=r.children.find(e=>"element"===e.name);return a.mask&&y?e.mask=y:e.mask=null,()=>{y&&!y.destroyed&&y.destroy()}},[y])}function SpriteElement(t){var{visible:e,env:r,trackIndex:i}=t;let f=t.element;var n=reactExports.useRef();let m=t.store,[a,s]=reactExports.useState("1"),o=reactExports.useRef(),[l,u]=reactExports.useState(1),c=reactExports.useMemo(()=>{var e,t=new Container,r=m.resourceManage.getCacheBlobURLById(f.resourceId),r=Texture.from(r),i=new Sprite(r.clone()),n=(r.on("update",()=>{u(+new Date)}),m.resourceManage.getResouceById(f.resourceId));return o.current=new ScreenFilter({videowidth:null==(e=null==n?void 0:n.styleSize)?void 0:e.width,videoheight:null==(e=null==n?void 0:n.styleSize)?void 0:e.height,texture:r}),o.current.id="ScreenFilter",o.current.enabled=f.matting&&f.matting.enabled,i.filters=[o.current],i.name="element",t.addChild(i),t},[f.resourceId,i]),[h]=(useMask(f,c,t.store,t.scale),useScreen(f,o.current,t.scale),reactExports.useEffect(()=>{var e=m.resourceManage.getTempData(f.id+"_gif");e&&null!==t.relativeTime&&e.drawFrame(Math.round(+t.relativeTime/e.delayFrame)%e.totalFrame)},[t.relativeTime]),reactExports.useEffect(()=>{if(f.isGif){if(!m.resourceManage.getTempData(f.id+"_gif")&&f.isGif){let d=m.resourceManage.getCacheBlobURLById(f.resourceId),p=c.children.find(e=>"element"===e.name);var e=m.resourceManage.getTempData(d+"_gifparse");let t=s=>{if(s){m.resourceManage.setTempData(d+"_gifparse",s);let t=document.createElement("canvas"),r=t.getContext("2d",{willReadFrequently:!0}),i=document.createElement("canvas");var o=i.getContext("2d");o.clearRect(0,0,s.width,s.height),t.width=s.width,t.height=s.height;let n=Texture.from(t);p.texture=n;let a=[];for(let e=0;e<s.gifArr.length;e++){var l=s.gifArr[e];if(!l)return;var{disposalType:u=2,patch:c}=l,l=l.dims,h=(i.width=l.width,i.height=l.height,o.clearRect(0,0,l.width,l.height),o.createImageData(l.width,l.height)),c=(h.data.set(c),o.putImageData(h,0,0),r.drawImage(i,l.left,l.top),r.getImageData(0,0,t.width,t.height));2!==u&&3!==u||r.clearRect(0,0,t.width,t.height),a.push(c)}var e=e=>{e=a[e];e&&(r.putImageData(e,0,0),n.update())};e(0),m.resourceManage.setTempData(f.id+"_gif",{totalFrame:s.totalFrame,delayFrame:s.delayFrame,width:s.width,height:s.height,drawFrame:e,destroy:()=>{t.width=t.height=0,i.width=i.height=0}})}};e?t(e):gif2frames(d,"buffer").then(e=>t(e))}return()=>m.resourceManage.removeTempData(f.id+"_gif")}},[]),useElementFilter(c,f),reactExports.useEffect(()=>{void 0!==f.blendMode&&(c.children.find(e=>"element"===e.name).blendMode=f.blendMode)},[f.blendMode]),void 0===f.scale&&(f.scale=1),useSyncPixiElement(c,{style:{...f.style},parent:t.parent,animateRef:n,visible:e,hide:t.hide,lock:t.lock,relativeTime:t.relativeTime,store:t.store},["x","y","width","height","alpha","rotation"],f));var d=t.transitionElement;let p=reactExports.useCallback(debounce$1(()=>{s(createID())},300),[]);var{x:g,y:v,width:y,height:_}=f.style;return reactExports.useEffect(()=>{t.hasTransition&&p()},[g,v,y,_]),reactExports.useEffect(()=>{var e,t,r,i,n=m.resourceManage.getResouceById(f.resourceId);f.resourceId&&n&&f.cropSize&&((n=c.children.find(e=>"element"===e.name)).texture.width+"_"+n.texture.height!="1_1"&&({x:e,y:t,width:r,height:i}=f.cropSize,n.texture.frame=new Rectangle(e,t,r,i)),h({...f.style},c))},[f.cropSize,f.resourceId,l]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["editor"===r&&jsxRuntimeExports.jsx(ControlElment,{hide:t.hide,lock:t.lock,trackIndex:i,scale:t.scale,store:t.store,element:f,visible:e}),t.hasTransition&&jsxRuntimeExports.jsx(TransitionElement,{currentTime:t.currentTime,relativeTime:t.relativeTime,trackIndex:i,transitionElement:d,nextElement:t.nextElement,element:f,dirty:d._dirty,store:t.store,env:t.env},a+d._dirty),jsxRuntimeExports.jsx(Animate$1,{ref:n,store:t.store,pixiElem:c,elementData:f,currentTime:t.currentTime,relativeTime:t.relativeTime})]})})}var e$5=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o$a=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float gamma;
uniform float contrast;
uniform float saturation;
uniform float brightness;
uniform float red;
uniform float green;
uniform float blue;
uniform float alpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (c.a > 0.0) {
        c.rgb /= c.a;

        vec3 rgb = pow(c.rgb, vec3(1. / gamma));
        rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
        rgb.r *= red;
        rgb.g *= green;
        rgb.b *= blue;
        c.rgb = rgb * brightness;

        c.rgb *= c.a;
    }

    gl_FragColor = c * alpha;
}
`;let s$6=class s2 extends Filter{constructor(e){super(e$5,o$a),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,e)}apply(e,t,r,i){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,r,i)}};var c$9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,v$2=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,y$1=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;let _$1=class _2 extends Filter{constructor(e=4,t=3,r=!1){super(c$9,r?y$1:v$2),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new Point,this.pixelSize=1,this._clamp=r,Array.isArray(e)?this.kernels=e:(this._blur=e,this.quality=t)}apply(n,e,a,s){var o=this._pixelSize.x/e._frame.width,l=this._pixelSize.y/e._frame.height;let u;if(1===this._quality||0===this._blur)u=this._kernels[0]+.5,this.uniforms.uOffset[0]=u*o,this.uniforms.uOffset[1]=u*l,n.applyFilter(this,e,a,s);else{var c=n.getFilterTexture();let t=e,r=c,i;var h=this._quality-1;for(let e=0;e<h;e++)u=this._kernels[e]+.5,this.uniforms.uOffset[0]=u*o,this.uniforms.uOffset[1]=u*l,n.applyFilter(this,t,r,1),i=t,t=r,r=i;u=this._kernels[h]+.5,this.uniforms.uOffset[0]=u*o,this.uniforms.uOffset[1]=u*l,n.applyFilter(this,t,a,s),n.returnFilterTexture(c)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,t)=>e+t+.5,0))}_generateKernels(){var e=this._blur,r=this._quality,i=[e];if(0<e){let t=e;var n=e/r;for(let e=1;e<r;e++)t-=n,i.push(t)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&0<e.length?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof Point?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get blur(){return this._blur}set blur(e){this._blur=e,this._generateKernels()}};var a$a=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,m$4=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`;let x$3=class x2 extends Filter{constructor(e=.5){super(a$a,m$4),this.threshold=e}get threshold(){return this.uniforms.threshold}set threshold(e){this.uniforms.threshold=e}};var g$2=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;let c$8=class c6 extends Filter{constructor(e){super(a$a,g$2),this.bloomScale=1,this.brightness=1,this._resolution=settings.FILTER_RESOLUTION,"number"==typeof e&&(e={threshold:e});var e=Object.assign(c$8.defaults,e),{kernels:t,blur:r,quality:i,pixelSize:n,resolution:a}=(this.bloomScale=e.bloomScale,this.brightness=e.brightness,e);this._extractFilter=new x$3(e.threshold),this._extractFilter.resolution=a,this._blurFilter=t?new _$1(t):new _$1(r,i),this.pixelSize=n,this.resolution=a}apply(e,t,r,i,n){var a=e.getFilterTexture(),n=(this._extractFilter.apply(e,t,a,1,n),e.getFilterTexture());this._blurFilter.apply(e,a,n,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=n,e.applyFilter(this,t,r,i),e.returnFilterTexture(n),e.returnFilterTexture(a)}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._extractFilter&&(this._extractFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get threshold(){return this._extractFilter.threshold}set threshold(e){this._extractFilter.threshold=e}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}},b$2=c$8;b$2.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:settings.FILTER_RESOLUTION};var o$9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,r$6=`varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform float pixelSize;
uniform sampler2D uSampler;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
    return floor(coord / size) * size;
}

vec2 getMod(vec2 coord, vec2 size)
{
    return mod(coord, size) / size;
}

float character(float n, vec2 p)
{
    p = floor(p*vec2(4.0, 4.0) + 2.5);

    if (clamp(p.x, 0.0, 4.0) == p.x)
    {
        if (clamp(p.y, 0.0, 4.0) == p.y)
        {
            if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;
        }
    }
    return 0.0;
}

void main()
{
    vec2 coord = mapCoord(vTextureCoord);

    // get the grid position
    vec2 pixCoord = pixelate(coord, vec2(pixelSize));
    pixCoord = unmapCoord(pixCoord);

    // sample the color at grid position
    vec4 color = texture2D(uSampler, pixCoord);

    // brightness of the color as it's perceived by the human eye
    float gray = 0.3 * color.r + 0.59 * color.g + 0.11 * color.b;

    // determine the character to use
    float n =  65536.0;             // .
    if (gray > 0.2) n = 65600.0;    // :
    if (gray > 0.3) n = 332772.0;   // *
    if (gray > 0.4) n = 15255086.0; // o
    if (gray > 0.5) n = 23385164.0; // &
    if (gray > 0.6) n = 15252014.0; // 8
    if (gray > 0.7) n = 13199452.0; // @
    if (gray > 0.8) n = 11512810.0; // #

    // get the mod..
    vec2 modd = getMod(coord, vec2(pixelSize));

    gl_FragColor = color * character( n, vec2(-1.0) + modd * 2.0);

}
`;let i$c=class i2 extends Filter{constructor(e=8){super(o$9,r$6),this.size=e}get size(){return this.uniforms.pixelSize}set size(e){this.uniforms.pixelSize=e}};var n$9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,e$4=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform float transformX;
uniform float transformY;
uniform vec3 lightColor;
uniform float lightAlpha;
uniform vec3 shadowColor;
uniform float shadowAlpha;

void main(void) {
    vec2 transform = vec2(1.0 / filterArea) * vec2(transformX, transformY);
    vec4 color = texture2D(uSampler, vTextureCoord);
    float light = texture2D(uSampler, vTextureCoord - transform).a;
    float shadow = texture2D(uSampler, vTextureCoord + transform).a;

    color.rgb = mix(color.rgb, lightColor, clamp((color.a - light) * lightAlpha, 0.0, 1.0));
    color.rgb = mix(color.rgb, shadowColor, clamp((color.a - shadow) * shadowAlpha, 0.0, 1.0));
    gl_FragColor = vec4(color.rgb * color.a, color.a);
}
`;let s$5=class s3 extends Filter{constructor(e){super(n$9,e$4),this._thickness=2,this._angle=0,this.uniforms.lightColor=new Float32Array(3),this.uniforms.shadowColor=new Float32Array(3),Object.assign(this,{rotation:45,thickness:2,lightColor:16777215,lightAlpha:.7,shadowColor:0,shadowAlpha:.7},e),this.padding=1}_updateTransform(){this.uniforms.transformX=this._thickness*Math.cos(this._angle),this.uniforms.transformY=this._thickness*Math.sin(this._angle)}get rotation(){return this._angle/DEG_TO_RAD}set rotation(e){this._angle=e*DEG_TO_RAD,this._updateTransform()}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this._updateTransform()}get lightColor(){return rgb2hex(this.uniforms.lightColor)}set lightColor(e){hex2rgb(e,this.uniforms.lightColor)}get lightAlpha(){return this.uniforms.lightAlpha}set lightAlpha(e){this.uniforms.lightAlpha=e}get shadowColor(){return rgb2hex(this.uniforms.shadowColor)}set shadowColor(e){hex2rgb(e,this.uniforms.shadowColor)}get shadowAlpha(){return this.uniforms.shadowAlpha}set shadowAlpha(e){this.uniforms.shadowAlpha=e}},p$2=class p2 extends Filter{constructor(e=2,t=4,r=settings.FILTER_RESOLUTION,i=5){super();let n,a;"number"==typeof e?(n=e,a=e):e instanceof Point?(n=e.x,a=e.y):Array.isArray(e)&&(n=e[0],a=e[1]),this.blurXFilter=new BlurFilterPass(!0,n,t,r,i),this.blurYFilter=new BlurFilterPass(!1,a,t,r,i),this.blurYFilter.blendMode=BLEND_MODES.SCREEN,this.defaultFilter=new AlphaFilter}apply(e,t,r,i){var n=e.getFilterTexture();this.defaultFilter.apply(e,t,r,i),this.blurXFilter.apply(e,t,n,1),this.blurYFilter.apply(e,n,r,0),e.returnFilterTexture(n)}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e}};var d$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,u$7=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;let n$8=class n2 extends Filter{constructor(e){super(d$3,u$7),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,n$8.defaults,e)}apply(e,t,r,i){var{width:n,height:a}=t.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=a,e.applyFilter(this,t,r,i)}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}get strength(){return this.uniforms.strength}set strength(e){this.uniforms.strength=e}get center(){return this.uniforms.center}set center(e){this.uniforms.center=e}},t$5=n$8;t$5.defaults={center:[.5,.5],radius:100,strength:1};var Q=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;
uniform bool uReplace;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    if (uReplace == false) {
        // mix resulting color with current color
        gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
    } else {
        // replace with gradient color
        gl_FragColor = gradientColor;
    }
}
`,W=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,v$1=v$1||{},v$1=(v$1.stringify=(()=>{var n={"visit_linear-gradient":function(e){return n.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return n.visit_gradient(e)},"visit_radial-gradient":function(e){return n.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return n.visit_gradient(e)},visit_gradient:function(e){var t=n.visit(e.orientation);return t&&(t+=", "),e.type+"("+t+n.visit(e.colorStops)+")"},visit_shape:function(e){var t=e.value,r=n.visit(e.at),e=n.visit(e.style);return e&&(t+=" "+e),r&&(t+=" at "+r),t},"visit_default-radial":function(e){var t="",e=n.visit(e.at);return e&&(t+=e),t},"visit_extent-keyword":function(e){var t=e.value,e=n.visit(e.at);return e&&(t+=" at "+e),t},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return n.visit(e.value.x)+" "+n.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return n.visit_color(e.value,e)},visit_hex:function(e){return n.visit_color("#"+e.value,e)},visit_rgb:function(e){return n.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return n.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,t){t=n.visit(t.length);return t&&(e+=" "+t),e},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var r="",i=e.length;return e.forEach(function(e,t){r+=n.visit(e),t<i-1&&(r+=", ")}),r},visit:function(e){if(!e)return"";if(e instanceof Array)return n.visit_array(e,"");if(e.type){var t=n["visit_"+e.type];if(t)return t(e);throw Error("Missing visitor visit_"+e.type)}throw Error("Invalid node.")}};return function(e){return n.visit(e)}})(),v$1||{}),ee=(v$1.parse=(()=>{var n={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},i="";function a(e){e=new Error(i+": "+e);throw e.source=i,e}function t(){var e=p(r);return 0<i.length&&a("Invalid input not EOF"),e}function r(){return e("linear-gradient",n.linearGradient,o)||e("repeating-linear-gradient",n.repeatingLinearGradient,o)||e("radial-gradient",n.radialGradient,l)||e("repeating-radial-gradient",n.repeatingRadialGradient,l)}function e(r,e,i){return s(e,function(e){var t=i();return!t||_(n.comma)||a("Missing comma before color stops"),{type:r,orientation:t,colorStops:p(f)}})}function s(e,t){e=_(e);if(e)return _(n.startCall)||a("Missing ("),t=t(e),_(n.endCall)||a("Missing )"),t}function o(){return y("directional",n.sideOrCorner,1)||y("angular",n.angleValue,1)}function l(){var e,t,r=u();return r&&((e=[]).push(r),t=i,_(n.comma))&&((r=u())?e.push(r):i=t),e}function u(){(t=y("shape",/^(circle)/i,0))&&(t.style=v()||c());var e,t=t||((t=y("shape",/^(ellipse)/i,0))&&(t.style=g()||c()),t);return t?t.at=h():(e=c())?(t=e,(e=h())&&(t.at=e)):(e=d())&&(t={type:"default-radial",at:e}),t}function c(){return y("extent-keyword",n.extentKeywords,1)}function h(){var e;if(y("position",/^at/,0))return(e=d())||a("Missing positioning value"),e}function d(){var e={x:g(),y:g()};if(e.x||e.y)return{type:"position",value:e}}function p(e){var t=e(),r=[];if(t)for(r.push(t);_(n.comma);)(t=e())?r.push(t):a("One extra comma");return r}function f(){var e=y("hex",n.hexColor,1)||s(n.rgbaColor,function(){return{type:"rgba",value:p(m)}})||s(n.rgbColor,function(){return{type:"rgb",value:p(m)}})||y("literal",n.literalColor,0);return e||a("Expected color definition"),e.length=g(),e}function m(){return _(n.number)[1]}function g(){return y("%",n.percentageValue,1)||function(){return y("position-keyword",n.positionKeywords,1)}()||v()}function v(){return y("px",n.pixelValue,1)||y("em",n.emValue,1)}function y(e,t,r){t=_(t);if(t)return{type:e,value:t[r]}}function _(e){var t=/^[\n\r\t\s]+/.exec(i);return t&&b(t[0].length),(t=e.exec(i))&&b(t[0].length),t}function b(e){i=i.substr(e)}return function(e){return i=e.toString(),t()}})(),v$1.parse),j={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},G={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function te(e){var t,r,i,n,a,s,o=[],l=1;return"string"==typeof e?j[e]?(o=j[e].slice(),a="rgb"):"transparent"===e?(a="rgb",o=[l=0,0,0]):/^#[A-Fa-f0-9]+$/.test(e)?(n=e.slice(1),l=1,(s=n.length)<=4?(o=[parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16)],4===s&&(l=parseInt(n[3]+n[3],16)/255)):(o=[parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16)],8===s&&(l=parseInt(n[6]+n[7],16)/255)),o[0]||(o[0]=0),o[1]||(o[1]=0),o[2]||(o[2]=0),a="rgb"):(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e))?(i="rgb"===(r=t[1]),a=n=r.replace(/a$/,""),s="cmyk"===n?4:"gray"===n?1:3,o=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(e,t){if(/%$/.test(e))return t===s?parseFloat(e)/100:"rgb"===n?255*parseFloat(e)/100:parseFloat(e);if("h"===n[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==G[e])return G[e]}return parseFloat(e)}),r===n&&o.push(1),l=i||void 0===o[s]?1:o[s],o=o.slice(0,s)):10<e.length&&/[0-9](?:\s|\/)/.test(e)&&(o=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),a=e.match(/([a-z])/gi).join("").toLowerCase()):isNaN(e)?Array.isArray(e)||e.length?(o=[e[0],e[1],e[2]],a="rgb",l=4===e.length?e[3]:1):e instanceof Object&&(o=null!=e.r||null!=e.red||null!=e.R?(a="rgb",[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(a="hsl",[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),l=e.a||e.alpha||e.opacity||1,null!=e.opacity)&&(l/=100):(a="rgb",o=[e>>>16,(65280&e)>>>8,255&e]),{space:a,values:o,alpha:l}}var S={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},k={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t,r,i=e[0]/360,n=e[1]/100,e=e[2]/100;if(0==n)return[r=255*e,r,r];for(var a,s=2*e-(a=e<.5?e*(1+n):e+n-e*n),o=[0,0,0],l=0;l<3;l++)(t=i+1/3*-(l-1))<0?t++:1<t&&t--,o[l]=255*(r=6*t<1?s+6*(a-s)*t:2*t<1?a:3*t<2?s+(a-s)*(2/3-t)*6:s);return o}};function re(e){var t,r,i,e=te(e=Array.isArray(e)&&e.raw?String.raw(...arguments):e);return e.space?(t=("h"===e.space[0]?k:S).min,r=("h"===e.space[0]?k:S).max,(i=Array(3))[0]=Math.min(Math.max(e.values[0],t[0]),r[0]),i[1]=Math.min(Math.max(e.values[1],t[1]),r[1]),i[2]=Math.min(Math.max(e.values[2],t[2]),r[2]),(i="h"===e.space[0]?k.rgb(i):i).push(Math.min(Math.max(e.alpha,0),1)),i):[]}function L(e){switch(typeof e){case"string":return ne(e);case"number":return hex2rgb(e);default:return e}}function ne(e){var t=re(e);if(t)return[t[0]/255,t[1]/255,t[2]/255,t[3]];throw new Error(`Unable to parse color "${e}" as RGBA.`)}function ie(e){e=ee(ge(e));if(0===e.length)throw new Error("Invalid CSS gradient.");if(1!==e.length)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");e=e[0];return{type:oe(e.type),stops:ae(e.colorStops),angle:ce(e.orientation)}}function oe(e){var t={"linear-gradient":0,"radial-gradient":1};if(e in t)return t[e];throw new Error(`Unsupported gradient type "${e}"`)}function ae(t){var r=ue(t),i=[];for(let e=0;e<t.length;e++){var n=le(t[e]);i.push({offset:r[e],color:n.slice(0,3),alpha:n[3]})}return i}function le(e){return L(se(e))}function se(e){switch(e.type){case"hex":return"#"+e.value;case"literal":return e.value;default:return`${e.type}(${e.value.join(",")})`}}function ue(r){let i=[];for(let t=0;t<r.length;t++){var n=r[t];let e=-1;"literal"===n.type&&n.length&&"type"in n.length&&"%"===n.length.type&&"value"in n.length&&(e=parseFloat(n.length.value)/100),i.push(e)}let a=0;for(let t=0;t<i.length;t++){var e=i[t];if(-1!==e)a=e;else if(0===t)i[t]=0;else if(t+1===i.length)i[t]=1;else{var s=(t=>{for(let e=t;e<i.length;e++)if(-1!==i[e])return{indexDelta:e-t,offset:i[e]};return{indexDelta:i.length-1-t,offset:1}})(t),o=(s.offset-a)/(1+s.indexDelta);for(let e=0;e<=s.indexDelta;e++)i[t+e]=a+(e+1)*o;t+=s.indexDelta,a=i[t]}}return i.map(fe)}function fe(e){return 6<e.toString().length?parseFloat(e.toString().substring(0,6)):e}function ce(e){if(void 0!==e&&"type"in e&&"value"in e)switch(e.type){case"angular":return parseFloat(e.value);case"directional":return pe(e.value)}return 0}function pe(e){var t={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(e in t)return t[e];throw new Error(`Unsupported directional value "${e}"`)}function ge(e){let t=e.replace(/\s{2,}/gu," ");return(t=(t=(t=(t=t.replace(/;/g,"")).replace(/ ,/g,",")).replace(/\( /g,"(")).replace(/ \)/g,")")).trim()}S.hsl=function(e){var t,r=e[0]/255,i=e[1]/255,e=e[2]/255,n=Math.min(r,i,e),a=Math.max(r,i,e),s=a-n;return a===n?t=0:r===a?t=(i-e)/s:i===a?t=2+(e-r)/s:e===a&&(t=4+(r-i)/s),(t=Math.min(60*t,360))<0&&(t+=360),e=(n+a)/2,[t,100*(a===n?0:e<=.5?s/(a+n):s/(2-a-n)),100*e]};var he=Object.defineProperty,me=Object.defineProperties,de=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,z$1=(e,t,r)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P$1=(e,t)=>{for(var r in t=t||{})ve.call(t,r)&&z$1(e,r,t[r]);if(N)for(var r of N(t))ye.call(t,r)&&z$1(e,r,t[r]);return e},be=(e,t)=>me(e,de(t));let D=90;function Ce(e){return[...e].sort((e,t)=>e.offset-t.offset)}let y=class extends Filter{constructor(e){let t,r,i;if(!(i=e&&"css"in e?be(P$1({},ie(e.css||"")),{alpha:null!=(t=e.alpha)?t:y.defaults.alpha,maxColors:null!=(r=e.maxColors)?r:y.defaults.maxColors}):P$1(P$1({},y.defaults),e)).stops||i.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super(W,Q),this._stops=[],this.autoFit=!1,Object.assign(this,i)}get stops(){return this._stops}set stops(e){var t=Ce(e),r=new Float32Array(3*t.length);for(let e=0;e<t.length;e++){var i=L(t[e].color),n=3*e;r[0+n]=i[0],r[1+n]=i[1],r[2+n]=i[2]}this.uniforms.uColors=r,this.uniforms.uOffsets=t.map(e=>e.offset),this.uniforms.uAlphas=t.map(e=>e.alpha),this.uniforms.uNumStops=t.length,this._stops=t}set type(e){this.uniforms.uType=e}get type(){return this.uniforms.uType}set angle(e){this.uniforms.uAngle=e-D}get angle(){return this.uniforms.uAngle+D}set alpha(e){this.uniforms.uAlpha=e}get alpha(){return this.uniforms.uAlpha}set maxColors(e){this.uniforms.uMaxColors=e}get maxColors(){return this.uniforms.uMaxColors}set replace(e){this.uniforms.uReplace=e}get replace(){return this.uniforms.uReplace}},b$1=y;b$1.LINEAR=0,b$1.RADIAL=1,b$1.CONIC=2,b$1.defaults={type:y.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0,replace:!1};var a$9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,c$7=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D colorMap;
uniform float _mix;
uniform float _size;
uniform float _sliceSize;
uniform float _slicePixelSize;
uniform float _sliceInnerSize;
void main() {
    vec4 color = texture2D(uSampler, vTextureCoord.xy);

    vec4 adjusted;
    if (color.a > 0.0) {
        color.rgb /= color.a;
        float innerWidth = _size - 1.0;
        float zSlice0 = min(floor(color.b * innerWidth), innerWidth);
        float zSlice1 = min(zSlice0 + 1.0, innerWidth);
        float xOffset = _slicePixelSize * 0.5 + color.r * _sliceInnerSize;
        float s0 = xOffset + (zSlice0 * _sliceSize);
        float s1 = xOffset + (zSlice1 * _sliceSize);
        float yOffset = _sliceSize * 0.5 + color.g * (1.0 - _sliceSize);
        vec4 slice0Color = texture2D(colorMap, vec2(s0,yOffset));
        vec4 slice1Color = texture2D(colorMap, vec2(s1,yOffset));
        float zOffset = fract(color.b * innerWidth);
        adjusted = mix(slice0Color, slice1Color, zOffset);

        color.rgb *= color.a;
    }
    gl_FragColor = vec4(mix(color, adjusted, _mix).rgb, color.a);

}`;let u$6=class u2 extends Filter{constructor(e,t=!1,r=1){super(a$9,c$7),this.mix=1,this._size=0,this._sliceSize=0,this._slicePixelSize=0,this._sliceInnerSize=0,this._nearest=!1,this._scaleMode=null,this._colorMap=null,this._scaleMode=null,this.nearest=t,this.mix=r,this.colorMap=e}apply(e,t,r,i){this.uniforms._mix=this.mix,e.applyFilter(this,t,r,i)}get colorSize(){return this._size}get colorMap(){return this._colorMap}set colorMap(e){e&&(null!=(e=e instanceof Texture?e:Texture.from(e))&&e.baseTexture&&(e.baseTexture.scaleMode=this._scaleMode,e.baseTexture.mipmap=MIPMAP_MODES.OFF,this._size=e.height,this._sliceSize=1/this._size,this._slicePixelSize=this._sliceSize/this._size,this._sliceInnerSize=this._slicePixelSize*(this._size-1),this.uniforms._size=this._size,this.uniforms._sliceSize=this._sliceSize,this.uniforms._slicePixelSize=this._slicePixelSize,this.uniforms._sliceInnerSize=this._sliceInnerSize,this.uniforms.colorMap=e),this._colorMap=e)}get nearest(){return this._nearest}set nearest(e){this._nearest=e,this._scaleMode=e?SCALE_MODES.NEAREST:SCALE_MODES.LINEAR;e=this._colorMap;e&&e.baseTexture&&(e.baseTexture._glTextures={},e.baseTexture.scaleMode=this._scaleMode,e.baseTexture.mipmap=MIPMAP_MODES.OFF,e._updateID++,e.baseTexture.emit("update",e.baseTexture))}updateColorMap(){var e=this._colorMap;e&&e.baseTexture&&(e._updateID++,e.baseTexture.emit("update",e.baseTexture),this.colorMap=e)}destroy(e=!1){this._colorMap&&this._colorMap.destroy(e),super.destroy()}};var n$7=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,a$8=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 color;
uniform float alpha;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    gl_FragColor = vec4(mix(currentColor.rgb, color.rgb, currentColor.a * alpha), currentColor.a);
}
`;let i$b=class i3 extends Filter{constructor(e=0,t=1){super(n$7,a$8),this._color=0,this._alpha=1,this.uniforms.color=new Float32Array(3),this.color=e,this.alpha=t}set color(e){var t=this.uniforms.color;"number"==typeof e?(hex2rgb(e,t),this._color=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._color=rgb2hex(t))}get color(){return this._color}set alpha(e){this.uniforms.alpha=e,this._alpha=e}get alpha(){return this._alpha}};var t$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,l$7=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 originalColor;
uniform vec3 newColor;
uniform float epsilon;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorDiff = originalColor - (currentColor.rgb / max(currentColor.a, 0.0000000001));
    float colorDistance = length(colorDiff);
    float doReplace = step(colorDistance, epsilon);
    gl_FragColor = vec4(mix(currentColor.rgb, (newColor + colorDiff) * currentColor.a, doReplace), currentColor.a);
}
`;let s$4=class s4 extends Filter{constructor(e=16711680,t=0,r=.4){super(t$4,l$7),this._originalColor=16711680,this._newColor=0,this.uniforms.originalColor=new Float32Array(3),this.uniforms.newColor=new Float32Array(3),this.originalColor=e,this.newColor=t,this.epsilon=r}set originalColor(e){var t=this.uniforms.originalColor;"number"==typeof e?(hex2rgb(e,t),this._originalColor=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._originalColor=rgb2hex(t))}get originalColor(){return this._originalColor}set newColor(e){var t=this.uniforms.newColor;"number"==typeof e?(hex2rgb(e,t),this._newColor=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._newColor=rgb2hex(t))}get newColor(){return this._newColor}set epsilon(e){this.uniforms.epsilon=e}get epsilon(){return this.uniforms.epsilon}};var o$8=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,x$2=`precision mediump float;

varying mediump vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec2 texelSize;
uniform float matrix[9];

void main(void)
{
   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left
   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center
   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right

   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left
   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center
   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right

   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left
   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center
   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right

   gl_FragColor =
       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +
       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +
       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];

   gl_FragColor.a = c22.a;
}
`;let n$6=class n3 extends Filter{constructor(e,t=200,r=200){super(o$8,x$2),this.uniforms.texelSize=new Float32Array(2),this.uniforms.matrix=new Float32Array(9),void 0!==e&&(this.matrix=e),this.width=t,this.height=r}get matrix(){return this.uniforms.matrix}set matrix(e){e.forEach((e,t)=>{this.uniforms.matrix[t]=e})}get width(){return 1/this.uniforms.texelSize[0]}set width(e){this.uniforms.texelSize[0]=1/e}get height(){return 1/this.uniforms.texelSize[1]}set height(e){this.uniforms.texelSize[1]=1/e}};var r$5=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o$7=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void)
{
    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);

    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);

    if (lum < 1.00)
    {
        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }

    if (lum < 0.75)
    {
        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }

    if (lum < 0.50)
    {
        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }

    if (lum < 0.3)
    {
        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)
        {
            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
        }
    }
}
`;let e$3=class e2 extends Filter{constructor(){super(r$5,o$7)}};var a$7=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,g$1=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;let e$2=class e3 extends Filter{constructor(e){super(a$7,g$1),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,e$2.defaults,e)}apply(e,t,r,i){var{width:n,height:a}=t.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=a,this.uniforms.seed=this.seed,this.uniforms.time=this.time,e.applyFilter(this,t,r,i)}set curvature(e){this.uniforms.curvature=e}get curvature(){return this.uniforms.curvature}set lineWidth(e){this.uniforms.lineWidth=e}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(e){this.uniforms.lineContrast=e}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(e){this.uniforms.verticalLine=e}get verticalLine(){return this.uniforms.verticalLine}set noise(e){this.uniforms.noise=e}get noise(){return this.uniforms.noise}set noiseSize(e){this.uniforms.noiseSize=e}get noiseSize(){return this.uniforms.noiseSize}set vignetting(e){this.uniforms.vignetting=e}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(e){this.uniforms.vignettingAlpha=e}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(e){this.uniforms.vignettingBlur=e}get vignettingBlur(){return this.uniforms.vignettingBlur}},t$3=e$2;t$3.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var t$2=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,a$6=`precision mediump float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform vec4 filterArea;
uniform sampler2D uSampler;

uniform float angle;
uniform float scale;
uniform bool grayscale;

float pattern()
{
   float s = sin(angle), c = cos(angle);
   vec2 tex = vTextureCoord * filterArea.xy;
   vec2 point = vec2(
       c * tex.x - s * tex.y,
       s * tex.x + c * tex.y
   ) * scale;
   return (sin(point.x) * sin(point.y)) * 4.0;
}

void main()
{
   vec4 color = texture2D(uSampler, vTextureCoord);
   vec3 colorRGB = vec3(color);

   if (grayscale)
   {
       colorRGB = vec3(color.r + color.g + color.b) / 3.0;
   }

   gl_FragColor = vec4(colorRGB * 10.0 - 5.0 + pattern(), color.a);
}
`;let i$a=class i4 extends Filter{constructor(e=1,t=5,r=!0){super(t$2,a$6),this.scale=e,this.angle=t,this.grayscale=r}get scale(){return this.uniforms.scale}set scale(e){this.uniforms.scale=e}get angle(){return this.uniforms.angle}set angle(e){this.uniforms.angle=e}get grayscale(){return this.uniforms.grayscale}set grayscale(e){this.uniforms.grayscale=e}};var w=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,O=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,P=Object.defineProperty,c$6=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,_=(e,t,r)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b=(e,t)=>{for(var r in t=t||{})T.call(t,r)&&_(e,r,t[r]);if(c$6)for(var r of c$6(t))z.call(t,r)&&_(e,r,t[r]);return e};let o$6=class o2 extends Filter{constructor(e){super(),this.angle=45,this._distance=5,this._resolution=settings.FILTER_RESOLUTION;var e=e?b(b({},o$6.defaults),e):o$6.defaults,{kernels:t,blur:r,quality:i,pixelSize:n,resolution:a}=e,{shadowOnly:t,rotation:r,distance:i,offset:n,alpha:a,color:e}=(this._offset=new ObservablePoint(this._updatePadding,this),this._tintFilter=new Filter(w,O),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=a,this._blurFilter=t?new _$1(t):new _$1(r,i),this.pixelSize=n,this.resolution=a,e);this.shadowOnly=t,void 0!==r&&void 0!==i?(this.rotation=r,this.distance=i):this.offset=n,this.alpha=a,this.color=e}apply(e,t,r,i){var n=e.getFilterTexture();this._tintFilter.apply(e,t,n,1),this._blurFilter.apply(e,n,r,i),!0!==this.shadowOnly&&e.applyFilter(this,t,r,0),e.returnFilterTexture(n)}_updatePadding(){var e=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=e+2*this.blur}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(e){this._offset.copyFrom(e),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._tintFilter&&(this._tintFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get distance(){return this._distance}set distance(e){deprecation("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=e,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/DEG_TO_RAD}set rotation(e){deprecation("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=e*DEG_TO_RAD,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(e){this._tintFilter.uniforms.alpha=e}get color(){return rgb2hex(this._tintFilter.uniforms.color)}set color(e){hex2rgb(e,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}},F=o$6;F.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:settings.FILTER_RESOLUTION};var t$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o$5=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float strength;
uniform vec4 filterArea;


void main(void)
{
	vec2 onePixel = vec2(1.0 / filterArea);

	vec4 color;

	color.rgb = vec3(0.5);

	color -= texture2D(uSampler, vTextureCoord - onePixel) * strength;
	color += texture2D(uSampler, vTextureCoord + onePixel) * strength;

	color.rgb = vec3((color.r + color.g + color.b) / 3.0);

	float alpha = texture2D(uSampler, vTextureCoord).a;

	gl_FragColor = vec4(color.rgb * alpha, alpha);
}
`;let n$5=class n4 extends Filter{constructor(e=5){super(t$1,o$5),this.strength=e}get strength(){return this.uniforms.strength}set strength(e){this.uniforms.strength=e}};var p$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,M=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;let c$5=class c7 extends Filter{constructor(e){super(p$1,M),this.offset=100,this.fillMode=c$5.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=Texture.from(this._canvas,{scaleMode:SCALE_MODES.NEAREST}),Object.assign(this,c$5.defaults,e)}apply(e,t,r,i){var{width:n,height:a}=t.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=a,this.uniforms.aspect=a/n,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,e.applyFilter(this,t,r,i)}_randomizeSizes(){var r=this._sizes,i=this._slices-1,e=this.sampleSize,n=Math.min(this.minSize/e,.9/this._slices);if(this.average){var a=this._slices;let t=1;for(let e=0;e<i;e++){var s=t/(a-e),s=Math.max(s*(1-.6*Math.random()),n);r[e]=s,t-=s}r[i]=t}else{let t=1;var o=Math.sqrt(1/this._slices);for(let e=0;e<i;e++){var l=Math.max(o*t*Math.random(),n);r[e]=l,t-=l}r[i]=t}this.shuffle()}shuffle(){var t=this._sizes;for(let e=this._slices-1;0<e;e--){var r=Math.random()*e>>0,i=t[e];t[e]=t[r],t[r]=i}}_randomizeOffsets(){for(let e=0;e<this._slices;e++)this._offsets[e]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){var t=this.sampleSize,e=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,t);let i,n=0;for(let e=0;e<this._slices;e++){i=Math.floor(256*this._offsets[e]);var a=this._sizes[e]*t;r.fillStyle=`rgba(${0<i?i:0}, ${i<0?-i:0}, 0, 1)`,r.fillRect(0,n>>0,t,1+a>>0),n+=a}e.baseTexture.update(),this.uniforms.displacementMap=e}set sizes(t){var r=Math.min(this._slices,t.length);for(let e=0;e<r;e++)this._sizes[e]=t[e]}get sizes(){return this._sizes}set offsets(t){var r=Math.min(this._slices,t.length);for(let e=0;e<r;e++)this._offsets[e]=t[e]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(e){this._slices!==e&&(this._slices=e,this.uniforms.slices=e,this._sizes=this.uniforms.slicesWidth=new Float32Array(e),this._offsets=this.uniforms.slicesOffset=new Float32Array(e),this.refresh())}get direction(){return this._direction}set direction(e){this._direction!==e&&(e=(this._direction=e)*DEG_TO_RAD,this.uniforms.sinDir=Math.sin(e),this.uniforms.cosDir=Math.cos(e))}get red(){return this.uniforms.red}set red(e){this.uniforms.red=e}get green(){return this.uniforms.green}set green(e){this.uniforms.green=e}get blue(){return this.uniforms.blue}set blue(e){this.uniforms.blue=e}destroy(){var e;null!=(e=this.texture)&&e.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}},l$6=c$5;l$6.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},l$6.TRANSPARENT=0,l$6.ORIGINAL=1,l$6.LOOP=2,l$6.CLAMP=3,l$6.MIRROR=4;var f$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,p=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;let e$1=class e4 extends Filter{constructor(e){var e=Object.assign({},e$1.defaults,e),{outerStrength:t,innerStrength:r,color:i,knockout:n,quality:a,alpha:s}=e,e=Math.round(e.distance);super(f$3,p.replace(/__ANGLE_STEP_SIZE__/gi,""+(1/a/e).toFixed(7)).replace(/__DIST__/gi,e.toFixed(0)+".0")),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:i,outerStrength:t,innerStrength:r,padding:e,knockout:n,alpha:s})}get color(){return rgb2hex(this.uniforms.glowColor)}set color(e){hex2rgb(e,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(e){this.uniforms.outerStrength=e}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(e){this.uniforms.innerStrength=e}get knockout(){return this.uniforms.knockout}set knockout(e){this.uniforms.knockout=e}get alpha(){return this.uniforms.alpha}set alpha(e){this.uniforms.alpha=e}},l$5=e$1;l$5.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var v=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,f$2=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,x$1=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;let a$5=class a2 extends Filter{constructor(e){super(v,x$1.replace("${perlin}",f$2)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);e=Object.assign(a$5.defaults,e);this._angleLight=new Point,this.angle=e.angle,this.gain=e.gain,this.lacunarity=e.lacunarity,this.alpha=e.alpha,this.parallel=e.parallel,this.center=e.center,this.time=e.time}apply(e,t,r,i){var{width:n,height:a}=t.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=a,this.uniforms.aspect=a/n,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,r,i)}get angle(){return this._angle}set angle(e){e=(this._angle=e)*DEG_TO_RAD;this._angleLight.x=Math.cos(e),this._angleLight.y=Math.sin(e)}get gain(){return this.uniforms.gain}set gain(e){this.uniforms.gain=e}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(e){this.uniforms.lacunarity=e}get alpha(){return this.uniforms.alpha}set alpha(e){this.uniforms.alpha=e}},r$4=a$5;r$4.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};var o$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,r$3=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    gl_FragColor = vec4(
        vec3(color.r * weight.r + color.g * weight.g  + color.b * weight.b),
        color.a
    );
}
`;let n$4=class n5 extends Filter{constructor(){super(o$4,r$3)}};var i$9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,s$3=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`;let t=class extends Filter{constructor(e){super(i$9,s$3),this._hue=0;e=Object.assign({},t.defaults,e);Object.assign(this,e)}get hue(){return this._hue}set hue(e){this._hue=e,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get colorize(){return this.uniforms.uColorize}set colorize(e){this.uniforms.uColorize=e}get lightness(){return this.uniforms.uLightness}set lightness(e){this.uniforms.uLightness=e}get saturation(){return this.uniforms.uSaturation}set saturation(e){this.uniforms.uSaturation=e}},n$3=t;n$3.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};var a$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,c$4=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uVelocity;
uniform int uKernelSize;
uniform float uOffset;

const int MAX_KERNEL_SIZE = 2048;

// Notice:
// the perfect way:
//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);
// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.
// So use uKernelSize directly.

void main(void)
{
    vec4 color = texture2D(uSampler, vTextureCoord);

    if (uKernelSize == 0)
    {
        gl_FragColor = color;
        return;
    }

    vec2 velocity = uVelocity / filterArea.xy;
    float offset = -uOffset / length(uVelocity) - 0.5;
    int k = uKernelSize - 1;

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }
        vec2 bias = velocity * (float(i) / float(k) + offset);
        color += texture2D(uSampler, vTextureCoord + bias);
    }
    gl_FragColor = color / float(uKernelSize);
}
`;let u$5=class u3 extends Filter{constructor(e=[0,0],t=5,r=0){super(a$4,c$4),this.kernelSize=5,this.uniforms.uVelocity=new Float32Array(2),this._velocity=new ObservablePoint(this.velocityChanged,this),this.setVelocity(e),this.kernelSize=t,this.offset=r}apply(e,t,r,i){var{x:n,y:a}=this.velocity;this.uniforms.uKernelSize=0!==n||0!==a?this.kernelSize:0,e.applyFilter(this,t,r,i)}set velocity(e){this.setVelocity(e)}get velocity(){return this._velocity}setVelocity(e){var t,r;Array.isArray(e)?([t,r]=e,this._velocity.set(t,r)):this._velocity.copyFrom(e)}velocityChanged(){this.uniforms.uVelocity[0]=this._velocity.x,this.uniforms.uVelocity[1]=this._velocity.y,this.padding=1+(Math.max(Math.abs(this._velocity.x),Math.abs(this._velocity.y))>>0)}set offset(e){this.uniforms.uOffset=e}get offset(){return this.uniforms.uOffset}};var c$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,g=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform float epsilon;

const int MAX_COLORS = %maxColors%;

uniform vec3 originalColors[MAX_COLORS];
uniform vec3 targetColors[MAX_COLORS];

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);

    float alpha = gl_FragColor.a;
    if (alpha < 0.0001)
    {
      return;
    }

    vec3 color = gl_FragColor.rgb / alpha;

    for(int i = 0; i < MAX_COLORS; i++)
    {
      vec3 origColor = originalColors[i];
      if (origColor.r < 0.0)
      {
        break;
      }
      vec3 colorDiff = origColor - color;
      if (length(colorDiff) < epsilon)
      {
        vec3 targetColor = targetColors[i];
        gl_FragColor = vec4((targetColor + colorDiff) * alpha, alpha);
        return;
      }
    }
}
`;let h$2=class h2 extends Filter{constructor(e,t=.05,r=e.length){super(c$3,g.replace(/%maxColors%/g,r.toFixed(0))),this._replacements=[],this._maxColors=0,this.epsilon=t,this._maxColors=r,this.uniforms.originalColors=new Float32Array(3*r),this.uniforms.targetColors=new Float32Array(3*r),this.replacements=e}set replacements(i){var n=this.uniforms.originalColors,a=this.uniforms.targetColors,e=i.length;if(e>this._maxColors)throw new Error(`Length of replacements (${e}) exceeds the maximum colors length (${this._maxColors})`);n[3*e]=-1;for(let r=0;r<e;r++){var s=i[r];let e=s[0],t=("number"==typeof e?e=hex2rgb(e):s[0]=rgb2hex(e),n[3*r]=e[0],n[3*r+1]=e[1],n[3*r+2]=e[2],s[1]);"number"==typeof t?t=hex2rgb(t):s[1]=rgb2hex(t),a[3*r]=t[0],a[3*r+1]=t[1],a[3*r+2]=t[2]}this._replacements=i}get replacements(){return this._replacements}refresh(){this.replacements=this._replacements}get maxColors(){return this._maxColors}set epsilon(e){this.uniforms.epsilon=e}get epsilon(){return this.uniforms.epsilon}};var l$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,d$2=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;let s$2=class s5 extends Filter{constructor(e,t=0){super(l$4,d$2),this.seed=0,this.uniforms.dimensions=new Float32Array(2),"number"==typeof e?(this.seed=e,e=void 0):this.seed=t,Object.assign(this,s$2.defaults,e)}apply(e,t,r,i){var n;this.uniforms.dimensions[0]=null==(n=t.filterFrame)?void 0:n.width,this.uniforms.dimensions[1]=null==(n=t.filterFrame)?void 0:n.height,this.uniforms.seed=this.seed,e.applyFilter(this,t,r,i)}set sepia(e){this.uniforms.sepia=e}get sepia(){return this.uniforms.sepia}set noise(e){this.uniforms.noise=e}get noise(){return this.uniforms.noise}set noiseSize(e){this.uniforms.noiseSize=e}get noiseSize(){return this.uniforms.noiseSize}set scratch(e){this.uniforms.scratch=e}get scratch(){return this.uniforms.scratch}set scratchDensity(e){this.uniforms.scratchDensity=e}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(e){this.uniforms.scratchWidth=e}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(e){this.uniforms.vignetting=e}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(e){this.uniforms.vignettingAlpha=e}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(e){this.uniforms.vignettingBlur=e}get vignettingBlur(){return this.uniforms.vignettingBlur}},r$2=s$2;r$2.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var u$4=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,c$2=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`;let r$1=class r2 extends Filter{constructor(e=1,t=0,r=.1,i=1,n=!1){super(u$4,c$2.replace(/\$\{angleStep\}/,r$1.getAngleStep(r))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=i,this.uniforms.uKnockout=n,Object.assign(this,{thickness:e,color:t,quality:r,alpha:i,knockout:n})}static getAngleStep(e){e=Math.max(e*r$1.MAX_SAMPLES,r$1.MIN_SAMPLES);return(2*Math.PI/e).toFixed(7)}apply(e,t,r,i){this.uniforms.uThickness[0]=this._thickness/t._frame.width,this.uniforms.uThickness[1]=this._thickness/t._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,e.applyFilter(this,t,r,i)}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get color(){return rgb2hex(this.uniforms.uColor)}set color(e){hex2rgb(e,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(e){this._knockout=e}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this.padding=e}},i$8=r$1;i$8.MIN_SAMPLES=1,i$8.MAX_SAMPLES=100;var e=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,n$2=`precision mediump float;

varying vec2 vTextureCoord;

uniform vec2 size;
uniform sampler2D uSampler;

uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 pixelate(vec2 coord, vec2 size)
{
	return floor( coord / size ) * size;
}

void main(void)
{
    vec2 coord = mapCoord(vTextureCoord);

    coord = pixelate(coord, size);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord);
}
`;let i$7=class i5 extends Filter{constructor(t=10){super(e,n$2),this.size=t}get size(){return this.uniforms.size}set size(e){this.uniforms.size=e="number"==typeof e?[e,e]:e}};var a$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o$3=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform float uRadian;
uniform vec2 uCenter;
uniform float uRadius;
uniform int uKernelSize;

const int MAX_KERNEL_SIZE = 2048;

void main(void)
{
    vec4 color = texture2D(uSampler, vTextureCoord);

    if (uKernelSize == 0)
    {
        gl_FragColor = color;
        return;
    }

    float aspect = filterArea.y / filterArea.x;
    vec2 center = uCenter.xy / filterArea.xy;
    float gradient = uRadius / filterArea.x * 0.3;
    float radius = uRadius / filterArea.x - gradient * 0.5;
    int k = uKernelSize - 1;

    vec2 coord = vTextureCoord;
    vec2 dir = vec2(center - coord);
    float dist = length(vec2(dir.x, dir.y * aspect));

    float radianStep = uRadian;
    if (radius >= 0.0 && dist > radius) {
        float delta = dist - radius;
        float gap = gradient;
        float scale = 1.0 - abs(delta / gap);
        if (scale <= 0.0) {
            gl_FragColor = color;
            return;
        }
        radianStep *= scale;
    }
    radianStep /= float(k);

    float s = sin(radianStep);
    float c = cos(radianStep);
    mat2 rotationMatrix = mat2(vec2(c, -s), vec2(s, c));

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }

        coord -= center;
        coord.y *= aspect;
        coord = rotationMatrix * coord;
        coord.y /= aspect;
        coord += center;

        vec4 sample = texture2D(uSampler, coord);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample;
    }

    gl_FragColor = color / float(uKernelSize);
}
`;let l$3=class l2 extends Filter{constructor(e=0,t=[0,0],r=5,i=-1){super(a$3,o$3),this._angle=0,this.angle=e,this.center=t,this.kernelSize=r,this.radius=i}apply(e,t,r,i){this.uniforms.uKernelSize=0!==this._angle?this.kernelSize:0,e.applyFilter(this,t,r,i)}set angle(e){this._angle=e,this.uniforms.uRadian=e*Math.PI/180}get angle(){return this._angle}get center(){return this.uniforms.uCenter}set center(e){this.uniforms.uCenter=e}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e=e<0||e===1/0?-1:e}};var m$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,s$1=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;let i$6=class i6 extends Filter{constructor(e){super(m$3,s$1),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,i$6.defaults,e)}apply(e,t,r,i){var n;this.uniforms.dimensions[0]=null==(n=t.filterFrame)?void 0:n.width,this.uniforms.dimensions[1]=null==(n=t.filterFrame)?void 0:n.height,this.uniforms.time=this.time,e.applyFilter(this,t,r,i)}set mirror(e){this.uniforms.mirror=e}get mirror(){return this.uniforms.mirror}set boundary(e){this.uniforms.boundary=e}get boundary(){return this.uniforms.boundary}set amplitude(e){this.uniforms.amplitude[0]=e[0],this.uniforms.amplitude[1]=e[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(e){this.uniforms.waveLength[0]=e[0],this.uniforms.waveLength[1]=e[1]}get waveLength(){return this.uniforms.waveLength}set alpha(e){this.uniforms.alpha[0]=e[0],this.uniforms.alpha[1]=e[1]}get alpha(){return this.uniforms.alpha}},o$2=i$6;o$2.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};var o$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,i$5=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

void main(void)
{
   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;
   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;
   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;
   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;
}
`;let u$3=class u4 extends Filter{constructor(e=[-10,0],t=[0,10],r=[0,0]){super(o$1,i$5),this.red=e,this.green=t,this.blue=r}get red(){return this.uniforms.red}set red(e){this.uniforms.red=e}get green(){return this.uniforms.green}set green(e){this.uniforms.green=e}get blue(){return this.uniforms.blue}set blue(e){this.uniforms.blue=e}};var s=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,f$1=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;let n$1=class n6 extends Filter{constructor(e=[0,0],t,r=0){super(s,f$1),this.center=e,Object.assign(this,n$1.defaults,t),this.time=r}apply(e,t,r,i){this.uniforms.time=this.time,e.applyFilter(this,t,r,i)}get center(){return this.uniforms.center}set center(e){this.uniforms.center=e}get amplitude(){return this.uniforms.amplitude}set amplitude(e){this.uniforms.amplitude=e}get wavelength(){return this.uniforms.wavelength}set wavelength(e){this.uniforms.wavelength=e}get brightness(){return this.uniforms.brightness}set brightness(e){this.uniforms.brightness=e}get speed(){return this.uniforms.speed}set speed(e){this.uniforms.speed=e}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}},i$4=n$1;i$4.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};var l$2=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,u$2=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D uLightmap;
uniform vec4 filterArea;
uniform vec2 dimensions;
uniform vec4 ambientColor;
void main() {
    vec4 diffuseColor = texture2D(uSampler, vTextureCoord);
    vec2 lightCoord = (vTextureCoord * filterArea.xy) / dimensions;
    vec4 light = texture2D(uLightmap, lightCoord);
    vec3 ambient = ambientColor.rgb * ambientColor.a;
    vec3 intensity = ambient + light.rgb;
    vec3 finalColor = diffuseColor.rgb * intensity;
    gl_FragColor = vec4(finalColor, diffuseColor.a);
}
`;let m$2=class m2 extends Filter{constructor(e,t=0,r=1){super(l$2,u$2),this._color=0,this.uniforms.dimensions=new Float32Array(2),this.uniforms.ambientColor=new Float32Array([0,0,0,r]),this.texture=e,this.color=t}apply(e,t,r,i){var n;this.uniforms.dimensions[0]=null==(n=t.filterFrame)?void 0:n.width,this.uniforms.dimensions[1]=null==(n=t.filterFrame)?void 0:n.height,e.applyFilter(this,t,r,i)}get texture(){return this.uniforms.uLightmap}set texture(e){this.uniforms.uLightmap=e}set color(e){var t=this.uniforms.ambientColor;"number"==typeof e?(hex2rgb(e,t),this._color=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this._color=rgb2hex(t))}get color(){return this._color}get alpha(){return this.uniforms.ambientColor[3]}set alpha(e){this.uniforms.ambientColor[3]=e}};var m$1=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,c$1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`;let l$1=class l3 extends Filter{constructor(e){var t;super(m$1,c$1),this.uniforms.blur=e.blur,this.uniforms.gradientBlur=e.gradientBlur,this.uniforms.start=null!=(t=e.start)?t:new Point(0,window.innerHeight/2),this.uniforms.end=null!=(t=e.end)?t:new Point(600,window.innerHeight/2),this.uniforms.delta=new Point(30,30),this.uniforms.texSize=new Point(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(e){this.uniforms.blur=e}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(e){this.uniforms.gradientBlur=e}get start(){return this.uniforms.start}set start(e){this.uniforms.start=e,this.updateDelta()}get end(){return this.uniforms.end}set end(e){this.uniforms.end=e,this.updateDelta()}},a$2=class a3 extends l$1{updateDelta(){var e=this.uniforms.end.x-this.uniforms.start.x,t=this.uniforms.end.y-this.uniforms.start.y,r=Math.sqrt(e*e+t*t);this.uniforms.delta.x=e/r,this.uniforms.delta.y=t/r}},u$1=class u5 extends l$1{updateDelta(){var e=this.uniforms.end.x-this.uniforms.start.x,t=this.uniforms.end.y-this.uniforms.start.y,r=Math.sqrt(e*e+t*t);this.uniforms.delta.x=-t/r,this.uniforms.delta.y=e/r}},d$1=class d2 extends Filter{constructor(e,t,r,i){super(),"number"==typeof e&&(deprecation("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),e={blur:e,gradientBlur:t,start:r,end:i}),e=Object.assign({},d$1.defaults,e),this.tiltShiftXFilter=new a$2(e),this.tiltShiftYFilter=new u$1(e)}apply(e,t,r,i){var n=e.getFilterTexture();this.tiltShiftXFilter.apply(e,t,n,1),this.tiltShiftYFilter.apply(e,n,r,i),e.returnFilterTexture(n)}get blur(){return this.tiltShiftXFilter.blur}set blur(e){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=e}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(e){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=e}get start(){return this.tiltShiftXFilter.start}set start(e){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=e}get end(){return this.tiltShiftXFilter.end}set end(e){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=e}},h$1=d$1;h$1.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};var i$3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,a$1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;let n=class extends Filter{constructor(e){super(i$3,a$1),Object.assign(this,n.defaults,e)}get offset(){return this.uniforms.offset}set offset(e){this.uniforms.offset=e}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}get angle(){return this.uniforms.angle}set angle(e){this.uniforms.angle=e}},r=n;r.defaults={radius:200,angle:4,padding:20,offset:new Point};var l=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,u=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,i$2=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,c=(e,t)=>{var r={};for(i in e)d.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&i$2)for(var i of i$2(e))t.indexOf(i)<0&&f.call(e,i)&&(r[i]=e[i]);return r};let a=class extends Filter{constructor(e){var e=Object.assign(a.defaults,e),t=e.maxKernelSize,e=c(e,["maxKernelSize"]);super(l,u.replace("${maxKernelSize}",t.toFixed(1))),Object.assign(this,e)}get center(){return this.uniforms.uCenter}set center(e){this.uniforms.uCenter=e}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(e){this.uniforms.uInnerRadius=e}get radius(){return this.uniforms.uRadius}set radius(e){this.uniforms.uRadius=e=e<0||e===1/0?-1:e}},o=a,filters=(o.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32},Object.freeze(Object.defineProperty({__proto__:null,AdjustmentFilter:s$6,AdvancedBloomFilter:b$2,AsciiFilter:i$c,BevelFilter:s$5,BloomFilter:p$2,BulgePinchFilter:t$5,CRTFilter:t$3,ColorGradientFilter:b$1,ColorMapFilter:u$6,ColorOverlayFilter:i$b,ColorReplaceFilter:s$4,ConvolutionFilter:n$6,CrossHatchFilter:e$3,DotFilter:i$a,DropShadowFilter:F,EmbossFilter:n$5,GlitchFilter:l$6,GlowFilter:l$5,GodrayFilter:r$4,GrayscaleFilter:n$4,HslAdjustmentFilter:n$3,KawaseBlurFilter:_$1,MotionBlurFilter:u$5,MultiColorReplaceFilter:h$2,OldFilmFilter:r$2,OutlineFilter:i$8,PixelateFilter:i$7,RGBSplitFilter:u$3,RadialBlurFilter:l$3,ReflectionFilter:o$2,ShockwaveFilter:i$4,SimpleLightmapFilter:m$2,TiltShiftAxisFilter:l$1,TiltShiftFilter:h$1,TiltShiftXFilter:a$2,TiltShiftYFilter:u$1,TwistFilter:r,ZoomBlurFilter:o},Symbol.toStringTag,{value:"Module"})));function VElement$1(e){let a=e.element,{visible:t,currentTime:r,relativeTime:n,env:s,trackIndex:o}=e,l=e.store,[,i]=reactExports.useState("1");var u=reactExports.useRef();let c=reactExports.useRef(null),[h,d]=reactExports.useState(1),p=reactExports.useRef(!1),f=reactExports.useRef(),m=reactExports.useRef(),g=reactExports.useRef(),v=reactExports.useMemo(()=>{var e=new Container;let t;if("export"===s){l.elementReadyMark[a.id]="start";(async()=>{var e=l.resourceManage.getResouceById(a.resourceId);if(!e)throw new Error("资源不存在"+a.resourceId);f.current=document.createElement("canvas"),f.current.width=null==(t=e.styleSize)?void 0:t.width,f.current.height=null==(t=e.styleSize)?void 0:t.height;var t=f.current.transferControlToOffscreen(),r=(m.current=new Worker(l.workerPath),m.current.elementid=a.id,l.resourceManage.getBlobURLBySourceId(a.resourceId));m.current.onmessage=e=>{"ready"===e.data.type?l.elementReadyMark[a.id]="success":"decodeMP4DemuxerSuccess"===e.data.type?l.renderAsyncMark[a.id+"_decodeMP4DemuxerSuccess"]="success":"draw"===e.data.type&&(y.texture.update(),l.renderAsyncMark[a.id]="success")};let i=a.clipTime;l.times&&(n=l.times[0]-a.startTime,i+=n),l.renderAsyncMark[a.id+"_decodeMP4DemuxerSuccess"]="start";var n=await mediaInfo(r),n=n.media.track.find(e=>"Video"===e["@type"])||{};m.current.postMessage({canvas:t,type:"initDecodeVideo",options:{url:r,rotation:Number(n.Rotation)||0,noAudioTracks:e.noAudioTracks,clipTime:i,elementId:a.id,aspectRatio:e.attrs.videoWidth/e.attrs.videoHeight}},[t])})(),t=Texture.from(f.current)}else{var r=l.resourceManage.getCacheBlobURLById(a.resourceId,o);if(!r)throw new Error("轨道资源未设置");r.target.muted=a.muted,r.target.volume=a.volume,r.target.playbackRate=getSpeedByRelative(0,a).speed;r=(t=Texture.from(r.target)).baseTexture.resource;r.autoPlay=!1,r.source.paused||r.source.pause()}var r=new Sprite(t),i=(t.on("update",()=>{d(+new Date)}),l.resourceManage.getResouceById(a.resourceId)),n=(null!=i&&i.styleSize&&(i.styleSize.width=Number(i.styleSize.width),i.styleSize.height=Number(i.styleSize.height)),g.current=new ScreenFilter({videowidth:null==(n=null==(n=null==i?void 0:i.styleSize)?void 0:n.width)?void 0:n.toFixed(1),videoheight:null==(i=null==(n=null==i?void 0:i.styleSize)?void 0:n.height)?void 0:i.toFixed(1),texture:t}),g.current.id="ScreenFilter",g.current.enabled=a.matting&&a.matting.enabled,new i$8);return n.alpha=0,n.color=16777215,n.thickness=-1,r.filters=[g.current,n],r.blendMode=a.blendMode,r.name="element",e.addChild(r),e},[a.resourceId,o]),y=(useMask(a,v,e.store,e.scale),useScreen(a,g.current,e.scale),v.children[0]),[_]=(reactExports.useEffect(()=>{var e;l.usedMediaInfo[a.id]||(l.usedMediaInfo[a.id]={resourceId:a.resourceId,volume:a.volume,startTime:a.startTime,duration:a.duration,clipTime:a.clipTime,speed:getSpeedByRelative(0,a).speed,muted:a.muted}),"export"!==s&&((e=l.resourceManage.getCacheBlobURLById(a.resourceId,o))&&(e.target.muted=a.muted,e.target.volume=a.volume,e.target.playbackRate=getSpeedByRelative(0,a).speed),1===a.separate&&(e.target.muted=!0),l.usedMediaInfo[a.id].muted=a.muted,l.usedMediaInfo[a.id].volume=a.volume)},[a.muted,a.separate,a.volume,a.speed,a.clipTime]),reactExports.useEffect(()=>{let e=y.texture.baseTexture.resource,t=()=>{p.current=!0};return"export"===s||c.current||(c.current=()=>{e.update()},e.source.addEventListener("seeked",c.current),e.source.addEventListener("canplay",t)),()=>{c.current&&e.source&&(e.source.removeEventListener("seeked",c.current),c.current=null),t,e.source&&e.source.removeEventListener("canplay",t),delete l.usedMediaInfo[a.id],f.current&&(f.current.remove(),f.current=null)}},[]),reactExports.useEffect(()=>{if(null!==n){var t=videoAvgSpeed(a),r=getSpeedByRelative(n/a.duration,a),i=n.toFixed(2)===a.duration.toFixed(2);if("export"===s){if("start"!==l.renderAsyncMark[a.id+"_decodeMP4DemuxerSuccess"]){l.renderAsyncMark[a.id]="start";let e=toNum(n+a.clipTime,3);a.curveSpeed&&(e=toNum(r.progress*a.duration*t+a.clipTime,3)),m.current.postMessage({type:"decodeFrameByTime",time:e,relativeTime:n,duration:a.duration}),i&&setTimeout(()=>{m.current&&(m.current.terminate(),m.current=null)},500)}}else{let e=y.texture.baseTexture.resource;l.playing?(e.source.playbackRate=r.speed,e.source.paused&&p.current&&e.source.play().then(()=>{e.source.currentTime=toNum(n+a.clipTime,3)}),a.fadeOutTime&&n>=a.duration-a.fadeOutTime&&(t=Math.min((a.duration-n)/a.fadeOutTime,1),r=a.volume*t,e.source.volume=r),a.fadeInTime&&n<=a.fadeInTime&&(t=Math.min(n/a.fadeInTime,1),r=a.volume*t,e.source.volume=r)):e.source.currentTime=n+a.clipTime,i&&!e.source.paused&&e.source.pause()}}else"export"===s||(t=y.texture.baseTexture.resource).source.paused||t.source.pause()},[n,a.clipTime]),useElementFilter(v,a),reactExports.useEffect(()=>{var e;void 0!==a.blendMode&&((e=v.children.find(e=>"element"===e.name)).blendMode=a.blendMode,null!=(e=e.texture))&&e.update()},[a.blendMode]),useSyncPixiElement(v,{style:{...a.style},parent:e.parent,visible:t,hide:e.hide,lock:e.lock,animateRef:u,relativeTime:e.relativeTime,store:e.store},["x","y","width","height","alpha","rotation"],a));reactExports.useEffect(()=>{var e,t,r,i,n=l.resourceManage.getResouceById(a.resourceId);a.resourceId&&a.cropSize&&n&&((n=v.children.find(e=>"element"===e.name)).texture.width+"_"+n.texture.height!="1_1"&&({x:e,y:t,width:r,height:i}=a.cropSize,n.texture.frame=new Rectangle(e,t,r,i)),_({...a.style},v))},[a.cropSize,a.resourceId,h]);var b=e.transitionElement;let x=reactExports.useCallback(debounce$1(()=>{i(createID())},500),[]);var{x:S,y:T,width:E,height:C}=a.style;return reactExports.useEffect(()=>{e.hasTransition&&x()},[S,T,E,C]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["editor"===s&&jsxRuntimeExports.jsx(ControlElment,{store:e.store,scale:e.scale,hide:e.hide,lock:e.lock,element:a,trackIndex:o,visible:t}),e.hasTransition&&jsxRuntimeExports.jsx(TransitionElement,{canvas:f,currentTime:r,relativeTime:n,trackIndex:o,transitionElement:b,nextElement:e.nextElement,element:a,dirty:b._dirty,store:e.store,env:e.env}),jsxRuntimeExports.jsx(Animate$1,{ref:u,store:e.store,pixiElem:v,elementData:a,currentTime:r,relativeTime:n})]})}let VertexShader=`
    attribute vec2 aVertexPosition;
    attribute vec2 aTextureCoord;
    uniform mat3 projectionMatrix;
    varying vec2 vTextureCoord;
    void main(void){
        gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
        vTextureCoord = aTextureCoord;
    }
`,FragmentShader=`
    varying vec2 vTextureCoord;
    uniform sampler2D uSampler;
    uniform sampler2D lut;
    uniform float intensity;
    void main() {
        vec4 color = texture2D(uSampler, vTextureCoord.xy);
        highp float blueColor = color.b * 63.0;
        //向下取值
        highp vec2 quad1;
        quad1.y = floor(floor(blueColor) / 8.0);
        quad1.x = floor(blueColor) - (quad1.y * 8.0);
         //向上取值
         highp vec2 quad2;
         quad2.y = floor(ceil(blueColor) / 8.0);
         quad2.x = ceil(blueColor) - (quad2.y * 8.0);

         //根据小正方形格子和RG通道，获取纹理坐标，每个大格子的大小:1/8=0.125，每个小格子的大小:1/512
         highp vec2 texPos1;
         texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
         texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);

         highp vec2 texPos2;
         texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
         texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);

         lowp vec4 newColor1 = texture2D(lut, texPos1);
         lowp vec4 newColor2 = texture2D(lut, texPos2);
         lowp vec4 newColor = mix(newColor1, newColor2, fract(blueColor));

         gl_FragColor = mix(color, vec4(newColor.rgb, color.w), intensity);
    }
`;class LutFilter extends Filter{constructor(e){e.texture.baseTexture.mipmap=MIPMAP_MODES.OFF,super(VertexShader,FragmentShader,{intensity:e.intensity,lut:e.texture}),this.id="",this.intensity=e.intensity}setLutImg(e){e.baseTexture.mipmap=MIPMAP_MODES.OFF,this.uniforms.lut=e}get intensity(){return this.uniforms.intensity}set intensity(e){this.uniforms.intensity=e}}function LutFilterElement(e){let r=e.element,t=e.visible,i=e.store,n=reactExports.useMemo(()=>{var e=i.resourceManage.getCacheBlobURLById(r.resourceId),e=Texture.from(e),e=new LutFilter({intensity:1,texture:e}),t=(e.id=r.id,e.blendMode=0,[...i.bodyContainer.filters||[]].filter(e=>e.id!==r.id));return t.push(e),i.bodyContainer.filters=t,e},[r.resourceId]);return reactExports.useEffect(()=>{var e=[...i.bodyContainer.filters||[]].filter(e=>e.id!==r.id);return e.push(n),i.bodyContainer.filters=e,()=>{var e;i.bodyContainer.filters=(null==(e=i.bodyContainer.filters)?void 0:e.filter(e=>e.id!==r.id))||[],n.destroy()}},[]),reactExports.useEffect(()=>{n.enabled=t,n.uniforms.intensity!==r.intensity&&(n.uniforms.intensity=r.intensity)},[t,r.intensity]),null}LutFilter.filterType="lutfilter";class TxtTexture{constructor(e,t,r){this._text=void 0,this._textStyle=void 0,this._rectText=void 0,this._bgContext=void 0,this._bgCanvas=void 0,this._textContext=void 0,this._textCanvas=void 0,this._rect=void 0,this._points=void 0,this._lines=void 0,this._lineWidths=void 0,this._lineWidthMax=void 0,this._cacheImg={},this._texture=void 0,this._scale=void 0,this._text=e,this._textStyle=t,this._scale=r}get rectText(){return this._rectText}get points(){return this._points}get rect(){return this._rect}_drawBackground(){var{radius:e=[0,0,0,0],backgroundColor:t}=this._textStyle;t&&(this._bgContext.fillStyle=this.getColor(t,1),this._bgContext.roundRect(0,0,this._textCanvas.width,this._textCanvas.height,[...e].map(e=>e*this._scale)),this._bgContext.fill())}update(e,t){return e!==this._text&&(this._text=e),t&&(this._textStyle=t),this._textContext.clearRect(0,0,this._textCanvas.width,this._textCanvas.height),this.init(),this.getTextRect()}setScale(e){return this._scale=e,this.update(this._text)}getColor(e,a){if(!e)return"";if("string"==typeof e)return e;var s=this._rect.width*this._scale,o=this._rect.height*this._scale,{type:e,value:l}=e;if("linear"===e){var u=(l.angle||0)%360;let e,t,r,i,n=(i=l.points?(e=l.points.x0/a,t=l.points.y0/a,r=l.points.x1/a,l.points.y1/a):(a=getIntersectionPoints(s,o,u),e=a.point1.x,t=a.point1.y,r=a.point2.x,a.point2.y),this._textContext.createLinearGradient(e,t,r,i));return l.colors.forEach(e=>{n.addColorStop(e.offset,e.color)}),n}if("radial"===e){var{x0:u,y0:a,x1:r,y1:i,r0:n,r1:c}=l.points||{x0:s/2,y0:o/2,r0:0,x1:s/2,y1:o/2,r1:Math.sqrt(Math.pow(s,2)+Math.pow(o,2))/2};let t=this._textContext.createRadialGradient(u,a,n,r,i,c);return l.colors.forEach(e=>{t.addColorStop(e.offset,e.color)}),t}if("conic"!==e)return"image"===e?({repeat:u,url:a}=l,this.createPattern(a,u)):"#000";{let{startAngle:e=0,x:t,y:r}=l.points||{startAngle:0,x:s/2,y:o/2},i=(void 0===t&&(t=s/2),void 0===r&&(r=o/2),this._textContext.createConicGradient(e,t,r));return l.colors.forEach(e=>{i.addColorStop(e.offset,e.color)}),i}}run(e){this._texture&&(this._textContext.clearRect(0,0,this._textCanvas.width/this._scale,this._textCanvas.height/this._scale),this._textContext.save(),this._textContext.scale(1/this._scale,1/this._scale),this._textContext.drawImage(this._bgCanvas,0,0),this._textContext.restore(),this._setWordPosition("strokeText",null,this._points),this._setWordPosition("fillText",null,this._points),this._texture.update())}destroys(){for(var e in this._texture.destroy(!0),this._cacheImg)this._cacheImg[e].remove();this._texture=null,this._cacheImg={},this._text=null,this._textStyle=null,this._lineWidths=null,this._points=null,this._bgCanvas.width=0,this._bgCanvas.height=0,this._bgCanvas.remove(),this._textCanvas.width=0,this._textCanvas.height=0,this._textCanvas.remove()}createPattern(i,n){return new Promise((r,e)=>{var t;if(this._cacheImg[i])t=this._textContext.createPattern(this._cacheImg[i],n),r(t);else{let t=new Image;t.crossOrigin="Anonymous",t.src=i,t.onload=()=>{this._cacheImg[i]=t;var e=this._textContext.createPattern(t,n);r(e)},t.onerror=()=>{e(t)}}})}async loadFont(e,t){if(t=e&&!t?`/assets/fonts/${e}/font.woff`:t){e=new FontFace(e,`url("${t}")`);try{var r=await e.load();document.fonts.add(r)}catch(e){}}}init(){this._points=[];var e,{fontSize:t=24,fill:r,fontFamily:i="",fontStyle:n="normal",stroke:a,shadow:s}=this._textStyle;return this._lines=this._text.split("\n"),this._rect=this.getTextRect(),this._textCanvas||(e=document.createElement("canvas"),this._textCanvas=e),this._textCanvas.width=this._rect.width*this._scale,this._textCanvas.height=this._rect.height*this._scale,this._textContext=this._textCanvas.getContext("2d"),this._textContext.scale(this._scale,this._scale),this._bgCanvas||(e=document.createElement("canvas"),this._bgCanvas=e),this._bgCanvas.width=this._rect.width*this._scale,this._bgCanvas.height=this._rect.height*this._scale,this._bgContext=this._bgCanvas.getContext("2d"),this._drawBackground(),this._textContext.save(),this._textContext.scale(1/this._scale,1/this._scale),this._textContext.drawImage(this._bgCanvas,0,0),this._textContext.restore(),this._textContext.textBaseline="middle",this._textContext.font=n+` ${t}px `+i,a&&(this._textContext.strokeStyle=this.getColor(a.color,this._scale),this._textContext.lineJoin=a.lineJoin||"round",this._textContext.lineWidth=a.lineWidth),r&&(this._textContext.fillStyle=this.getColor(r,this._scale)),s&&(this._textContext.shadowColor=s.color||"#000000",{x:e,y:n}=calculateVector(s.angle,s.distance*this._scale),this._textContext.shadowOffsetX=e,this._textContext.shadowOffsetY=n,this._textContext.shadowBlur=s.blur||0),this._countLines(),this._setWordPosition("strokeText",this._points),this._setWordPosition("fillText",null),this._texture?this._texture.update():this._texture=Texture.from(this._textCanvas),this._texture&&this._texture.baseTexture.setSize(this._rect.width,this._rect.height,this._scale),this._texture}_setWordPosition(d,p,f){let{lineHeight:e,shadow:t,align:m,stroke:g,fontSize:r=24,padding:v=[0,0,0,0],letterSpacing:y=0}=this._textStyle,_=void 0===e?r:e;var i=_/2+v[0];t&&(this._textContext.shadowColor="strokeText"===d?t.color:"rgba(0,0,0,0)");let b=i;this._lines.forEach((t,e)=>{let r=0;r="right"===m?this._lineWidthMax-this._lineWidths[e]:"center"===m?(this._lineWidthMax-this._lineWidths[e])/2:0;var i,n,a,s,o,l,u,c=f?f[e]:[];let h=(g?g.lineWidth:0)+r+v[3];for(let e=0;e<t.length;e++)f?(this._textContext.save(),{offsetX:n=0,offsetY:a=0,offsetScaleX:s=0,offsetScaleY:o=0,offsetOpacity:l,offsetRotate:u=0}=i=c[e],this._textContext.translate(i.x+i.width/2+n,i.y+a),void 0!==u?this._textContext.rotate(u):this._textContext.rotate(i.rotate||0),void 0!==l&&(this._textContext.globalAlpha=l),void 0!==s?this._textContext.scale(s,o):this._textContext.scale(i.scalex||1,i.scaley||1),this._textContext.translate(-i.x+n,-i.y+a),this._textContext[d](t[e],i.x-i.width/2+n,i.y+a),this._textContext.globalAlpha=1,this._textContext.restore()):(this._textContext[d](t[e],h,b),u=this._textContext.measureText(t[e]).width,c.push({x:h,y:b,width:u}),h+=u+y);p&&p.push(c),b+=_})}_countLines(){let{letterSpacing:n=0}=this._textStyle;this._lineWidths=this._lines.map((t,e)=>{let r=0;for(let e=0;e<t.length;e++){var i=this._textContext.measureText(t[e]).width;r+=i+n}return r-n}),this._lineWidthMax=Math.max(...this._lineWidths)}getTextRect(){var e={},{padding:t,letterSpacing:r,lineHeight:i,fontFamily:n,fontSize:a,fontStyle:s,stroke:o,shadow:l}=this._textStyle,r=(e.textBaseline="middle",void 0!==r&&(e.letterSpacing=r),void 0===i?a:i),i=(e.lineHeight=r,void 0!==n&&(e.fontFamily=n),void 0!==a&&(e.fontSize=a),void 0!==s&&(e.fontStyle=s),void 0!==o&&(e.stroke="red",e.lineJoin=o.lineJoin,e.strokeThickness=o.lineWidth),void 0!==l&&(e.dropShadow=!0,e.dropShadowAngle=l.angle,e.dropShadowDistance=l.distance,e.dropShadowBlur=l.blur,e.dropShadowColor=l.color),this._rectText=new Text(this._text,e),this._rectText.getLocalBounds());let u=[0,0,0,0];var[n,a,s,o]=u=void 0!==t?[...t]:u;return i.width+=a+o,i.height=r*this._text.split("\n").length+n+s,i}}function calculateVector(e,t){e*=Math.PI/180;return{x:t*Math.cos(e),y:t*Math.sin(e)}}function compatibilityTextStyle(t){if("newTextStyle"===t.type)return{...t};t.fill||(t.fill="#fff");var e,r,i,n,a,s={radius:[0,0,0,0],type:"newTextStyle",direction:"horizontal",fillType:"string"==typeof t.fill?"normal":"gradual",fill:"#ffffff",padding:[5,5,5,5],fontSize:t.fontSize||200,letterSpacing:t.letterSpacing||0,lineHeight:t.lineHeight||200,align:t.align||"left",fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontStyle:t.fontStyle,stroke:{color:"#000000",lineJoin:"round",lineWidth:10}};if(t.textBgColor&&(i=t.textBgColor,s.backgroundColor=`rgba(${i.r}, ${i.g}, ${i.b}, ${i.a})`),t.dropShadow&&({dropShadowAlpha:i,dropShadowAngle:a,dropShadowBlur:e,dropShadowColor:r,dropShadowDistance:n}=t,(r=tinycolor(r)).setAlpha(i),s.shadow={distance:n,angle:a,color:r.toRgbString(),blur:e}),t.stroke&&({stroke:i,strokeThickness:n}=t,a=tinycolor(i),s.stroke={color:a.toRgbString(),lineJoin:"round",lineWidth:n}),t.fill){let{fill:r,fillGradientType:e}=t;"string"==typeof r?s.fill=r:s.fill={type:"linear",value:{angle:0===e?0:Math.PI/2,colors:r.map((e,t)=>({color:e,offset:t/(r.length-1)}))}}}return s}function getIntersectionPoints(e,t,r){var r=r*(Math.PI/180),i=Math.cos(r),r=Math.sin(r),n=t/2,a=e/2/Math.abs(i),n=n/Math.abs(r),a=Math.min(a,n),n=a*i,i=a*r,a=e/2,r=t/2;return{point1:{x:a+n,y:r-i},point2:{x:a+-n,y:r- -i}}}function TaggedTextElement(l){var{visible:e,env:t,trackIndex:r}=l;let u=l.element;var i=reactExports.useRef();let[,n]=reactExports.useReducer(e=>e+1,0),a=l.store,c=reactExports.useRef(),s=(void 0===u.scale&&(u.scale=1),reactExports.useMemo(()=>{var e,{text:t,textStyle:r}=u,r=(r.fontSize=200,r.lineHeight=r.fontSize,compatibilityTextStyle(r));for(e in r.lineHeight||(r.lineHeight=r.fontSize),u.textStyle)delete u.textStyle[e];Object.assign(u.textStyle,r);var i=u.textScale||1,t=(u.textScale=i,new TxtTexture(t,r,i)),r=(c.current=t,c.current.init()),{width:n,height:a}=c.current.rect,n=(u.style.width=n/i,u.style.height=a/i,new Sprite(r)),a=(n.tt=t,n.name="element",new Container);return a.addChild(n),a},[r]));return reactExports.useEffect(()=>{var e=c.current.update(u.text,{...u.textStyle});u.style.width=e.width*u.textScale,u.style.height=e.height*u.textScale,n(),setTimeout(()=>{pubsub.publish(a.events.UPDATE_CONTROL_TARGET)},0)},[u.text,u.textStyle,u._textStyleDirty,u.textScale]),reactExports.useEffect(()=>{if(u.textEnterAnimate){let n=e=>{var t=u.style;return t?"alpha"===e&&void 0===t.alpha?1:t[e]??0:0},a=[],r=u.textEnterAnimate.duration,s=Math.max(r/u.text.length,.01),o=(u.textEnterAnimate.frames.forEach(e=>{var t=e.progress*r;a.push({time:t,id:createID(),ease:u.textEnterAnimate.ease,transform:{...e.transform},alpha:e.alpha,width:e.width,height:e.height,_dirty:createID()})}),0);c.current.points.forEach((e,t)=>{e.forEach((e,t)=>{var r,i=getNowFrame({animateStatusFrames:a,time:l.relativeTime-o*s,duration:u.duration,getStyleValue:n});i&&({alpha:i,transform:r}=i,r&&(void 0!==r.translateX&&(e.offsetX=r.translateX),void 0!==r.translateY&&(e.offsetY=r.translateY),void 0!==r.scaleX&&(e.offsetScaleX=r.scaleX),void 0!==r.scaleY&&(e.offsetScaleY=r.scaleY),void 0!==r.rotation)&&(e.offsetRotate=r.rotation),void 0!==i)&&(e.offsetOpacity=i),o++})}),c.current.run()}},[u.textEnterAnimate,l.relativeTime]),reactExports.useEffect(()=>{u.textStyle.fontFamily||(u.textStyle.fontFamily="Default"),u.textStyle.fontFamily&&loadFont(u.textStyle.fontFamily,u.textStyle.fontFamilyURL).then(()=>{var e=c.current.update(u.text,u.textStyle);u.style.width=e.width*u.textScale,u.style.height=e.height*u.textScale,n(),setTimeout(()=>{pubsub.publish(a.events.UPDATE_CONTROL_TARGET)},0)})},[u.textStyle.fontFamily]),reactExports.useEffect(()=>{var e,t;void 0!==u.style.width&&void 0!==u.style.height&&(u.style.width=Math.max(u.style.width,1),u.style.height=Math.max(u.style.height,1),e=Math.max(u.style.width/c.current.rect.width,.1),(t=s.children.find(e=>"element"===e.name)).width=u.style.width,t.height=u.style.height,u.textScale=e,c.current.setScale(u.textScale))},[u.style.width]),reactExports.useEffect(()=>()=>{c.current.destroys()},[]),useSyncPixiElement(s,{style:{...u.style},parent:l.parent,animateRef:i,visible:e,hide:l.hide,lock:l.lock,relativeTime:l.relativeTime,store:l.store},["x","y","alpha","rotation"],u),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["editor"===t&&jsxRuntimeExports.jsx(ControlElment,{store:l.store,trackIndex:r,scale:l.scale,hide:l.hide,lock:l.lock,element:u,visible:e}),jsxRuntimeExports.jsx(Animate$1,{ref:i,store:l.store,pixiElem:s,elementData:u,currentTime:l.currentTime,relativeTime:l.relativeTime})]})}function CaptionText(l){var{visible:e,env:t,trackIndex:r,scale:i}=l;let u=l.element;var n=reactExports.useRef();let[,a]=reactExports.useReducer(e=>e+1,0),s=l.store,o=reactExports.useRef(),c=(void 0===u.scale&&(u.scale=1),reactExports.useMemo(()=>{var e,t=new Container,{text:r,textStyle:i}=u,i=(i.fontSize=200,i.lineHeight=i.fontSize,compatibilityTextStyle(i));for(e in i.lineHeight||(i.lineHeight=i.fontSize),u.textStyle)delete u.textStyle[e];Object.assign(u.textStyle,i);var i=u.textScale||1,r=(u.textScale=i,new TxtTexture(r,u.textStyle,i)),n=(o.current=r).init(),{width:a,height:s}=r.rect,n=new Sprite(n);return n.tt=r,n.name="element",u.style.width=a/i,u.style.height=s/i,t.addChild(n),t},[r])),h=c.children.find(e=>"element"===e.name),d=(reactExports.useEffect(()=>{var e=h.tt.update(u.text,u.textStyle);u.style.width=e.width*u.textScale,u.style.height=e.height*u.textScale,s.captionContainer.children.forEach(e=>{var t=e.children.find(e=>"element"===e.name);h.name!==t.name&&(t=t.tt.update(e.elementData.text,u.textStyle),e.elementData.style.width=t.width*e.elementData.textScale,e.elementData.style.height=t.height*e.elementData.textScale)}),a(),setTimeout(()=>{pubsub.publish(s.events.UPDATE_CONTROL_TARGET)},0)},[u.text,u.textStyle,u._textStyleDirty,u.textScale]),reactExports.useEffect(()=>{if(u.textEnterAnimate){let n=e=>{var t=u.style;return t?"alpha"===e&&void 0===t.alpha?1:t[e]??0:0},a=[],r=u.textEnterAnimate.duration,s=Math.max(r/u.text.length,.01),o=(u.textEnterAnimate.frames.forEach(e=>{var t=e.progress*r;a.push({time:t,id:createID(),ease:u.textEnterAnimate.ease,transform:{...e.transform},alpha:e.alpha,width:e.width,height:e.height,_dirty:createID()})}),0);h.tt.points.forEach((e,t)=>{e.forEach((e,t)=>{var{alpha:r,transform:i}=getNowFrame({animateStatusFrames:a,time:l.relativeTime-o*s,duration:u.duration,getStyleValue:n});i&&(void 0!==i.translateX&&(e.offsetX=i.translateX),void 0!==i.translateY&&(e.offsetY=i.translateY),void 0!==i.scaleX&&(e.offsetScaleX=i.scaleX),void 0!==i.scaleY&&(e.offsetScaleY=i.scaleY),void 0!==i.rotation)&&(e.offsetRotate=i.rotation),void 0!==r&&(e.offsetOpacity=r),o++})}),h.tt.run()}},[u.textEnterAnimate,l.relativeTime]),reactExports.useEffect(()=>{u.textStyle.fontFamily||(u.textStyle.fontFamily="Default"),loadFont(u.textStyle.fontFamily,u.textStyle.fontFamilyURL).then(()=>{var e=h.tt.update(u.text,u.textStyle);u.style.width=e.width*u.textScale,u.style.height=e.height*u.textScale,s.captionContainer.children.forEach(e=>{var t=e.children.find(e=>"element"===e.name);h.name!==t.name&&(t=t.tt.update(e.elementData.text,u.textStyle),e.elementData.style.width=t.width*e.elementData.textScale,e.elementData.style.height=t.height*e.elementData.textScale)}),a(),setTimeout(()=>{pubsub.publish(s.events.UPDATE_CONTROL_TARGET)},0)})},[u.textStyle.fontFamily]),reactExports.useCallback(e=>{if(void 0!==u.style.width&&void 0!==u.style.height){u.style.width=Math.max(e,1),u.style.height=Math.max(u.style.height,1);let r=Math.max(e/h.tt.rect.width,.1);r.toFixed(3)!==u.textScale.toFixed(3)&&l.store.captionContainer.children.forEach(e=>{var t=e.children.find(e=>"element"===e.name);e.elementData.textScale=r,t.tt.setScale(u.textScale)});var t=c.children.find(e=>"element"===e.name);t&&(t.width=e,t.height=u.style.height,u.textScale=r,h.tt.setScale(u.textScale),p(u.style,h))}},[])),[,p]=(reactExports.useEffect(()=>{d(u.style.width)},[u.style.width]),reactExports.useEffect(()=>()=>{h.tt.destroys()},[]),useSyncPixiElement(c,{style:{...u.style},parent:l.parent,animateRef:n,visible:e,hide:l.hide,lock:l.lock,relativeTime:l.relativeTime,store:l.store},["x","y","alpha","rotation"],u));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["editor"===t&&jsxRuntimeExports.jsx(ControlElment,{store:l.store,trackIndex:r,scale:i,hide:l.hide,lock:l.lock,isCaption:!0,element:u,visible:e}),jsxRuntimeExports.jsx(Animate$1,{ref:n,store:l.store,pixiElem:c,elementData:u,currentTime:l.currentTime,relativeTime:l.relativeTime})]})}function VElement(e){let i=e.element,{relativeTime:n,env:a,trackIndex:s}=e,o=e.store,l=reactExports.useRef(!1);return reactExports.useMemo(()=>{var e=new Container;if("export"===a)o.elementReadyMark[i.id]="start";else{var t=o.resourceManage.getCacheBlobURLById(i.resourceId,s);if(!t)throw new Error("轨道资源未设置");t.target.muted=i.muted,t.target.volume=i.volume,t.target.playbackRate=i.speed,t.target.autoplay=!1,t.target.paused||t.target.pause()}return e},[i.resourceId,s]),reactExports.useEffect(()=>{var e;o.usedMediaInfo[i.id]||(o.usedMediaInfo[i.id]={resourceId:i.resourceId,volume:i.volume,startTime:i.startTime,duration:i.duration,clipTime:i.clipTime,speed:i.speed,muted:i.muted}),"export"!==a&&((e=o.resourceManage.getCacheBlobURLById(i.resourceId,s))&&(e.target.muted=i.muted,e.target.volume=i.volume,e.target.playbackRate=i.speed),o.usedMediaInfo[i.id].muted=i.muted,o.usedMediaInfo[i.id].volume=i.volume,o.usedMediaInfo[i.id].speed=i.speed)},[i.muted,i.volume,i.speed]),reactExports.useEffect(()=>{let e=()=>{l.current=!0},t=o.resourceManage.getCacheBlobURLById(i.resourceId,s);return"export"===a?o.elementReadyMark[i.id]="success":t.target.addEventListener("canplay",e),()=>{delete o.usedMediaInfo[i.id],"export"!==a&&t.target.removeEventListener("canplay",e)}},[]),reactExports.useEffect(()=>{if(null!==n){var t=n.toFixed(1)===i.duration.toFixed(1);if("export"!==a){let e=o.resourceManage.getCacheBlobURLById(i.resourceId,s);o.playing?(e.target.paused&&l.current&&e.target.play().then(()=>{e.target.currentTime=toNum(n+i.clipTime,3)}),i.fadeOutTime&&n>=i.duration-i.fadeOutTime&&(r=Math.min((i.duration-n)/i.fadeOutTime,1),r=i.volume*r,e.target.volume=r),i.fadeInTime&&n<=i.fadeInTime&&(r=Math.min(n/i.fadeInTime,1),r=i.volume*r,e.target.volume=r)):e.target.currentTime=n,t&&!e.target.paused&&e.target.pause()}}else{var r;"export"===a||(r=o.resourceManage.getCacheBlobURLById(i.resourceId,s)).target.paused||r.target.pause()}},[n,i.clipTime]),null}function EffectCanvas(e){let t,{visible:r,relativeTime:i,trackIndex:n}=e,a=(reactExports.useRef(),e.element),s=e.store,o=reactExports.useRef(null),l=reactExports.useMemo(()=>{var e=new Container;let t=document.createElement("canvas"),r=(t.width=s.data.width,t.height=s.data.height,s.elementReadyMark[a.id]="start",Texture.from(t));var i=new Sprite(r.clone());return a.jscript?window.EModule.import(a.jscript).then(e=>{(o.current=e).init(t,a,s,PIXI),null!=(e=o.current)&&e.play({relativeTime:0,duration:a.duration,progress:0}),r.update(),s.elementReadyMark[a.id]="success"}):s.elementReadyMark[a.id]="success",i.name="element",e.addChild(i),e},[n]);return reactExports.useEffect(()=>{var e;void 0!==a.blendMode&&(e=l.children.find(e=>"element"===e.name))&&(e.blendMode=a.blendMode)},[a.blendMode]),void 0===a.scale&&(a.scale=1),reactExports.useEffect(()=>{l&&(a&&(l.name=null==a?void 0:a.id),l.elementData=a,l.visible=e.visible,e.hide&&(l.visible=!1),"editor"===s.env)&&pubsub.publish(s.events.VISIBLE_CONTROL,{visible:e.visible,elementId:null==a?void 0:a.id})},[e.visible,e.hide]),reactExports.useEffect(()=>{e.lock?l.interactive=!1:l.interactive=!0},[e.lock]),reactExports.useEffect(()=>{var e;l&&(l.alpha=toNum((null==(e=a.style)?void 0:e.alpha)??1,6))},[null==(t=a.style)?void 0:t.alpha]),reactExports.useEffect(()=>l&&e.parent?(e.parent.addChild(l),()=>{o.current.destroy&&o.current.destroy(),l.destroy({children:0!==l.children.length})}):void 0,[]),reactExports.useEffect(()=>{var e,t;r&&null!==i?(t=i/a.duration,null!=(e=o.current)&&e.play({relativeTime:i,duration:a.duration,progress:t}),l.children.find(e=>"element"===e.name).texture.update()):null!=(e=o.current)&&e.pause()},[r,i]),null}var lottie$1={exports:{}},lottieExports=(!function(module,exports){"undefined"!=typeof navigator&&(e=>{module.exports=e()})(function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(e){_useWebWorker=!!e},getWebWorker=function(){return _useWebWorker},setLocationHref=function(e){locationHref=e},getLocationHref=function(){return locationHref};function createTag(e){return document.createElement(e)}function extendPrototype(e,t){for(var r,i=e.length,n=0;n<i;n+=1)for(var a in r=e[n].prototype)Object.prototype.hasOwnProperty.call(r,a)&&(t.prototype[a]=r[a])}function getDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)}function createProxyFunction(e){function t(){}return t.prototype=e,t}var audioControllerFactory=(()=>{function e(e){this.audios=[],this.audioFactory=e,this._volume=1,this._isMuted=!1}return e.prototype={addAudio:function(e){this.audios.push(e)},pause:function(){for(var e=this.audios.length,t=0;t<e;t+=1)this.audios[t].pause()},resume:function(){for(var e=this.audios.length,t=0;t<e;t+=1)this.audios[t].resume()},setRate:function(e){for(var t=this.audios.length,r=0;r<t;r+=1)this.audios[r].setRate(e)},createAudio:function(e){return this.audioFactory?this.audioFactory(e):window.Howl?new window.Howl({src:[e]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(e){this.audioFactory=e},setVolume:function(e){this._volume=e,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){for(var e=this.audios.length,t=0;t<e;t+=1)this.audios[t].volume(this._volume*(this._isMuted?0:1))}},function(){return new e}})(),createTypedArray=(()=>{function r(e,t){var r,i=0,n=[];switch(e){case"int16":case"uint8c":r=1;break;default:r=1.1}for(i=0;i<t;i+=1)n.push(r);return n}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(e,t){return"float32"===e?new Float32Array(t):"int16"===e?new Int16Array(t):"uint8c"===e?new Uint8ClampedArray(t):r(e,t)}:r})();function createSizedArray(e){return Array.apply(null,{length:e})}function _typeof$6(e){return(_typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={},defaultCurveSegments=((()=>{for(var e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],t=e.length,r=0;r<t;r+=1)BMMath[e[r]]=Math[e[r]]})(),BMMath.random=Math.random,BMMath.abs=function(e){if("object"===_typeof$6(e)&&e.length){for(var t=createSizedArray(e.length),r=e.length,i=0;i<r;i+=1)t[i]=Math.abs(e[i]);return t}return Math.abs(e)},150),degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(e){e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.display="block",e.style.transformOrigin="0 0",e.style.webkitTransformOrigin="0 0",e.style.backfaceVisibility="visible",e.style.webkitBackfaceVisibility="visible",e.style.transformStyle="preserve-3d",e.style.webkitTransformStyle="preserve-3d",e.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(e,t,r,i){this.type=e,this.currentTime=t,this.totalTime=r,this.direction=i<0?-1:1}function BMCompleteEvent(e,t){this.type=e,this.direction=t<0?-1:1}function BMCompleteLoopEvent(e,t,r,i){this.type=e,this.currentLoop=r,this.totalLoops=t,this.direction=i<0?-1:1}function BMSegmentStartEvent(e,t,r){this.type=e,this.firstFrame=t,this.totalFrames=r}function BMDestroyEvent(e,t){this.type=e,this.target=t}function BMRenderFrameErrorEvent(e,t){this.type="renderFrameError",this.nativeError=e,this.currentTime=t}function BMConfigErrorEvent(e){this.type="configError",this.nativeError=e}var createElementID=(()=>{var e=0;return function(){return idPrefix$1+"__lottie_element_"+(e+=1)}})();function HSVtoRGB(e,t,r){var i,n,a,s=Math.floor(6*e),e=6*e-s,o=r*(1-t),l=r*(1-e*t),u=r*(1-(1-e)*t);switch(s%6){case 0:i=r,n=u,a=o;break;case 1:i=l,n=r,a=o;break;case 2:i=o,n=r,a=u;break;case 3:i=o,n=l,a=r;break;case 4:i=u,n=o,a=r;break;case 5:i=r,n=o,a=l}return[i,n,a]}function RGBtoHSV(e,t,r){var i,n=Math.max(e,t,r),a=Math.min(e,t,r),s=n-a,o=0===n?0:s/n,l=n/255;switch(n){case a:i=0;break;case e:i=t-r+s*(t<r?6:0),i/=6*s;break;case t:i=r-e+2*s,i/=6*s;break;case r:i=e-t+4*s,i/=6*s}return[i,o,l]}function addSaturationToRGB(e,t){e=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return e[1]+=t,1<e[1]?e[1]=1:e[1]<=0&&(e[1]=0),HSVtoRGB(e[0],e[1],e[2])}function addBrightnessToRGB(e,t){e=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return e[2]+=t,1<e[2]?e[2]=1:e[2]<0&&(e[2]=0),HSVtoRGB(e[0],e[1],e[2])}function addHueToRGB(e,t){e=RGBtoHSV(255*e[0],255*e[1],255*e[2]);return e[0]+=t/360,1<e[0]?--e[0]:e[0]<0&&(e[0]+=1),HSVtoRGB(e[0],e[1],e[2])}var rgbToHex=(()=>{for(var e,i=[],t=0;t<256;t+=1)e=t.toString(16),i[t]=1===e.length?"0"+e:e;return function(e,t,r){return"#"+i[e=e<0?0:e]+i[t=t<0?0:t]+i[r=r<0?0:r]}})(),setSubframeEnabled=function(e){subframeEnabled=!!e},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(e){expressionsPlugin=e},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(e){expressionsInterfaces=e},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(e){defaultCurveSegments=e},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(e){idPrefix$1=e};function createNS(e){return document.createElementNS(svgNS,e)}function _typeof$5(e){return(_typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var dataManager=(()=>{var r,i,n=1,a=[],s={onmessage:function(){},postMessage:function(e){r({data:e})}},o={postMessage:function(e){s.onmessage({data:e})}};function l(){var e,t;i||(e=function(t){function e(){function c(e,t){for(var r,i,n,a=e.length,s=0;s<a;s+=1)if("ks"in(n=e[s])&&!n.completed){if(n.completed=!0,n.hasMask)for(var o=n.masksProperties,l=o.length,u=0;u<l;u+=1)if(o[u].pt.k.i)p(o[u].pt.k);else for(i=o[u].pt.k.length,r=0;r<i;r+=1)o[u].pt.k[r].s&&p(o[u].pt.k[r].s[0]),o[u].pt.k[r].e&&p(o[u].pt.k[r].e[0]);0===n.ty?(n.layers=h(n.refId,t),c(n.layers,t)):4===n.ty?d(n.shapes):5===n.ty&&0===(n=n).t.a.length&&0 in n.t.p}}function h(e,t){e=((e,t)=>{for(var r=0,i=t.length;r<i;){if(t[r].id===e)return t[r];r+=1}return null})(e,t);return e?e.layers.__used?JSON.parse(JSON.stringify(e.layers)):(e.layers.__used=!0,e.layers):null}function d(e){for(var t,r,i=e.length-1;0<=i;--i)if("sh"===e[i].ty)if(e[i].ks.k.i)p(e[i].ks.k);else for(r=e[i].ks.k.length,t=0;t<r;t+=1)e[i].ks.k[t].s&&p(e[i].ks.k[t].s[0]),e[i].ks.k[t].e&&p(e[i].ks.k[t].e[0]);else"gr"===e[i].ty&&d(e[i].it)}function p(e){for(var t=e.i.length,r=0;r<t;r+=1)e.i[r][0]+=e.v[r][0],e.i[r][1]+=e.v[r][1],e.o[r][0]+=e.v[r][0],e.o[r][1]+=e.v[r][1]}function n(e,t){t=t?t.split("."):[100,100,100];return e[0]>t[0]||!(e[0]<t[0])&&(t[1]<e[1]||!(e[1]<t[1])&&t[2]<e[2])}i=[4,4,14];var i,a=function(e){if(n(i,e.v)&&(s(e.layers),e.assets))for(var t=e.assets.length,r=0;r<t;r+=1)e.assets[r].layers&&s(e.assets[r].layers)};function s(e){for(var t,r,i=e.length,n=0;n<i;n+=1)5===e[n].ty&&(t=e[n],r=void 0,r=t.t.d,t.t.d={k:[{s:r,t:0}]})}o=[4,7,99];var o,l,u=function(e){if(e.chars&&!n(o,e.v))for(var t=e.chars.length,r=0;r<t;r+=1){var i=e.chars[r];i.data&&i.data.shapes&&(d(i.data.shapes),i.data.ip=0,i.data.op=99999,i.data.st=0,i.data.sr=1,i.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},e.chars[r].t||(i.data.shapes.push({ty:"no"}),i.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}},f=(l=[5,7,15],function(e){if(n(l,e.v)&&(m(e.layers),e.assets))for(var t=e.assets.length,r=0;r<t;r+=1)e.assets[r].layers&&m(e.assets[r].layers)});function m(e){for(var t,r=e.length,i=0;i<r;i+=1)5===e[i].ty&&("number"==typeof(t=(t=e[i]).t.p).a&&(t.a={a:0,k:t.a}),"number"==typeof t.p&&(t.p={a:0,k:t.p}),"number"==typeof t.r)&&(t.r={a:0,k:t.r})}g=[4,1,9];var g,v=function(e){if(n(g,e.v)&&(y(e.layers),e.assets))for(var t=e.assets.length,r=0;r<t;r+=1)e.assets[r].layers&&y(e.assets[r].layers)};function y(e){for(var t=e.length,r=0;r<t;r+=1)4===e[r].ty&&!function e(t){for(var r,i,n=t.length,a=0;a<n;a+=1)if("gr"===t[a].ty)e(t[a].it);else if("fl"===t[a].ty||"st"===t[a].ty)if(t[a].c.k&&t[a].c.k[0].i)for(i=t[a].c.k.length,r=0;r<i;r+=1)t[a].c.k[r].s&&(t[a].c.k[r].s[0]/=255,t[a].c.k[r].s[1]/=255,t[a].c.k[r].s[2]/=255,t[a].c.k[r].s[3]/=255),t[a].c.k[r].e&&(t[a].c.k[r].e[0]/=255,t[a].c.k[r].e[1]/=255,t[a].c.k[r].e[2]/=255,t[a].c.k[r].e[3]/=255);else t[a].c.k[0]/=255,t[a].c.k[1]/=255,t[a].c.k[2]/=255,t[a].c.k[3]/=255}(e[r].shapes)}_=[4,4,18];var _,b=function(e){if(n(_,e.v)&&(x(e.layers),e.assets))for(var t=e.assets.length,r=0;r<t;r+=1)e.assets[r].layers&&x(e.assets[r].layers)};function x(e){for(var t,r,i,n=e.length,a=0;a<n;a+=1){if((t=e[a]).hasMask)for(var s=t.masksProperties,o=s.length,l=0;l<o;l+=1)if(s[l].pt.k.i)s[l].pt.k.c=s[l].cl;else for(i=s[l].pt.k.length,r=0;r<i;r+=1)s[l].pt.k[r].s&&(s[l].pt.k[r].s[0].c=s[l].cl),s[l].pt.k[r].e&&(s[l].pt.k[r].e[0].c=s[l].cl);4===t.ty&&!function e(t){for(var r,i,n=t.length-1;0<=n;--n)if("sh"===t[n].ty)if(t[n].ks.k.i)t[n].ks.k.c=t[n].closed;else for(i=t[n].ks.k.length,r=0;r<i;r+=1)t[n].ks.k[r].s&&(t[n].ks.k[r].s[0].c=t[n].closed),t[n].ks.k[r].e&&(t[n].ks.k[r].e[0].c=t[n].closed);else"gr"===t[n].ty&&e(t[n].it)}(t.shapes)}}var e={};return e.completeData=function(e){if(!e.__complete){v(e),a(e),u(e),f(e),b(e),c(e.layers,e.assets);var t=e.chars,r=e.assets;if(t)for(var i=0,n=t.length,i=0;i<n;i+=1)1===t[i].t&&(t[i].data.layers=h(t[i].data.refId,r),c(t[i].data.layers,r));e.__complete=!0}},e.checkColors=v,e.checkChars=u,e.checkPathProperties=f,e.checkShapes=b,e.completeLayers=c,e}function s(e){var t=e.getResponseHeader("content-type");return t&&"json"===e.responseType&&-1!==t.indexOf("json")||e.response&&"object"===_typeof$5(e.response)?e.response:e.response&&"string"==typeof e.response?JSON.parse(e.response):e.responseText?JSON.parse(e.responseText):null}var r;o.dataManager||(o.dataManager=e()),o.assetLoader||(o.assetLoader={load:function(t,r,e,i){var n,a=new XMLHttpRequest;try{a.responseType="json"}catch(e){}a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)n=s(a),e(n);else try{n=s(a),e(n)}catch(e){i&&i(e)}};try{a.open(["G","E","T"].join(""),t,!0)}catch(e){a.open(["G","E","T"].join(""),r+"/"+t,!0)}a.send()}}),"loadAnimation"===t.data.type?o.assetLoader.load(t.data.path,t.data.fullPath,function(e){o.dataManager.completeData(e),o.postMessage({id:t.data.id,payload:e,status:"success"})},function(){o.postMessage({id:t.data.id,status:"error"})}):"complete"===t.data.type?(r=t.data.animation,o.dataManager.completeData(r),o.postMessage({id:t.data.id,payload:r,status:"success"})):"loadData"===t.data.type&&o.assetLoader.load(t.data.path,t.data.fullPath,function(e){o.postMessage({id:t.data.id,payload:e,status:"success"})},function(){o.postMessage({id:t.data.id,status:"error"})})},(i=window.Worker&&window.Blob&&getWebWorker()?(t=new Blob(["var _workerSelf = self; self.onmessage = ",e.toString()],{type:"text/javascript"}),t=URL.createObjectURL(t),new Worker(t)):(r=e,s)).onmessage=function(e){var e=e.data,t=e.id,r=a[t];a[t]=null,"success"===e.status?r.onComplete(e.payload):r.onError&&r.onError()})}function u(e,t){var r="processId_"+(n+=1);return a[r]={onComplete:e,onError:t},r}return{loadAnimation:function(e,t,r){l(),t=u(t,r),i.postMessage({type:"loadAnimation",path:e,fullPath:window.location.origin+window.location.pathname,id:t})},loadData:function(e,t,r){l(),t=u(t,r),i.postMessage({type:"loadData",path:e,fullPath:window.location.origin+window.location.pathname,id:t})},completeAnimation:function(e,t,r){l(),t=u(t,r),i.postMessage({type:"complete",animation:e,id:t})}}})(),ImagePreloader=(()=>{(e=createTag("canvas")).width=1,e.height=1,(t=e.getContext("2d")).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1);var e,t,n=e;function r(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function i(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function a(e,t,r){var i="";return i=e.e?e.p:t?t+(t=-1!==(t=e.p).indexOf("images/")?t.split("/")[1]:t):(i=r,(i+=e.u||"")+e.p)}function s(){this._imageLoaded=r.bind(this),this._footageLoaded=i.bind(this),this.testImageLoaded=function(e){var t=0,r=setInterval(function(){(e.getBBox().width||500<t)&&(this._imageLoaded(),clearInterval(r)),t+=1}.bind(this),50)}.bind(this),this.createFootageData=function(e){var t={assetData:e},e=a(e,this.assetsPath,this.path);return dataManager.loadData(e,function(e){t.img=e,this._footageLoaded()}.bind(this),function(){t.img={},this._footageLoaded()}.bind(this)),t}.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return s.prototype={loadAssets:function(e,t){this.imagesLoadedCb=t;for(var r=e.length,i=0;i<r;i+=1)e[i].layers||(e[i].t&&"seq"!==e[i].t?3===e[i].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(e[i]))):(this.totalImages+=1,this.images.push(this._createImageData(e[i]))))},setAssetsPath:function(e){this.assetsPath=e||""},setPath:function(e){this.path=e||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(e){for(var t=0,r=this.images.length;t<r;){if(this.images[t].assetData===e)return this.images[t].img;t+=1}return null},createImgData:function(e){var t=a(e,this.assetsPath,this.path),r=createTag("img"),i=(r.crossOrigin="anonymous",r.addEventListener("load",this._imageLoaded,!1),r.addEventListener("error",function(){i.img=n,this._imageLoaded()}.bind(this),!1),r.src=t,{img:r,assetData:e});return i},createImageData:function(e){var t=a(e,this.assetsPath,this.path),r=createNS("image"),i=(isSafari?this.testImageLoaded(r):r.addEventListener("load",this._imageLoaded,!1),r.addEventListener("error",function(){i.img=n,this._imageLoaded()}.bind(this),!1),r.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this._elementHelper.append?this._elementHelper.append(r):this._elementHelper.appendChild(r),{img:r,assetData:e});return i},imageLoaded:r,footageLoaded:i,setCacheType:function(e,t){"svg"===e?(this._elementHelper=t,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},s})();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(e,t){if(this._cbs[e])for(var r=this._cbs[e],i=0;i<r.length;i+=1)r[i](t)},addEventListener:function(e,t){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(t),function(){this.removeEventListener(e,t)}.bind(this)},removeEventListener:function(e,t){if(t){if(this._cbs[e]){for(var r=0,i=this._cbs[e].length;r<i;)this._cbs[e][r]===t&&(this._cbs[e].splice(r,1),--r,--i),r+=1;this._cbs[e].length||(this._cbs[e]=null)}}else this._cbs[e]=null}};var markerParser=function(t){for(var e=[],r=0;r<t.length;r+=1){var i=t[r],i={time:i.tm,duration:i.dr};try{i.payload=JSON.parse(t[r].cm)}catch(e){try{i.payload=(e=>{for(var t,r=e.split("\r\n"),i={},n=0,a=0;a<r.length;a+=1)2===(t=r[a].split(":")).length&&(i[t[0]]=t[1].trim(),n+=1);if(0===n)throw new Error;return i})(t[r].cm)}catch(e){i.payload={name:t[r].cm}}}e.push(i)}return e},ProjectInterface=(()=>{function t(e){this.compositions.push(e)}return function(){function e(e){for(var t=0,r=this.compositions.length;t<r;){if(this.compositions[t].data&&this.compositions[t].data.nm===e)return this.compositions[t].prepareFrame&&this.compositions[t].data.xt&&this.compositions[t].prepareFrame(this.currentFrame),this.compositions[t].compInterface;t+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}})(),renderers={},registerRenderer=function(e,t){renderers[e]=t};function getRenderer(e){return renderers[e]}function getRegisteredRenderer(){if(renderers.canvas)return"canvas";for(var e in renderers)if(renderers[e])return e;return""}function _typeof$4(e){return(_typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0),this.expressionsPlugin=getExpressionsPlugin()},animationManager=(extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(e){(e.wrapper||e.container)&&(this.wrapper=e.wrapper||e.container);var t="svg",r=(e.animType?t=e.animType:e.renderer&&(t=e.renderer),getRenderer(t));this.renderer=new r(this,e.rendererSettings),this.imagePreloader.setCacheType(t,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=t,""===e.loop||null==e.loop||!0===e.loop?this.loop=!0:!1===e.loop?this.loop=!1:this.loop=parseInt(e.loop,10),this.autoplay=!("autoplay"in e)||e.autoplay,this.name=e.name||"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(e,"autoloadSegments")||e.autoloadSegments,this.assetsPath=e.assetsPath,this.initialSegment=e.initialSegment,e.audioFactory&&this.audioController.setAudioFactory(e.audioFactory),e.animationData?this.setupAnimation(e.animationData):e.path&&(-1!==e.path.lastIndexOf("\\")?this.path=e.path.substr(0,e.path.lastIndexOf("\\")+1):this.path=e.path.substr(0,e.path.lastIndexOf("/")+1),this.fileName=e.path.substr(e.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(e.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(e){dataManager.completeAnimation(e,this.configAnimation)},AnimationItem.prototype.setData=function(e,t){var t={wrapper:e,animationData:t=t&&"object"!==_typeof$4(t)?JSON.parse(t):t},e=e.attributes,r=(t.path=e.getNamedItem("data-animation-path")?e.getNamedItem("data-animation-path").value:e.getNamedItem("data-bm-path")?e.getNamedItem("data-bm-path").value:e.getNamedItem("bm-path")?e.getNamedItem("bm-path").value:"",t.animType=e.getNamedItem("data-anim-type")?e.getNamedItem("data-anim-type").value:e.getNamedItem("data-bm-type")?e.getNamedItem("data-bm-type").value:e.getNamedItem("bm-type")?e.getNamedItem("bm-type").value:e.getNamedItem("data-bm-renderer")?e.getNamedItem("data-bm-renderer").value:e.getNamedItem("bm-renderer")?e.getNamedItem("bm-renderer").value:getRegisteredRenderer()||"canvas",e.getNamedItem("data-anim-loop")?e.getNamedItem("data-anim-loop").value:e.getNamedItem("data-bm-loop")?e.getNamedItem("data-bm-loop").value:e.getNamedItem("bm-loop")?e.getNamedItem("bm-loop").value:""),r=("false"===r?t.loop=!1:"true"===r?t.loop=!0:""!==r&&(t.loop=parseInt(r,10)),e.getNamedItem("data-anim-autoplay")?e.getNamedItem("data-anim-autoplay").value:e.getNamedItem("data-bm-autoplay")?e.getNamedItem("data-bm-autoplay").value:!e.getNamedItem("bm-autoplay")||e.getNamedItem("bm-autoplay").value);t.autoplay="false"!==r,t.name=e.getNamedItem("data-name")?e.getNamedItem("data-name").value:e.getNamedItem("data-bm-name")?e.getNamedItem("data-bm-name").value:e.getNamedItem("bm-name")?e.getNamedItem("bm-name").value:"","false"===(e.getNamedItem("data-anim-prerender")?e.getNamedItem("data-anim-prerender").value:e.getNamedItem("data-bm-prerender")?e.getNamedItem("data-bm-prerender").value:e.getNamedItem("bm-prerender")?e.getNamedItem("bm-prerender").value:"")&&(t.prerender=!1),t.path?this.setParams(t):this.trigger("destroy")},AnimationItem.prototype.includeLayers=function(e){e.op>this.animationData.op&&(this.animationData.op=e.op,this.totalFrames=Math.floor(e.op-this.animationData.ip));for(var t,r=this.animationData.layers,i=r.length,n=e.layers,a=n.length,s=0;s<a;s+=1)for(t=0;t<i;){if(r[t].id===n[s].id){r[t]=n[s];break}t+=1}if((e.chars||e.fonts)&&(this.renderer.globalData.fontManager.addChars(e.chars),this.renderer.globalData.fontManager.addFonts(e.fonts,this.renderer.globalData.defs)),e.assets)for(i=e.assets.length,t=0;t<i;t+=1)this.animationData.assets.push(e.assets[t]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(e){this.animationData=e;e=getExpressionsPlugin();e&&e.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var e=this.animationData.segments;e&&0!==e.length&&this.autoloadSegments?(e=e.shift(),this.timeCompleted=e.time*this.frameRate,e=this.path+this.fileName+"_"+this.segmentPos+".json",this.segmentPos+=1,dataManager.loadData(e,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))):(this.trigger("data_ready"),this.timeCompleted=this.totalFrames)},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(e){if(this.renderer)try{this.animationData=e,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(e),e.assets||(e.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(e.assets),this.markers=markerParser(e.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(e){this.triggerConfigError(e)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){var e;!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()&&(this.isLoaded=!0,(e=getExpressionsPlugin())&&e.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay)&&this.play()},AnimationItem.prototype.resize=function(e,t){this.renderer.updateContainerSize("number"==typeof e?e:void 0,"number"==typeof t?t:void 0)},AnimationItem.prototype.setSubframe=function(e){this.isSubframeEnabled=!!e},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.expressionsPlugin&&this.expressionsPlugin.resetFrame(),this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(e){this.triggerRenderFrameError(e)}},AnimationItem.prototype.play=function(e){e&&this.name!==e||!0===this.isPaused&&(this.isPaused=!1,this.trigger("_play"),this.audioController.resume(),this._idle)&&(this._idle=!1,this.trigger("_active"))},AnimationItem.prototype.pause=function(e){e&&this.name!==e||!1===this.isPaused&&(this.isPaused=!0,this.trigger("_pause"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(e){e&&this.name!==e||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(e){e&&this.name!==e||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(e){for(var t,r=0;r<this.markers.length;r+=1)if((t=this.markers[r]).payload&&t.payload.name===e)return t;return null},AnimationItem.prototype.goToAndStop=function(e,t,r){r&&this.name!==r||(r=Number(e),isNaN(r)?(r=this.getMarkerData(e))&&this.goToAndStop(r.time,!0):t?this.setCurrentRawFrameValue(e):this.setCurrentRawFrameValue(e*this.frameModifier),this.pause())},AnimationItem.prototype.goToAndPlay=function(e,t,r){var i;r&&this.name!==r||(i=Number(e),isNaN(i)?(e=this.getMarkerData(e))&&(e.duration?this.playSegments([e.time,e.time+e.duration],!0):this.goToAndStop(e.time,!0)):this.goToAndStop(i,t,r),this.play())},AnimationItem.prototype.advanceTime=function(e){var t;!0!==this.isPaused&&!1!==this.isLoaded&&(t=!1,(e=this.currentRawFrame+e*this.frameModifier)>=this.totalFrames-1&&0<this.frameModifier?this.loop&&this.playCount!==this.loop?e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(t=!0,e=this.totalFrames-1):e<0?this.checkSegments(e%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(t=!0,e=0):(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(e),t)&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))},AnimationItem.prototype.adjustSegment=function(e,t){this.playCount=0,e[1]<e[0]?(0<this.frameModifier&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=e[0]-e[1],this.timeCompleted=this.totalFrames,this.firstFrame=e[1],this.setCurrentRawFrameValue(this.totalFrames-.001-t)):e[1]>e[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=e[1]-e[0],this.timeCompleted=this.totalFrames,this.firstFrame=e[0],this.setCurrentRawFrameValue(.001+t)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(e,t){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<e?r=e:this.currentRawFrame+this.firstFrame>t&&(r=t-e)),this.firstFrame=e,this.totalFrames=t-e,this.timeCompleted=this.totalFrames,-1!==r&&this.goToAndStop(r,!0)},AnimationItem.prototype.playSegments=function(e,t){if(t&&(this.segments.length=0),"object"===_typeof$4(e[0]))for(var r=e.length,i=0;i<r;i+=1)this.segments.push(e[i]);else this.segments.push(e);this.segments.length&&t&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(e){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),e&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(e){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),e),!0)},AnimationItem.prototype.destroy=function(e){e&&this.name!==e||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.expressionsPlugin=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(e){this.currentRawFrame=e,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(e){this.playSpeed=e,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(e){this.playDirection=e<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(e){this.loop=e},AnimationItem.prototype.setVolume=function(e,t){t&&this.name!==t||this.audioController.setVolume(e)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(e){e&&this.name!==e||this.audioController.mute()},AnimationItem.prototype.unmute=function(e){e&&this.name!==e||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(e){var t,r="";return r=e.e?e.p:this.assetsPath?(-1!==(t=e.p).indexOf("images/")&&(t=t.split("/")[1]),this.assetsPath+t):(r=this.path,(r+=e.u||"")+e.p)},AnimationItem.prototype.getAssetData=function(e){for(var t=0,r=this.assets.length;t<r;){if(e===this.assets[t].id)return this.assets[t];t+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(e){return e?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(e,t,r){try{this.renderer.getElementByPath(e).updateDocumentData(t,r)}catch(e){}},AnimationItem.prototype.trigger=function(e){if(this._cbs&&this._cbs[e])switch(e){case"enterFrame":this.triggerEvent(e,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(e,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(e,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(e,new BMCompleteEvent(e,this.frameMult));break;case"segmentStart":this.triggerEvent(e,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(e,new BMDestroyEvent(e,this));break;default:this.triggerEvent(e)}"enterFrame"===e&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(e,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===e&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(e,this.loop,this.playCount,this.frameMult)),"complete"===e&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(e,this.frameMult)),"segmentStart"===e&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(e,this.firstFrame,this.totalFrames)),"destroy"===e&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(e,this))},AnimationItem.prototype.triggerRenderFrameError=function(e){e=new BMRenderFrameErrorEvent(e,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},AnimationItem.prototype.triggerConfigError=function(e){e=new BMConfigErrorEvent(e,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},(()=>{var e={},n=[],i=0,a=0,s=0,o=!0,l=!1;function r(e){for(var t=0,r=e.target;t<a;)n[t].animation===r&&(n.splice(t,1),--t,--a,r.isPaused||h()),t+=1}function u(e,t){if(!e)return null;for(var r=0;r<a;){if(n[r].elem===e&&null!==n[r].elem)return n[r].animation;r+=1}var i=new AnimationItem;return d(i,e),i.setData(e,t),i}function c(){s+=1,f()}function h(){--s}function d(e,t){e.addEventListener("destroy",r),e.addEventListener("_active",c),e.addEventListener("_idle",h),n.push({elem:t,animation:e}),a+=1}function p(e){for(var t=e-i,r=0;r<a;r+=1)n[r].animation.advanceTime(t);i=e,s&&!l?window.requestAnimationFrame(p):o=!0}function t(e){i=e,window.requestAnimationFrame(p)}function f(){!l&&s&&o&&(window.requestAnimationFrame(t),o=!1)}return e.registerAnimation=u,e.loadAnimation=function(e){var t=new AnimationItem;return d(t,null),t.setParams(e),t},e.setSpeed=function(e,t){for(var r=0;r<a;r+=1)n[r].animation.setSpeed(e,t)},e.setDirection=function(e,t){for(var r=0;r<a;r+=1)n[r].animation.setDirection(e,t)},e.play=function(e){for(var t=0;t<a;t+=1)n[t].animation.play(e)},e.pause=function(e){for(var t=0;t<a;t+=1)n[t].animation.pause(e)},e.stop=function(e){for(var t=0;t<a;t+=1)n[t].animation.stop(e)},e.togglePause=function(e){for(var t=0;t<a;t+=1)n[t].animation.togglePause(e)},e.searchAnimations=function(e,t,r){for(var i,n=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),a=n.length,s=0;s<a;s+=1)r&&n[s].setAttribute("data-bm-type",r),u(n[s],e);t&&0===a&&(r=r||"svg",(t=document.getElementsByTagName("body")[0]).innerText="",(i=createTag("div")).style.width="100%",i.style.height="100%",i.setAttribute("data-bm-type",r),t.appendChild(i),u(i,e))},e.resize=function(){for(var e=0;e<a;e+=1)n[e].animation.resize()},e.goToAndStop=function(e,t,r){for(var i=0;i<a;i+=1)n[i].animation.goToAndStop(e,t,r)},e.destroy=function(e){for(var t=a-1;0<=t;--t)n[t].animation.destroy(e)},e.freeze=function(){l=!0},e.unfreeze=function(){l=!1,f()},e.setVolume=function(e,t){for(var r=0;r<a;r+=1)n[r].animation.setVolume(e,t)},e.mute=function(e){for(var t=0;t<a;t+=1)n[t].animation.mute(e)},e.unmute=function(e){for(var t=0;t<a;t+=1)n[t].animation.unmute(e)},e.getRegisteredAnimations=function(){for(var e=n.length,t=[],r=0;r<e;r+=1)t.push(n[r].animation);return t},e})()),BezierFactory=(()=>{var e={getBezierEasing:function(e,t,r,i,n){n=n||("bez_"+e+"_"+t+"_"+r+"_"+i).replace(/\./g,"p");if(a[n])return a[n];e=new s([e,t,r,i]);return a[n]=e}},a={},T=11,E=1/(T-1),t="function"==typeof Float32Array;function i(e,t){return 1-3*t+3*e}function C(e,t,r){return((i(t,r)*e+(3*r-6*t))*e+3*t)*e}function A(e,t,r){return 3*i(t,r)*e*e+2*(3*r-6*t)*e+3*t}function s(e){this._p=e,this._mSampleValues=new(t?Float32Array:Array)(T),this._precomputed=!1,this.get=this.get.bind(this)}return s.prototype={get:function(e){var t=this._p[0],r=this._p[1],i=this._p[2],n=this._p[3];return this._precomputed||this._precompute(),t===r&&i===n?e:0===e?0:1===e?1:C(this._getTForX(e),r,n)},_precompute:function(){var e=this._p[0],t=this._p[1],r=this._p[2],i=this._p[3];this._precomputed=!0,e===t&&r===i||this._calcSampleValues()},_calcSampleValues:function(){for(var e=this._p[0],t=this._p[2],r=0;r<T;++r)this._mSampleValues[r]=C(r*E,e,t)},_getTForX:function(e){for(var t=this._p[0],r=this._p[2],i=this._mSampleValues,n=0,a=1,s=T-1;a!==s&&i[a]<=e;++a)n+=E;var o=n+(e-i[--a])/(i[a+1]-i[a])*E,l=A(o,t,r);if(.001<=l){for(var u=e,c=o,h=t,d=r,p=0;p<4;++p){var f=A(c,h,d);if(0===f)return c;c-=(C(c,h,d)-u)/f}return c}if(0===l)return o;for(var m,g,v=e,y=n,_=n+E,b=t,x=r,S=0;0<(m=C(g=y+(_-y)/2,b,x)-v)?_=g:y=g,1e-7<Math.abs(m)&&++S<10;);return g}},e})(),pooling={double:function(e){return e.concat(createSizedArray(e.length))}},poolFactory=function(e,t,r){var i=0,n=e,a=createSizedArray(n);return{newElement:function(){var e;e=i?a[--i]:t();return e},release:function(e){i===n&&(a=pooling.double(a),n*=2);r&&r(e);a[i]=e,i+=1}}},bezierLengthPool=poolFactory(8,function(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}),segmentsLengthPool=poolFactory(8,function(){return{lengths:[],totalLength:0}},function(e){for(var t=e.lengths.length,r=0;r<t;r+=1)bezierLengthPool.release(e.lengths[r]);e.lengths.length=0});function bezFunction(){var A=Math;function g(e,t,r,i,n,a){n=e*i+t*n+r*a-n*i-a*e-r*t;return-.001<n&&n<.001}var c=function(e,t,r,i){for(var n,a,s,o,l=getDefaultCurveSegments(),u=0,c=[],h=[],d=bezierLengthPool.newElement(),p=r.length,f=0;f<l;f+=1){for(s=f/(l-1),n=o=0;n<p;n+=1)a=bmPow(1-s,3)*e[n]+3*bmPow(1-s,2)*s*r[n]+3*(1-s)*bmPow(s,2)*i[n]+bmPow(s,3)*t[n],c[n]=a,null!==h[n]&&(o+=bmPow(c[n]-h[n],2)),h[n]=c[n];o&&(u+=o=bmSqrt(o)),d.percents[f]=s,d.lengths[f]=u}return d.addedLength=u,d};function v(e){this.segmentLength=0,this.points=new Array(e)}function y(e,t){this.partialLength=e,this.point=t}function e(e,t,r,i){var n=(e[0]+"_"+e[1]+"_"+t[0]+"_"+t[1]+"_"+r[0]+"_"+r[1]+"_"+i[0]+"_"+i[1]).replace(/\./g,"p");if(!_[n]){for(var a,s,o,l,u,c=getDefaultCurveSegments(),h=0,d=null,p=new v(c=2===e.length&&(e[0]!==t[0]||e[1]!==t[1])&&g(e[0],e[1],t[0],t[1],e[0]+r[0],e[1]+r[1])&&g(e[0],e[1],t[0],t[1],t[0]+i[0],t[1]+i[1])?2:c),f=r.length,m=0;m<c;m+=1){for(u=createSizedArray(f),o=m/(c-1),a=l=0;a<f;a+=1)s=bmPow(1-o,3)*e[a]+3*bmPow(1-o,2)*o*(e[a]+r[a])+3*(1-o)*bmPow(o,2)*(t[a]+i[a])+bmPow(o,3)*t[a],u[a]=s,null!==d&&(l+=bmPow(u[a]-d[a],2));h+=l=bmSqrt(l),p.points[m]=new y(l,u),d=u}p.segmentLength=h,_[n]=p}return _[n]}var _;_={};function w(e,t){var r=t.percents,i=t.lengths,n=r.length,a=bmFloor((n-1)*e),s=e*t.addedLength,o=0;if(a===n-1||0===a||s===i[a])return r[a];for(var l=i[a]>s?-1:1,u=!0;u;)if(i[a]<=s&&i[a+1]>s?(o=(s-i[a])/(i[a+1]-i[a]),u=!1):a+=l,a<0||n-1<=a){if(a===n-1)return r[a];u=!1}return r[a]+(r[a+1]-r[a])*o}var P=createTypedArray("float32",8);return{getSegmentsLength:function(e){for(var t=segmentsLengthPool.newElement(),r=e.c,i=e.v,n=e.o,a=e.i,s=e._length,o=t.lengths,l=0,u=0;u<s-1;u+=1)o[u]=c(i[u],i[u+1],n[u],a[u+1]),l+=o[u].addedLength;return r&&s&&(o[u]=c(i[u],i[0],n[u],a[0]),l+=o[u].addedLength),t.totalLength=l,t},getNewSegment:function(e,t,r,i,n,a,s){n<0?n=0:1<n&&(n=1);for(var n=w(n,s),a=w(a=1<a?1:a,s),o=e.length,l=1-a,u=(s=1-n)*s*s,c=n*s*s*3,h=n*n*s*3,d=n*n*n,p=s*s*l,f=n*s*l+s*n*l+s*s*a,m=n*n*l+s*n*a+n*s*a,g=n*n*a,v=s*l*l,y=n*l*l+s*a*l+s*l*a,_=n*a*l+s*a*a+n*l*a,b=n*a*a,x=l*l*l,S=a*l*l+l*a*l+l*l*a,T=a*a*l+l*a*a+a*l*a,E=a*a*a,C=0;C<o;C+=1)P[4*C]=A.round(1e3*(u*e[C]+c*r[C]+h*i[C]+d*t[C]))/1e3,P[4*C+1]=A.round(1e3*(p*e[C]+f*r[C]+m*i[C]+g*t[C]))/1e3,P[4*C+2]=A.round(1e3*(v*e[C]+y*r[C]+_*i[C]+b*t[C]))/1e3,P[4*C+3]=A.round(1e3*(x*e[C]+S*r[C]+T*i[C]+E*t[C]))/1e3;return P},getPointInSegment:function(e,t,r,i,n,a){return n=w(n,a),a=1-n,[A.round(1e3*(a*a*a*e[0]+(n*a*a+a*n*a+a*a*n)*r[0]+(n*n*a+a*n*n+n*a*n)*i[0]+n*n*n*t[0]))/1e3,A.round(1e3*(a*a*a*e[1]+(n*a*a+a*n*a+a*a*n)*r[1]+(n*n*a+a*n*n+n*a*n)*i[1]+n*n*n*t[1]))/1e3]},buildBezierData:e,pointOnLine2D:g,pointOnLine3D:function(e,t,r,i,n,a,s,o,l){var u;return 0===r&&0===a&&0===l?g(e,t,i,n,s,o):(u=A.sqrt(A.pow(i-e,2)+A.pow(n-t,2)+A.pow(a-r,2)),e=A.sqrt(A.pow(s-e,2)+A.pow(o-t,2)+A.pow(l-r,2)),t=A.sqrt(A.pow(s-i,2)+A.pow(o-n,2)+A.pow(l-a,2)),-1e-4<(r=e<u?t<u?u-e-t:t-e-u:e<t?t-e-u:e-u-t)&&r<1e-4)}}}var bez=bezFunction(),initFrame=initialDefaultFrame,mathAbs=Math.abs;function interpolateValue(e,t){for(var r,i,n,a,s=this.offsetTime,o=("multidimensional"===this.propType&&(r=createTypedArray("float32",this.pv.length)),t.lastIndex),l=o,u=this.keyframes.length-1,c=!0;c;){if(i=this.keyframes[l],n=this.keyframes[l+1],l===u-1&&e>=n.t-s){i.h&&(i=n),o=0;break}if(n.t-s>e){o=l;break}l<u-1?l+=1:(o=0,c=!1)}var h=this.keyframesMetadata[l]||{},d=n.t-s,p=i.t-s;if(i.to){h.bezierData||(h.bezierData=bez.buildBezierData(i.s,n.s||i.e,i.to,i.ti));var f=h.bezierData;if(d<=e||e<p)for(var m=d<=e?f.points.length-1:0,g=f.points[m].point.length,v=0;v<g;v+=1)r[v]=f.points[m].point[v];else{h.__fnct?a=h.__fnct:(a=BezierFactory.getBezierEasing(i.o.x,i.o.y,i.i.x,i.i.y,i.n).get,h.__fnct=a);for(var y,_=a((e-p)/(d-p)),b=f.segmentLength*_,x=t.lastFrame<e&&t._lastKeyframeIndex===l?t._lastAddedLength:0,S=t.lastFrame<e&&t._lastKeyframeIndex===l?t._lastPoint:0,c=!0,T=f.points.length;c;){if(x+=f.points[S].partialLength,0==b||0===_||S===f.points.length-1){for(g=f.points[S].point.length,v=0;v<g;v+=1)r[v]=f.points[S].point[v];break}if(x<=b&&b<x+f.points[S+1].partialLength){for(y=(b-x)/f.points[S+1].partialLength,g=f.points[S].point.length,v=0;v<g;v+=1)r[v]=f.points[S].point[v]+(f.points[S+1].point[v]-f.points[S].point[v])*y;break}S<T-1?S+=1:c=!1}t._lastPoint=S,t._lastAddedLength=x-f.points[S].partialLength,t._lastKeyframeIndex=l}}else{var E,C,A,w,P,u=i.s.length,M=n.s||i.e;if(this.sh&&1!==i.h)d<=e?(r[0]=M[0],r[1]=M[1],r[2]=M[2]):e<=p?(r[0]=i.s[0],r[1]=i.s[1],r[2]=i.s[2]):quaternionToEuler(r,slerp(createQuaternion(i.s),createQuaternion(M),(e-p)/(d-p)));else for(l=0;l<u;l+=1)1!==i.h&&(_=d<=e?1:e<p?0:(i.o.x.constructor===Array?(h.__fnct||(h.__fnct=[]),h.__fnct[l]?a=h.__fnct[l]:(E=void 0===i.o.x[l]?i.o.x[0]:i.o.x[l],C=void 0===i.o.y[l]?i.o.y[0]:i.o.y[l],A=void 0===i.i.x[l]?i.i.x[0]:i.i.x[l],w=void 0===i.i.y[l]?i.i.y[0]:i.i.y[l],a=BezierFactory.getBezierEasing(E,C,A,w).get,h.__fnct[l]=a)):h.__fnct?a=h.__fnct:(E=i.o.x,C=i.o.y,A=i.i.x,w=i.i.y,a=BezierFactory.getBezierEasing(E,C,A,w).get,i.keyframeMetadata=a),a((e-p)/(d-p)))),M=n.s||i.e,P=1===i.h?i.s[l]:i.s[l]+(M[l]-i.s[l])*_,"multidimensional"===this.propType?r[l]=P:r=P}return t.lastIndex=o,r}function slerp(e,t,r){var i,n,a=[],s=e[0],o=e[1],l=e[2],e=e[3],u=t[0],c=t[1],h=t[2],t=t[3],d=s*u+o*c+l*h+e*t;return d<0&&(d=-d,u=-u,c=-c,h=-h,t=-t),d=1e-6<1-d?(d=Math.acos(d),i=Math.sin(d),n=Math.sin((1-r)*d)/i,Math.sin(r*d)/i):(n=1-r,r),a[0]=n*s+d*u,a[1]=n*o+d*c,a[2]=n*l+d*h,a[3]=n*e+d*t,a}function quaternionToEuler(e,t){var r=t[0],i=t[1],n=t[2],t=t[3],a=Math.atan2(2*i*t-2*r*n,1-2*i*i-2*n*n),s=Math.asin(2*r*i+2*n*t),t=Math.atan2(2*r*t-2*i*n,1-2*r*r-2*n*n);e[0]=a/degToRads,e[1]=s/degToRads,e[2]=t/degToRads}function createQuaternion(e){var t=e[0]*degToRads,r=e[1]*degToRads,e=e[2]*degToRads,i=Math.cos(t/2),n=Math.cos(r/2),a=Math.cos(e/2),t=Math.sin(t/2),r=Math.sin(r/2),e=Math.sin(e/2);return[t*r*a+i*n*e,t*n*a+i*r*e,i*r*a-t*n*e,i*n*a-t*r*e]}function getValueAtCurrentTime(){var e=this.comp.renderedFrame-this.offsetTime,t=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime;return e===this._caching.lastFrame||this._caching.lastFrame!==initFrame&&(this._caching.lastFrame>=r&&r<=e||this._caching.lastFrame<t&&e<t)||(this._caching.lastFrame>=e&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0),r=this.interpolateValue(e,this._caching),this.pv=r),this._caching.lastFrame=e,this.pv}function setVValue(e){var t;if("unidimensional"===this.propType)t=e*this.mult,1e-5<mathAbs(this.v-t)&&(this.v=t,this._mdf=!0);else for(var r=0,i=this.v.length;r<i;)t=e[r]*this.mult,1e-5<mathAbs(this.v[r]-t)&&(this.v[r]=t,this._mdf=!0),r+=1}function processEffectsSequence(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{this.lock=!0,this._mdf=this._isFirstFrame;for(var e=this.effectsSequence.length,t=this.kf?this.pv:this.data.k,r=0;r<e;r+=1)t=this.effectsSequence[r](t);this.setVValue(t),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function addEffect(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function ValueProperty(e,t,r,i){this.propType="unidimensional",this.mult=r||1,this.data=t,this.v=r?t.k*r:t.k,this.pv=t.k,this._mdf=!1,this.elem=e,this.container=i,this.comp=e.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function MultiDimensionalProperty(e,t,r,i){this.propType="multidimensional",this.mult=r||1,this.data=t,this._mdf=!1,this.elem=e,this.container=i,this.comp=e.comp,this.k=!1,this.kf=!1,this.frameId=-1;var n,a=t.k.length;for(this.v=createTypedArray("float32",a),this.pv=createTypedArray("float32",a),this.vel=createTypedArray("float32",a),n=0;n<a;n+=1)this.v[n]=t.k[n]*this.mult,this.pv[n]=t.k[n];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=processEffectsSequence,this.setVValue=setVValue,this.addEffect=addEffect}function KeyframedValueProperty(e,t,r,i){this.propType="unidimensional",this.keyframes=t.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:initFrame,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=t,this.mult=r||1,this.elem=e,this.container=i,this.comp=e.comp,this.v=initFrame,this.pv=initFrame,this._isFirstFrame=!0,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.addEffect=addEffect}function KeyframedMultidimensionalProperty(e,t,r,i){this.propType="multidimensional";for(var n,a,s,o,l=t.k.length,u=0;u<l-1;u+=1)t.k[u].to&&t.k[u].s&&t.k[u+1]&&t.k[u+1].s&&(n=t.k[u].s,a=t.k[u+1].s,s=t.k[u].to,o=t.k[u].ti,(2===n.length&&(n[0]!==a[0]||n[1]!==a[1])&&bez.pointOnLine2D(n[0],n[1],a[0],a[1],n[0]+s[0],n[1]+s[1])&&bez.pointOnLine2D(n[0],n[1],a[0],a[1],a[0]+o[0],a[1]+o[1])||3===n.length&&(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2])&&bez.pointOnLine3D(n[0],n[1],n[2],a[0],a[1],a[2],n[0]+s[0],n[1]+s[1],n[2]+s[2])&&bez.pointOnLine3D(n[0],n[1],n[2],a[0],a[1],a[2],a[0]+o[0],a[1]+o[1],a[2]+o[2]))&&(t.k[u].to=null,t.k[u].ti=null),n[0]===a[0])&&n[1]===a[1]&&0===s[0]&&0===s[1]&&0===o[0]&&0===o[1]&&(2===n.length||n[2]===a[2]&&0===s[2]&&0===o[2])&&(t.k[u].to=null,t.k[u].ti=null);this.effectsSequence=[getValueAtCurrentTime.bind(this)],this.data=t,this.keyframes=t.k,this.keyframesMetadata=[],this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=r||1,this.elem=e,this.container=i,this.comp=e.comp,this.getValue=processEffectsSequence,this.setVValue=setVValue,this.interpolateValue=interpolateValue,this.frameId=-1;var c=t.k[0].s.length;for(this.v=createTypedArray("float32",c),this.pv=createTypedArray("float32",c),u=0;u<c;u+=1)this.v[u]=initFrame,this.pv[u]=initFrame;this._caching={lastFrame:initFrame,lastIndex:0,value:createTypedArray("float32",c)},this.addEffect=addEffect}var PropertyFactory={getProp:function(e,t,r,i,n){var a;if((t=t.sid?e.globalData.slotManager.getProp(t):t).k.length)if("number"==typeof t.k[0])a=new MultiDimensionalProperty(e,t,i,n);else switch(r){case 0:a=new KeyframedValueProperty(e,t,i,n);break;case 1:a=new KeyframedMultidimensionalProperty(e,t,i,n)}else a=new ValueProperty(e,t,i,n);return a.effectsSequence.length&&n.addDynamicProperty(a),a}};function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;for(var e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=poolFactory(8,function(){return createTypedArray("float32",2)});function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(e,t){this.c=e,this.setLength(t);for(var r=0;r<t;)this.v[r]=pointPool.newElement(),this.o[r]=pointPool.newElement(),this.i[r]=pointPool.newElement(),r+=1},ShapePath.prototype.setLength=function(e){for(;this._maxLength<e;)this.doubleArrayLength();this._length=e},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(e,t,r,i,n){var a;switch(this._length=Math.max(this._length,i+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":a=this.v;break;case"i":a=this.i;break;case"o":a=this.o;break;default:a=[]}a[i]&&(a[i],n)||(a[i]=pointPool.newElement()),a[i][0]=e,a[i][1]=t},ShapePath.prototype.setTripleAt=function(e,t,r,i,n,a,s,o){this.setXYAt(e,t,"v",s,o),this.setXYAt(r,i,"o",s,o),this.setXYAt(n,a,"i",s,o)},ShapePath.prototype.reverse=function(){for(var e=new ShapePath,t=(e.setPathData(this.c,this._length),this.v),r=this.o,i=this.i,n=0,a=(this.c&&(e.setTripleAt(t[0][0],t[0][1],i[0][0],i[0][1],r[0][0],r[0][1],0,!1),n=1),this._length-1),s=this._length,o=n;o<s;o+=1)e.setTripleAt(t[a][0],t[a][1],i[a][0],i[a][1],r[a][0],r[a][1],o,!1),--a;return e},ShapePath.prototype.length=function(){return this._length};var shapePool=(()=>{var n=poolFactory(4,function(){return new ShapePath},function(e){for(var t=e._length,r=0;r<t;r+=1)pointPool.release(e.v[r]),pointPool.release(e.i[r]),pointPool.release(e.o[r]),e.v[r]=null,e.i[r]=null,e.o[r]=null;e._length=0,e.c=!1});return n.clone=function(e){var t,r=n.newElement(),i=void 0===e._length?e.v.length:e._length;for(r.setLength(i),r.c=e.c,t=0;t<i;t+=1)r.setTripleAt(e.v[t][0],e.v[t][1],e.o[t][0],e.o[t][1],e.i[t][0],e.i[t][1],t);return r},n})();function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(e){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=e,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){for(var e=0;e<this._length;e+=1)shapePool.release(this.shapes[e]);this._length=0};var shapeCollectionPool=(()=>{var e={newShapeCollection:function(){var e;e=i?a[--i]:new ShapeCollection;return e},release:function(e){var t,r=e._length;for(t=0;t<r;t+=1)shapePool.release(e.shapes[t]);e._length=0,i===n&&(a=pooling.double(a),n*=2);a[i]=e,i+=1}},i=0,n=4,a=createSizedArray(n);return e})(),ShapePropertyFactory=(()=>{var n=-999999;function e(e,t,r){var i,n,a,s,o,l,u,c=r.lastIndex,h=this.keyframes;if(e<h[0].t-this.offsetTime)i=h[0].s[0],n=!0,c=0;else if(e>=h[h.length-1].t-this.offsetTime)i=(h[h.length-1].s?h[h.length-1].s:h[h.length-2].e)[0],n=!0;else{for(var d,p,f,m,g,v,y=c,_=h.length-1,b=!0;b&&(d=h[y],!((p=h[y+1]).t-this.offsetTime>e));)y<_-1?y+=1:b=!1;f=this.keyframesMetadata[y]||{},c=y,(n=1===d.h)||(g=e>=p.t-this.offsetTime?1:e<d.t-this.offsetTime?0:(f.__fnct?m=f.__fnct:(m=BezierFactory.getBezierEasing(d.o.x,d.o.y,d.i.x,d.i.y).get,f.__fnct=m),m((e-(d.t-this.offsetTime))/(p.t-this.offsetTime-(d.t-this.offsetTime)))),v=(p.s||d.e)[0]),i=d.s[0]}for(o=t._length,l=i.i[0].length,r.lastIndex=c,a=0;a<o;a+=1)for(s=0;s<l;s+=1)u=n?i.i[a][s]:i.i[a][s]+(v.i[a][s]-i.i[a][s])*g,t.i[a][s]=u,u=n?i.o[a][s]:i.o[a][s]+(v.o[a][s]-i.o[a][s])*g,t.o[a][s]=u,u=n?i.v[a][s]:i.v[a][s]+(v.v[a][s]-i.v[a][s])*g,t.v[a][s]=u}function i(){this.paths=this.localShapeCollection}function t(e){((e,t)=>{if(e._length===t._length&&e.c===t.c){for(var r=e._length,i=0;i<r;i+=1)if(e.v[i][0]!==t.v[i][0]||e.v[i][1]!==t.v[i][1]||e.o[i][0]!==t.o[i][0]||e.o[i][1]!==t.o[i][1]||e.i[i][0]!==t.i[i][0]||e.i[i][1]!==t.i[i][1])return;return 1}})(this.v,e)||(this.v=shapePool.clone(e),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function r(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{this.lock=!0,this._mdf=!1,e=this.kf?this.pv:(this.data.ks||this.data.pt).k;for(var e,t=this.effectsSequence.length,r=0;r<t;r+=1)e=this.effectsSequence[r](e);this.setVValue(e),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function a(e,t,r){this.propType="shape",this.comp=e.comp,this.container=e,this.elem=e,this.data=t,this.k=!1,this.kf=!1,this._mdf=!1;e=(3===r?t.pt:t.ks).k;this.v=shapePool.clone(e),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=i,this.effectsSequence=[]}function s(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function o(e,t,r){this.propType="shape",this.comp=e.comp,this.elem=e,this.container=e,this.offsetTime=e.data.st,this.keyframes=(3===r?t.pt:t.ks).k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;e=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,e),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=n,this.reset=i,this._caching={lastFrame:n,lastIndex:0},this.effectsSequence=[function(){var e=this.comp.renderedFrame-this.offsetTime,t=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime,i=this._caching.lastFrame;return i!==n&&(i<t&&e<t||r<i&&r<e)||(this._caching.lastIndex=i<e?this._caching.lastIndex:0,this.interpolateShape(e,this.pv,this._caching)),this._caching.lastFrame=e,this.pv}.bind(this)]}a.prototype.interpolateShape=e,a.prototype.getValue=r,a.prototype.setVValue=t,a.prototype.addEffect=s,o.prototype.getValue=r,o.prototype.interpolateShape=e,o.prototype.setVValue=t,o.prototype.addEffect=s,l=roundCorner,c.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf)&&this.convertEllToPath()},convertEllToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,i=this.s.v[1]/2,n=3!==this.d,a=this.v;a.v[0][0]=e,a.v[0][1]=t-i,a.v[1][0]=n?e+r:e-r,a.v[1][1]=t,a.v[2][0]=e,a.v[2][1]=t+i,a.v[3][0]=n?e-r:e+r,a.v[3][1]=t,a.i[0][0]=n?e-r*l:e+r*l,a.i[0][1]=t-i,a.i[1][0]=n?e+r:e-r,a.i[1][1]=t-i*l,a.i[2][0]=n?e+r*l:e-r*l,a.i[2][1]=t+i,a.i[3][0]=n?e-r:e+r,a.i[3][1]=t+i*l,a.o[0][0]=n?e+r*l:e-r*l,a.o[0][1]=t-i,a.o[1][0]=n?e+r:e-r,a.o[1][1]=t+i*l,a.o[2][0]=n?e-r*l:e+r*l,a.o[2][1]=t+i,a.o[3][0]=n?e-r:e+r,a.o[3][1]=t-i*l}},extendPrototype([DynamicPropertyContainer],c);var l,u=c;function c(e,t){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=t.d,this.elem=e,this.comp=e.comp,this.frameId=-1,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}d.prototype={reset:i,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf)&&this.convertToPath()},convertStarToPath:function(){for(var e=2*Math.floor(this.pt.v),t=2*Math.PI/e,r=!0,i=this.or.v,n=this.ir.v,a=this.os.v,s=this.is.v,o=2*Math.PI*i/(2*e),l=2*Math.PI*n/(2*e),u=-Math.PI/2,c=(u+=this.r.v,3===this.data.d?-1:1),h=this.v._length=0;h<e;h+=1){var d=r?a:s,p=r?o:l,f=(m=r?i:n)*Math.cos(u),m=m*Math.sin(u),g=0==f&&0==m?0:m/Math.sqrt(f*f+m*m),v=0==f&&0==m?0:-f/Math.sqrt(f*f+m*m);f+=+this.p.v[0],m+=+this.p.v[1],this.v.setTripleAt(f,m,f-g*p*d*c,m-v*p*d*c,f+g*p*d*c,m+v*p*d*c,h,!0),r=!r,u+=t*c}},convertPolygonToPath:function(){var e,t=Math.floor(this.pt.v),r=2*Math.PI/t,i=this.or.v,n=this.os.v,a=2*Math.PI*i/(4*t),s=.5*-Math.PI,o=3===this.data.d?-1:1;for(s+=this.r.v,e=this.v._length=0;e<t;e+=1){var l=i*Math.cos(s),u=i*Math.sin(s),c=0==l&&0==u?0:u/Math.sqrt(l*l+u*u),h=0==l&&0==u?0:-l/Math.sqrt(l*l+u*u);l+=+this.p.v[0],u+=+this.p.v[1],this.v.setTripleAt(l,u,l-c*a*n*o,u-h*a*n*o,l+c*a*n*o,u+h*a*n*o,e,!0),s+=r*o}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],d);var h=d;function d(e,t){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=e,this.comp=e.comp,this.data=t,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),1===t.sy?(this.ir=PropertyFactory.getProp(e,t.ir,0,0,this),this.is=PropertyFactory.getProp(e,t.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(e,t.pt,0,0,this),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,degToRads,this),this.or=PropertyFactory.getProp(e,t.or,0,0,this),this.os=PropertyFactory.getProp(e,t.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}f.prototype={convertRectToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,i=this.s.v[1]/2,n=bmMin(r,i,this.r.v),a=n*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(e+r,t-i+n,e+r,t-i+n,e+r,t-i+a,0,!0),this.v.setTripleAt(e+r,t+i-n,e+r,t+i-a,e+r,t+i-n,1,!0),0!==n?(this.v.setTripleAt(e+r-n,t+i,e+r-n,t+i,e+r-a,t+i,2,!0),this.v.setTripleAt(e-r+n,t+i,e-r+a,t+i,e-r+n,t+i,3,!0),this.v.setTripleAt(e-r,t+i-n,e-r,t+i-n,e-r,t+i-a,4,!0),this.v.setTripleAt(e-r,t-i+n,e-r,t-i+a,e-r,t-i+n,5,!0),this.v.setTripleAt(e-r+n,t-i,e-r+n,t-i,e-r+a,t-i,6,!0),this.v.setTripleAt(e+r-n,t-i,e+r-a,t-i,e+r-n,t-i,7,!0)):(this.v.setTripleAt(e-r,t+i,e-r+a,t+i,e-r,t+i,2),this.v.setTripleAt(e-r,t-i,e-r,t-i+a,e-r,t-i,3))):(this.v.setTripleAt(e+r,t-i+n,e+r,t-i+a,e+r,t-i+n,0,!0),0!==n?(this.v.setTripleAt(e+r-n,t-i,e+r-n,t-i,e+r-a,t-i,1,!0),this.v.setTripleAt(e-r+n,t-i,e-r+a,t-i,e-r+n,t-i,2,!0),this.v.setTripleAt(e-r,t-i+n,e-r,t-i+n,e-r,t-i+a,3,!0),this.v.setTripleAt(e-r,t+i-n,e-r,t+i-a,e-r,t+i-n,4,!0),this.v.setTripleAt(e-r+n,t+i,e-r+n,t+i,e-r+a,t+i,5,!0),this.v.setTripleAt(e+r-n,t+i,e+r-a,t+i,e+r-n,t+i,6,!0),this.v.setTripleAt(e+r,t+i-n,e+r,t+i-n,e+r,t+i-a,7,!0)):(this.v.setTripleAt(e-r,t-i,e-r+a,t-i,e-r,t-i,1,!0),this.v.setTripleAt(e-r,t+i,e-r,t+i-a,e-r,t+i,2,!0),this.v.setTripleAt(e+r,t+i,e+r-a,t+i,e+r,t+i,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf)&&this.convertRectToPath()},reset:i},extendPrototype([DynamicPropertyContainer],f);var p=f;function f(e,t){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=e,this.comp=e.comp,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),this.p=PropertyFactory.getProp(e,t.p,1,0,this),this.s=PropertyFactory.getProp(e,t.s,1,0,this),this.r=PropertyFactory.getProp(e,t.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}var m={getShapeProp:function(e,t,r){var i;return 3===r||4===r?i=new((3===r?t.pt:t.ks).k.length?o:a)(e,t,r):5===r?i=new p(e,t):6===r?i=new u(e,t):7===r&&(i=new h(e,t)),i.k&&e.addDynamicProperty(i),i},getConstructorFunction:function(){return a},getKeyframedConstructorFunction:function(){return o}};return m})(),Matrix=(()=>{var i=Math.cos,n=Math.sin,a=Math.tan,s=Math.round;function e(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function t(e){var t;return 0===e?this:(t=i(e),e=n(e),this._t(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1))}function r(e){var t;return 0===e?this:(t=i(e),e=n(e),this._t(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1))}function o(e){var t;return 0===e?this:(t=i(e),e=n(e),this._t(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1))}function l(e){var t;return 0===e?this:(t=i(e),e=n(e),this._t(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1))}function u(e,t){return this._t(1,t,e,1,0,0)}function c(e,t){return this.shear(a(e),a(t))}function h(e,t){var r=i(t),t=n(t);return this._t(r,t,0,0,-t,r,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,a(e),1,0,0,0,0,1,0,0,0,0,1)._t(r,-t,0,0,t,r,0,0,0,0,1,0,0,0,0,1)}function d(e,t,r){return r||0===r||(r=1),1===e&&1===t&&1===r?this:this._t(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1)}function p(e,t,r,i,n,a,s,o,l,u,c,h,d,p,f,m){return this.props[0]=e,this.props[1]=t,this.props[2]=r,this.props[3]=i,this.props[4]=n,this.props[5]=a,this.props[6]=s,this.props[7]=o,this.props[8]=l,this.props[9]=u,this.props[10]=c,this.props[11]=h,this.props[12]=d,this.props[13]=p,this.props[14]=f,this.props[15]=m,this}function f(e,t,r){return r=r||0,0!==e||0!==t||0!==r?this._t(1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1):this}function m(e,t,r,i,n,a,s,o,l,u,c,h,d,p,f,m){var g,v,y,_,b,x,S,T,E,C,A,w,P,M,I,D,R=this.props;return 1===e&&0===t&&0===r&&0===i&&0===n&&1===a&&0===s&&0===o&&0===l&&0===u&&1===c&&0===h?(R[12]=R[12]*e+R[15]*d,R[13]=R[13]*a+R[15]*p,R[14]=R[14]*c+R[15]*f,R[15]*=m,this._identityCalculated=!1):(g=R[0],b=R[4],x=R[5],S=R[6],T=R[7],E=R[8],C=R[9],A=R[10],w=R[11],P=R[12],M=R[13],I=R[14],D=R[15],R[0]=g*e+(v=R[1])*n+(y=R[2])*l+(_=R[3])*d,R[1]=g*t+v*a+y*u+_*p,R[2]=g*r+v*s+y*c+_*f,R[3]=g*i+v*o+y*h+_*m,R[4]=b*e+x*n+S*l+T*d,R[5]=b*t+x*a+S*u+T*p,R[6]=b*r+x*s+S*c+T*f,R[7]=b*i+x*o+S*h+T*m,R[8]=E*e+C*n+A*l+w*d,R[9]=E*t+C*a+A*u+w*p,R[10]=E*r+C*s+A*c+w*f,R[11]=E*i+C*o+A*h+w*m,R[12]=P*e+M*n+I*l+D*d,R[13]=P*t+M*a+I*u+D*p,R[14]=P*r+M*s+I*c+D*f,R[15]=P*i+M*o+I*h+D*m,this._identityCalculated=!1),this}function g(e){e=e.props;return this.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function v(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function y(e){for(var t=0;t<16;){if(e.props[t]!==this.props[t])return!1;t+=1}return!0}function _(e){for(var t=0;t<16;t+=1)e.props[t]=this.props[t];return e}function b(e){for(var t=0;t<16;t+=1)this.props[t]=e[t]}function x(e,t,r){return{x:e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],y:e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],z:e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}}function S(e,t,r){return e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12]}function T(e,t,r){return e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13]}function E(e,t,r){return e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}function C(){var e=this.props[0]*this.props[5]-this.props[1]*this.props[4],t=this.props[5]/e,r=-this.props[1]/e,i=-this.props[4]/e,n=this.props[0]/e,a=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/e,e=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/e,s=new Matrix;return s.props[0]=t,s.props[1]=r,s.props[4]=i,s.props[5]=n,s.props[12]=a,s.props[13]=e,s}function A(e){return this.getInverseMatrix().applyToPointArray(e[0],e[1],e[2]||0)}function w(e){for(var t=e.length,r=[],i=0;i<t;i+=1)r[i]=A(e[i]);return r}function P(e,t,r){var i,n,a,s,o,l,u=createTypedArray("float32",6);return this.isIdentity()?(u[0]=e[0],u[1]=e[1],u[2]=t[0],u[3]=t[1],u[4]=r[0],u[5]=r[1]):(i=this.props[0],n=this.props[1],a=this.props[4],s=this.props[5],o=this.props[12],l=this.props[13],u[0]=e[0]*i+e[1]*a+o,u[1]=e[0]*n+e[1]*s+l,u[2]=t[0]*i+t[1]*a+o,u[3]=t[0]*n+t[1]*s+l,u[4]=r[0]*i+r[1]*a+o,u[5]=r[0]*n+r[1]*s+l),u}function M(e,t,r){e=this.isIdentity()?[e,t,r]:[e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]];return e}function I(e,t){var r;return this.isIdentity()?e+","+t:(r=this.props,Math.round(100*(e*r[0]+t*r[4]+r[12]))/100+","+Math.round(100*(e*r[1]+t*r[5]+r[13]))/100)}function D(){for(var e=0,t=this.props,r="matrix3d(";e<16;)r=r+s(1e4*t[e])/1e4+(15===e?")":","),e+=1;return r}function R(e){return e<1e-6&&0<e||-1e-6<e&&e<0?s(1e4*e)/1e4:e}function k(){var e=this.props;return"matrix("+R(e[0])+","+R(e[1])+","+R(e[4])+","+R(e[5])+","+R(e[12])+","+R(e[13])+")"}return function(){this.reset=e,this.rotate=t,this.rotateX=r,this.rotateY=o,this.rotateZ=l,this.skew=c,this.skewFromAxis=h,this.shear=u,this.scale=d,this.setTransform=p,this.translate=f,this.transform=m,this.multiply=g,this.applyToPoint=x,this.applyToX=S,this.applyToY=T,this.applyToZ=E,this.applyToPointArray=M,this.applyToTriplePoints=P,this.applyToPointStringified=I,this.toCSS=D,this.to2dCSS=k,this.clone=_,this.cloneFromProps=b,this.equals=y,this.inversePoints=w,this.inversePoint=A,this.getInverseMatrix=C,this._t=this.transform,this.isIdentity=v,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}})();function _typeof$3(e){return(_typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var lottie={};function setLocation(e){setLocationHref(e)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(e){setSubframeEnabled(e)}function setPrefix(e){setIdPrefix(e)}function loadAnimation(e){return animationManager.loadAnimation(e)}function setQuality(e){if("string"==typeof e)switch(e){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10)}else!isNaN(e)&&1<e&&setDefaultCurveSegments(e)}function inBrowser(){return"undefined"!=typeof navigator}function installPlugin(e,t){"expressions"===e&&setExpressionsPlugin(t)}function getFactory(e){switch(e){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(e){for(var t=queryString.split("&"),r=0;r<t.length;r+=1){var i=t[r].split("=");if(decodeURIComponent(i[0])==e)return decodeURIComponent(i[1])}}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.12.2";var queryString="",scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""},queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",readyStateCheckInterval=(getQueryVariable("renderer"),setInterval(checkReady,100));try{"object"!==_typeof$3(exports)&&(window.bodymovin=lottie)}catch(err){}var ShapeModifiers=(()=>{var e={},i={};return e.registerModifier=function(e,t){i[e]||(i[e]=t)},e.getModifier=function(e,t,r){return new i[e](t,r)},e})();function ShapeModifier(){}function TrimModifier(){}function PuckerAndBloatModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(e){var t;this.closed||(e.sh.container.addDynamicProperty(e.sh),t={shape:e.sh,data:e,localShapeCollection:shapeCollectionPool.newShapeCollection()},this.shapes.push(t),this.addShapeToModifier(t),this._isAnimated&&e.setAsAnimated())},ShapeModifier.prototype.init=function(e,t){this.shapes=[],this.elem=e,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(e,t){this.s=PropertyFactory.getProp(e,t.s,0,.01,this),this.e=PropertyFactory.getProp(e,t.e,0,.01,this),this.o=PropertyFactory.getProp(e,t.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=t.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(e){e.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(e,t,r,i,n){for(var a,s,o=[],l=(t<=1?o.push({s:e,e:t}):1<=e?o.push({s:e-1,e:t-1}):(o.push({s:e,e:1}),o.push({s:0,e:t-1})),[]),u=o.length,c=0;c<u;c+=1)(s=o[c]).e*n<i||s.s*n>i+r||(a=s.s*n<=i?0:(s.s*n-i)/r,s=s.e*n>=i+r?1:(s.e*n-i)/r,l.push([a,s]));return l.length||l.push([0,0]),l},TrimModifier.prototype.releasePathsData=function(e){for(var t=e.length,r=0;r<t;r+=1)segmentsLengthPool.release(e[r]);return e.length=0,e},TrimModifier.prototype.processShapes=function(e){this._mdf||e?((t=this.o.v%360/360)<0&&(t+=1),r=1<this.s.v?1+t:this.s.v<0?0+t:this.s.v+t,(i=1<this.e.v?1+t:this.e.v<0?0+t:this.e.v+t)<r&&(t=r,r=i,i=t),r=1e-4*Math.round(1e4*r),i=1e-4*Math.round(1e4*i),this.sValue=r,this.eValue=i):(r=this.sValue,i=this.eValue);var t,r,i,n,a,s,o,l,u,c=this.shapes.length,h=0;if(i===r)for(m=0;m<c;m+=1)this.shapes[m].localShapeCollection.releaseShapes(),this.shapes[m].shape._mdf=!0,this.shapes[m].shape.paths=this.shapes[m].localShapeCollection,this._mdf&&(this.shapes[m].pathsData.length=0);else if(1===i&&0===r||0===i&&1===r){if(this._mdf)for(m=0;m<c;m+=1)this.shapes[m].pathsData.length=0,this.shapes[m].shape._mdf=!0}else{for(var d,p,f=[],m=0;m<c;m+=1)if((d=this.shapes[m]).shape._mdf||this._mdf||e||2===this.m){if(s=(n=d.shape.paths)._length,u=0,!d.shape._mdf&&d.pathsData.length)u=d.totalShapeLength;else{for(o=this.releasePathsData(d.pathsData),a=0;a<s;a+=1)l=bez.getSegmentsLength(n.shapes[a]),o.push(l),u+=l.totalLength;d.totalShapeLength=u,d.pathsData=o}h+=u,d.shape._mdf=!0}else d.shape.paths=d.localShapeCollection;var g,v=r,y=i,_=0;for(m=c-1;0<=m;--m)if((d=this.shapes[m]).shape._mdf){for((p=d.localShapeCollection).releaseShapes(),2===this.m&&1<c?(g=this.calculateShapeEdges(r,i,d.totalShapeLength,_,h),_+=d.totalShapeLength):g=[[v,y]],s=g.length,a=0;a<s;a+=1){v=g[a][0],y=g[a][1],f.length=0,y<=1?f.push({s:d.totalShapeLength*v,e:d.totalShapeLength*y}):1<=v?f.push({s:d.totalShapeLength*(v-1),e:d.totalShapeLength*(y-1)}):(f.push({s:d.totalShapeLength*v,e:d.totalShapeLength}),f.push({s:0,e:d.totalShapeLength*(y-1)}));var b,x=this.addShapes(d,f[0]);f[0].s!==f[0].e&&(1<f.length&&(x=d.shape.paths.shapes[d.shape.paths._length-1].c?(b=x.pop(),this.addPaths(x,p),this.addShapes(d,f[1],b)):(this.addPaths(x,p),this.addShapes(d,f[1]))),this.addPaths(x,p))}d.shape.paths=p}}},TrimModifier.prototype.addPaths=function(e,t){for(var r=e.length,i=0;i<r;i+=1)t.addShape(e[i])},TrimModifier.prototype.addSegment=function(e,t,r,i,n,a,s){n.setXYAt(t[0],t[1],"o",a),n.setXYAt(r[0],r[1],"i",a+1),s&&n.setXYAt(e[0],e[1],"v",a),n.setXYAt(i[0],i[1],"v",a+1)},TrimModifier.prototype.addSegmentFromArray=function(e,t,r,i){t.setXYAt(e[1],e[5],"o",r),t.setXYAt(e[2],e[6],"i",r+1),i&&t.setXYAt(e[0],e[4],"v",r),t.setXYAt(e[3],e[7],"v",r+1)},TrimModifier.prototype.addShapes=function(e,t,r){var i,n,a,s,o,l,u,c,h=e.pathsData,d=e.shape.paths.shapes,p=e.shape.paths._length,f=0,m=[],g=!0,v=r?(s=r._length,r._length):(r=shapePool.newElement(),s=0);for(m.push(r),i=0;i<p;i+=1){for(o=h[i].lengths,r.c=d[i].c,a=d[i].c?o.length:o.length+1,n=1;n<a;n+=1)if(f+(c=o[n-1]).addedLength<t.s)f+=c.addedLength,r.c=!1;else{if(f>t.e){r.c=!1;break}t.s<=f&&t.e>=f+c.addedLength?(this.addSegment(d[i].v[n-1],d[i].o[n-1],d[i].i[n],d[i].v[n],r,s,g),g=!1):(l=bez.getNewSegment(d[i].v[n-1],d[i].v[n],d[i].o[n-1],d[i].i[n],(t.s-f)/c.addedLength,(t.e-f)/c.addedLength,o[n-1]),this.addSegmentFromArray(l,r,s,g),r.c=g=!1),f+=c.addedLength,s+=1}if(d[i].c&&o.length&&(c=o[n-1],f<=t.e?(u=o[n-1].addedLength,t.s<=f&&t.e>=f+u?(this.addSegment(d[i].v[n-1],d[i].o[n-1],d[i].i[0],d[i].v[0],r,s,g),g=!1):(l=bez.getNewSegment(d[i].v[n-1],d[i].v[0],d[i].o[n-1],d[i].i[0],(t.s-f)/u,(t.e-f)/u,o[n-1]),this.addSegmentFromArray(l,r,s,g),r.c=g=!1)):r.c=!1,f+=c.addedLength,s+=1),r._length&&(r.setXYAt(r.v[v][0],r.v[v][1],"i",v),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),f>t.e)break;i<p-1&&(r=shapePool.newElement(),g=!0,m.push(r),s=0)}return m},extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(e,t){for(var r=t/100,i=[0,0],n=e._length,a=0,a=0;a<n;a+=1)i[0]+=e.v[a][0],i[1]+=e.v[a][1];i[0]/=n,i[1]/=n;var s,o,l,u,c,h,d=shapePool.newElement();for(d.c=e.c,a=0;a<n;a+=1)s=e.v[a][0]+(i[0]-e.v[a][0])*r,o=e.v[a][1]+(i[1]-e.v[a][1])*r,l=e.o[a][0]+(i[0]-e.o[a][0])*-r,u=e.o[a][1]+(i[1]-e.o[a][1])*-r,c=e.i[a][0]+(i[0]-e.i[a][0])*-r,h=e.i[a][1]+(i[1]-e.i[a][1])*-r,d.setTripleAt(s,o,l,u,c,h,a);return d},PuckerAndBloatModifier.prototype.processShapes=function(e){var t,r,i,n=this.shapes.length,a=this.amount.v;if(0!==a)for(var s,o,l=0;l<n;l+=1){if(o=(s=this.shapes[l]).localShapeCollection,s.shape._mdf||this._mdf||e)for(o.releaseShapes(),s.shape._mdf=!0,t=s.shape.paths.shapes,i=s.shape.paths._length,r=0;r<i;r+=1)o.addShape(this.processPath(t[r],a));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=(()=>{var a=[0,0];function i(e,t,r){if(this.elem=e,this.frameId=-1,this.propType="transform",this.data=t,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(r||e),t.p&&t.p.s?(this.px=PropertyFactory.getProp(e,t.p.x,0,0,this),this.py=PropertyFactory.getProp(e,t.p.y,0,0,this),t.p.z&&(this.pz=PropertyFactory.getProp(e,t.p.z,0,0,this))):this.p=PropertyFactory.getProp(e,t.p||{k:[0,0,0]},1,0,this),t.rx){if(this.rx=PropertyFactory.getProp(e,t.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(e,t.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(e,t.rz,0,degToRads,this),t.or.k[0].ti)for(var i=t.or.k.length,n=0;n<i;n+=1)t.or.k[n].to=null,t.or.k[n].ti=null;this.or=PropertyFactory.getProp(e,t.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(e,t.r||{k:0},0,degToRads,this);t.sk&&(this.sk=PropertyFactory.getProp(e,t.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(e,t.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(e,t.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(e,t.s||{k:[100,100,100]},1,.01,this),t.o?this.o=PropertyFactory.getProp(e,t.o,0,.01,e):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return i.prototype={applyToMatrix:function(e){var t=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||t,this.a&&e.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&e.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&e.skewFromAxis(-this.sk.v,this.sa.v),this.r?e.rotate(-this.r.v):e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?e.translate(this.px.v,this.py.v,-this.pz.v):e.translate(this.px.v,this.py.v,0):e.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(e){var t,r,i,n;this.elem.globalData.frameId!==this.frameId&&(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),(this._mdf||e)&&(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented&&(e=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime?r=this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(t=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/e,0),this.p.getValueAtTime(this.p.keyframes[0].t/e,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(t=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/e,0),this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/e,0)):(t=this.p.pv,this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/e,this.p.offsetTime)):this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime?(t=[],r=[],i=this.px,n=this.py,i._caching.lastFrame+i.offsetTime<=i.keyframes[0].t?(t[0]=i.getValueAtTime((i.keyframes[0].t+.01)/e,0),t[1]=n.getValueAtTime((n.keyframes[0].t+.01)/e,0),r[0]=i.getValueAtTime(i.keyframes[0].t/e,0),r[1]=n.getValueAtTime(n.keyframes[0].t/e,0)):i._caching.lastFrame+i.offsetTime>=i.keyframes[i.keyframes.length-1].t?(t[0]=i.getValueAtTime(i.keyframes[i.keyframes.length-1].t/e,0),t[1]=n.getValueAtTime(n.keyframes[n.keyframes.length-1].t/e,0),r[0]=i.getValueAtTime((i.keyframes[i.keyframes.length-1].t-.01)/e,0),r[1]=n.getValueAtTime((n.keyframes[n.keyframes.length-1].t-.01)/e,0)):(t=[i.pv,n.pv],r[0]=i.getValueAtTime((i._caching.lastFrame+i.offsetTime-.01)/e,i.offsetTime),r[1]=n.getValueAtTime((n._caching.lastFrame+n.offsetTime-.01)/e,n.offsetTime))):t=r=a,this.v.rotate(-Math.atan2(t[1]-r[1],t[0]-r[0]))),this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])),this.frameId=this.elem.globalData.frameId)},precalculateMatrix:function(){if(this.appliedTransformations=0,this.pre.reset(),!this.a.effectsSequence.length&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],i),i.prototype.addDynamicProperty=function(e){this._addDynamicProperty(e),this.elem.addDynamicProperty(e),this._isDirty=!0},i.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(e,t,r){return new i(e,t,r)}}})();function RepeaterModifier(){}function RoundCornersModifier(){}function floatEqual(e,t){return 1e5*Math.abs(e-t)<=Math.min(Math.abs(e),Math.abs(t))}function floatZero(e){return Math.abs(e)<=1e-5}function lerp(e,t,r){return e*(1-r)+t*r}function lerpPoint(e,t,r){return[lerp(e[0],t[0],r),lerp(e[1],t[1],r)]}function quadRoots(e,t,r){return 0===e||(r=t*t-4*e*r)<0?[]:(t=-t/(2*e),0==r?[t]:[t-(r=Math.sqrt(r)/(2*e)),t+r])}function polynomialCoefficients(e,t,r,i){return[3*t-e-3*r+i,3*e-6*t+3*r,-3*e+3*t,e]}function singlePoint(e){return new PolynomialBezier(e,e,e,e,!1)}function PolynomialBezier(e,t,r,i,n){n&&pointEqual(e,t)&&(t=lerpPoint(e,i,1/3)),n&&pointEqual(r,i)&&(r=lerpPoint(e,i,2/3));var n=polynomialCoefficients(e[0],t[0],r[0],i[0]),a=polynomialCoefficients(e[1],t[1],r[1],i[1]);this.a=[n[0],a[0]],this.b=[n[1],a[1]],this.c=[n[2],a[2]],this.d=[n[3],a[3]],this.points=[e,t,r,i]}function extrema(e,t){for(var r,i,n=e.points[0][t],a=e.points[e.points.length-1][t],s=(a<n&&(r=a,a=n,n=r),quadRoots(3*e.a[t],2*e.b[t],e.c[t])),o=0;o<s.length;o+=1)0<s[o]&&s[o]<1&&((i=e.point(s[o])[t])<n?n=i:a<i&&(a=i));return{min:n,max:a}}function intersectData(e,t,r){var i=e.boundingBox();return{cx:i.cx,cy:i.cy,width:i.width,height:i.height,bez:e,t:(t+r)/2,t1:t,t2:r}}function splitData(e){var t=e.bez.split(.5);return[intersectData(t[0],e.t1,e.t),intersectData(t[1],e.t,e.t2)]}function boxIntersect(e,t){return 2*Math.abs(e.cx-t.cx)<e.width+t.width&&2*Math.abs(e.cy-t.cy)<e.height+t.height}function intersectsImpl(e,t,r,i,n,a){boxIntersect(e,t)&&(a<=r||e.width<=i&&e.height<=i&&t.width<=i&&t.height<=i?n.push([e.t,t.t]):(e=splitData(e),t=splitData(t),intersectsImpl(e[0],t[0],r+1,i,n,a),intersectsImpl(e[0],t[1],r+1,i,n,a),intersectsImpl(e[1],t[0],r+1,i,n,a),intersectsImpl(e[1],t[1],r+1,i,n,a)))}function crossProduct(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function lineIntersection(e,t,r,i){e=[e[0],e[1],1],t=[t[0],t[1],1],r=[r[0],r[1],1],i=[i[0],i[1],1],e=crossProduct(crossProduct(e,t),crossProduct(r,i));return floatZero(e[2])?null:[e[0]/e[2],e[1]/e[2]]}function polarOffset(e,t,r){return[e[0]+Math.cos(t)*r,e[1]-Math.sin(t)*r]}function pointDistance(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1])}function pointEqual(e,t){return floatEqual(e[0],t[0])&&floatEqual(e[1],t[1])}function ZigZagModifier(){}function setPoint(e,t,r,i,n,a,s){var o=r-Math.PI/2,l=r+Math.PI/2,u=t[0]+Math.cos(r)*i*n,t=t[1]-Math.sin(r)*i*n;e.setTripleAt(u,t,u+Math.cos(o)*a,t-Math.sin(o)*a,u+Math.cos(l)*s,t-Math.sin(l)*s,e.length())}function getPerpendicularVector(e,t){t=[t[0]-e[0],t[1]-e[1]],e=.5*-Math.PI;return[Math.cos(e)*t[0]-Math.sin(e)*t[1],Math.sin(e)*t[0]+Math.cos(e)*t[1]]}function getProjectingAngle(e,t){var r=0===t?e.length()-1:t-1,t=(t+1)%e.length(),r=getPerpendicularVector(e.v[r],e.v[t]);return Math.atan2(0,1)-Math.atan2(r[1],r[0])}function zigZagCorner(e,t,r,i,n,a,s){var o=getProjectingAngle(t,r),l=t.v[r%t._length],u=t.v[0===r?t._length-1:r-1],c=t.v[(r+1)%t._length],u=2===a?Math.sqrt(Math.pow(l[0]-u[0],2)+Math.pow(l[1]-u[1],2)):0,a=2===a?Math.sqrt(Math.pow(l[0]-c[0],2)+Math.pow(l[1]-c[1],2)):0;setPoint(e,t.v[r%t._length],o,s,i,a/(2*(n+1)),u/(2*(n+1)))}function zigZagSegment(e,t,r,i,n,a){for(var s=0;s<i;s+=1){var o=(s+1)/(i+1),l=2===n?Math.sqrt(Math.pow(t.points[3][0]-t.points[0][0],2)+Math.pow(t.points[3][1]-t.points[0][1],2)):0,u=t.normalAngle(o);setPoint(e,t.point(o),u,a,r,l/(2*(i+1)),l/(2*(i+1))),a=-a}return a}function linearOffset(e,t,r){var i=Math.atan2(t[0]-e[0],t[1]-e[1]);return[polarOffset(e,i,r),polarOffset(t,i,r)]}function offsetSegment(e,t){var r=linearOffset(e.points[0],e.points[1],t),i=r[0],n=r[1],a=(r=linearOffset(e.points[1],e.points[2],t))[0],s=r[1],e=(r=linearOffset(e.points[2],e.points[3],t))[0],t=r[1],r=lineIntersection(i,n,a,s),n=(null===r&&(r=n),lineIntersection(e,t,a,s));return new PolynomialBezier(i,r,n=null===n?e:n,t)}function joinLines(e,t,r,i,n){var a,s,o=t.points[3],l=r.points[0];return 3===i||pointEqual(o,l)?o:2===i?(i=-t.tangentAngle(1),s=-r.tangentAngle(0)+Math.PI,a=lineIntersection(o,polarOffset(o,i+Math.PI/2,100),l,polarOffset(l,i+Math.PI/2,100)),a=polarOffset(o,i,2*(i=a?pointDistance(a,o):pointDistance(o,l)/2)*roundCorner),e.setXYAt(a[0],a[1],"o",e.length()-1),a=polarOffset(l,s,2*i*roundCorner),e.setTripleAt(l[0],l[1],l[0],l[1],a[0],a[1],e.length()),l):(s=lineIntersection(pointEqual(o,t.points[2])?t.points[0]:t.points[2],o,l,pointEqual(l,r.points[1])?r.points[3]:r.points[1]))&&pointDistance(s,o)<n?(e.setTripleAt(s[0],s[1],s[0],s[1],s[0],s[1],e.length()),s):o}function getIntersection(e,t){e=e.intersections(t);return e.length&&floatEqual(e[0][0],1)&&e.shift(),e.length?e[0]:null}function pruneSegmentIntersection(e,t){var r=e.slice(),i=t.slice(),n=getIntersection(e[e.length-1],t[0]);return n&&(r[e.length-1]=e[e.length-1].split(n[0])[0],i[0]=t[0].split(n[1])[1]),1<e.length&&1<t.length&&(n=getIntersection(e[0],t[t.length-1]))?[[e[0].split(n[0])[0]],[t[t.length-1].split(n[1])[1]]]:[r,i]}function pruneIntersections(e){for(var t,r=1;r<e.length;r+=1)t=pruneSegmentIntersection(e[r-1],e[r]),e[r-1]=t[0],e[r]=t[1];return 1<e.length&&(t=pruneSegmentIntersection(e[e.length-1],e[0]),e[e.length-1]=t[0],e[0]=t[1]),e}function offsetSegmentSplit(e,t){var r,i,n,a=e.inflectionPoints();return 0===a.length?[offsetSegment(e,t)]:1===a.length||floatEqual(a[1],1)?(i=(r=e.split(a[0]))[0],n=r[1],[offsetSegment(i,t),offsetSegment(n,t)]):(i=(r=e.split(a[0]))[0],e=(a[1]-a[0])/(1-a[0]),a=(r=r[1].split(e))[0],n=r[1],[offsetSegment(i,t),offsetSegment(a,t),offsetSegment(n,t)])}function OffsetPathModifier(){}function getFontProperties(e){for(var t=e.fStyle?e.fStyle.split(" "):[],r="normal",i="normal",n=t.length,a=0;a<n;a+=1)switch(t[a].toLowerCase()){case"italic":i="italic";break;case"bold":r="700";break;case"black":r="900";break;case"medium":r="500";break;case"regular":case"normal":r="400";break;case"light":case"thin":r="200"}return{style:i,weight:e.fWeight||r}}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(e,t.c,0,null,this),this.o=PropertyFactory.getProp(e,t.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(e,t.tr,this),this.so=PropertyFactory.getProp(e,t.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(e,t.tr.eo,0,.01,this),this.data=t,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(e,t,r,i,n,a){var s=a?-1:1,o=i.s.v[0]+(1-i.s.v[0])*(1-n),l=i.s.v[1]+(1-i.s.v[1])*(1-n);e.translate(i.p.v[0]*s*n,i.p.v[1]*s*n,i.p.v[2]),t.translate(-i.a.v[0],-i.a.v[1],i.a.v[2]),t.rotate(-i.r.v*s*n),t.translate(i.a.v[0],i.a.v[1],i.a.v[2]),r.translate(-i.a.v[0],-i.a.v[1],i.a.v[2]),r.scale(a?1/o:o,a?1/l:l),r.translate(i.a.v[0],i.a.v[1],i.a.v[2])},RepeaterModifier.prototype.init=function(e,t,r,i){for(this.elem=e,this.arr=t,this.pos=r,this.elemsData=i,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t[r]);0<r;)this._elements.unshift(t[--r]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(e){for(var t=e.length,r=0;r<t;r+=1)e[r]._processed=!1,"gr"===e[r].ty&&this.resetElements(e[r].it)},RepeaterModifier.prototype.cloneElements=function(e){e=JSON.parse(JSON.stringify(e));return this.resetElements(e),e},RepeaterModifier.prototype.changeGroupRender=function(e,t){for(var r=e.length,i=0;i<r;i+=1)e[i]._render=t,"gr"===e[i].ty&&this.changeGroupRender(e[i].it,t)},RepeaterModifier.prototype.processShapes=function(e){var t,r,i,n,a,s=!1;if(this._mdf||e){var o,l=Math.ceil(this.c.v);if(this._groups.length<l){for(;this._groups.length<l;){var u={it:this.cloneElements(this._elements),ty:"gr"};u.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,u),this._groups.splice(0,0,u),this._currentCopies+=1}this.elem.reloadShapes(),s=!0}for(i=a=0;i<=this._groups.length-1;i+=1)this._groups[i]._render=o=a<l,this.changeGroupRender(this._groups[i].it,o),o||(0!==(o=(o=this.elemsData[i].it)[o.length-1]).transform.op.v?(o.transform.op._mdf=!0,o.transform.op.v=0):o.transform.op._mdf=!1),a+=1;this._currentCopies=l;var c,h,e=this.o.v,d=e%1,p=0<e?Math.floor(e):Math.ceil(e),f=this.pMatrix.props,m=this.rMatrix.props,g=this.sMatrix.props,v=(this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset(),0);if(0<e){for(;v<p;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),v+=1;d&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,d,!1),v+=d)}else if(e<0){for(;p<v;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),--v;d&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-d,!0),v-=d)}for(i=1===this.data.m?0:this._currentCopies-1,n=1===this.data.m?1:-1,a=this._currentCopies;a;){if(h=(r=(t=this.elemsData[i].it)[t.length-1].transform.mProps.v.props).length,t[t.length-1].transform.mProps._mdf=!0,t[t.length-1].transform.op._mdf=!0,t[t.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(i/(this._currentCopies-1)),0!==v){for((0!==i&&1===n||i!==this._currentCopies-1&&-1===n)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),this.matrix.transform(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]),c=0;c<h;c+=1)r[c]=this.matrix.props[c];this.matrix.reset()}else for(this.matrix.reset(),c=0;c<h;c+=1)r[c]=this.matrix.props[c];v+=1,--a,i+=n}}else for(a=this._currentCopies,i=0,n=1;a;)r=(t=this.elemsData[i].it)[t.length-1].transform.mProps.v.props,t[t.length-1].transform.mProps._mdf=!1,t[t.length-1].transform.op._mdf=!1,--a,i+=n;return s},RepeaterModifier.prototype.addShape=function(){},extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(e,t.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(e,t){for(var r,i,n,a,s,o,l,u,c,h,d=shapePool.newElement(),p=(d.c=e.c,e._length),f=0,m=0;m<p;m+=1)r=e.v[m],n=e.o[m],i=e.i[m],r[0]===n[0]&&r[1]===n[1]&&r[0]===i[0]&&r[1]===i[1]?0!==m&&m!==p-1||e.c?(a=0===m?e.v[p-1]:e.v[m-1],o=(s=Math.sqrt(Math.pow(r[0]-a[0],2)+Math.pow(r[1]-a[1],2)))?Math.min(s/2,t)/s:0,c=r[0]+(a[0]-r[0])*o,h=r[1]-(r[1]-a[1])*o,l=c-(c-r[0])*roundCorner,u=h-(h-r[1])*roundCorner,d.setTripleAt(c,h,l,u,c,h,f),f+=1,a=m===p-1?e.v[0]:e.v[m+1],o=(s=Math.sqrt(Math.pow(r[0]-a[0],2)+Math.pow(r[1]-a[1],2)))?Math.min(s/2,t)/s:0,l=r[0]+(a[0]-r[0])*o,u=r[1]+(a[1]-r[1])*o,c=l-(l-r[0])*roundCorner,h=u-(u-r[1])*roundCorner,d.setTripleAt(l,u,l,u,c,h,f)):d.setTripleAt(r[0],r[1],n[0],n[1],i[0],i[1],f):d.setTripleAt(e.v[m][0],e.v[m][1],e.o[m][0],e.o[m][1],e.i[m][0],e.i[m][1],f),f+=1;return d},RoundCornersModifier.prototype.processShapes=function(e){var t,r,i,n=this.shapes.length,a=this.rd.v;if(0!==a)for(var s,o,l=0;l<n;l+=1){if(o=(s=this.shapes[l]).localShapeCollection,s.shape._mdf||this._mdf||e)for(o.releaseShapes(),s.shape._mdf=!0,t=s.shape.paths.shapes,i=s.shape.paths._length,r=0;r<i;r+=1)o.addShape(this.processPath(t[r],a));s.shape.paths=s.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},PolynomialBezier.prototype.point=function(e){return[((this.a[0]*e+this.b[0])*e+this.c[0])*e+this.d[0],((this.a[1]*e+this.b[1])*e+this.c[1])*e+this.d[1]]},PolynomialBezier.prototype.derivative=function(e){return[(3*e*this.a[0]+2*this.b[0])*e+this.c[0],(3*e*this.a[1]+2*this.b[1])*e+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(e){e=this.derivative(e);return Math.atan2(e[1],e[0])},PolynomialBezier.prototype.normalAngle=function(e){e=this.derivative(e);return Math.atan2(e[0],e[1])},PolynomialBezier.prototype.inflectionPoints=function(){var e,t=this.a[1]*this.b[0]-this.a[0]*this.b[1];return floatZero(t)||(t=(e=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/t)*e-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/t)<0?[]:floatZero(t=Math.sqrt(t))?0<t&&t<1?[e]:[]:[e-t,e+t].filter(function(e){return 0<e&&e<1})},PolynomialBezier.prototype.split=function(e){var t,r,i,n;return e<=0?[singlePoint(this.points[0]),this]:1<=e?[this,singlePoint(this.points[this.points.length-1])]:(t=lerpPoint(this.points[0],this.points[1],e),n=lerpPoint(this.points[1],this.points[2],e),r=lerpPoint(this.points[2],this.points[3],e),i=lerpPoint(t,n,e),n=lerpPoint(n,r,e),e=lerpPoint(i,n,e),[new PolynomialBezier(this.points[0],t,i,e,!0),new PolynomialBezier(e,n,r,this.points[3],!0)])},PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var e=this.bounds();return{left:e.x.min,right:e.x.max,top:e.y.min,bottom:e.y.max,width:e.x.max-e.x.min,height:e.y.max-e.y.min,cx:(e.x.max+e.x.min)/2,cy:(e.y.max+e.y.min)/2}},PolynomialBezier.prototype.intersections=function(e,t,r){void 0===t&&(t=2),void 0===r&&(r=7);var i=[];return intersectsImpl(intersectData(this,0,1),intersectData(e,0,1),0,t,i,r),i},PolynomialBezier.shapeSegment=function(e,t){var r=(t+1)%e.length();return new PolynomialBezier(e.v[t],e.o[t],e.i[r],e.v[r],!0)},PolynomialBezier.shapeSegmentInverted=function(e,t){var r=(t+1)%e.length();return new PolynomialBezier(e.v[r],e.i[r],e.o[t],e.v[t],!0)},extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(e,t.s,0,null,this),this.frequency=PropertyFactory.getProp(e,t.r,0,null,this),this.pointsType=PropertyFactory.getProp(e,t.pt,0,null,this),this._isAnimated=0!==this.amplitude.effectsSequence.length||0!==this.frequency.effectsSequence.length||0!==this.pointsType.effectsSequence.length},ZigZagModifier.prototype.processPath=function(e,t,r,i){var n=e._length,a=shapePool.newElement();if(a.c=e.c,e.c||--n,0!==n){var s=-1,o=PolynomialBezier.shapeSegment(e,0);zigZagCorner(a,e,0,t,r,i,s);for(var l=0;l<n;l+=1)s=zigZagSegment(a,o,t,r,i,-s),o=l!==n-1||e.c?PolynomialBezier.shapeSegment(e,(l+1)%n):null,zigZagCorner(a,e,l+1,t,r,i,s)}return a},ZigZagModifier.prototype.processShapes=function(e){var t,r,i,n=this.shapes.length,a=this.amplitude.v,s=Math.max(0,Math.round(this.frequency.v)),o=this.pointsType.v;if(0!==a)for(var l,u,c=0;c<n;c+=1){if(u=(l=this.shapes[c]).localShapeCollection,l.shape._mdf||this._mdf||e)for(u.releaseShapes(),l.shape._mdf=!0,t=l.shape.paths.shapes,i=l.shape.paths._length,r=0;r<i;r+=1)u.addShape(this.processPath(t[r],a,s,o));l.shape.paths=l.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(e,t.a,0,null,this),this.miterLimit=PropertyFactory.getProp(e,t.ml,0,null,this),this.lineJoin=t.lj,this._isAnimated=0!==this.amount.effectsSequence.length},OffsetPathModifier.prototype.processPath=function(e,t,r,i){for(var n,a,s=shapePool.newElement(),o=(s.c=e.c,e.length()),l=(e.c||--o,[]),u=0;u<o;u+=1)a=PolynomialBezier.shapeSegment(e,u),l.push(offsetSegmentSplit(a,t));if(!e.c)for(u=o-1;0<=u;--u)a=PolynomialBezier.shapeSegmentInverted(e,u),l.push(offsetSegmentSplit(a,t));var l=pruneIntersections(l),c=null,h=null;for(u=0;u<l.length;u+=1){var d=l[u];for(h&&(c=joinLines(s,h,d[0],r,i)),h=d[d.length-1],n=0;n<d.length;n+=1)a=d[n],c&&pointEqual(a.points[0],c)?s.setXYAt(a.points[1][0],a.points[1][1],"o",s.length()-1):s.setTripleAt(a.points[0][0],a.points[0][1],a.points[1][0],a.points[1][1],a.points[0][0],a.points[0][1],s.length()),s.setTripleAt(a.points[3][0],a.points[3][1],a.points[3][0],a.points[3][1],a.points[2][0],a.points[2][1],s.length()),c=a.points[3]}return l.length&&joinLines(s,h,l[0][0],r,i),s},OffsetPathModifier.prototype.processShapes=function(e){var t,r,i,n=this.shapes.length,a=this.amount.v,s=this.miterLimit.v,o=this.lineJoin;if(0!==a)for(var l,u,c=0;c<n;c+=1){if(u=(l=this.shapes[c]).localShapeCollection,l.shape._mdf||this._mdf||e)for(u.releaseShapes(),l.shape._mdf=!0,t=l.shape.paths.shapes,i=l.shape.paths._length,r=0;r<i;r+=1)u.addShape(this.processPath(t[r],a,o,s));l.shape.paths=l.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var FontManager=(()=>{var a={w:0,size:0,shapes:[],data:{shapes:[]}},t=(t=[]).concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]),r=127462,i=127487,n=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"];function h(e,t){var r=createTag("span"),i=(r.setAttribute("aria-hidden",!0),r.style.fontFamily=t,createTag("span")),n=(i.innerText="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",r.appendChild(i),document.body.appendChild(r),i.offsetWidth);return i.style.fontFamily=(e=>{for(var t=e.split(","),r=t.length,i=[],n=0;n<r;n+=1)"sans-serif"!==t[n]&&"monospace"!==t[n]&&i.push(t[n]);return i.join(",")})(e)+", "+t,{node:i,w:n,parent:r}}function d(e,t){var r,i,n=document.body&&t?"svg":"canvas",a=getFontProperties(e);return r="svg"==n?((i=createNS("text")).style.fontSize="100px",i.setAttribute("font-family",e.fFamily),i.setAttribute("font-style",a.style),i.setAttribute("font-weight",a.weight),i.textContent="1",e.fClass?(i.style.fontFamily="inherit",i.setAttribute("class",e.fClass)):i.style.fontFamily=e.fFamily,t.appendChild(i),i):((t=new OffscreenCanvas(500,500).getContext("2d")).font=a.style+" "+a.weight+" 100px "+e.fFamily,t),{measureText:function(e){return"svg"==n?(r.textContent=e,r.getComputedTextLength()):r.measureText(e).width}}}function s(e){var t=0,r=e.charCodeAt(0);return t=55296<=r&&r<=56319&&56320<=(e=e.charCodeAt(1))&&e<=57343?1024*(r-55296)+e-56320+65536:t}function o(e){e=s(e);return r<=e&&e<=i}function e(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)}return e.isModifier=function(e,t){return e=e.toString(16)+t.toString(16),-1!==n.indexOf(e)},e.isZeroWidthJoiner=function(e){return 8205===e},e.isFlagEmoji=function(e){return o(e.substr(0,2))&&o(e.substr(2,2))},e.isRegionalCode=o,e.isCombinedCharacter=function(e){return-1!==t.indexOf(e)},e.isRegionalFlag=function(e,t){var r;if(127988!==s(e.substr(t,2)))return!1;var i=0;for(t+=2;i<5;){if((r=s(e.substr(t,2)))<917601||917626<r)return!1;i+=1,t+=2}return 917631===s(e.substr(t,2))},e.isVariationSelector=function(e){return 65039===e},e.BLACK_FLAG_CODE_POINT=127988,e.prototype={addChars:function(e){if(e){this.chars||(this.chars=[]);for(var t,r,i=e.length,n=this.chars.length,a=0;a<i;a+=1){for(t=0,r=!1;t<n;)this.chars[t].style===e[a].style&&this.chars[t].fFamily===e[a].fFamily&&this.chars[t].ch===e[a].ch&&(r=!0),t+=1;r||(this.chars.push(e[a]),n+=1)}}},addFonts:function(e,t){if(e)if(this.chars)this.isLoaded=!0,this.fonts=e.list;else if(document.body){for(var r=e.list,i=r.length,n=i,a=0;a<i;a+=1){var s,o,l,u,c=!0;if(r[a].loaded=!1,r[a].monoCase=h(r[a].fFamily,"monospace"),r[a].sansCase=h(r[a].fFamily,"sans-serif"),r[a].fPath){if("p"===r[a].fOrigin||3===r[a].origin)(c=0<(o=document.querySelectorAll('style[f-forigin="p"][f-family="'+r[a].fFamily+'"], style[f-origin="3"][f-family="'+r[a].fFamily+'"]')).length?!1:c)&&((l=createTag("style")).setAttribute("f-forigin",r[a].fOrigin),l.setAttribute("f-origin",r[a].origin),l.setAttribute("f-family",r[a].fFamily),l.type="text/css",l.innerText="@font-face {font-family: "+r[a].fFamily+"; font-style: normal; src: url('"+r[a].fPath+"');}",t.appendChild(l));else if("g"===r[a].fOrigin||1===r[a].origin){for(o=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),s=0;s<o.length;s+=1)-1!==o[s].href.indexOf(r[a].fPath)&&(c=!1);c&&((l=createTag("link")).setAttribute("f-forigin",r[a].fOrigin),l.setAttribute("f-origin",r[a].origin),l.type="text/css",l.rel="stylesheet",l.href=r[a].fPath,document.body.appendChild(l))}else if("t"===r[a].fOrigin||2===r[a].origin){for(o=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),s=0;s<o.length;s+=1)r[a].fPath===o[s].src&&(c=!1);c&&((u=createTag("link")).setAttribute("f-forigin",r[a].fOrigin),u.setAttribute("f-origin",r[a].origin),u.setAttribute("rel","stylesheet"),u.setAttribute("href",r[a].fPath),t.appendChild(u))}}else r[a].loaded=!0,--n;r[a].helper=d(r[a],t),r[a].cache={},this.fonts.push(r[a])}0===n?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0,e.list.forEach(function(e){e.helper=d(e),e.cache={}}),this.fonts=e.list;else this.isLoaded=!0},getCharData:function(e,t,r){for(var i=0,n=this.chars.length;i<n;){if(this.chars[i].ch===e&&this.chars[i].style===t&&this.chars[i].fFamily===r)return this.chars[i];i+=1}return("string"==typeof e&&13!==e.charCodeAt(0)||!e)&&console&&console.warn&&!this._warned&&(this._warned=!0),a},getFontByName:function(e){for(var t=0,r=this.fonts.length;t<r;){if(this.fonts[t].fName===e)return this.fonts[t];t+=1}return this.fonts[0]},measureText:function(e,t,r){var i,n,a,t=this.getFontByName(t),s=e;return t.cache[s]||(i=t.helper," "===e?(n=i.measureText("|"+e+"|"),a=i.measureText("||"),t.cache[s]=(n-a)/100):t.cache[s]=i.measureText(e)/100),t.cache[s]*r},checkLoadedFonts:function(){for(var e,t,r=this.fonts.length,i=r,n=0;n<r;n+=1)this.fonts[n].loaded?--i:"n"===this.fonts[n].fOrigin||0===this.fonts[n].origin?this.fonts[n].loaded=!0:(e=this.fonts[n].monoCase.node,t=this.fonts[n].monoCase.w,e.offsetWidth===t&&(e=this.fonts[n].sansCase.node,t=this.fonts[n].sansCase.w,e.offsetWidth===t)||(--i,this.fonts[n].loaded=!0),this.fonts[n].loaded&&(this.fonts[n].sansCase.parent.parentNode.removeChild(this.fonts[n].sansCase.parent),this.fonts[n].monoCase.parent.parentNode.removeChild(this.fonts[n].monoCase.parent)));0!==i&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}},e})();function SlotManager(e){this.animationData=e}function slotFactory(e){return new SlotManager(e)}function RenderableElement(){}SlotManager.prototype.getProp=function(e){return this.animationData.slots&&this.animationData.slots[e.sid]?Object.assign(e,this.animationData.slots[e.sid].p):e},RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){-1===this.renderableComponents.indexOf(e)&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){-1!==this.renderableComponents.indexOf(e)&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){for(var e=this.renderableComponents.length,t=0;t<e;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=(()=>{var t={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(e){return t[e]||""}})();function SliderEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function AngleEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function ColorEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,1,0,r)}function PointEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,1,0,r)}function LayerIndexEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function MaskIndexEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function CheckboxEffect(e,t,r){this.p=PropertyFactory.getProp(t,e.v,0,0,r)}function NoValueEffect(){this.p={}}function EffectsManager(e,t){for(var r,i=e.ef||[],n=(this.effectElements=[],i.length),a=0;a<n;a+=1)r=new GroupEffect(i[a],t),this.effectElements.push(r)}function GroupEffect(e,t){this.init(e,t)}function BaseElement(){}function FrameElement(){}function FootageElement(e,t,r){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.footageData=t.imageLoader.getAsset(this.assetData),this.initBaseData(e,t,r)}function AudioElement(e,t,r){this.initFrame(),this.initRenderable(),this.assetData=t.getAssetData(e.refId),this.initBaseData(e,t,r),this._isPlaying=!1,this._canPlay=!1;r=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(r),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,e.au&&e.au.lv?e.au.lv:{k:[100]},1,.01,this)}function BaseRenderer(){}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(e,t){this.data=e,this.effectElements=[],this.initDynamicPropertyContainer(t);for(var r,i=this.data.ef.length,n=this.data.ef,a=0;a<i;a+=1){switch(r=null,n[a].ty){case 0:r=new SliderEffect(n[a],t,this);break;case 1:r=new AngleEffect(n[a],t,this);break;case 2:r=new ColorEffect(n[a],t,this);break;case 3:r=new PointEffect(n[a],t,this);break;case 4:case 7:r=new CheckboxEffect(n[a],t,this);break;case 10:r=new LayerIndexEffect(n[a],t,this);break;case 11:r=new MaskIndexEffect(n[a],t,this);break;case 5:r=new EffectsManager(n[a],t);break;default:r=new NoValueEffect(n[a])}r&&this.effectElements.push(r)}},BaseElement.prototype={checkMasks:function(){if(this.data.hasMask)for(var e=0,t=this.data.masksProperties.length;e<t;){if("n"!==this.data.masksProperties[e].mode&&!1!==this.data.masksProperties[e].cl)return!0;e+=1}return!1},initExpressions:function(){var e,t,r,i,n=getExpressionInterfaces();n&&(i=n("layer"),e=n("effects"),t=n("shape"),r=n("text"),n=n("comp"),this.layerInterface=i(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager),i=e.createEffectsInterface(this,this.layerInterface),this.layerInterface.registerEffectsInterface(i),0===this.data.ty||this.data.xt?this.compInterface=n(this):4===this.data.ty?(this.layerInterface.shapeInterface=t(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=r(this),this.layerInterface.text=this.layerInterface.textInterface))},setBlendMode:function(){var e=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=e},initBaseData:function(e,t,r){this.globalData=t,this.comp=r,this.data=e,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,t){for(var r=this.dynamicProperties.length,i=0;i<r;i+=1)(t||this._isParent&&"transform"===this.dynamicProperties[i].propType)&&(this.dynamicProperties[i].getValue(),this.dynamicProperties[i]._mdf)&&(this.globalData._mdf=!0,this._mdf=!0)},addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&this.dynamicProperties.push(e)}},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var e=getExpressionInterfaces();e&&(e=e("footage"),this.layerInterface=e(this))},FootageElement.prototype.getFootageData=function(){return this.footageData},AudioElement.prototype.prepareFrame=function(e){this.prepareRenderableFrame(e,!0),this.prepareProperties(e,!0),this.tm._placeholder?this._currentTime=e/this.data.sr:(e=this.tm.v,this._currentTime=e),this._volume=this.lv.v[0];e=this._volume*this._volumeMultiplier;this._previousVolume!==e&&(this._previousVolume=e,this.audio.volume(e))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||.1<Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek()))&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(e){this.audio.rate(e)},AudioElement.prototype.volume=function(e){this._volumeMultiplier=e,this._previousVolume=e*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},BaseRenderer.prototype.checkLayers=function(e){var t,r,i=this.layers.length;for(this.completeLayers=!0,t=i-1;0<=t;--t)this.elements[t]||(r=this.layers[t]).ip-r.st<=e-this.layers[t].st&&r.op-r.st>e-this.layers[t].st&&this.buildItem(t),this.completeLayers=!!this.elements[t]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(e){switch(e.ty){case 2:return this.createImage(e);case 0:return this.createComp(e);case 1:return this.createSolid(e);case 3:return this.createNull(e);case 4:return this.createShape(e);case 5:return this.createText(e);case 6:return this.createAudio(e);case 13:return this.createCamera(e);case 15:return this.createFootage(e);default:return this.createNull(e)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(e){return new AudioElement(e,this.globalData,this)},BaseRenderer.prototype.createFootage=function(e){return new FootageElement(e,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){for(var e=this.layers.length,t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(e){this.completeLayers=!1;for(var t,r=e.length,i=this.layers.length,n=0;n<r;n+=1)for(t=0;t<i;){if(this.layers[t].id===e[n].id){this.layers[t]=e[n];break}t+=1}},BaseRenderer.prototype.setProjectInterface=function(e){this.globalData.projectInterface=e},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(e,t,r){for(var i=this.elements,n=this.layers,a=0,s=n.length;a<s;)n[a].ind==t&&(i[a]&&!0!==i[a]?(r.push(i[a]),i[a].setAsParent(),void 0!==n[a].parent?this.buildElementParenting(e,n[a].parent,r):e.setHierarchy(r)):(this.buildItem(a),this.addPendingElement(e))),a+=1},BaseRenderer.prototype.addPendingElement=function(e){this.pendingElements.push(e)},BaseRenderer.prototype.searchExtraCompositions=function(e){for(var t,r=e.length,i=0;i<r;i+=1)e[i].xt&&((t=this.createComp(e[i])).initExpressions(),this.globalData.projectInterface.registerComposition(t))},BaseRenderer.prototype.getElementById=function(e){for(var t=this.elements.length,r=0;r<t;r+=1)if(this.elements[r].data.ind===e)return this.elements[r];return null},BaseRenderer.prototype.getElementByPath=function(e){var t,r=e.shift();if("number"==typeof r)t=this.elements[r];else for(var i=this.elements.length,n=0;n<i;n+=1)if(this.elements[n].data.nm===r){t=this.elements[n];break}return 0===e.length?t:t.getElementByPath(e)},BaseRenderer.prototype.setupGlobalData=function(e,t){this.globalData.fontManager=new FontManager,this.globalData.slotManager=slotFactory(e),this.globalData.fontManager.addChars(e.chars),this.globalData.fontManager.addFonts(e.fonts,t),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=e.fr,this.globalData.nm=e.nm,this.globalData.compSize={w:e.w,h:e.h}};var effectTypes={TRANSFORM_EFFECT:"transformEFfect"};function TransformElement(){}function MaskElement(e,t,r){this.data=e,this.element=t,this.globalData=r,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;for(var i,n,a,s,o,l=this.globalData.defs,u=this.masksProperties?this.masksProperties.length:0,c=(this.viewData=createSizedArray(u),this.solidPath="",this.masksProperties),h=0,d=[],p=createElementID(),f="clipPath",m="clip-path",g=0;g<u;g+=1)if(("a"!==c[g].mode&&"n"!==c[g].mode||c[g].inv||100!==c[g].o.k||c[g].o.x)&&(m=f="mask"),"s"!==c[g].mode&&"i"!==c[g].mode||0!==h?n=null:((n=createNS("rect")).setAttribute("fill","#ffffff"),n.setAttribute("width",this.element.comp.data.w||0),n.setAttribute("height",this.element.comp.data.h||0),d.push(n)),i=createNS("path"),"n"===c[g].mode)this.viewData[g]={op:PropertyFactory.getProp(this.element,c[g].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,c[g],3),elem:i,lastPath:""},l.appendChild(i);else{if(h+=1,i.setAttribute("fill","s"===c[g].mode?"#000000":"#ffffff"),i.setAttribute("clip-rule","nonzero"),0!==c[g].x.k?(m=f="mask",s=PropertyFactory.getProp(this.element,c[g].x,0,null,this.element),o=createElementID(),(b=createNS("filter")).setAttribute("id",o),(a=createNS("feMorphology")).setAttribute("operator","erode"),a.setAttribute("in","SourceGraphic"),a.setAttribute("radius","0"),b.appendChild(a),l.appendChild(b),i.setAttribute("stroke","s"===c[g].mode?"#000000":"#ffffff")):s=a=null,this.storedData[g]={elem:i,x:s,expan:a,lastPath:"",lastOperator:"",filterId:o,lastRadius:0},"i"===c[g].mode){for(var v=d.length,y=createNS("g"),_=0;_<v;_+=1)y.appendChild(d[_]);var b=createNS("mask");b.setAttribute("mask-type","alpha"),b.setAttribute("id",p+"_"+h),b.appendChild(i),l.appendChild(b),y.setAttribute("mask","url("+getLocationHref()+"#"+p+"_"+h+")"),d.length=0,d.push(y)}else d.push(i);c[g].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[g]={elem:i,lastPath:"",op:PropertyFactory.getProp(this.element,c[g].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,c[g],3),invRect:n},this.viewData[g].prop.k||this.drawPath(c[g],this.viewData[g].prop.v,this.viewData[g])}for(this.maskElement=createNS(f),u=d.length,g=0;g<u;g+=1)this.maskElement.appendChild(d[g]);0<h&&(this.maskElement.setAttribute("id",p),this.element.maskedElement.setAttribute(m,"url("+getLocationHref()+"#"+p+")"),l.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}TransformElement.prototype={initTransform:function(){var e=new Matrix;this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_localMatMdf:!1,_opMdf:!1,mat:e,localMat:e,localOpacity:1},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,t=this.finalTransform.mat,r=0,i=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<i;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,t.cloneFromProps(e),r=0;r<i;r+=1)t.multiply(this.hierarchy[r].finalTransform.mProp.v)}this.finalTransform._matMdf&&(this.finalTransform._localMatMdf=this.finalTransform._matMdf),this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v)},renderLocalTransform:function(){if(this.localTransforms){var e=0,t=this.localTransforms.length;if(this.finalTransform._localMatMdf=this.finalTransform._matMdf,!this.finalTransform._localMatMdf||!this.finalTransform._opMdf)for(;e<t;)this.localTransforms[e]._mdf&&(this.finalTransform._localMatMdf=!0),this.localTransforms[e]._opMdf&&!this.finalTransform._opMdf&&(this.finalTransform.localOpacity=this.finalTransform.mProp.o.v,this.finalTransform._opMdf=!0),e+=1;if(this.finalTransform._localMatMdf){var r=this.finalTransform.localMat;for(this.localTransforms[0].matrix.clone(r),e=1;e<t;e+=1){var i=this.localTransforms[e].matrix;r.multiply(i)}r.multiply(this.finalTransform.mat)}if(this.finalTransform._opMdf){for(var n=this.finalTransform.localOpacity,e=0;e<t;e+=1)n*=.01*this.localTransforms[e].opacity;this.finalTransform.localOpacity=n}}},searchEffectTransforms:function(){if(this.renderableEffectsManager){var e=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT);if(e.length){this.localTransforms=[],this.finalTransform.localMat=new Matrix;for(var t=0,r=e.length,t=0;t<r;t+=1)this.localTransforms.push(e[t])}}},globalToLocal:function(e){for(var t=[],r=(t.push(this.finalTransform),!0),i=this.comp;r;)i.finalTransform?(i.data.hasMask&&t.splice(0,0,i.finalTransform),i=i.comp):r=!1;for(var n,a=t.length,s=0;s<a;s+=1)n=t[s].mat.applyToPointArray(0,0,0),e=[e[0]-n[0],e[1]-n[1],0];return e},mHelper:new Matrix},MaskElement.prototype.getMaskProperty=function(e){return this.viewData[e].prop},MaskElement.prototype.renderFrame=function(e){for(var t,r=this.element.finalTransform.mat,i=this.masksProperties.length,n=0;n<i;n+=1)(this.viewData[n].prop._mdf||e)&&this.drawPath(this.masksProperties[n],this.viewData[n].prop.v,this.viewData[n]),(this.viewData[n].op._mdf||e)&&this.viewData[n].elem.setAttribute("fill-opacity",this.viewData[n].op.v),"n"!==this.masksProperties[n].mode&&(this.viewData[n].invRect&&(this.element.finalTransform.mProp._mdf||e)&&this.viewData[n].invRect.setAttribute("transform",r.getInverseMatrix().to2dCSS()),this.storedData[n].x)&&(this.storedData[n].x._mdf||e)&&(t=this.storedData[n].expan,this.storedData[n].x.v<0?("erode"!==this.storedData[n].lastOperator&&(this.storedData[n].lastOperator="erode",this.storedData[n].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[n].filterId+")")),t.setAttribute("radius",-this.storedData[n].x.v)):("dilate"!==this.storedData[n].lastOperator&&(this.storedData[n].lastOperator="dilate",this.storedData[n].elem.setAttribute("filter",null)),this.storedData[n].elem.setAttribute("stroke-width",2*this.storedData[n].x.v)))},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var e="M0,0 ";return(e+=" h"+this.globalData.compSize.w)+(" v"+this.globalData.compSize.h)+(" h-"+this.globalData.compSize.w)+(" v-"+this.globalData.compSize.h+" ")},MaskElement.prototype.drawPath=function(e,t,r){for(var i,n=" M"+t.v[0][0]+","+t.v[0][1],a=t._length,s=1;s<a;s+=1)n+=" C"+t.o[s-1][0]+","+t.o[s-1][1]+" "+t.i[s][0]+","+t.i[s][1]+" "+t.v[s][0]+","+t.v[s][1];t.c&&1<a&&(n+=" C"+t.o[s-1][0]+","+t.o[s-1][1]+" "+t.i[0][0]+","+t.i[0][1]+" "+t.v[0][0]+","+t.v[0][1]),r.lastPath!==n&&(i="",r.elem&&(t.c&&(i=e.inv?this.solidPath+n:n),r.elem.setAttribute("d",i)),r.lastPath=n)},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=(()=>{var e={createFilter:function(e,t){var r=createNS("filter");r.setAttribute("id",e),!0!==t&&(r.setAttribute("filterUnits","objectBoundingBox"),r.setAttribute("x","0%"),r.setAttribute("y","0%"),r.setAttribute("width","100%"),r.setAttribute("height","100%"));return r},createAlphaToLuminanceFilter:function(){var e=createNS("feColorMatrix");return e.setAttribute("type","matrix"),e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),e}};return e})(),featureSupport=(()=>{var e={maskType:!0,svgLumaHidden:!0,offscreenCanvas:"undefined"!=typeof OffscreenCanvas};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(e.maskType=!1),/firefox/i.test(navigator.userAgent)&&(e.svgLumaHidden=!1),e})(),registeredEffects$1={},idPrefix="filter_result_";function SVGEffects(e){var t,r="SourceGraphic",i=e.data.ef?e.data.ef.length:0,n=createElementID(),a=filtersFactory.createFilter(n,!0),s=0;for(this.filters=[],t=0;t<i;t+=1){o=null;var o,l=e.data.ef[t].ty;registeredEffects$1[l]&&(o=new registeredEffects$1[l].effect(a,e.effectsManager.effectElements[t],e,idPrefix+s,r),r=idPrefix+s,registeredEffects$1[l].countsAsEffect)&&(s+=1),o&&this.filters.push(o)}s&&(e.globalData.defs.appendChild(a),e.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+n+")")),this.filters.length&&e.addRenderableComponent(this)}function registerEffect$1(e,t,r){registeredEffects$1[e]={effect:t,countsAsEffect:r}}function SVGBaseElement(){}function HierarchyElement(){}function RenderableDOMElement(){}function IImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.assetData&&this.assetData.sid&&(this.assetData=t.slotManager.getProp(this.assetData)),this.initElement(e,t,r),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ProcessedElement(e,t){this.elem=e,this.pos=t}function IShapeElement(){}SVGEffects.prototype.renderFrame=function(e){for(var t=this.filters.length,r=0;r<t;r+=1)this.filters[r].renderFrame(e)},SVGEffects.prototype.getEffects=function(e){for(var t=this.filters.length,r=[],i=0;i<t;i+=1)this.filters[i].type===e&&r.push(this.filters[i]);return r},SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e,t,r,i=null;this.data.td?(this.matteMasks={},(e=createNS("g")).setAttribute("id",this.layerId),e.appendChild(this.layerElement),this.globalData.defs.appendChild(i=e)):this.data.tt?(this.matteElement.appendChild(this.layerElement),i=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.ty||this.data.hd||(e=createNS("clipPath"),(r=createNS("path")).setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z"),t=createElementID(),e.setAttribute("id",t),e.appendChild(r),this.globalData.defs.appendChild(e),this.checkMasks()?((r=createNS("g")).setAttribute("clip-path","url("+getLocationHref()+"#"+t+")"),r.appendChild(this.layerElement),this.transformedElement=r,i?i.appendChild(this.transformedElement):this.baseElement=this.transformedElement):this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+t+")")),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._localMatMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.localMat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.localOpacity)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this),this.searchEffectTransforms()},getMatte:function(e){var t,r,i,n,a,s,o,l,u;return this.matteMasks||(this.matteMasks={}),this.matteMasks[e]||(t=this.layerId+"_"+e,1===e||3===e?((s=createNS("mask")).setAttribute("id",t),s.setAttribute("mask-type",3===e?"luminance":"alpha"),(n=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),s.appendChild(n),this.globalData.defs.appendChild(s),featureSupport.maskType||1!==e||(s.setAttribute("mask-type","luminance"),r=createElementID(),i=filtersFactory.createFilter(r),this.globalData.defs.appendChild(i),i.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(a=createNS("g")).appendChild(n),s.appendChild(a),a.setAttribute("filter","url("+getLocationHref()+"#"+r+")"))):2===e&&((s=createNS("mask")).setAttribute("id",t),s.setAttribute("mask-type","alpha"),o=createNS("g"),s.appendChild(o),r=createElementID(),i=filtersFactory.createFilter(r),(u=createNS("feComponentTransfer")).setAttribute("in","SourceGraphic"),i.appendChild(u),(l=createNS("feFuncA")).setAttribute("type","table"),l.setAttribute("tableValues","1.0 0.0"),u.appendChild(l),this.globalData.defs.appendChild(i),(u=createNS("rect")).setAttribute("width",this.comp.data.w),u.setAttribute("height",this.comp.data.h),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("fill","#ffffff"),u.setAttribute("opacity","0"),o.setAttribute("filter","url("+getLocationHref()+"#"+r+")"),o.appendChild(u),(n=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),o.appendChild(n),featureSupport.maskType||(s.setAttribute("mask-type","luminance"),i.appendChild(filtersFactory.createAlphaToLuminanceFilter()),a=createNS("g"),o.appendChild(u),a.appendChild(this.layerElement),o.appendChild(a)),this.globalData.defs.appendChild(s)),this.matteMasks[e]=t),this.matteMasks[e]},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+e+")")}},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},IShapeElement.prototype={addShapeToModifiers:function(e){for(var t=this.shapeModifiers.length,r=0;r<t;r+=1)this.shapeModifiers[r].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var t=this.shapeModifiers.length;0<t;)if(this.shapeModifiers[0].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){for(var e=this.shapes.length,t=0;t<e;t+=1)this.shapes[t].sh.reset();for(t=(e=this.shapeModifiers.length)-1;0<=t&&!this.shapeModifiers[t].processShapes(this._isFirstFrame);--t);}},searchProcessedElement:function(e){for(var t=this.processedElements,r=0,i=t.length;r<i;){if(t[r].elem===e)return t[r].pos;r+=1}return 0},addProcessedElement:function(e,t){for(var r=this.processedElements,i=r.length;i;)if(r[--i].elem===e)return void(r[i].pos=t);r.push(new ProcessedElement(e,t))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(e,t,r){this.caches=[],this.styles=[],this.transformers=e,this.lStr="",this.sh=r,this.lvl=t,this._isAnimated=!!r.k;for(var i=0,n=e.length;i<n;){if(e[i].mProps.dynamicProperties.length){this._isAnimated=!0;break}i+=1}}function SVGStyleData(e,t){this.data=e,this.type=e.ty,this.d="",this.lvl=t,this._mdf=!1,this.closed=!0===e.hd,this.pElem=createNS("path"),this.msElem=null}function DashProperty(e,t,r,i){this.elem=e,this.frameId=-1,this.dataProps=createSizedArray(t.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",t.length?t.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(i);for(var n,a=t.length||0,s=0;s<a;s+=1)n=PropertyFactory.getProp(e,t[s].v,0,0,this),this.k=n.k||this.k,this.dataProps[s]={n:t[s].n,p:n};this.k||this.getValue(!0),this._isAnimated=this.k}function SVGStrokeStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.c=PropertyFactory.getProp(e,t.c,1,255,this),this.style=r}function SVGNoStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.style=r}function GradientProperty(e,t,r){this.data=t,this.c=createTypedArray("uint8c",4*t.p);var i=t.k.k[0].s?t.k.k[0].s.length-4*t.p:t.k.k.length-4*t.p;this.o=createTypedArray("float32",i),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=i,this.initDynamicPropertyContainer(r),this.prop=PropertyFactory.getProp(e,t.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function SVGGradientFillStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.initGradientData(e,t,r)}function SVGGradientStrokeStyleData(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(e,t.w,0,null,this),this.d=new DashProperty(e,t.d||{},"svg",this),this.initGradientData(e,t,r),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(e,t,r){this.transform={mProps:e,op:t,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},DashProperty.prototype.getValue=function(e){if((this.elem.globalData.frameId!==this.frameId||e)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||e,this._mdf)){var t=0,r=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),t=0;t<r;t+=1)"o"!==this.dataProps[t].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[t].p.v:this.dashArray[t]=this.dataProps[t].p.v:this.dashoffset[0]=this.dataProps[t].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),extendPrototype([DynamicPropertyContainer],SVGNoStyleData),GradientProperty.prototype.comparePoints=function(e,t){for(var r=0,i=this.o.length/2;r<i;){if(.01<Math.abs(e[4*r]-e[4*t+2*r]))return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var e=0,t=this.data.k.k.length;e<t;){if(!this.comparePoints(this.data.k.k[e].s,this.data.p))return!1;e+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(e){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||e){for(var t,r,i=4*this.data.p,n=0;n<i;n+=1)t=n%4==0?100:255,r=Math.round(this.prop.v[n]*t),this.c[n]!==r&&(this.c[n]=r,this._cmdf=!e);if(this.o.length)for(i=this.prop.v.length,n=4*this.data.p;n<i;n+=1)t=n%2==0?100:1,r=n%2==0?Math.round(100*this.prop.v[n]):this.prop.v[n],this.o[n-4*this.data.p]!==r&&(this.o[n-4*this.data.p]=r,this._omdf=!e);this._mdf=!e}},extendPrototype([DynamicPropertyContainer],GradientProperty),SVGGradientFillStyleData.prototype.initGradientData=function(e,t,r){this.o=PropertyFactory.getProp(e,t.o,0,.01,this),this.s=PropertyFactory.getProp(e,t.s,1,null,this),this.e=PropertyFactory.getProp(e,t.e,1,null,this),this.h=PropertyFactory.getProp(e,t.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(e,t.a||{k:0},0,degToRads,this),this.g=new GradientProperty(e,t.g,this),this.style=r,this.stops=[],this.setGradientData(r.pElem,t),this.setGradientOpacity(t,r),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(e,t){for(var r,i=createElementID(),n=createNS(1===t.t?"linearGradient":"radialGradient"),a=(n.setAttribute("id",i),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse"),[]),s=4*t.g.p,o=0;o<s;o+=4)r=createNS("stop"),n.appendChild(r),a.push(r);e.setAttribute("gf"===t.ty?"fill":"stroke","url("+getLocationHref()+"#"+i+")"),this.gf=n,this.cst=a},SVGGradientFillStyleData.prototype.setGradientOpacity=function(e,t){if(this.g._hasOpacity&&!this.g._collapsable){for(var r,i,n=createNS("mask"),a=createNS("path"),s=(n.appendChild(a),createElementID()),o=createElementID(),l=(n.setAttribute("id",o),createNS(1===e.t?"linearGradient":"radialGradient")),u=(l.setAttribute("id",s),l.setAttribute("spreadMethod","pad"),l.setAttribute("gradientUnits","userSpaceOnUse"),i=(e.g.k.k[0].s||e.g.k.k).length,this.stops),c=4*e.g.p;c<i;c+=2)(r=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),l.appendChild(r),u.push(r);a.setAttribute("gf"===e.ty?"fill":"stroke","url("+getLocationHref()+"#"+s+")"),"gs"===e.ty&&(a.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),a.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),1===e.lj)&&a.setAttribute("stroke-miterlimit",e.ml),this.of=l,this.ms=n,this.ost=u,this.maskId=o,t.msElem=a}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var buildShapeString=function(e,t,r,i){if(0===t)return"";for(var n=e.o,a=e.i,s=e.v,o=" M"+i.applyToPointStringified(s[0][0],s[0][1]),l=1;l<t;l+=1)o+=" C"+i.applyToPointStringified(n[l-1][0],n[l-1][1])+" "+i.applyToPointStringified(a[l][0],a[l][1])+" "+i.applyToPointStringified(s[l][0],s[l][1]);return o=r&&t?o+(" C"+i.applyToPointStringified(n[l-1][0],n[l-1][1])+" "+i.applyToPointStringified(a[0][0],a[0][1])+" "+i.applyToPointStringified(s[0][0],s[0][1]))+"z":o},SVGElementsRenderer=(()=>{var m=new Matrix,g=new Matrix;function t(e,t,r){(r||t.transform.op._mdf)&&t.transform.container.setAttribute("opacity",t.transform.op.v),(r||t.transform.mProps._mdf)&&t.transform.container.setAttribute("transform",t.transform.mProps.v.to2dCSS())}function r(){}function i(e,t,r){for(var i,n,a,s,o,l,u,c,h,d=t.styles.length,p=t.lvl,f=0;f<d;f+=1){if(s=t.sh._mdf||r,t.styles[f].lvl<p){for(u=g.reset(),c=p-t.styles[f].lvl,h=t.transformers.length-1;!s&&0<c;)s=t.transformers[h].mProps._mdf||s,--c,--h;if(s)for(c=p-t.styles[f].lvl,h=t.transformers.length-1;0<c;)u.multiply(t.transformers[h].mProps.v),--c,--h}else u=m;if(n=(l=t.sh.paths)._length,s){for(a="",i=0;i<n;i+=1)(o=l.shapes[i])&&o._length&&(a+=buildShapeString(o,o._length,o.c,u));t.caches[f]=a}else a=t.caches[f];t.styles[f].d+=!0===e.hd?"":a,t.styles[f]._mdf=s||t.styles[f]._mdf}}function n(e,t,r){var i=t.style;(t.c._mdf||r)&&i.pElem.setAttribute("fill","rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r)&&i.pElem.setAttribute("fill-opacity",t.o.v)}function a(e,t,r){s(e,t,r),o(0,t,r)}function s(e,t,r){var i,n,a,s,o=t.gf,l=t.g._hasOpacity,u=t.s.v,c=t.e.v;if((t.o._mdf||r)&&(a="gf"===e.ty?"fill-opacity":"stroke-opacity",t.style.pElem.setAttribute(a,t.o.v)),(t.s._mdf||r)&&(s="x1"==(a=1===e.t?"x1":"cx")?"y1":"cy",o.setAttribute(a,u[0]),o.setAttribute(s,u[1]),l)&&!t.g._collapsable&&(t.of.setAttribute(a,u[0]),t.of.setAttribute(s,u[1])),t.g._cmdf||r)for(var h=t.cst,d=t.g.c,p=h.length,f=0;f<p;f+=1)(i=h[f]).setAttribute("offset",d[4*f]+"%"),i.setAttribute("stop-color","rgb("+d[4*f+1]+","+d[4*f+2]+","+d[4*f+3]+")");if(l&&(t.g._omdf||r)){var m=t.g.o;for(p=(h=t.g._collapsable?t.cst:t.ost).length,f=0;f<p;f+=1)i=h[f],t.g._collapsable||i.setAttribute("offset",m[2*f]+"%"),i.setAttribute("stop-opacity",m[2*f+1])}1===e.t?(t.e._mdf||r)&&(o.setAttribute("x2",c[0]),o.setAttribute("y2",c[1]),l)&&!t.g._collapsable&&(t.of.setAttribute("x2",c[0]),t.of.setAttribute("y2",c[1])):((t.s._mdf||t.e._mdf||r)&&(n=Math.sqrt(Math.pow(u[0]-c[0],2)+Math.pow(u[1]-c[1],2)),o.setAttribute("r",n),l)&&!t.g._collapsable&&t.of.setAttribute("r",n),(t.e._mdf||t.h._mdf||t.a._mdf||r)&&(n=n||Math.sqrt(Math.pow(u[0]-c[0],2)+Math.pow(u[1]-c[1],2)),a=Math.atan2(c[1]-u[1],c[0]-u[0]),1<=(s=t.h.v)?s=.99:s<=-1&&(s=-.99),e=n*s,r=Math.cos(a+t.a.v)*e+u[0],c=Math.sin(a+t.a.v)*e+u[1],o.setAttribute("fx",r),o.setAttribute("fy",c),l)&&!t.g._collapsable&&(t.of.setAttribute("fx",r),t.of.setAttribute("fy",c)))}function o(e,t,r){var i=t.style,n=t.d;n&&(n._mdf||r)&&n.dashStr&&(i.pElem.setAttribute("stroke-dasharray",n.dashStr),i.pElem.setAttribute("stroke-dashoffset",n.dashoffset[0])),t.c&&(t.c._mdf||r)&&i.pElem.setAttribute("stroke","rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r)&&i.pElem.setAttribute("stroke-opacity",t.o.v),(t.w._mdf||r)&&(i.pElem.setAttribute("stroke-width",t.w.v),i.msElem)&&i.msElem.setAttribute("stroke-width",t.w.v)}return{createRenderFunction:function(e){switch(e.ty){case"fl":return n;case"gf":return s;case"gs":return a;case"st":return o;case"sh":case"el":case"rc":case"sr":return i;case"tr":return t;case"no":return r;default:return null}}}})();function SVGShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(e,t,r),this.prevViewData=[]}function LetterProps(e,t,r,i,n,a){this.o=e,this.sw=t,this.sc=r,this.fc=i,this.m=n,this.p=a,this._mdf={o:!0,sw:!!t,sc:!!r,fc:!!i,m:!0,p:!0}}function TextProperty(e,t){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,t.d&&t.d.sid&&(t.d=e.globalData.slotManager.getProp(t.d)),this.data=t,this.elem=e,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){for(var e,t,r,i=this.shapes.length,n=this.stylesList.length,a=[],s=!1,o=0;o<n;o+=1){for(r=this.stylesList[o],s=!1,e=a.length=0;e<i;e+=1)-1!==(t=this.shapes[e]).styles.indexOf(r)&&(a.push(t),s=t._isAnimated||s);1<a.length&&s&&this.setShapesAsAnimated(a)}},SVGShapeElement.prototype.setShapesAsAnimated=function(e){for(var t=e.length,r=0;r<t;r+=1)e[r].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(e,t){var r,t=new SVGStyleData(e,t),i=t.pElem;return"st"===e.ty?r=new SVGStrokeStyleData(this,e,t):"fl"===e.ty?r=new SVGFillStyleData(this,e,t):"gf"===e.ty||"gs"===e.ty?(r=new("gf"===e.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,e,t),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),i.setAttribute("mask","url("+getLocationHref()+"#"+r.maskId+")"))):"no"===e.ty&&(r=new SVGNoStyleData(this,e,t)),"st"!==e.ty&&"gs"!==e.ty||(i.setAttribute("stroke-linecap",lineCapEnum[e.lc||2]),i.setAttribute("stroke-linejoin",lineJoinEnum[e.lj||2]),i.setAttribute("fill-opacity","0"),1===e.lj&&i.setAttribute("stroke-miterlimit",e.ml)),2===e.r&&i.setAttribute("fill-rule","evenodd"),e.ln&&i.setAttribute("id",e.ln),e.cl&&i.setAttribute("class",e.cl),e.bm&&(i.style["mix-blend-mode"]=getBlendMode(e.bm)),this.stylesList.push(t),this.addToAnimatedContents(e,r),r},SVGShapeElement.prototype.createGroupElement=function(e){var t=new ShapeGroupData;return e.ln&&t.gr.setAttribute("id",e.ln),e.cl&&t.gr.setAttribute("class",e.cl),e.bm&&(t.gr.style["mix-blend-mode"]=getBlendMode(e.bm)),t},SVGShapeElement.prototype.createTransformElement=function(e,t){var r=TransformPropertyFactory.getTransformProperty(this,e,this),r=new SVGTransformData(r,r.o,t);return this.addToAnimatedContents(e,r),r},SVGShapeElement.prototype.createShapeElement=function(e,t,r){var i=4;"rc"===e.ty?i=5:"el"===e.ty?i=6:"sr"===e.ty&&(i=7);t=new SVGShapeData(t,r,ShapePropertyFactory.getShapeProp(this,e,i,this));return this.shapes.push(t),this.addShapeToModifiers(t),this.addToAnimatedContents(e,t),t},SVGShapeElement.prototype.addToAnimatedContents=function(e,t){for(var r=0,i=this.animatedContents.length;r<i;){if(this.animatedContents[r].element===t)return;r+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(e),element:t,data:e})},SVGShapeElement.prototype.setElementStyles=function(e){for(var t=e.styles,r=this.stylesList.length,i=0;i<r;i+=1)this.stylesList[i].closed||t.push(this.stylesList[i])},SVGShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;for(var e=this.itemsData.length,t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(e,t,r,i,n,a,s){for(var o,l,u,c,h,d=[].concat(a),p=e.length-1,f=[],m=[],g=p;0<=g;--g){if((h=this.searchProcessedElement(e[g]))?t[g]=r[h-1]:e[g]._render=s,"fl"===e[g].ty||"st"===e[g].ty||"gf"===e[g].ty||"gs"===e[g].ty||"no"===e[g].ty)h?t[g].style.closed=!1:t[g]=this.createStyleElement(e[g],n),e[g]._render&&t[g].style.pElem.parentNode!==i&&i.appendChild(t[g].style.pElem),f.push(t[g].style);else if("gr"===e[g].ty){if(h)for(l=t[g].it.length,o=0;o<l;o+=1)t[g].prevViewData[o]=t[g].it[o];else t[g]=this.createGroupElement(e[g]);this.searchShapes(e[g].it,t[g].it,t[g].prevViewData,t[g].gr,n+1,d,s),e[g]._render&&t[g].gr.parentNode!==i&&i.appendChild(t[g].gr)}else"tr"===e[g].ty?(h||(t[g]=this.createTransformElement(e[g],i)),u=t[g].transform,d.push(u)):"sh"===e[g].ty||"rc"===e[g].ty||"el"===e[g].ty||"sr"===e[g].ty?(h||(t[g]=this.createShapeElement(e[g],d,n)),this.setElementStyles(t[g])):"tm"===e[g].ty||"rd"===e[g].ty||"ms"===e[g].ty||"pb"===e[g].ty||"zz"===e[g].ty||"op"===e[g].ty?(h?(c=t[g]).closed=!1:((c=ShapeModifiers.getModifier(e[g].ty)).init(this,e[g]),t[g]=c,this.shapeModifiers.push(c)),m.push(c)):"rp"===e[g].ty&&(h?(c=t[g]).closed=!0:(c=ShapeModifiers.getModifier(e[g].ty),(t[g]=c).init(this,e,g,t),this.shapeModifiers.push(c),s=!1),m.push(c));this.addProcessedElement(e[g],g+1)}for(p=f.length,g=0;g<p;g+=1)f[g].closed=!0;for(p=m.length,g=0;g<p;g+=1)m[g].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){this.renderModifiers();for(var e=this.stylesList.length,t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){for(var e,t=this.animatedContents.length,r=0;r<t;r+=1)e=this.animatedContents[r],(this._isFirstFrame||e.element._isAnimated)&&!0!==e.data&&e.fn(e.data,e.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},LetterProps.prototype.update=function(e,t,r,i,n,a){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1;var s=this._mdf.p=!1;return this.o!==e&&(this.o=e,s=this._mdf.o=!0),this.sw!==t&&(this.sw=t,s=this._mdf.sw=!0),this.sc!==r&&(this.sc=r,s=this._mdf.sc=!0),this.fc!==i&&(this.fc=i,s=this._mdf.fc=!0),this.m!==n&&(this.m=n,s=this._mdf.m=!0),!a.length||this.p[0]===a[0]&&this.p[1]===a[1]&&this.p[4]===a[4]&&this.p[5]===a[5]&&this.p[12]===a[12]&&this.p[13]===a[13]||(this.p=a,s=this._mdf.p=!0),s},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},TextProperty.prototype.setCurrentData=function(e){e.__complete||this.completeTextData(e),this.currentData=e,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=1<this.data.d.k.length,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(e){this.effectsSequence.push(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(e){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||e){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var t=this.currentData,r=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{this.lock=!0,this._mdf=!1;for(var i=this.effectsSequence.length,n=e||this.data.d.k[this.keysIndex].s,a=0;a<i;a+=1)n=r!==this.keysIndex?this.effectsSequence[a](n,n.t):this.effectsSequence[a](this.currentData,n.t);t!==n&&this.setCurrentData(n),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var e=this.data.d.k,t=this.elem.comp.renderedFrame,r=0,i=e.length;r<=i-1&&!(r===i-1||e[r+1].t>t);)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(e){for(var t,r,i=[],n=0,a=e.length,s=!1,o=!1,l="";n<a;)s=o,o=!1,t=e.charCodeAt(n),l=e.charAt(n),FontManager.isCombinedCharacter(t)?s=!0:55296<=t&&t<=56319?FontManager.isRegionalFlag(e,n)?l=e.substr(n,14):56320<=(r=e.charCodeAt(n+1))&&r<=57343&&(FontManager.isModifier(t,r)?(l=e.substr(n,2),s=!0):l=FontManager.isFlagEmoji(e.substr(n,4))?e.substr(n,4):e.substr(n,2)):56319<t?(r=e.charCodeAt(n+1),FontManager.isVariationSelector(t)&&(s=!0)):FontManager.isZeroWidthJoiner(t)&&(o=s=!0),s?(i[i.length-1]+=l,s=!1):i.push(l),n+=l.length;return i},TextProperty.prototype.completeTextData=function(e){e.__complete=!0;var t,r,i,n,a=this.elem.globalData.fontManager,s=this.data,o=[],l=0,u=s.m.g,c=0,h=0,d=0,p=[],f=0,m=0,g=a.getFontByName(e.f),v=0,y=getFontProperties(g),_=(e.fWeight=y.weight,e.fStyle=y.style,e.finalSize=e.s,e.finalText=this.buildFinalText(e.t),T=e.finalText.length,e.finalLineHeight=e.lh,e.tr/1e3*e.finalSize);if(e.sz)for(var b=!0,$=e.sz[0],B=e.sz[1];b;){for(var x,S=0,f=0,T=(x=this.buildFinalText(e.t)).length,_=e.tr/1e3*e.finalSize,E=-1,C=0;C<T;C+=1)n=x[C].charCodeAt(0),t=!1," "===x[C]?E=C:13!==n&&3!==n||(t=!(f=0),S+=e.finalLineHeight||1.2*e.finalSize),f=$<f+(v=a.chars?(i=a.getCharData(x[C],g.fStyle,g.fFamily),t?0:i.w*e.finalSize/100):a.measureText(x[C],e.f,e.finalSize))&&" "!==x[C]?(-1===E?T+=1:C=E,S+=e.finalLineHeight||1.2*e.finalSize,x.splice(C,E===C?1:0,"\r"),E=-1,0):f+v+_;S+=g.ascent*e.finalSize/100,this.canResize&&e.finalSize>this.minimumFontSize&&B<S?(--e.finalSize,e.finalLineHeight=e.finalSize*e.lh/e.s):(e.finalText=x,T=e.finalText.length,b=!1)}f=-_;var A,v=0,w=0;for(C=0;C<T;C+=1)if(t=!1,13===(n=(A=e.finalText[C]).charCodeAt(0))||3===n?(w=0,p.push(f),m=m<f?f:m,f=-2*_,t=!(r=""),d+=1):r=A,v=a.chars?(i=a.getCharData(A,g.fStyle,a.getFontByName(e.f).fFamily),t?0:i.w*e.finalSize/100):a.measureText(r,e.f,e.finalSize)," "===A?w+=v+_:(f+=v+_+w,w=0),o.push({l:v,an:v,add:c,n:t,anIndexes:[],val:r,line:d,animatorJustifyOffset:0}),2==u){if(c+=v,""===r||" "===r||C===T-1){for(""!==r&&" "!==r||(c-=v);h<=C;)o[h].an=c,o[h].ind=l,o[h].extra=v,h+=1;l+=1,c=0}}else if(3==u){if(c+=v,""===r||C===T-1){for(""===r&&(c-=v);h<=C;)o[h].an=c,o[h].ind=l,o[h].extra=v,h+=1;c=0,l+=1}}else o[l].ind=l,o[l].extra=0,l+=1;if(e.l=o,m=m<f?f:m,p.push(f),e.sz)e.boxWidth=e.sz[0],e.justifyOffset=0;else switch(e.boxWidth=m,e.j){case 1:e.justifyOffset=-e.boxWidth;break;case 2:e.justifyOffset=-e.boxWidth/2;break;default:e.justifyOffset=0}e.lineWidths=p;for(var P,M,I,D,R=s.a,L=R.length,k=[],O=0;O<L;O+=1){for((P=R[O]).a.sc&&(e.strokeColorAnim=!0),P.a.sw&&(e.strokeWidthAnim=!0),(P.a.fc||P.a.fh||P.a.fs||P.a.fb)&&(e.fillColorAnim=!0),I=P.s.b,C=D=0;C<T;C+=1)(M=o[C]).anIndexes[O]=D,(1==I&&""!==M.val||2==I&&""!==M.val&&" "!==M.val||3==I&&(M.n||" "==M.val||C==T-1)||4==I&&(M.n||C==T-1))&&(1===P.s.rn&&k.push(D),D+=1);s.a[O].s.totalChars=D;var F,N=-1;if(1===P.s.rn)for(C=0;C<T;C+=1)N!=(M=o[C]).anIndexes[O]&&(N=M.anIndexes[O],F=k.splice(Math.floor(Math.random()*k.length),1)[0]),M.anIndexes[O]=F}e.yOffset=e.finalLineHeight||1.2*e.finalSize,e.ls=e.ls||0,e.ascent=g.ascent*e.finalSize/100},TextProperty.prototype.updateDocumentData=function(e,t){t=void 0===t?this.keysIndex:t;var r=this.copyData({},this.data.d.k[t].s),r=this.copyData(r,e);this.data.d.k[t].s=r,this.recalculate(t),this.setCurrentData(r),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(e){e=this.data.d.k[e].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},TextProperty.prototype.canResizeFont=function(e){this.canResize=e,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(e){this.minimumFontSize=Math.floor(e)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=(()=>{var o=Math.max,l=Math.min,u=Math.floor;function i(e,t){this._currentTextLength=-1,this.k=!1,this.data=t,this.elem=e,this.comp=e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(e),this.s=PropertyFactory.getProp(e,t.s||{k:0},0,0,this),"e"in t?this.e=PropertyFactory.getProp(e,t.e,0,0,this):this.e={v:100},this.o=PropertyFactory.getProp(e,t.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(e,t.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(e,t.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(e,t.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(e,t.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return i.prototype={getMult:function(e){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var t,r=0,i=0,n=1,a=1,r=(0<this.ne.v?r=this.ne.v/100:i=-this.ne.v/100,0<this.xe.v?n=1-this.xe.v/100:a=1+this.xe.v/100,BezierFactory.getBezierEasing(r,i,n,a).get),i=0,n=this.finalS,a=this.finalE,s=this.data.sh;return i=2===s?r(i=a===n?a<=e?1:0:o(0,l(.5/(a-n)+(e-n)/(a-n),1))):3===s?r(i=a===n?a<=e?0:1:1-o(0,l(.5/(a-n)+(e-n)/(a-n),1))):4===s?(a===n?i=0:(i=o(0,l(.5/(a-n)+(e-n)/(a-n),1)))<.5?i*=2:i=1-2*(i-.5),r(i)):r(i=5===s?a===n?0:(t=-(r=a-n)/2+(e=l(o(0,e+.5-n),a-n)),r=r/2,Math.sqrt(1-t*t/(r*r))):6===s?a===n?0:(e=l(o(0,e+.5-n),a-n),(1+Math.cos(Math.PI+2*Math.PI*e/(a-n)))/2):e>=u(n)?o(0,l(e-n<0?l(a,1)-(n-e):a-e,1)):i),100!==this.sm.v&&(i<(r=.5-.5*(t=0===(t=.01*this.sm.v)?1e-8:t))?i=0:1<(i=(i-r)/t)&&(i=1)),i*this.a.v},getValue:function(e){this.iterateDynamicProperties(),this._mdf=e||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,e&&2===this.data.r&&(this.e.v=this._currentTextLength);var e=2===this.data.r?1:100/this.data.totalChars,t=this.o.v/e,r=this.s.v/e+t,e=this.e.v/e+t;e<r&&(t=r,r=e,e=t),this.finalS=r,this.finalE=e}},extendPrototype([DynamicPropertyContainer],i),{getTextSelectorProp:function(e,t,r){return new i(e,t)}}})();function TextAnimatorDataProperty(e,t,r){var i={propType:!1},n=PropertyFactory.getProp,a=t.a;this.a={r:a.r?n(e,a.r,0,degToRads,r):i,rx:a.rx?n(e,a.rx,0,degToRads,r):i,ry:a.ry?n(e,a.ry,0,degToRads,r):i,sk:a.sk?n(e,a.sk,0,degToRads,r):i,sa:a.sa?n(e,a.sa,0,degToRads,r):i,s:a.s?n(e,a.s,1,.01,r):i,a:a.a?n(e,a.a,1,0,r):i,o:a.o?n(e,a.o,0,.01,r):i,p:a.p?n(e,a.p,1,0,r):i,sw:a.sw?n(e,a.sw,0,0,r):i,sc:a.sc?n(e,a.sc,1,0,r):i,fc:a.fc?n(e,a.fc,1,0,r):i,fh:a.fh?n(e,a.fh,0,0,r):i,fs:a.fs?n(e,a.fs,0,.01,r):i,fb:a.fb?n(e,a.fb,0,.01,r):i,t:a.t?n(e,a.t,0,0,r):i},this.s=TextSelectorProp.getTextSelectorProp(e,t.s,r),this.s.t=t.s.t}function TextAnimatorProperty(e,t,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=e,this._renderType=t,this._elem=r,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}function ITextElement(){}TextAnimatorProperty.prototype.searchProperties=function(){for(var e,t=this._textData.a.length,r=PropertyFactory.getProp,i=0;i<t;i+=1)e=this._textData.a[i],this._animatorsData[i]=new TextAnimatorDataProperty(this._elem,e,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:r(this._elem,this._textData.p.a,0,0,this),f:r(this._elem,this._textData.p.f,0,0,this),l:r(this._elem,this._textData.p.l,0,0,this),r:r(this._elem,this._textData.p.r,0,0,this),p:r(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=r(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(e,$){if(this.lettersChangedFlag=$,this._mdf||this._isFirstFrame||$||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var t,r,i,B,n,a,s,o,l,L,u,N,c,h=this._moreOptions.alignment.v,d=this._animatorsData,p=this._textData,f=this.mHelper,G=this._renderType,z=this.renderedLetters.length,m=e.l;if(this._hasMaskedPath){if(c=this._pathData.m,!this._pathData.n||this._pathData._mdf){for(var g,v=c.v,y={tLength:0,segments:[]},_=(v=this._pathData.r.v?v.reverse():v)._length-1,b=u=0;b<_;b+=1)g=bez.buildBezierData(v.v[b],v.v[b+1],[v.o[b][0]-v.v[b][0],v.o[b][1]-v.v[b][1]],[v.i[b+1][0]-v.v[b+1][0],v.i[b+1][1]-v.v[b+1][1]]),y.tLength+=g.segmentLength,y.segments.push(g),u+=g.segmentLength;b=_,c.v.c&&(g=bez.buildBezierData(v.v[b],v.v[0],[v.o[b][0]-v.v[b][0],v.o[b][1]-v.v[b][1]],[v.i[0][0]-v.v[0][0],v.i[0][1]-v.v[0][1]]),y.tLength+=g.segmentLength,y.segments.push(g),u+=g.segmentLength),this._pathData.pi=y}if(y=this._pathData.pi,t=this._pathData.f.v,n=1,B=!(i=a=0),l=y.segments,t<0&&c.v.c)for(y.tLength<Math.abs(t)&&(t=-Math.abs(t)%y.tLength),n=(o=l[a=l.length-1].points).length-1;t<0;)t+=o[n].partialLength,--n<0&&(n=(o=l[--a].points).length-1);s=(o=l[a].points)[n-1],L=(r=o[n]).partialLength}_=m.length;var x,U,S,T,j,V,E,C,A,w,P,H,W,Y,X,q,M=0,K=0,Q=1.2*e.finalSize*.714,Z=!0,I=d.length,D=-1,J=t,ee=a,te=n,re=-1,ie="",ne=this.defaultPropsArray;if(2===e.j||1===e.j){var R=0,ae=0,se=2===e.j?-.5:-1,k=0,oe=!0;for(b=0;b<_;b+=1)if(m[b].n){for(R&&(R+=ae);k<b;)m[k].animatorJustifyOffset=R,k+=1;oe=!(R=0)}else{for(F=0;F<I;F+=1)(x=d[F].a).t.propType&&(oe&&2===e.j&&(ae+=x.t.v*se),(S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars)).length?R+=x.t.v*S[0]*se:R+=x.t.v*S*se);oe=!1}for(R&&(R+=ae);k<b;)m[k].animatorJustifyOffset=R,k+=1}for(b=0;b<_;b+=1){if(f.reset(),E=1,m[b].n)M=0,K=K+e.yOffset+(Z?1:0),t=J,Z=!1,this._hasMaskedPath&&(s=(o=l[a=ee].points)[(n=te)-1],L=(r=o[n]).partialLength,i=0),X=H=Y=ie="",ne=this.defaultPropsArray;else{if(this._hasMaskedPath){if(re!==m[b].line){switch(e.j){case 1:t+=u-e.lineWidths[m[b].line];break;case 2:t+=(u-e.lineWidths[m[b].line])/2}re=m[b].line}D!==m[b].ind&&(m[D]&&(t+=m[D].extra),t+=m[b].an/2,D=m[b].ind),t+=h[0]*m[b].an*.005;for(var O=0,F=0;F<I;F+=1)(x=d[F].a).p.propType&&((S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars)).length?O+=x.p.v[0]*S[0]:O+=x.p.v[0]*S),x.a.propType&&((S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars)).length?O+=x.a.v[0]*S[0]:O+=x.a.v[0]*S);for(B=!0,this._pathData.a.v&&(t=.5*m[0].an+(u-this._pathData.f.v-.5*m[0].an-.5*m[m.length-1].an)*D/(_-1),t+=this._pathData.f.v);B;)t+O<=i+L||!o?(N=(t+O-i)/r.partialLength,j=s.point[0]+(r.point[0]-s.point[0])*N,V=s.point[1]+(r.point[1]-s.point[1])*N,f.translate(-h[0]*m[b].an*.005,-h[1]*Q*.01),B=!1):o&&(i+=r.partialLength,(n+=1)>=o.length&&(n=0,o=l[a+=1]?l[a].points:c.v.c?l[a=n=0].points:(i-=r.partialLength,null)),o)&&(s=r,L=(r=o[n]).partialLength);T=m[b].an/2-m[b].add,f.translate(-T,0,0)}else T=m[b].an/2-m[b].add,f.translate(-T,0,0),f.translate(-h[0]*m[b].an*.005,-h[1]*Q*.01,0);for(F=0;F<I;F+=1)(x=d[F].a).t.propType&&(S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars),0===M&&0===e.j||(this._hasMaskedPath?S.length?t+=x.t.v*S[0]:t+=x.t.v*S:S.length?M+=x.t.v*S[0]:M+=x.t.v*S));for(e.strokeWidthAnim&&(A=e.sw||0),e.strokeColorAnim&&(C=e.sc?[e.sc[0],e.sc[1],e.sc[2]]:[0,0,0]),e.fillColorAnim&&e.fc&&(w=[e.fc[0],e.fc[1],e.fc[2]]),F=0;F<I;F+=1)(x=d[F].a).a.propType&&((S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars)).length?f.translate(-x.a.v[0]*S[0],-x.a.v[1]*S[1],x.a.v[2]*S[2]):f.translate(-x.a.v[0]*S,-x.a.v[1]*S,x.a.v[2]*S));for(F=0;F<I;F+=1)(x=d[F].a).s.propType&&((S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars)).length?f.scale(1+(x.s.v[0]-1)*S[0],1+(x.s.v[1]-1)*S[1],1):f.scale(1+(x.s.v[0]-1)*S,1+(x.s.v[1]-1)*S,1));for(F=0;F<I;F+=1){if(x=d[F].a,S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars),x.sk.propType&&(S.length?f.skewFromAxis(-x.sk.v*S[0],x.sa.v*S[1]):f.skewFromAxis(-x.sk.v*S,x.sa.v*S)),x.r.propType&&(S.length?f.rotateZ(-x.r.v*S[2]):f.rotateZ(-x.r.v*S)),x.ry.propType&&(S.length?f.rotateY(x.ry.v*S[1]):f.rotateY(x.ry.v*S)),x.rx.propType&&(S.length?f.rotateX(x.rx.v*S[0]):f.rotateX(x.rx.v*S)),x.o.propType&&(S.length?E+=(x.o.v*S[0]-E)*S[0]:E+=(x.o.v*S-E)*S),e.strokeWidthAnim&&x.sw.propType&&(S.length?A+=x.sw.v*S[0]:A+=x.sw.v*S),e.strokeColorAnim&&x.sc.propType)for(P=0;P<3;P+=1)S.length?C[P]+=(x.sc.v[P]-C[P])*S[0]:C[P]+=(x.sc.v[P]-C[P])*S;if(e.fillColorAnim&&e.fc){if(x.fc.propType)for(P=0;P<3;P+=1)S.length?w[P]+=(x.fc.v[P]-w[P])*S[0]:w[P]+=(x.fc.v[P]-w[P])*S;x.fh.propType&&(w=S.length?addHueToRGB(w,x.fh.v*S[0]):addHueToRGB(w,x.fh.v*S)),x.fs.propType&&(w=S.length?addSaturationToRGB(w,x.fs.v*S[0]):addSaturationToRGB(w,x.fs.v*S)),x.fb.propType&&(w=S.length?addBrightnessToRGB(w,x.fb.v*S[0]):addBrightnessToRGB(w,x.fb.v*S))}}for(F=0;F<I;F+=1)(x=d[F].a).p.propType&&(S=d[F].s.getMult(m[b].anIndexes[F],p.a[F].s.totalChars),this._hasMaskedPath?S.length?f.translate(0,x.p.v[1]*S[0],-x.p.v[2]*S[1]):f.translate(0,x.p.v[1]*S,-x.p.v[2]*S):S.length?f.translate(x.p.v[0]*S[0],x.p.v[1]*S[1],-x.p.v[2]*S[2]):f.translate(x.p.v[0]*S,x.p.v[1]*S,-x.p.v[2]*S));if(e.strokeWidthAnim&&(H=A<0?0:A),e.strokeColorAnim&&(W="rgb("+Math.round(255*C[0])+","+Math.round(255*C[1])+","+Math.round(255*C[2])+")"),e.fillColorAnim&&e.fc&&(Y="rgb("+Math.round(255*w[0])+","+Math.round(255*w[1])+","+Math.round(255*w[2])+")"),this._hasMaskedPath)f.translate(0,-e.ls),f.translate(0,h[1]*Q*.01+K,0),this._pathData.p.v&&(q=(r.point[1]-s.point[1])/(r.point[0]-s.point[0]),q=180*Math.atan(q)/Math.PI,r.point[0]<s.point[0]&&(q+=180),f.rotate(-q*Math.PI/180)),f.translate(j,V,0),t-=h[0]*m[b].an*.005,m[b+1]&&D!==m[b+1].ind&&(t=(t+=m[b].an/2)+.001*e.tr*e.finalSize);else{switch(f.translate(M,K,0),e.ps&&f.translate(e.ps[0],e.ps[1]+e.ascent,0),e.j){case 1:f.translate(m[b].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[m[b].line]),0,0);break;case 2:f.translate(m[b].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[m[b].line])/2,0,0)}f.translate(0,-e.ls),f.translate(T,0,0),f.translate(h[0]*m[b].an*.005,h[1]*Q*.01,0),M+=m[b].l+.001*e.tr*e.finalSize}"html"===G?ie=f.toCSS():"svg"===G?ie=f.to2dCSS():ne=[f.props[0],f.props[1],f.props[2],f.props[3],f.props[4],f.props[5],f.props[6],f.props[7],f.props[8],f.props[9],f.props[10],f.props[11],f.props[12],f.props[13],f.props[14],f.props[15]],X=E}z<=b?(U=new LetterProps(X,H,W,Y,ie,ne),this.renderedLetters.push(U),z+=1,this.lettersChangedFlag=!0):(U=this.renderedLetters[b],this.lettersChangedFlag=U.update(X,H,W,Y,ie,ne)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),ITextElement.prototype.initElement=function(e,t,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(e,t,r),this.textProperty=new TextProperty(this,e.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(e.t,this.renderType,this),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)},ITextElement.prototype.createPathShape=function(e,t){for(var r,i=t.length,n="",a=0;a<i;a+=1)"sh"===t[a].ty&&(r=t[a].ks.k,n+=buildShapeString(r,r.i.length,!0,e));return n},ITextElement.prototype.updateDocumentData=function(e,t){this.textProperty.updateDocumentData(e,t)},ITextElement.prototype.canResizeFont=function(e){this.textProperty.canResizeFont(e)},ITextElement.prototype.setMinimumFontSize=function(e){this.textProperty.setMinimumFontSize(e)},ITextElement.prototype.applyTextPropertiesToMatrix=function(e,t,r,i,n){switch(e.ps&&t.translate(e.ps[0],e.ps[1]+e.ascent,0),t.translate(0,-e.ls,0),e.j){case 1:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r]),0,0);break;case 2:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r])/2,0,0)}t.translate(i,n,0)},ITextElement.prototype.buildColor=function(e){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},ITextElement.prototype.validateText=function(){(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)};var emptyShapeData={shapes:[]};function SVGTextLottieElement(e,t,r){this.textSpans=[],this.renderType="svg",this.initElement(e,t,r)}function ISolidElement(e,t,r){this.initElement(e,t,r)}function NullElement(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initFrame(),this.initTransform(e,t,r),this.initHierarchy()}function SVGRendererBase(){}function ICompElement(){}function SVGCompElement(e,t,r){this.layers=e.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function SVGRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var e="",r=(t&&t.title&&(r=createNS("title"),i=createElementID(),r.setAttribute("id",i),r.textContent=t.title,this.svgElement.appendChild(r),e+=i),t&&t.description&&(r=createNS("desc"),i=createElementID(),r.setAttribute("id",i),r.textContent=t.description,this.svgElement.appendChild(r),e+=" "+i),e&&this.svgElement.setAttribute("aria-labelledby",e),createNS("defs")),i=(this.svgElement.appendChild(r),createNS("g"));this.svgElement.appendChild(i),this.layerElement=i,this.renderConfig={preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",progressiveLoad:t&&t.progressiveLoad||!1,hideOnTransparent:!(t&&!1===t.hideOnTransparent),viewBoxOnly:t&&t.viewBoxOnly||!1,viewBoxSize:t&&t.viewBoxSize||!1,className:t&&t.className||"",id:t&&t.id||"",focusable:t&&t.focusable,filterSize:{width:t&&t.filterSize&&t.filterSize.width||"100%",height:t&&t.filterSize&&t.filterSize.height||"100%",x:t&&t.filterSize&&t.filterSize.x||"0%",y:t&&t.filterSize&&t.filterSize.y||"0%"},width:t&&t.width,height:t&&t.height,runExpressions:!t||void 0===t.runExpressions||t.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:r,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(e){for(var t=0,r=e.length,i=[],n="";t<r;)e[t]===String.fromCharCode(13)||e[t]===String.fromCharCode(3)?(i.push(n),n=""):n+=e[t],t+=1;return i.push(n),i},SVGTextLottieElement.prototype.buildShapeData=function(e,t){var r;return e.shapes&&e.shapes.length&&(r=e.shapes[0]).it&&(r=r.it[r.it.length-1]).s&&(r.s.k[0]=t,r.s.k[1]=t),e},SVGTextLottieElement.prototype.buildNewText=function(){this.addDynamicProperty(this);var e,t,r=this.textProperty.currentData,i=(this.renderedLetters=createSizedArray(r?r.l.length:0),r.fc?this.layerElement.setAttribute("fill",this.buildColor(r.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),r.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(r.sc)),this.layerElement.setAttribute("stroke-width",r.sw)),this.layerElement.setAttribute("font-size",r.finalSize),this.globalData.fontManager.getFontByName(r.f)),n=(i.fClass?this.layerElement.setAttribute("class",i.fClass):(this.layerElement.setAttribute("font-family",i.fFamily),e=r.fWeight,t=r.fStyle,this.layerElement.setAttribute("font-style",t),this.layerElement.setAttribute("font-weight",e)),this.layerElement.setAttribute("aria-label",r.t),r.l||[]),a=!!this.globalData.fontManager.chars,s=(b=n.length,this.mHelper),o=this.data.singleShape,l=0,u=0,c=!0,h=.001*r.tr*r.finalSize;if(!o||a||r.sz){var d,p,f,m,g=this.textSpans.length;for(x=0;x<b;x+=1)this.textSpans[x]||(this.textSpans[x]={span:null,childSpan:null,glyph:null}),a&&o&&0!==x||(d=x<g?this.textSpans[x].span:createNS(a?"g":"text"),g<=x&&(d.setAttribute("stroke-linecap","butt"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit","4"),this.textSpans[x].span=d,a&&(m=createNS("g"),d.appendChild(m),this.textSpans[x].childSpan=m),this.textSpans[x].span=d,this.layerElement.appendChild(d)),d.style.display="inherit"),s.reset(),o&&(n[x].n&&(l=-h,u=u+r.yOffset+(c?1:0),c=!1),this.applyTextPropertiesToMatrix(r,s,n[x].line,l,u),l=l+(n[x].l||0)+h),a?(p=1===(m=this.globalData.fontManager.getCharData(r.finalText[x],i.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily)).t?new SVGCompElement(m.data,this.globalData,this):(p=emptyShapeData,new SVGShapeElement(p=m.data&&m.data.shapes?this.buildShapeData(m.data,r.finalSize):p,this.globalData,this)),this.textSpans[x].glyph&&(f=this.textSpans[x].glyph,this.textSpans[x].childSpan.removeChild(f.layerElement),f.destroy()),(this.textSpans[x].glyph=p)._debug=!0,p.prepareFrame(0),p.renderFrame(),this.textSpans[x].childSpan.appendChild(p.layerElement),1===m.t&&this.textSpans[x].childSpan.setAttribute("transform","scale("+r.finalSize/100+","+r.finalSize/100+")")):(o&&d.setAttribute("transform","translate("+s.props[12]+","+s.props[13]+")"),d.textContent=n[x].val,d.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"));o&&d&&d.setAttribute("d","")}else{var v=this.textContainer,y="start";switch(r.j){case 1:y="end";break;case 2:y="middle";break;default:y="start"}v.setAttribute("text-anchor",y),v.setAttribute("letter-spacing",h);for(var _=this.buildTextContents(r.finalText),b=_.length,u=r.ps?r.ps[1]+r.ascent:0,x=0;x<b;x+=1)(d=this.textSpans[x].span||createNS("tspan")).textContent=_[x],d.setAttribute("x",0),d.setAttribute("y",u),d.style.display="inherit",v.appendChild(d),this.textSpans[x]||(this.textSpans[x]={span:null,glyph:null}),this.textSpans[x].span=d,u+=r.finalLineHeight;this.layerElement.appendChild(v)}for(;x<this.textSpans.length;)this.textSpans[x].span.style.display="none",x+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){var e;return this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged&&(this._sizeChanged=!1,e=this.layerElement.getBBox(),this.bbox={top:e.y,left:e.x,width:e.width,height:e.height}),this.bbox},SVGTextLottieElement.prototype.getValue=function(){var e,t,r=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,e=0;e<r;e+=1)(t=this.textSpans[e].glyph)&&(t.prepareFrame(this.comp.renderedFrame-this.data.st),t._mdf)&&(this._mdf=!0)},SVGTextLottieElement.prototype.renderInnerContent=function(){if(this.validateText(),(!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){this._sizeChanged=!0;for(var e,t,r,i=this.textAnimator.renderedLetters,n=this.textProperty.currentData.l,a=n.length,s=0;s<a;s+=1)n[s].n||(e=i[s],t=this.textSpans[s].span,(r=this.textSpans[s].glyph)&&r.renderFrame(),e._mdf.m&&t.setAttribute("transform",e.m),e._mdf.o&&t.setAttribute("opacity",e.o),e._mdf.sw&&t.setAttribute("stroke-width",e.sw),e._mdf.sc&&t.setAttribute("stroke",e.sc),e._mdf.fc&&t.setAttribute("fill",e.fc))}},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var e=createNS("rect");e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.layerElement.appendChild(e)},NullElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(e){return new NullElement(e,this.globalData,this)},SVGRendererBase.prototype.createShape=function(e){return new SVGShapeElement(e,this.globalData,this)},SVGRendererBase.prototype.createText=function(e){return new SVGTextLottieElement(e,this.globalData,this)},SVGRendererBase.prototype.createImage=function(e){return new IImageElement(e,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(e){return new ISolidElement(e,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(e){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+e.w+" "+e.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",e.w),this.svgElement.setAttribute("height",e.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var t=this.globalData.defs,r=(this.setupGlobalData(e,t),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=e,createNS("clipPath")),i=createNS("rect"),n=(i.setAttribute("width",e.w),i.setAttribute("height",e.h),i.setAttribute("x",0),i.setAttribute("y",0),createElementID());r.setAttribute("id",n),r.appendChild(i),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+n+")"),t.appendChild(r),this.layers=e.layers,this.elements=createSizedArray(e.layers.length)},SVGRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;for(var e=this.layers?this.layers.length:0,t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(e){for(var t=0,r=this.layers.length,t=0;t<r;t+=1)if(this.layers[t].ind===e)return t;return-1},SVGRendererBase.prototype.buildItem=function(e){var t,r,i=this.elements;i[e]||99===this.layers[e].ty||(i[e]=!0,t=this.createItem(this.layers[e]),i[e]=t,getExpressionsPlugin()&&(0===this.layers[e].ty&&this.globalData.projectInterface.registerComposition(t),t.initExpressions()),this.appendElementInPos(t,e),this.layers[e].tt&&-1!==(r="tp"in this.layers[e]?this.findIndexByInd(this.layers[e].tp):e-1)&&(this.elements[r]&&!0!==this.elements[r]?(i=i[r].getMatte(this.layers[e].tt),t.setMatte(i)):(this.buildItem(r),this.addPendingElement(t))))},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();if(e.checkParenting(),e.data.tt)for(var t=0,r=this.elements.length;t<r;){if(this.elements[t]===e){var i="tp"in e.data?this.findIndexByInd(e.data.tp):t-1,i=this.elements[i].getMatte(this.layers[t].tt);e.setMatte(i);break}t+=1}}},SVGRendererBase.prototype.renderFrame=function(e){if(this.renderedFrame!==e&&!this.destroyed){null===e?e=this.renderedFrame:this.renderedFrame=e,this.globalData.frameNum=e,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=e,this.globalData._mdf=!1;var t,r=this.layers.length;for(this.completeLayers||this.checkLayers(e),t=r-1;0<=t;--t)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(e-this.layers[t].st);if(this.globalData._mdf)for(t=0;t<r;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(e,t){e=e.getBaseElement();if(e){for(var r,i=0;i<t;)this.elements[i]&&!0!==this.elements[i]&&this.elements[i].getBaseElement()&&(r=this.elements[i].getBaseElement()),i+=1;r?this.layerElement.insertBefore(e,r):this.layerElement.appendChild(e)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&t.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(e){if(this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.isInRange||this.data.xt){this.tm._placeholder?this.renderedFrame=e/this.data.sr:((e=this.tm.v)===this.data.op&&(e=this.data.op-1),this.renderedFrame=e);var t,e=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),t=e-1;0<=t;--t)(this.completeLayers||this.elements[t])&&(this.elements[t].prepareFrame(this.renderedFrame-this.layers[t].st),this.elements[t]._mdf)&&(this._mdf=!0)}},ICompElement.prototype.renderInnerContent=function(){for(var e=this.layers.length,t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},ICompElement.prototype.setElements=function(e){this.elements=e},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){for(var e=this.layers.length,t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(e){return new SVGCompElement(e,this.globalData,this)},ShapeTransformManager.prototype={addTransformSequence:function(e){for(var t=e.length,r="_",i=0;i<t;i+=1)r+=e[i].transform.key+"_";var n=this.sequences[r];return n||(n={transforms:[].concat(e),finalTransform:new Matrix,_mdf:!1},this.sequences[r]=n,this.sequenceList.push(n)),n},processSequence:function(e,t){for(var r=0,i=e.transforms.length,n=t;r<i&&!t;){if(e.transforms[r].transform.mProps._mdf){n=!0;break}r+=1}if(n)for(e.finalTransform.reset(),r=i-1;0<=r;--r)e.finalTransform.multiply(e.transforms[r].transform.mProps.v);e._mdf=n},processSequences:function(e){for(var t=this.sequenceList.length,r=0;r<t;r+=1)this.processSequence(this.sequenceList[r],e)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var i="__lottie_element_luma_buffer",n=null,a=null,s=null;function t(){var e,t,r;n||(e=createNS("svg"),t=createNS("filter"),r=createNS("feColorMatrix"),t.setAttribute("id",i),r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),t.appendChild(r),e.appendChild(t),e.setAttribute("id",i+"_svg"),featureSupport.svgLumaHidden&&(e.style.display="none"),s=e,document.body.appendChild(s),n=createTag("canvas"),(a=n.getContext("2d")).filter="url(#"+i+")",a.fillStyle="rgba(0,0,0,0)",a.fillRect(0,0,1,1))}return{load:t,get:function(e){return n||t(),n.width=e.width,n.height=e.height,a.filter="url(#"+i+")",n}}};function createCanvas(e,t){var r;return featureSupport.offscreenCanvas?new OffscreenCanvas(e,t):((r=createTag("canvas")).width=e,r.height=t,r)}var assetLoader={loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas:createCanvas},registeredEffects={};function CVEffects(e){var t,r=e.data.ef?e.data.ef.length:0;for(this.filters=[],t=0;t<r;t+=1){i=null;var i,n=e.data.ef[t].ty;(i=registeredEffects[n]?new registeredEffects[n].effect(e.effectsManager.effectElements[t],e):i)&&this.filters.push(i)}this.filters.length&&e.addRenderableComponent(this)}function registerEffect(e,t){registeredEffects[e]={effect:t}}function CVMaskElement(e,t){this.data=e,this.element=t,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);for(var r=this.masksProperties.length,i=!1,n=0;n<r;n+=1)"n"!==this.masksProperties[n].mode&&(i=!0),this.viewData[n]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[n],3);(this.hasMasks=i)&&this.element.addRenderableComponent(this)}function CVBaseElement(){}CVEffects.prototype.renderFrame=function(e){for(var t=this.filters.length,r=0;r<t;r+=1)this.filters[r].renderFrame(e)},CVEffects.prototype.getEffects=function(e){for(var t=this.filters.length,r=[],i=0;i<t;i+=1)this.filters[i].type===e&&r.push(this.filters[i]);return r},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var e,t,r,i,n=this.element.finalTransform.mat,a=this.element.canvasContext,s=this.masksProperties.length;for(a.beginPath(),e=0;e<s;e+=1)if("n"!==this.masksProperties[e].mode){this.masksProperties[e].inv&&(a.moveTo(0,0),a.lineTo(this.element.globalData.compSize.w,0),a.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),a.lineTo(0,this.element.globalData.compSize.h),a.lineTo(0,0)),i=this.viewData[e].v,t=n.applyToPointArray(i.v[0][0],i.v[0][1],0),a.moveTo(t[0],t[1]);for(var o=i._length,l=1;l<o;l+=1)r=n.applyToTriplePoints(i.o[l-1],i.i[l],i.v[l]),a.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);r=n.applyToTriplePoints(i.o[l-1],i.i[0],i.v[0]),a.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5])}this.element.globalData.renderer.save(!0),a.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};function CVShapeData(e,t,r,i){this.styledShapes=[],this.tr=[0,0,0,0,0,0];for(var n,a=4,s=("rc"===t.ty?a=5:"el"===t.ty?a=6:"sr"===t.ty&&(a=7),this.sh=ShapePropertyFactory.getShapeProp(e,t,a,e),r.length),o=0;o<s;o+=1)r[o].closed||(n={transforms:i.addTransformSequence(r[o].transforms),trNodes:[]},this.styledShapes.push(n),r[o].elements.push(n))}function CVShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(e,t,r)}function CVTextElement(e,t,r){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(e,t,r)}function CVImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.img=t.imageLoader.getAsset(this.assetData),this.initElement(e,t,r)}function CVSolidElement(e,t,r){this.initElement(e,t,r)}function CanvasRendererBase(){}function CanvasContext(){this.opacity=-1,this.transform=createTypedArray("float32",16),this.fillStyle="",this.strokeStyle="",this.lineWidth="",this.lineCap="",this.lineJoin="",this.miterLimit="",this.id=Math.random()}function CVContextData(){this.stack=[],this.cArrPos=0,this.cTr=new Matrix;for(var e=0;e<15;e+=1){var t=new CanvasContext;this.stack[e]=t}this._length=15,this.nativeContext=null,this.transformMat=new Matrix,this.currentOpacity=1,this.currentFillStyle="",this.appliedFillStyle="",this.currentStrokeStyle="",this.appliedStrokeStyle="",this.currentLineWidth="",this.appliedLineWidth="",this.currentLineCap="",this.appliedLineCap="",this.currentLineJoin="",this.appliedLineJoin="",this.appliedMiterLimit="",this.currentMiterLimit=""}function CVCompElement(e,t,r){this.completeLayers=!1,this.layers=e.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function CanvasRenderer(e,t){this.animationItem=e,this.renderConfig={clearCanvas:!t||void 0===t.clearCanvas||t.clearCanvas,context:t&&t.context||null,progressiveLoad:t&&t.progressiveLoad||!1,preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:t&&t.contentVisibility||"visible",className:t&&t.className||"",id:t&&t.id||"",runExpressions:!t||void 0===t.runExpressions||t.runExpressions},this.renderConfig.dpr=t&&t.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=t&&t.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas",this.renderConfig.clearCanvas&&(this.ctxTransform=this.contextData.transform.bind(this.contextData),this.ctxOpacity=this.contextData.opacity.bind(this.contextData),this.ctxFillStyle=this.contextData.fillStyle.bind(this.contextData),this.ctxStrokeStyle=this.contextData.strokeStyle.bind(this.contextData),this.ctxLineWidth=this.contextData.lineWidth.bind(this.contextData),this.ctxLineCap=this.contextData.lineCap.bind(this.contextData),this.ctxLineJoin=this.contextData.lineJoin.bind(this.contextData),this.ctxMiterLimit=this.contextData.miterLimit.bind(this.contextData),this.ctxFill=this.contextData.fill.bind(this.contextData),this.ctxFillRect=this.contextData.fillRect.bind(this.contextData),this.ctxStroke=this.contextData.stroke.bind(this.contextData),this.save=this.contextData.save.bind(this.contextData))}function HBaseElement(){}function HSolidElement(e,t,r){this.initElement(e,t,r)}function HShapeElement(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(e,t,r),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(e,t,r){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(e,t,r)}function HCameraElement(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initHierarchy();t=PropertyFactory.getProp;if(this.pe=t(this,e.pe,0,0,this),e.ks.p.s?(this.px=t(this,e.ks.p.x,1,0,this),this.py=t(this,e.ks.p.y,1,0,this),this.pz=t(this,e.ks.p.z,1,0,this)):this.p=t(this,e.ks.p,1,0,this),e.ks.a&&(this.a=t(this,e.ks.a,1,0,this)),e.ks.or.k.length&&e.ks.or.k[0].to)for(var i=e.ks.or.k.length,n=0;n<i;n+=1)e.ks.or.k[n].to=null,e.ks.or.k[n].ti=null;this.or=t(this,e.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=t(this,e.ks.rx,0,degToRads,this),this.ry=t(this,e.ks.ry,0,degToRads,this),this.rz=t(this,e.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HImageElement(e,t,r){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,r)}function HybridRendererBase(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&!1===t.hideOnTransparent),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function HCompElement(e,t,r){this.layers=e.layers,this.supports3d=!e.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(e,t,r),this.tm=e.tm?PropertyFactory.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function HybridRenderer(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:t&&t.className||"",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(t&&!1===t.hideOnTransparent),filterSize:{width:t&&t.filterSize&&t.filterSize.width||"400%",height:t&&t.filterSize&&t.filterSize.height||"400%",x:t&&t.filterSize&&t.filterSize.x||"-100%",y:t&&t.filterSize&&t.filterSize.y||"-100%"},runExpressions:!t||void 0===t.runExpressions||t.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){var e,t;1<=this.data.tt&&(this.buffers=[],e=this.globalData.canvasContext,t=assetLoader.createCanvas(e.canvas.width,e.canvas.height),this.buffers.push(t),t=assetLoader.createCanvas(e.canvas.width,e.canvas.height),this.buffers.push(t),3<=this.data.tt)&&!document._isProxy&&assetLoader.loadLumaCanvas(),this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects(this),this.searchEffectTransforms()},createContent:function(){},setBlendMode:function(){var e,t=this.globalData;t.blendMode!==this.data.bm&&(t.blendMode=this.data.bm,e=getBlendMode(this.data.bm),t.canvasContext.globalCompositeOperation=e)},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this),this.transformEffects=this.renderableEffectsManager.getEffects(effectTypes.TRANSFORM_EFFECT)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(e){e.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){var e;1<=this.data.tt&&(e=this.buffers[0].getContext("2d"),this.clearCanvas(e),e.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform))},exitLayer:function(){var e,t;1<=this.data.tt&&(t=(e=this.buffers[1]).getContext("2d"),this.clearCanvas(t),t.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform),this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1).renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),3<=this.data.tt&&!document._isProxy&&((t=assetLoader.getLumaCanvas(this.canvasContext.canvas)).getContext("2d").drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(t,0,0)),this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(e,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over")},renderFrame:function(e){this.hidden||this.data.hd||(1!==this.data.td||e)&&(this.renderTransform(),this.renderRenderable(),this.renderLocalTransform(),this.setBlendMode(),e=0===this.data.ty,this.prepareLayer(),this.globalData.renderer.save(e),this.globalData.renderer.ctxTransform(this.finalTransform.localMat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.localOpacity),this.renderInnerContent(),this.globalData.renderer.restore(e),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame)&&(this._isFirstFrame=!1)},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(e,t){var r,t={data:e,type:e.ty,preTransforms:this.transformsManager.addTransformSequence(t),transforms:[],elements:[],closed:!0===e.hd},i={};return"fl"===e.ty||"st"===e.ty?(i.c=PropertyFactory.getProp(this,e.c,1,255,this),i.c.k||(t.co="rgb("+bmFloor(i.c.v[0])+","+bmFloor(i.c.v[1])+","+bmFloor(i.c.v[2])+")")):"gf"!==e.ty&&"gs"!==e.ty||(i.s=PropertyFactory.getProp(this,e.s,1,null,this),i.e=PropertyFactory.getProp(this,e.e,1,null,this),i.h=PropertyFactory.getProp(this,e.h||{k:0},0,.01,this),i.a=PropertyFactory.getProp(this,e.a||{k:0},0,degToRads,this),i.g=new GradientProperty(this,e.g,this)),i.o=PropertyFactory.getProp(this,e.o,0,.01,this),"st"===e.ty||"gs"===e.ty?(t.lc=lineCapEnum[e.lc||2],t.lj=lineJoinEnum[e.lj||2],1==e.lj&&(t.ml=e.ml),i.w=PropertyFactory.getProp(this,e.w,0,null,this),i.w.k||(t.wi=i.w.v),e.d&&(r=new DashProperty(this,e.d,"canvas",this),i.d=r,i.d.k||(t.da=i.d.dashArray,t.do=i.d.dashoffset[0]))):t.r=2===e.r?"evenodd":"nonzero",this.stylesList.push(t),i.style=t,i},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(e){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,e.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,e,this)}}},CVShapeElement.prototype.createShapeElement=function(e){e=new CVShapeData(this,e,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e},CVShapeElement.prototype.reloadShapes=function(){this._isFirstFrame=!0;for(var e=this.itemsData.length,t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(e){for(var t=this.stylesList.length,r=0;r<t;r+=1)this.stylesList[r].closed||this.stylesList[r].transforms.push(e)},CVShapeElement.prototype.removeTransformFromStyleList=function(){for(var e=this.stylesList.length,t=0;t<e;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.pop()},CVShapeElement.prototype.closeStyles=function(e){for(var t=e.length,r=0;r<t;r+=1)e[r].closed=!0},CVShapeElement.prototype.searchShapes=function(e,t,r,i,n){for(var a,s,o,l,u,c=e.length-1,h=[],d=[],p=[].concat(n),f=c;0<=f;--f){if((o=this.searchProcessedElement(e[f]))?t[f]=r[o-1]:e[f]._shouldRender=i,"fl"===e[f].ty||"st"===e[f].ty||"gf"===e[f].ty||"gs"===e[f].ty)o?t[f].style.closed=!1:t[f]=this.createStyleElement(e[f],p),h.push(t[f].style);else if("gr"===e[f].ty){if(o)for(s=t[f].it.length,a=0;a<s;a+=1)t[f].prevViewData[a]=t[f].it[a];else t[f]=this.createGroupElement(e[f]);this.searchShapes(e[f].it,t[f].it,t[f].prevViewData,i,p)}else"tr"===e[f].ty?(o||(u=this.createTransformElement(e[f]),t[f]=u),p.push(t[f]),this.addTransformToStyleList(t[f])):"sh"===e[f].ty||"rc"===e[f].ty||"el"===e[f].ty||"sr"===e[f].ty?o||(t[f]=this.createShapeElement(e[f])):"tm"===e[f].ty||"rd"===e[f].ty||"pb"===e[f].ty||"zz"===e[f].ty||"op"===e[f].ty?(o?(l=t[f]).closed=!1:((l=ShapeModifiers.getModifier(e[f].ty)).init(this,e[f]),t[f]=l,this.shapeModifiers.push(l)),d.push(l)):"rp"===e[f].ty&&(o?(l=t[f]).closed=!0:(l=ShapeModifiers.getModifier(e[f].ty),(t[f]=l).init(this,e,f,t),this.shapeModifiers.push(l),i=!1),d.push(l));this.addProcessedElement(e[f],f+1)}for(this.removeTransformFromStyleList(),this.closeStyles(h),c=d.length,f=0;f<c;f+=1)d[f].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(e,t){(e._opMdf||t.op._mdf||this._isFirstFrame)&&(t.opacity=e.opacity,t.opacity*=t.op.v,t._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){for(var e,t,r,i,n,a,s,o,l=this.stylesList.length,u=this.globalData.renderer,c=this.globalData.canvasContext,h=0;h<l;h+=1)if(("st"!==(s=(o=this.stylesList[h]).type)&&"gs"!==s||0!==o.wi)&&o.data._shouldRender&&0!==o.coOp&&0!==this.globalData.currentGlobalAlpha){for(u.save(),n=o.elements,"st"===s||"gs"===s?(u.ctxStrokeStyle("st"===s?o.co:o.grd),u.ctxLineWidth(o.wi),u.ctxLineCap(o.lc),u.ctxLineJoin(o.lj),u.ctxMiterLimit(o.ml||0)):u.ctxFillStyle("fl"===s?o.co:o.grd),u.ctxOpacity(o.coOp),"st"!==s&&"gs"!==s&&c.beginPath(),u.ctxTransform(o.preTransforms.finalTransform.props),t=n.length,e=0;e<t;e+=1){for("st"!==s&&"gs"!==s||(c.beginPath(),o.da&&(c.setLineDash(o.da),c.lineDashOffset=o.do)),i=(a=n[e].trNodes).length,r=0;r<i;r+=1)"m"===a[r].t?c.moveTo(a[r].p[0],a[r].p[1]):"c"===a[r].t?c.bezierCurveTo(a[r].pts[0],a[r].pts[1],a[r].pts[2],a[r].pts[3],a[r].pts[4],a[r].pts[5]):c.closePath();"st"!==s&&"gs"!==s||(u.ctxStroke(),o.da&&c.setLineDash(this.dashResetter))}"st"!==s&&"gs"!==s&&this.globalData.renderer.ctxFill(o.r),u.restore()}},CVShapeElement.prototype.renderShape=function(e,t,r,i){for(var n=e,a=t.length-1;0<=a;--a)"tr"===t[a].ty?(n=r[a].transform,this.renderShapeTransform(e,n)):"sh"===t[a].ty||"el"===t[a].ty||"rc"===t[a].ty||"sr"===t[a].ty?this.renderPath(t[a],r[a]):"fl"===t[a].ty?this.renderFill(t[a],r[a],n):"st"===t[a].ty?this.renderStroke(t[a],r[a],n):"gf"===t[a].ty||"gs"===t[a].ty?this.renderGradientFill(t[a],r[a],n):"gr"===t[a].ty?this.renderShape(n,t[a].it,r[a].it):t[a].ty;i&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(e,t){if(this._isFirstFrame||t._mdf||e.transforms._mdf){for(var r,i,n=e.trNodes,a=t.paths,s=a._length,o=(n.length=0,e.transforms.finalTransform),l=0;l<s;l+=1){var u=a.shapes[l];if(u&&u.v){for(i=u._length,r=1;r<i;r+=1)1===r&&n.push({t:"m",p:o.applyToPointArray(u.v[0][0],u.v[0][1],0)}),n.push({t:"c",pts:o.applyToTriplePoints(u.o[r-1],u.i[r],u.v[r])});1===i&&n.push({t:"m",p:o.applyToPointArray(u.v[0][0],u.v[0][1],0)}),u.c&&i&&(n.push({t:"c",pts:o.applyToTriplePoints(u.o[r-1],u.i[0],u.v[0])}),n.push({t:"z"}))}}e.trNodes=n}},CVShapeElement.prototype.renderPath=function(e,t){if(!0!==e.hd&&e._shouldRender)for(var r=t.styledShapes.length,i=0;i<r;i+=1)this.renderStyledShape(t.styledShapes[i],t.sh)},CVShapeElement.prototype.renderFill=function(e,t,r){var i=t.style;(t.c._mdf||this._isFirstFrame)&&(i.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r._opMdf||this._isFirstFrame)&&(i.coOp=t.o.v*r.opacity)},CVShapeElement.prototype.renderGradientFill=function(e,t,r){var i=t.style;if(!i.grd||t.g._mdf||t.s._mdf||t.e._mdf||1!==e.t&&(t.h._mdf||t.a._mdf)){for(var n,a,s,o,l=this.globalData.canvasContext,u=t.s.v,c=t.e.v,h=(o=1===e.t?l.createLinearGradient(u[0],u[1],c[0],c[1]):(n=Math.sqrt(Math.pow(u[0]-c[0],2)+Math.pow(u[1]-c[1],2)),c=Math.atan2(c[1]-u[1],c[0]-u[0]),1<=(a=t.h.v)?a=.99:a<=-1&&(a=-.99),a=n*a,s=Math.cos(c+t.a.v)*a+u[0],c=Math.sin(c+t.a.v)*a+u[1],l.createRadialGradient(s,c,0,u[0],u[1],n)),e.g.p),d=t.g.c,p=1,f=0;f<h;f+=1)t.g._hasOpacity&&t.g._collapsable&&(p=t.g.o[2*f+1]),o.addColorStop(d[4*f]/100,"rgba("+d[4*f+1]+","+d[4*f+2]+","+d[4*f+3]+","+p+")");i.grd=o}i.coOp=t.o.v*r.opacity},CVShapeElement.prototype.renderStroke=function(e,t,r){var i=t.style,n=t.d;n&&(n._mdf||this._isFirstFrame)&&(i.da=n.dashArray,i.do=n.dashoffset[0]),(t.c._mdf||this._isFirstFrame)&&(i.co="rgb("+bmFloor(t.c.v[0])+","+bmFloor(t.c.v[1])+","+bmFloor(t.c.v[2])+")"),(t.o._mdf||r._opMdf||this._isFirstFrame)&&(i.coOp=t.o.v*r.opacity),(t.w._mdf||this._isFirstFrame)&&(i.wi=t.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){for(var e,t,r,i,n,a,s,o,l=this.textProperty.currentData,u=(this.renderedLetters=createSizedArray(l.l?l.l.length:0),!1),u=(l.fc?(u=!0,this.values.fill=this.buildColor(l.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=u,!1),c=(l.sc&&(u=!0,this.values.stroke=this.buildColor(l.sc),this.values.sWidth=l.sw),this.globalData.fontManager.getFontByName(l.f)),h=l.l,d=this.mHelper,p=(this.stroke=u,this.values.fValue=l.finalSize+"px "+this.globalData.fontManager.getFontByName(l.f).fFamily,e=l.finalText.length,this.data.singleShape),f=.001*l.tr*l.finalSize,m=0,g=0,v=!0,y=0,_=0;_<e;_+=1){t=(t=this.globalData.fontManager.getCharData(l.finalText[_],c.fStyle,this.globalData.fontManager.getFontByName(l.f).fFamily))&&t.data||{},d.reset(),p&&h[_].n&&(m=-f,g=g+l.yOffset+(v?1:0),v=!1),a=(n=t.shapes?t.shapes[0].it:[]).length,d.scale(l.finalSize/100,l.finalSize/100),p&&this.applyTextPropertiesToMatrix(l,d,h[_].line,m,g);for(var b=createSizedArray(a-1),x=0,S=0;S<a;S+=1)if("sh"===n[S].ty){for(i=n[S].ks.k.i.length,s=n[S].ks.k,o=[],r=1;r<i;r+=1)1===r&&o.push(d.applyToX(s.v[0][0],s.v[0][1],0),d.applyToY(s.v[0][0],s.v[0][1],0)),o.push(d.applyToX(s.o[r-1][0],s.o[r-1][1],0),d.applyToY(s.o[r-1][0],s.o[r-1][1],0),d.applyToX(s.i[r][0],s.i[r][1],0),d.applyToY(s.i[r][0],s.i[r][1],0),d.applyToX(s.v[r][0],s.v[r][1],0),d.applyToY(s.v[r][0],s.v[r][1],0));o.push(d.applyToX(s.o[r-1][0],s.o[r-1][1],0),d.applyToY(s.o[r-1][0],s.o[r-1][1],0),d.applyToX(s.i[0][0],s.i[0][1],0),d.applyToY(s.i[0][0],s.i[0][1],0),d.applyToX(s.v[0][0],s.v[0][1],0),d.applyToY(s.v[0][0],s.v[0][1],0)),b[x]=o,x+=1}p&&(m=m+h[_].l+f),this.textSpans[y]?this.textSpans[y].elem=b:this.textSpans[y]={elem:b},y+=1}},CVTextElement.prototype.renderInnerContent=function(){this.validateText();this.canvasContext.font=this.values.fValue,this.globalData.renderer.ctxLineCap("butt"),this.globalData.renderer.ctxLineJoin("miter"),this.globalData.renderer.ctxMiterLimit(4),this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);for(var e,t,r,i,n,a,s,o=this.textAnimator.renderedLetters,l=this.textProperty.currentData.l,u=l.length,c=null,h=null,d=null,p=this.globalData.renderer,f=0;f<u;f+=1)if(!l[f].n){if((n=o[f])&&(p.save(),p.ctxTransform(n.p),p.ctxOpacity(n.o)),this.fill){for(n&&n.fc?c!==n.fc&&(p.ctxFillStyle(n.fc),c=n.fc):c!==this.values.fill&&(c=this.values.fill,p.ctxFillStyle(this.values.fill)),t=(a=this.textSpans[f].elem).length,this.globalData.canvasContext.beginPath(),e=0;e<t;e+=1)for(i=(s=a[e]).length,this.globalData.canvasContext.moveTo(s[0],s[1]),r=2;r<i;r+=6)this.globalData.canvasContext.bezierCurveTo(s[r],s[r+1],s[r+2],s[r+3],s[r+4],s[r+5]);this.globalData.canvasContext.closePath(),p.ctxFill()}if(this.stroke){for(n&&n.sw?d!==n.sw&&(d=n.sw,p.ctxLineWidth(n.sw)):d!==this.values.sWidth&&(d=this.values.sWidth,p.ctxLineWidth(this.values.sWidth)),n&&n.sc?h!==n.sc&&(h=n.sc,p.ctxStrokeStyle(n.sc)):h!==this.values.stroke&&(h=this.values.stroke,p.ctxStrokeStyle(this.values.stroke)),t=(a=this.textSpans[f].elem).length,this.globalData.canvasContext.beginPath(),e=0;e<t;e+=1)for(i=(s=a[e]).length,this.globalData.canvasContext.moveTo(s[0],s[1]),r=2;r<i;r+=6)this.globalData.canvasContext.bezierCurveTo(s[r],s[r+1],s[r+2],s[r+3],s[r+4],s[r+5]);this.globalData.canvasContext.closePath(),p.ctxStroke()}n&&this.globalData.renderer.restore()}},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){var e,t,r,i,n,a,s,o,l;!this.img.width||this.assetData.w===this.img.width&&this.assetData.h===this.img.height||((e=createTag("canvas")).width=this.assetData.w,e.height=this.assetData.h,t=e.getContext("2d"),r=this.img.width,i=this.img.height,a=this.assetData.w/this.assetData.h,l=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio,a<(n=r/i)&&"xMidYMid slice"===l||n<a&&"xMidYMid slice"!==l?s=(o=i)*a:o=(s=r)/a,t.drawImage(this.img,(r-s)/2,(i-o)/2,s,o,0,0,this.assetData.w,this.assetData.h),this.img=e)},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){this.globalData.renderer.ctxFillStyle(this.data.sc),this.globalData.renderer.ctxFillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(e){return new CVShapeElement(e,this.globalData,this)},CanvasRendererBase.prototype.createText=function(e){return new CVTextElement(e,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(e){return new CVImageElement(e,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(e){return new CVSolidElement(e,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(e){1===e[0]&&0===e[1]&&0===e[4]&&1===e[5]&&0===e[12]&&0===e[13]||this.canvasContext.transform(e[0],e[1],e[4],e[5],e[12],e[13])},CanvasRendererBase.prototype.ctxOpacity=function(e){this.canvasContext.globalAlpha*=e<0?0:e},CanvasRendererBase.prototype.ctxFillStyle=function(e){this.canvasContext.fillStyle=e},CanvasRendererBase.prototype.ctxStrokeStyle=function(e){this.canvasContext.strokeStyle=e},CanvasRendererBase.prototype.ctxLineWidth=function(e){this.canvasContext.lineWidth=e},CanvasRendererBase.prototype.ctxLineCap=function(e){this.canvasContext.lineCap=e},CanvasRendererBase.prototype.ctxLineJoin=function(e){this.canvasContext.lineJoin=e},CanvasRendererBase.prototype.ctxMiterLimit=function(e){this.canvasContext.miterLimit=e},CanvasRendererBase.prototype.ctxFill=function(e){this.canvasContext.fill(e)},CanvasRendererBase.prototype.ctxFillRect=function(e,t,r,i){this.canvasContext.fillRect(e,t,r,i)},CanvasRendererBase.prototype.ctxStroke=function(){this.canvasContext.stroke()},CanvasRendererBase.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRendererBase.prototype.save=function(){this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(e){this.renderConfig.clearCanvas?(e&&(this.globalData.blendMode="source-over"),this.contextData.restore(e)):this.canvasContext.restore()},CanvasRendererBase.prototype.configAnimation=function(e){var t,r;this.animationItem.wrapper?(this.animationItem.container=createTag("canvas"),(t=this.animationItem.container.style).width="100%",t.height="100%",t.transformOrigin=r="0px 0px 0px",t.mozTransformOrigin=r,t.webkitTransformOrigin=r,t["-webkit-transform"]=r,t.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)):this.canvasContext=this.renderConfig.context,this.contextData.setContext(this.canvasContext),this.data=e,this.layers=e.layers,this.transformCanvas={w:e.w,h:e.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(e,document.body),this.globalData.canvasContext=this.canvasContext,(this.globalData.renderer=this).globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(e.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(e,t){var r,i,n,a,s;this.reset(),e?(i=t,this.canvasContext.canvas.width=r=e,this.canvasContext.canvas.height=i):(i=this.animationItem.wrapper&&this.animationItem.container?(r=this.animationItem.wrapper.offsetWidth,this.animationItem.wrapper.offsetHeight):(r=this.canvasContext.canvas.width,this.canvasContext.canvas.height),this.canvasContext.canvas.width=r*this.renderConfig.dpr,this.canvasContext.canvas.height=i*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")?(e=(t=this.renderConfig.preserveAspectRatio.split(" "))[1]||"meet",n=(t=t[0]||"xMidYMid").substr(0,4),t=t.substr(4),(a=r/i)<(s=this.transformCanvas.w/this.transformCanvas.h)&&"meet"===e||s<a&&"slice"===e?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=r/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=i/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=i/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===n&&(s<a&&"meet"===e||a<s&&"slice"===e)?(r-this.transformCanvas.w*(i/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===n&&(s<a&&"meet"===e||a<s&&"slice"===e)?(r-this.transformCanvas.w*(i/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===t&&(a<s&&"meet"===e||s<a&&"slice"===e)?(i-this.transformCanvas.h*(r/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===t&&(a<s&&"meet"===e||s<a&&"slice"===e)?(i-this.transformCanvas.h*(r/this.transformCanvas.w))*this.renderConfig.dpr:0):("none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=r/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=i/(this.transformCanvas.h/this.renderConfig.dpr)):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0),this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");for(var e=(this.layers?this.layers.length:0)-1;0<=e;--e)this.elements[e]&&this.elements[e].destroy&&this.elements[e].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(e,t){if((this.renderedFrame!==e||!0!==this.renderConfig.clearCanvas||t)&&!this.destroyed&&-1!==e){this.renderedFrame=e,this.globalData.frameNum=e-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||t,this.globalData.projectInterface.currentFrame=e;var r,t=this.layers.length;for(this.completeLayers||this.checkLayers(e),r=t-1;0<=r;--r)(this.completeLayers||this.elements[r])&&this.elements[r].prepareFrame(e-this.layers[r].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),r=t-1;0<=r;--r)(this.completeLayers||this.elements[r])&&this.elements[r].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(e){var t,r=this.elements;r[e]||99===this.layers[e].ty||(t=this.createItem(this.layers[e],this,this.globalData),(r[e]=t).initExpressions())},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"},CVContextData.prototype.duplicate=function(){for(var e=2*this._length,t=0,t=this._length;t<e;t+=1)this.stack[t]=new CanvasContext;this._length=e},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.stack[this.cArrPos].opacity=1},CVContextData.prototype.restore=function(e){--this.cArrPos;for(var t,r=this.stack[this.cArrPos],i=r.transform,n=this.cTr.props,a=0;a<16;a+=1)n[a]=i[a];e&&(this.nativeContext.restore(),t=this.stack[this.cArrPos+1],this.appliedFillStyle=t.fillStyle,this.appliedStrokeStyle=t.strokeStyle,this.appliedLineWidth=t.lineWidth,this.appliedLineCap=t.lineCap,this.appliedLineJoin=t.lineJoin,this.appliedMiterLimit=t.miterLimit),this.nativeContext.setTransform(i[0],i[1],i[4],i[5],i[12],i[13]),(e||-1!==r.opacity&&this.currentOpacity!==r.opacity)&&(this.nativeContext.globalAlpha=r.opacity,this.currentOpacity=r.opacity),this.currentFillStyle=r.fillStyle,this.currentStrokeStyle=r.strokeStyle,this.currentLineWidth=r.lineWidth,this.currentLineCap=r.lineCap,this.currentLineJoin=r.lineJoin,this.currentMiterLimit=r.miterLimit},CVContextData.prototype.save=function(e){e&&this.nativeContext.save();for(var t=this.cTr.props,r=(this._length<=this.cArrPos&&this.duplicate(),this.stack[this.cArrPos]),i=0;i<16;i+=1)r.transform[i]=t[i];this.cArrPos+=1;e=this.stack[this.cArrPos];e.opacity=r.opacity,e.fillStyle=r.fillStyle,e.strokeStyle=r.strokeStyle,e.lineWidth=r.lineWidth,e.lineCap=r.lineCap,e.lineJoin=r.lineJoin,e.miterLimit=r.miterLimit},CVContextData.prototype.setOpacity=function(e){this.stack[this.cArrPos].opacity=e},CVContextData.prototype.setContext=function(e){this.nativeContext=e},CVContextData.prototype.fillStyle=function(e){this.stack[this.cArrPos].fillStyle!==e&&(this.currentFillStyle=e,this.stack[this.cArrPos].fillStyle=e)},CVContextData.prototype.strokeStyle=function(e){this.stack[this.cArrPos].strokeStyle!==e&&(this.currentStrokeStyle=e,this.stack[this.cArrPos].strokeStyle=e)},CVContextData.prototype.lineWidth=function(e){this.stack[this.cArrPos].lineWidth!==e&&(this.currentLineWidth=e,this.stack[this.cArrPos].lineWidth=e)},CVContextData.prototype.lineCap=function(e){this.stack[this.cArrPos].lineCap!==e&&(this.currentLineCap=e,this.stack[this.cArrPos].lineCap=e)},CVContextData.prototype.lineJoin=function(e){this.stack[this.cArrPos].lineJoin!==e&&(this.currentLineJoin=e,this.stack[this.cArrPos].lineJoin=e)},CVContextData.prototype.miterLimit=function(e){this.stack[this.cArrPos].miterLimit!==e&&(this.currentMiterLimit=e,this.stack[this.cArrPos].miterLimit=e)},CVContextData.prototype.transform=function(e){this.transformMat.cloneFromProps(e);e=this.cTr,this.transformMat.multiply(e),e.cloneFromProps(this.transformMat.props),e=e.props;this.nativeContext.setTransform(e[0],e[1],e[4],e[5],e[12],e[13])},CVContextData.prototype.opacity=function(e){var t=this.stack[this.cArrPos].opacity;this.stack[this.cArrPos].opacity!==(t*=e<0?0:e)&&(this.currentOpacity!==e&&(this.nativeContext.globalAlpha=e,this.currentOpacity=e),this.stack[this.cArrPos].opacity=t)},CVContextData.prototype.fill=function(e){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fill(e)},CVContextData.prototype.fillRect=function(e,t,r,i){this.appliedFillStyle!==this.currentFillStyle&&(this.appliedFillStyle=this.currentFillStyle,this.nativeContext.fillStyle=this.appliedFillStyle),this.nativeContext.fillRect(e,t,r,i)},CVContextData.prototype.stroke=function(){this.appliedStrokeStyle!==this.currentStrokeStyle&&(this.appliedStrokeStyle=this.currentStrokeStyle,this.nativeContext.strokeStyle=this.appliedStrokeStyle),this.appliedLineWidth!==this.currentLineWidth&&(this.appliedLineWidth=this.currentLineWidth,this.nativeContext.lineWidth=this.appliedLineWidth),this.appliedLineCap!==this.currentLineCap&&(this.appliedLineCap=this.currentLineCap,this.nativeContext.lineCap=this.appliedLineCap),this.appliedLineJoin!==this.currentLineJoin&&(this.appliedLineJoin=this.currentLineJoin,this.nativeContext.lineJoin=this.appliedLineJoin),this.appliedMiterLimit!==this.currentMiterLimit&&(this.appliedMiterLimit=this.currentMiterLimit,this.nativeContext.miterLimit=this.appliedMiterLimit),this.nativeContext.stroke()},extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var e=this.canvasContext;e.beginPath(),e.moveTo(0,0),e.lineTo(this.data.w,0),e.lineTo(this.data.w,this.data.h),e.lineTo(0,this.data.h),e.lineTo(0,0),e.clip();for(var t=this.layers.length-1;0<=t;--t)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},CVCompElement.prototype.destroy=function(){for(var e=this.layers.length-1;0<=e;--e)this.elements[e]&&this.elements[e].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)},extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(e){return new CVCompElement(e,this.globalData,this)},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var e,t=this.transformedElement?this.transformedElement.style:{};this.finalTransform._matMdf&&(e=this.finalTransform.mat.toCSS(),t.transform=e,t.webkitTransform=e),this.finalTransform._opMdf&&(t.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var e;this.data.hasMask?((e=createNS("rect")).setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((e=createTag("div")).style.width=this.data.sw+"px",e.style.height=this.data.sh+"px",e.style.backgroundColor=this.data.sc),this.layerElement.appendChild(e)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var e,t;this.baseElement.style.fontSize=0,this.data.hasMask?(this.layerElement.appendChild(this.shapesContainer),e=this.svgElement):(e=createNS("svg"),t=this.comp.data||this.globalData.compSize,e.setAttribute("width",t.w),e.setAttribute("height",t.h),e.appendChild(this.shapesContainer),this.layerElement.appendChild(e)),this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=e},HShapeElement.prototype.getTransformedPoint=function(e,t){for(var r=e.length,i=0;i<r;i+=1)t=e[i].mProps.v.applyToPointArray(t[0],t[1],0);return t},HShapeElement.prototype.calculateShapeBoundingBox=function(e,t){var r,i,n,a,s,o=e.sh.v,l=e.transformers,u=o._length;if(!(u<=1)){for(r=0;r<u-1;r+=1)i=this.getTransformedPoint(l,o.v[r]),n=this.getTransformedPoint(l,o.o[r]),a=this.getTransformedPoint(l,o.i[r+1]),s=this.getTransformedPoint(l,o.v[r+1]),this.checkBounds(i,n,a,s,t);o.c&&(i=this.getTransformedPoint(l,o.v[r]),n=this.getTransformedPoint(l,o.o[r]),a=this.getTransformedPoint(l,o.i[0]),s=this.getTransformedPoint(l,o.v[0]),this.checkBounds(i,n,a,s,t))}},HShapeElement.prototype.checkBounds=function(e,t,r,i,n){this.getBoundsOfCurve(e,t,r,i);e=this.shapeBoundingBox;n.x=bmMin(e.left,n.x),n.xMax=bmMax(e.right,n.xMax),n.y=bmMin(e.top,n.y),n.yMax=bmMax(e.bottom,n.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(e,t,r,i){for(var n,a,s,o,l=[[e[0],i[0]],[e[1],i[1]]],u=0;u<2;++u)a=6*e[u]-12*t[u]+6*r[u],n=-3*e[u]+9*t[u]-9*r[u]+3*i[u],o=3*t[u]-3*e[u],a|=0,o|=0,0==(n|=0)&&0==a||(0==n?0<(s=-o/a)&&s<1&&l[u].push(this.calculateF(s,e,t,r,i,u)):0<=(s=a*a-4*o*n)&&(0<(o=(-a+bmSqrt(s))/(2*n))&&o<1&&l[u].push(this.calculateF(o,e,t,r,i,u)),0<(o=(-a-bmSqrt(s))/(2*n)))&&o<1&&l[u].push(this.calculateF(o,e,t,r,i,u)));this.shapeBoundingBox.left=bmMin.apply(null,l[0]),this.shapeBoundingBox.top=bmMin.apply(null,l[1]),this.shapeBoundingBox.right=bmMax.apply(null,l[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,l[1])},HShapeElement.prototype.calculateF=function(e,t,r,i,n,a){return bmPow(1-e,3)*t[a]+3*bmPow(1-e,2)*e*r[a]+3*(1-e)*bmPow(e,2)*i[a]+bmPow(e,3)*n[a]},HShapeElement.prototype.calculateBoundingBox=function(e,t){for(var r=e.length,i=0;i<r;i+=1)e[i]&&e[i].sh?this.calculateShapeBoundingBox(e[i],t):e[i]&&e[i].it?this.calculateBoundingBox(e[i].it,t):e[i]&&e[i].style&&e[i].w&&this.expandStrokeBoundingBox(e[i].w,t)},HShapeElement.prototype.expandStrokeBoundingBox=function(e,t){var r=0;if(e.keyframes){for(var i=0;i<e.keyframes.length;i+=1){var n=e.keyframes[i].s;r<n&&(r=n)}r*=e.mult}else r=e.v*e.mult;t.x-=r,t.xMax+=r,t.y-=r,t.yMax+=r},HShapeElement.prototype.currentBoxContains=function(e){return this.currentBBox.x<=e.x&&this.currentBBox.y<=e.y&&this.currentBBox.width+this.currentBBox.x>=e.x+e.width&&this.currentBBox.height+this.currentBBox.y>=e.y+e.height},HShapeElement.prototype.renderInnerContent=function(){var e,t;this._renderShapeFrame(),this.hidden||!this._isFirstFrame&&!this._mdf||((t=this.tempBoundingBox).x=e=999999,t.xMax=-e,t.y=e,t.yMax=-e,this.calculateBoundingBox(this.itemsData,t),t.width=t.xMax<t.x?0:t.xMax-t.x,t.height=t.yMax<t.y?0:t.yMax-t.y,!this.currentBoxContains(t)&&(e=!1,this.currentBBox.w!==t.width&&(this.currentBBox.w=t.width,this.shapeCont.setAttribute("width",t.width),e=!0),this.currentBBox.h!==t.height&&(this.currentBBox.h=t.height,this.shapeCont.setAttribute("height",t.height),e=!0),e||this.currentBBox.x!==t.x||this.currentBBox.y!==t.y)&&(this.currentBBox.w=t.width,this.currentBBox.h=t.height,this.currentBBox.x=t.x,this.currentBBox.y=t.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),e=this.shapeCont.style,t="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)",e.transform=t,e.webkitTransform=t))},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){var e;this.isMasked=this.checkMasks(),this.isMasked?(this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH),e=createNS("g"),this.maskedElement.appendChild(e),this.innerElem=e):(this.renderType="html",this.innerElem=this.layerElement),this.checkParenting()},HTextElement.prototype.buildNewText=function(){for(var e,t,r,i,n,a,s,o=this.textProperty.currentData,l=(this.renderedLetters=createSizedArray(o.l?o.l.length:0),this.innerElem.style),u=o.fc?this.buildColor(o.fc):"rgba(0,0,0,0)",c=(l.fill=u,l.color=u,o.sc&&(l.stroke=this.buildColor(o.sc),l.strokeWidth=o.sw+"px"),this.globalData.fontManager.getFontByName(o.f)),h=(this.globalData.fontManager.chars||(l.fontSize=o.finalSize+"px",l.lineHeight=o.finalSize+"px",c.fClass?this.innerElem.className=c.fClass:(l.fontFamily=c.fFamily,u=o.fWeight,e=o.fStyle,l.fontStyle=e,l.fontWeight=u)),o.l),d=h.length,p=this.mHelper,f=0,m=0;m<d;m+=1)this.globalData.fontManager.chars?(this.textPaths[f]?t=this.textPaths[f]:((t=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),t.setAttribute("stroke-linejoin",lineJoinEnum[2]),t.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[f]?i=(r=this.textSpans[f]).children[0]:((r=createTag("div")).style.lineHeight=0,(i=createNS("svg")).appendChild(t),styleDiv(r)))):this.isMasked?t=this.textPaths[f]||createNS("text"):this.textSpans[f]?(r=this.textSpans[f],t=this.textPaths[f]):(styleDiv(r=createTag("span")),styleDiv(t=createTag("span")),r.appendChild(t)),this.globalData.fontManager.chars?(a=(a=this.globalData.fontManager.getCharData(o.finalText[m],c.fStyle,this.globalData.fontManager.getFontByName(o.f).fFamily))?a.data:null,p.reset(),a&&a.shapes&&a.shapes.length&&(n=a.shapes[0].it,p.scale(o.finalSize/100,o.finalSize/100),n=this.createPathShape(p,n),t.setAttribute("d",n)),this.isMasked?this.innerElem.appendChild(t):(this.innerElem.appendChild(r),a&&a.shapes?(document.body.appendChild(i),n=i.getBBox(),i.setAttribute("width",n.width+2),i.setAttribute("height",n.height+2),i.setAttribute("viewBox",n.x-1+" "+(n.y-1)+" "+(n.width+2)+" "+(n.height+2)),a=i.style,s="translate("+(n.x-1)+"px,"+(n.y-1)+"px)",a.transform=s,a.webkitTransform=s,h[m].yOffset=n.y-1):(i.setAttribute("width",1),i.setAttribute("height",1)),r.appendChild(i))):(t.textContent=h[m].val,t.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked?this.innerElem.appendChild(t):(this.innerElem.appendChild(r),a=t.style,s="translate3d(0,"+-o.finalSize/1.2+"px,0)",a.transform=s,a.webkitTransform=s)),this.isMasked?this.textSpans[f]=t:this.textSpans[f]=r,this.textSpans[f].style.display="block",this.textPaths[f]=t,f+=1;for(;f<this.textSpans.length;)this.textSpans[f].style.display="none",f+=1},HTextElement.prototype.renderInnerContent=function(){var e;if(this.validateText(),this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;this.isMasked&&this.finalTransform._matMdf&&(this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),e=this.svgElement.style,n="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)",e.transform=n,e.webkitTransform=n)}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){for(var t,r,i,n,a=0,s=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l,l=o.length,u=0;u<l;u+=1)o[u].n?a+=1:(r=this.textSpans[u],i=this.textPaths[u],t=s[a],a+=1,t._mdf.m&&(this.isMasked?r.setAttribute("transform",t.m):(r.style.webkitTransform=t.m,r.style.transform=t.m)),r.style.opacity=t.o,t.sw&&t._mdf.sw&&i.setAttribute("stroke-width",t.sw),t.sc&&t._mdf.sc&&i.setAttribute("stroke",t.sc),t.fc&&t._mdf.fc&&(i.setAttribute("fill",t.fc),i.style.color=t.fc));this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)&&(n=this.innerElem.getBBox(),this.currentBBox.w!==n.width&&(this.currentBBox.w=n.width,this.svgElement.setAttribute("width",n.width)),this.currentBBox.h!==n.height&&(this.currentBBox.h=n.height,this.svgElement.setAttribute("height",n.height)),this.currentBBox.w===n.width+2&&this.currentBBox.h===n.height+2&&this.currentBBox.x===n.x-1&&this.currentBBox.y===n.y-1||(this.currentBBox.w=n.width+2,this.currentBBox.h=n.height+2,this.currentBBox.x=n.x-1,this.currentBBox.y=n.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),e=this.svgElement.style,n="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)",e.transform=n,e.webkitTransform=n))}},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){for(var e,t,r,i,n,a=this.comp.threeDElements.length,s=0;s<a;s+=1)"3d"===(n=this.comp.threeDElements[s]).type&&(e=n.perspectiveElem.style,n=n.container.style,t=this.pe.v+"px",r="0px 0px 0px",i="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)",e.perspective=t,e.webkitPerspective=t,n.transformOrigin=r,n.mozTransformOrigin=r,n.webkitTransformOrigin=r,e.transform=i,e.webkitTransform=i)},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var e=this._isFirstFrame;if(this.hierarchy)for(l=this.hierarchy.length,u=0;u<l;u+=1)e=this.hierarchy[u].finalTransform.mProp._mdf||e;if(e||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(u=l=this.hierarchy.length-1;0<=u;--u){var t=this.hierarchy[u].finalTransform.mProp;this.mat.translate(-t.p.v[0],-t.p.v[1],t.p.v[2]),this.mat.rotateX(-t.or.v[0]).rotateY(-t.or.v[1]).rotateZ(t.or.v[2]),this.mat.rotateX(-t.rx.v).rotateY(-t.ry.v).rotateZ(t.rz.v),this.mat.scale(1/t.s.v[0],1/t.s.v[1],1/t.s.v[2]),this.mat.translate(t.a.v[0],t.a.v[1],t.a.v[2])}this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a&&(i=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]],r=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)),i=[i[0]/r,i[1]/r,i[2]/r],r=Math.sqrt(i[2]*i[2]+i[0]*i[0]),r=Math.atan2(i[1],r),i=Math.atan2(i[0],-i[2]),this.mat.rotateY(i).rotateX(-r)),this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var r,i,n=!this._prevMat.equals(this.mat);if((n||this.pe._mdf)&&this.comp.threeDElements){for(var a,s,o,l=this.comp.threeDElements.length,u=0;u<l;u+=1)"3d"===(o=this.comp.threeDElements[u]).type&&(n&&(a=this.mat.toCSS(),(s=o.container.style).transform=a,s.webkitTransform=a),this.pe._mdf)&&((s=o.perspectiveElem.style).perspective=this.pe.v+"px",s.webkitPerspective=this.pe.v+"px");this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData),t=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(t),t.crossOrigin="anonymous",t.src=e,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRendererBase.prototype.appendElementInPos=function(e,t){e=e.getBaseElement();if(e){var r=this.layers[t];if(r.ddd&&this.supports3d)this.addTo3dContainer(e,t);else if(this.threeDElements)this.addTo3dContainer(e,t);else{for(var i,n,a=0;a<t;)this.elements[a]&&!0!==this.elements[a]&&this.elements[a].getBaseElement&&(n=this.elements[a],i=(this.layers[a].ddd?this.getThreeDContainerByPos(a):n.getBaseElement())||i),a+=1;i?r.ddd&&this.supports3d||this.layerElement.insertBefore(e,i):r.ddd&&this.supports3d||this.layerElement.appendChild(e)}}},HybridRendererBase.prototype.createShape=function(e){return new(this.supports3d?HShapeElement:SVGShapeElement)(e,this.globalData,this)},HybridRendererBase.prototype.createText=function(e){return new(this.supports3d?HTextElement:SVGTextLottieElement)(e,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(e){return this.camera=new HCameraElement(e,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(e){return new(this.supports3d?HImageElement:IImageElement)(e,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(e){return new(this.supports3d?HSolidElement:ISolidElement)(e,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(e){for(var t=0,r=this.threeDElements.length;t<r;){if(this.threeDElements[t].startPos<=e&&this.threeDElements[t].endPos>=e)return this.threeDElements[t].perspectiveElem;t+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(e,t){var r,i=createTag("div"),n=(styleDiv(i),createTag("div")),a=(styleDiv(n),"3d"===t&&((a=i.style).width=this.globalData.compSize.w+"px",a.height=this.globalData.compSize.h+"px",a.webkitTransformOrigin=r="50% 50%",a.mozTransformOrigin=r,a.transformOrigin=r,(a=n.style).transform=r="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)",a.webkitTransform=r),i.appendChild(n),{container:n,perspectiveElem:i,startPos:e,endPos:e,type:t});return this.threeDElements.push(a),a},HybridRendererBase.prototype.build3dContainers=function(){for(var e,t=this.layers.length,r="",i=0;i<t;i+=1)this.layers[i].ddd&&3!==this.layers[i].ty?(e="3d"!==r?this.createThreeDContainer(i,r="3d"):e).endPos=Math.max(e.endPos,i):(e="2d"!==r?this.createThreeDContainer(i,r="2d"):e).endPos=Math.max(e.endPos,i);for(i=(t=this.threeDElements.length)-1;0<=i;--i)this.resizerElem.appendChild(this.threeDElements[i].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(e,t){for(var r=0,i=this.threeDElements.length;r<i;){if(t<=this.threeDElements[r].endPos){for(var n,a=this.threeDElements[r].startPos;a<t;)this.elements[a]&&this.elements[a].getBaseElement&&(n=this.elements[a].getBaseElement()),a+=1;n?this.threeDElements[r].container.insertBefore(e,n):this.threeDElements[r].container.appendChild(e);break}r+=1}},HybridRendererBase.prototype.configAnimation=function(e){var t=createTag("div"),r=this.animationItem.wrapper,i=t.style,r=(i.width=e.w+"px",i.height=e.h+"px",styleDiv(this.resizerElem=t),i.transformStyle="flat",i.mozTransformStyle="flat",i.webkitTransformStyle="flat",this.renderConfig.className&&t.setAttribute("class",this.renderConfig.className),r.appendChild(t),i.overflow="hidden",createNS("svg")),t=(r.setAttribute("width","1"),r.setAttribute("height","1"),styleDiv(r),this.resizerElem.appendChild(r),createNS("defs"));r.appendChild(t),this.data=e,this.setupGlobalData(e,r),this.globalData.defs=t,this.layers=e.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;for(var e=this.layers?this.layers.length:0,t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var e,t,r,i=this.animationItem.wrapper.offsetWidth,n=this.animationItem.wrapper.offsetHeight,i=i/n<this.globalData.compSize.w/this.globalData.compSize.h?(e=i/this.globalData.compSize.w,t=i/this.globalData.compSize.w,r=0,(n-this.globalData.compSize.h*(i/this.globalData.compSize.w))/2):(e=n/this.globalData.compSize.h,t=n/this.globalData.compSize.h,r=(i-this.globalData.compSize.w*(n/this.globalData.compSize.h))/2,0),n=this.resizerElem.style;n.webkitTransform="matrix3d("+e+",0,0,0,0,"+t+",0,0,0,0,1,0,"+r+","+i+",0,1)",n.transform=n.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else for(var e=this.globalData.compSize.w,t=this.globalData.compSize.h,r=this.threeDElements.length,i=0;i<r;i+=1){var n=this.threeDElements[i].perspectiveElem.style;n.webkitPerspective=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))+"px",n.perspective=n.webkitPerspective}},HybridRendererBase.prototype.searchExtraCompositions=function(e){for(var t,r=e.length,i=createTag("div"),n=0;n<r;n+=1)e[n].xt&&((t=this.createComp(e[n],i,this.globalData.comp,null)).initExpressions(),this.globalData.projectInterface.registerComposition(t))},extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(e,t){for(var r,i=0;i<t;)this.elements[i]&&this.elements[i].getBaseElement&&(r=this.elements[i].getBaseElement()),i+=1;r?this.layerElement.insertBefore(e,r):this.layerElement.appendChild(e)},HCompElement.prototype.createComp=function(e){return new(this.supports3d?HCompElement:SVGCompElement)(e,this.globalData,this)},extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(e){return new(this.supports3d?HCompElement:SVGCompElement)(e,this.globalData,this)};var CompExpressionInterface=function(i){function e(e){for(var t=0,r=i.layers.length;t<r;){if(i.layers[t].nm===e||i.layers[t].ind===e)return i.elements[t].layerInterface;t+=1}return null}return Object.defineProperty(e,"_name",{value:i.data.nm}),(e.layer=e).pixelAspect=1,e.height=i.data.h||i.globalData.compSize.h,e.width=i.data.w||i.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/i.globalData.frameRate,e.displayStartTime=0,e.numLayers=i.layers.length,e};function _typeof$2(e){return(_typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function seedRandom(s,o){var l=this,u=256,c=6,h="random",d=o.pow(u,c),p=o.pow(2,52),f=2*p,m=u-1;function g(e){var t,r=e.length,s=this,i=0,n=s.i=s.j=0,a=s.S=[];for(r||(e=[r++]);i<u;)a[i]=i++;for(i=0;i<u;i++)a[i]=a[n=m&n+e[i%r]+(t=a[i])],a[n]=t;s.g=function(e){for(var t,r=0,i=s.i,n=s.j,a=s.S;e--;)t=a[i=m&i+1],r=r*u+a[m&(a[i]=a[n=m&n+t])+(a[n]=t)];return s.i=i,s.j=n,r}}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function y(e,t){for(var r,i=e+"",n=0;n<i.length;)t[m&n]=m&(r^=19*t[m&n])+i.charCodeAt(n++);return _(t)}function _(e){return String.fromCharCode.apply(0,e)}o["seed"+h]=function(e,t,r){function i(){for(var e=a.g(c),t=d,r=0;e<p;)e=(e+r)*u,t*=u,r=a.g(1);for(;f<=e;)e/=2,t/=2,r>>>=1;return(e+r)/t}var n=[],e=y(function e(t,r){var i,n=[],a=_typeof$2(t);if(r&&"object"==a)for(i in t)try{n.push(e(t[i],r-1))}catch(e){}return n.length?n:"string"==a?t:t+"\0"}((t=!0===t?{entropy:!0}:t||{}).entropy?[e,_(s)]:null===e?(()=>{try{var t=new Uint8Array(u);return(l.crypto||l.msCrypto).getRandomValues(t),_(t)}catch(e){t=l.navigator,t=t&&t.plugins;return[+new Date,l,t,l.screen,_(s)]}})():e,3),n),a=new g(n);return i.int32=function(){return 0|a.g(4)},i.quick=function(){return a.g(4)/4294967296},i.double=i,y(_(a.S),s),(t.pass||r||function(e,t,r,i){return i&&(i.S&&v(i,a),e.state=function(){return v(a,{})}),r?(o[h]=e,t):e})(i,e,"global"in t?t.global:this==o,t.state)},y(o.random(),s)}function initialize$2(e){seedRandom([],e)}var propTypes={SHAPE:"shape"};function _typeof$1(e){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null,_lottieGlobal={};function resetFrame(){_lottieGlobal={}}function $bm_isInstanceOfArray(e){return e.constructor===Array||e.constructor===Float32Array}function isNumerable(e,t){return"number"===e||t instanceof Number||"boolean"===e||"string"===e}function $bm_neg(e){var t=_typeof$1(e);if("number"===t||e instanceof Number||"boolean"===t)return-e;if($bm_isInstanceOfArray(e)){for(var r=e.length,i=[],n=0;n<r;n+=1)i[n]=-e[n];return i}return e.propType?e.v:-e}initialize$2(BMMath);var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(e,t){var r=_typeof$1(e),i=_typeof$1(t);if(isNumerable(r,e)&&isNumerable(i,t)||"string"===r||"string"===i)return e+t;if($bm_isInstanceOfArray(e)&&isNumerable(i,t))return(e=e.slice(0))[0]+=t,e;if(isNumerable(r,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e+t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var n=0,a=e.length,s=t.length,o=[];n<a||n<s;)("number"==typeof e[n]||e[n]instanceof Number)&&("number"==typeof t[n]||t[n]instanceof Number)?o[n]=e[n]+t[n]:o[n]=void 0===t[n]?e[n]:e[n]||t[n],n+=1;return o}return 0}var add=sum;function sub(e,t){var r=_typeof$1(e),i=_typeof$1(t);if(isNumerable(r,e)&&isNumerable(i,t))return(e="string"===r?parseInt(e,10):e)-(t="string"===i?parseInt(t,10):t);if($bm_isInstanceOfArray(e)&&isNumerable(i,t))return(e=e.slice(0))[0]-=t,e;if(isNumerable(r,e)&&$bm_isInstanceOfArray(t))return(t=t.slice(0))[0]=e-t[0],t;if($bm_isInstanceOfArray(e)&&$bm_isInstanceOfArray(t)){for(var n=0,a=e.length,s=t.length,o=[];n<a||n<s;)("number"==typeof e[n]||e[n]instanceof Number)&&("number"==typeof t[n]||t[n]instanceof Number)?o[n]=e[n]-t[n]:o[n]=void 0===t[n]?e[n]:e[n]||t[n],n+=1;return o}return 0}function mul(e,t){var r,i,n,a=_typeof$1(e),s=_typeof$1(t);if(isNumerable(a,e)&&isNumerable(s,t))return e*t;if($bm_isInstanceOfArray(e)&&isNumerable(s,t)){for(n=e.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=e[i]*t;return r}if(isNumerable(a,e)&&$bm_isInstanceOfArray(t)){for(n=t.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=e*t[i];return r}return 0}function div(e,t){var r,i,n,a=_typeof$1(e),s=_typeof$1(t);if(isNumerable(a,e)&&isNumerable(s,t))return e/t;if($bm_isInstanceOfArray(e)&&isNumerable(s,t)){for(n=e.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=e[i]/t;return r}if(isNumerable(a,e)&&$bm_isInstanceOfArray(t)){for(n=t.length,r=createTypedArray("float32",n),i=0;i<n;i+=1)r[i]=e/t[i];return r}return 0}function mod(e,t){return(e="string"==typeof e?parseInt(e,10):e)%(t="string"==typeof t?parseInt(t,10):t)}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(e,t,r){var i;return r<t&&(i=r,r=t,t=i),Math.min(Math.max(e,t),r)}function radiansToDegrees(e){return e/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(e){return e*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(e,t){if("number"==typeof e||e instanceof Number)return Math.abs(e-(t=t||0));for(var r=Math.min(e.length,(t=t||helperLengthArray).length),i=0,n=0;n<r;n+=1)i+=Math.pow(t[n]-e[n],2);return Math.sqrt(i)}function normalize(e){return div(e,length(e))}function rgbToHsl(e){var t,r=e[0],i=e[1],n=e[2],a=Math.max(r,i,n),s=Math.min(r,i,n),o=(a+s)/2;if(a===s)u=t=0;else{var l=a-s,u=.5<o?l/(2-a-s):l/(a+s);switch(a){case r:t=(i-n)/l+(i<n?6:0);break;case i:t=(n-r)/l+2;break;case n:t=(r-i)/l+4}t/=6}return[t,u,o,e[3]]}function hue2rgb(e,t,r){return r<0&&(r+=1),1<r&&--r,r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function hslToRgb(e){var t,r,i,n=e[0],a=e[1],s=e[2];return 0===a?r=i=t=s:(t=hue2rgb(a=2*s-(s=s<.5?s*(1+a):s+a-s*a),s,n+1/3),r=hue2rgb(a,s,n),i=hue2rgb(a,s,n-1/3)),[t,r,i,e[3]]}function linear(e,t,r,i,n){var a;if(void 0!==i&&void 0!==n||(i=t,n=r,t=0,r=1),r<t&&(a=r,r=t,t=a),e<=t)return i;if(r<=e)return n;var s=r===t?0:(e-t)/(r-t);if(!i.length)return i+(n-i)*s;for(var o=i.length,l=createTypedArray("float32",o),u=0;u<o;u+=1)l[u]=i[u]+(n[u]-i[u])*s;return l}function random(e,t){if(void 0===t&&(void 0===e?(e=0,t=1):(t=e,e=void 0)),t.length){for(var r=t.length,i=(e=e||createTypedArray("float32",r),createTypedArray("float32",r)),n=BMMath.random(),a=0;a<r;a+=1)i[a]=e[a]+n*(t[a]-e[a]);return i}return(e=void 0===e?0:e)+BMMath.random()*(t-e)}function createPath(e,t,r,i){for(var n,a,s=e.length,o=shapePool.newElement(),l=(o.setPathData(!!i,s),[0,0]),u=0;u<s;u+=1)n=t&&t[u]?t[u]:l,a=r&&r[u]?r[u]:l,o.setTripleAt(e[u][0],e[u][1],a[0]+e[u][0],a[1]+e[u][1],n[0]+e[u][0],n[1]+e[u][1],u,!0);return o}function initiateExpression(elem,data,property){function noOp(e){return e}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property,inPoint=(thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0,elem.data.ip/elem.comp.globalData.frameRate),outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw||0,height=elem.data.sh||0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(e,t){for(var r=this.pv.length||1,i=createTypedArray("float32",r),n=Math.floor(5*time),a=0,s=0;a<n;){for(s=0;s<r;s+=1)i[s]+=-t+2*t*BMMath.random();a+=1}var o=5*time,l=o-Math.floor(o),u=createTypedArray("float32",r);if(1<r){for(s=0;s<r;s+=1)u[s]=this.pv[s]+i[s]+(-t+2*t*BMMath.random())*l;return u}return this.pv+i[0]+(-t+2*t*BMMath.random())*l}.bind(this);function loopInDuration(e,t){return loopIn(e,t,!0)}function loopOutDuration(e,t){return loopOut(e,t,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(e,t){t=[t[0]-e[0],t[1]-e[1],t[2]-e[2]],e=Math.atan2(t[0],Math.sqrt(t[1]*t[1]+t[2]*t[2]))/degToRads;return[-Math.atan2(t[1],t[2])/degToRads,e,0]}function easeOut(e,t,r,i,n){return applyEase(easeOutBez,e,t,r,i,n)}function easeIn(e,t,r,i,n){return applyEase(easeInBez,e,t,r,i,n)}function ease(e,t,r,i,n){return applyEase(easeInOutBez,e,t,r,i,n)}function applyEase(e,t,r,i,n,a){void 0===n?(n=r,a=i):t=(t-r)/(i-r),1<t?t=1:t<0&&(t=0);var s=e(t);if($bm_isInstanceOfArray(n)){for(var o=n.length,l=createTypedArray("float32",o),u=0;u<o;u+=1)l[u]=(a[u]-n[u])*s+n[u];return l}return(a-n)*s+n}function nearestKey(e){var t,r,i,n=data.k.length;if(data.k.length&&"number"!=typeof data.k[0])if(r=-1,(e*=elem.comp.globalData.frameRate)<data.k[0].t)r=1,i=data.k[0].t;else{for(t=0;t<n-1;t+=1){if(e===data.k[t].t){r=t+1,i=data.k[t].t;break}if(e>data.k[t].t&&e<data.k[t+1].t){i=(e-data.k[t].t>data.k[t+1].t-e?(r=t+2,data.k[t+1]):(r=t+1,data.k[t])).t;break}}-1===r&&(r=t+1,i=data.k[t].t)}else i=r=0;var a={};return a.index=r,a.time=i/elem.comp.globalData.frameRate,a}function key(e){if(!data.k.length||"number"==typeof data.k[0])throw new Error("The property has no keyframe at index "+e);for(var t={time:data.k[--e].t/elem.comp.globalData.frameRate,value:[]},r=Object.prototype.hasOwnProperty.call(data.k[e],"s")?data.k[e].s:data.k[e-1].e,i=r.length,n=0;n<i;n+=1)t[n]=r[n],t.value[n]=r[n];return t}function framesToTime(e,t){return e/(t=t||elem.comp.globalData.frameRate)}function timeToFrames(e,t){return(e=e||0===e?e:time)*(t=t||elem.comp.globalData.frameRate)}function seedRandom(e){BMMath.seedrandom(randSeed+e)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(e,t){return"string"==typeof value?void 0===t?value.substring(e):value.substring(e,t):""}function substr(e,t){return"string"==typeof value?void 0===t?value.substr(e):value.substr(e,t):""}function posterizeTime(e){time=0===e?0:Math.floor(time*e)/e,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(e){return value=e,this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),!transform&&(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform)&&(anchorPoint=transform.anchorPoint),4===elemType&&(content=content||thisLayer("ADBE Root Vectors Group")),effect=effect||thisLayer(4),(hasParent=!(!elem.hierarchy||!elem.hierarchy.length))&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath,_lottieGlobal],ob.resetFrame=resetFrame,ob}(),Expressions=(()=>{var e={};return e.initExpressions=function(e){var r=0,i=[];e.renderer.compInterface=CompExpressionInterface(e.renderer),e.renderer.globalData.projectInterface.registerComposition(e.renderer),e.renderer.globalData.pushExpression=function(){r+=1},e.renderer.globalData.popExpression=function(){if(0===--r){var e,t=i.length;for(e=0;e<t;e+=1)i[e].release();i.length=0}},e.renderer.globalData.registerExpressionProperty=function(e){-1===i.indexOf(e)&&i.push(e)}},e.resetFrame=ExpressionManager.resetFrame,e})(),MaskManagerInterface=(()=>{function e(e,t){this._mask=e,this._data=t}return Object.defineProperty(e.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(e.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(t){for(var r=createSizedArray(t.viewData.length),i=t.viewData.length,n=0;n<i;n+=1)r[n]=new e(t.viewData[n],t.masksProperties[n]);return function(e){for(n=0;n<i;){if(t.masksProperties[n].nm===e)return r[n];n+=1}return null}}})(),ExpressionPropertyInterface=(()=>{var c={pv:0,v:0,mult:1},h={pv:[0,0,0],v:[0,0,0],mult:1};function d(i,n,a){Object.defineProperty(i,"velocity",{get:function(){return n.getVelocityAtTime(n.comp.currentFrame)}}),i.numKeys=n.keyframes?n.keyframes.length:0,i.key=function(e){var t,r;return i.numKeys?(t="",t="s"in n.keyframes[e-1]?n.keyframes[e-1].s:"e"in n.keyframes[e-2]?n.keyframes[e-2].e:n.keyframes[e-2].s,(r="unidimensional"===a?new Number(t):Object.assign({},t)).time=n.keyframes[e-1].t/n.elem.comp.globalData.frameRate,r.value="unidimensional"===a?t[0]:t,r):0},i.valueAtTime=n.getValueAtTime,i.speedAtTime=n.getSpeedAtTime,i.velocityAtTime=n.getVelocityAtTime,i.propertyGroup=n.propertyGroup}function p(){return c}return function(e){var t,r,i,n,a,s,o,l,u;return e?"unidimensional"===e.propType?(r=1/(t=(t=e)&&"pv"in t?t:c).mult,i=t.pv*r,(n=new Number(i)).value=i,d(n,t,"unidimensional"),function(){return t.k&&t.getValue(),i=t.v*r,n.value!==i&&((n=new Number(i)).value=i,d(n,t,"unidimensional")),n}):(s=1/(a=(a=e)&&"pv"in a?a:h).mult,o=a.data&&a.data.l||a.pv.length,l=createTypedArray("float32",o),u=createTypedArray("float32",o),l.value=u,d(l,a,"multidimensional"),function(){a.k&&a.getValue();for(var e=0;e<o;e+=1)u[e]=a.v[e]*s,l[e]=u[e];return l}):p}})(),TransformExpressionInterface=function(e){function t(e){switch(e){case"scale":case"Scale":case"ADBE Scale":case 6:return t.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return t.rotation;case"ADBE Rotate X":return t.xRotation;case"ADBE Rotate Y":return t.yRotation;case"position":case"Position":case"ADBE Position":case 2:return t.position;case"ADBE Position_0":return t.xPosition;case"ADBE Position_1":return t.yPosition;case"ADBE Position_2":return t.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return t.anchorPoint;case"opacity":case"Opacity":case 11:return t.opacity;default:return null}}var r,i,n,a;return Object.defineProperty(t,"rotation",{get:ExpressionPropertyInterface(e.r||e.rz)}),Object.defineProperty(t,"zRotation",{get:ExpressionPropertyInterface(e.rz||e.r)}),Object.defineProperty(t,"xRotation",{get:ExpressionPropertyInterface(e.rx)}),Object.defineProperty(t,"yRotation",{get:ExpressionPropertyInterface(e.ry)}),Object.defineProperty(t,"scale",{get:ExpressionPropertyInterface(e.s)}),e.p?a=ExpressionPropertyInterface(e.p):(r=ExpressionPropertyInterface(e.px),i=ExpressionPropertyInterface(e.py),e.pz&&(n=ExpressionPropertyInterface(e.pz))),Object.defineProperty(t,"position",{get:function(){return e.p?a():[r(),i(),n?n():0]}}),Object.defineProperty(t,"xPosition",{get:ExpressionPropertyInterface(e.px)}),Object.defineProperty(t,"yPosition",{get:ExpressionPropertyInterface(e.py)}),Object.defineProperty(t,"zPosition",{get:ExpressionPropertyInterface(e.pz)}),Object.defineProperty(t,"anchorPoint",{get:ExpressionPropertyInterface(e.a)}),Object.defineProperty(t,"opacity",{get:ExpressionPropertyInterface(e.o)}),Object.defineProperty(t,"skew",{get:ExpressionPropertyInterface(e.sk)}),Object.defineProperty(t,"skewAxis",{get:ExpressionPropertyInterface(e.sa)}),Object.defineProperty(t,"orientation",{get:ExpressionPropertyInterface(e.or)}),t},LayerExpressionInterface=(()=>{function n(e){var t=new Matrix;return void 0!==e?this._elem.finalTransform.mProp.getValueAtTime(e).clone(t):this._elem.finalTransform.mProp.applyToMatrix(t),t}function a(e,t){t=this.getMatrix(t);return t.props[12]=0,t.props[13]=0,t.props[14]=0,this.applyPoint(t,e)}function s(e,t){t=this.getMatrix(t);return this.applyPoint(t,e)}function o(e,t){t=this.getMatrix(t);return t.props[12]=0,t.props[13]=0,t.props[14]=0,this.invertPoint(t,e)}function l(e,t){t=this.getMatrix(t);return this.invertPoint(t,e)}function u(e,t){if(this._elem.hierarchy&&this._elem.hierarchy.length)for(var r=this._elem.hierarchy.length,i=0;i<r;i+=1)this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(e);return e.applyToPointArray(t[0],t[1],t[2]||0)}function c(e,t){if(this._elem.hierarchy&&this._elem.hierarchy.length)for(var r=this._elem.hierarchy.length,i=0;i<r;i+=1)this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(e);return e.inversePoint(t)}function h(e){var t=new Matrix;if(t.reset(),this._elem.finalTransform.mProp.applyToMatrix(t),this._elem.hierarchy&&this._elem.hierarchy.length)for(var r=this._elem.hierarchy.length,i=0;i<r;i+=1)this._elem.hierarchy[i].finalTransform.mProp.applyToMatrix(t);return t.inversePoint(e)}function d(){return[1,1,1,1]}return function(t){function r(e){switch(e){case"ADBE Root Vectors Group":case"Contents":case 2:return r.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return i;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return r.effect;case"ADBE Text Properties":return r.textInterface;default:return null}}r.getMatrix=n,r.invertPoint=c,r.applyPoint=u,r.toWorld=s,r.toWorldVec=a,r.fromWorld=l,r.fromWorldVec=o,r.toComp=s,r.fromComp=h,r.sampleImage=d,r.sourceRectAtTime=t.sourceRectAtTime.bind(t);var i,e=getDescriptor(i=TransformExpressionInterface((r._elem=t).finalTransform.mProp),"anchorPoint");return Object.defineProperties(r,{hasParent:{get:function(){return t.hierarchy.length}},parent:{get:function(){return t.hierarchy[0].layerInterface}},rotation:getDescriptor(i,"rotation"),scale:getDescriptor(i,"scale"),position:getDescriptor(i,"position"),opacity:getDescriptor(i,"opacity"),anchorPoint:e,anchor_point:e,transform:{get:function(){return i}},active:{get:function(){return t.isInRange}}}),r.startTime=t.data.st,r.index=t.data.ind,r.source=t.data.refId,r.height=0===t.data.ty?t.data.h:100,r.width=0===t.data.ty?t.data.w:100,r.inPoint=t.data.ip/t.comp.globalData.frameRate,r.outPoint=t.data.op/t.comp.globalData.frameRate,r._name=t.data.nm,r.registerMaskInterface=function(e){r.mask=new MaskManagerInterface(e,t)},r.registerEffectsInterface=function(e){r.effect=e},r}})(),propertyGroupFactory=function(t,r){return function(e){return(e=void 0===e?1:e)<=0?t:r(e-1)}},PropertyInterface=function(e,t){var r={_name:e};return function(e){return(e=void 0===e?1:e)<=0?r:t(e-1)}},EffectsExpressionInterface=(()=>{function c(e,t,r,i){var n=ExpressionPropertyInterface(e.p);return e.p.setGroupProperty&&e.p.setGroupProperty(PropertyInterface("",i)),function(){return 10===t?r.comp.compInterface(e.p.v):n()}}return{createEffectsInterface:function(e,t){if(e.effectsManager){var r,i=[],n=e.data.ef,a=e.effectsManager.effectElements.length;for(r=0;r<a;r+=1)i.push(function e(n,t,r,i){function a(e){for(var t=n.ef,r=0,i=t.length;r<i;){if(e===t[r].nm||e===t[r].mn||e===t[r].ix)return 5===t[r].ty?o[r]:o[r]();r+=1}throw new Error}var s=propertyGroupFactory(a,r);var o=[];var l;var u=n.ef.length;for(l=0;l<u;l+=1)5===n.ef[l].ty?o.push(e(n.ef[l],t.effectElements[l],t.effectElements[l].propertyGroup,i)):o.push(c(t.effectElements[l],n.ef[l].ty,i,s));"ADBE Color Control"===n.mn&&Object.defineProperty(a,"color",{get:function(){return o[0]()}});Object.defineProperties(a,{numProperties:{get:function(){return n.np}},_name:{value:n.nm},propertyGroup:{value:s}});a.enabled=0!==n.en;a.active=a.enabled;return a}(n[r],e.effectsManager.effectElements[r],t,e));var s=e.data.ef||[],o=function(e){for(r=0,a=s.length;r<a;){if(e===s[r].nm||e===s[r].mn||e===s[r].ix)return i[r];r+=1}return null};return Object.defineProperty(o,"numProperties",{get:function(){return s.length}}),o}return null}}})(),ShapePathInterface=function(e,t,r){var i=t.sh;function n(e){return"Shape"===e||"shape"===e||"Path"===e||"path"===e||"ADBE Vector Shape"===e||2===e?n.path:null}t=propertyGroupFactory(n,r);return i.setGroupProperty(PropertyInterface("Path",t)),Object.defineProperties(n,{path:{get:function(){return i.k&&i.getValue(),i}},shape:{get:function(){return i.k&&i.getValue(),i}},_name:{value:e.nm},ix:{value:e.ix},propertyIndex:{value:e.ix},mn:{value:e.mn},propertyGroup:{value:r}}),n},ShapeExpressionInterface=(()=>{function s(e,t,r){for(var i=[],n=e?e.length:0,a=0;a<n;a+=1)"gr"===e[a].ty?i.push(((e,t,r)=>{function i(e){switch(e){case"ADBE Vectors Group":case"Contents":case 2:return i.content;default:return i.transform}}return i.propertyGroup=propertyGroupFactory(i,r),r=((e,t,r)=>{function i(e){for(var t=0,r=n.length;t<r;){if(n[t]._name===e||n[t].mn===e||n[t].propertyIndex===e||n[t].ix===e||n[t].ind===e)return n[t];t+=1}return"number"==typeof e?n[e-1]:null}i.propertyGroup=propertyGroupFactory(i,r),n=s(e.it,t.it,i.propertyGroup),i.numProperties=n.length;var n,r=o(e.it[e.it.length-1],t.it[t.it.length-1],i.propertyGroup);return i.transform=r,i.propertyIndex=e.cix,i._name=e.nm,i})(e,t,i.propertyGroup),t=o(e.it[e.it.length-1],t.it[t.it.length-1],i.propertyGroup),i.content=r,i.transform=t,Object.defineProperty(i,"_name",{get:function(){return e.nm}}),i.numProperties=e.np,i.propertyIndex=e.ix,i.nm=e.nm,i.mn=e.mn,i})(e[a],t[a],r)):"fl"===e[a].ty?i.push(((e,t,r)=>{function i(e){return"Color"===e||"color"===e?i.color:"Opacity"===e||"opacity"===e?i.opacity:null}return Object.defineProperties(i,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(PropertyInterface("Color",r)),t.o.setGroupProperty(PropertyInterface("Opacity",r)),i})(e[a],t[a],r)):"st"===e[a].ty?i.push(((e,t,r)=>{var i,r=propertyGroupFactory(l,r),n=propertyGroupFactory(void 0,r),a=e.d?e.d.length:0,s={};for(i=0;i<a;i+=1){{o=void 0;var o=i;Object.defineProperty(s,e.d[o].nm,{get:ExpressionPropertyInterface(t.d.dataProps[o].p)})}t.d.dataProps[i].p.setGroupProperty(n)}function l(e){return"Color"===e||"color"===e?l.color:"Opacity"===e||"opacity"===e?l.opacity:"Stroke Width"===e||"stroke width"===e?l.strokeWidth:null}return Object.defineProperties(l,{color:{get:ExpressionPropertyInterface(t.c)},opacity:{get:ExpressionPropertyInterface(t.o)},strokeWidth:{get:ExpressionPropertyInterface(t.w)},dash:{get:function(){return s}},_name:{value:e.nm},mn:{value:e.mn}}),t.c.setGroupProperty(PropertyInterface("Color",r)),t.o.setGroupProperty(PropertyInterface("Opacity",r)),t.w.setGroupProperty(PropertyInterface("Stroke Width",r)),l})(e[a],t[a],r)):"tm"===e[a].ty?i.push(((t,e,r)=>{function i(e){return e===t.e.ix||"End"===e||"end"===e?i.end:e===t.s.ix?i.start:e===t.o.ix?i.offset:null}var n=propertyGroupFactory(i,r);return i.propertyIndex=t.ix,e.s.setGroupProperty(PropertyInterface("Start",n)),e.e.setGroupProperty(PropertyInterface("End",n)),e.o.setGroupProperty(PropertyInterface("Offset",n)),i.propertyIndex=t.ix,i.propertyGroup=r,Object.defineProperties(i,{start:{get:ExpressionPropertyInterface(e.s)},end:{get:ExpressionPropertyInterface(e.e)},offset:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm}}),i.mn=t.mn,i})(e[a],t[a],r)):"tr"!==e[a].ty&&("el"===e[a].ty?i.push(((t,e,r)=>{function i(e){return t.p.ix===e?i.position:t.s.ix===e?i.size:null}return r=propertyGroupFactory(i,r),i.propertyIndex=t.ix,(e="tm"===e.sh.ty?e.sh.prop:e.sh).s.setGroupProperty(PropertyInterface("Size",r)),e.p.setGroupProperty(PropertyInterface("Position",r)),Object.defineProperties(i,{size:{get:ExpressionPropertyInterface(e.s)},position:{get:ExpressionPropertyInterface(e.p)},_name:{value:t.nm}}),i.mn=t.mn,i})(e[a],t[a],r)):"sr"===e[a].ty?i.push(((t,e,r)=>{function i(e){return t.p.ix===e?i.position:t.r.ix===e?i.rotation:t.pt.ix===e?i.points:t.or.ix===e||"ADBE Vector Star Outer Radius"===e?i.outerRadius:t.os.ix===e?i.outerRoundness:!t.ir||t.ir.ix!==e&&"ADBE Vector Star Inner Radius"!==e?t.is&&t.is.ix===e?i.innerRoundness:null:i.innerRadius}return r=propertyGroupFactory(i,r),e="tm"===e.sh.ty?e.sh.prop:e.sh,i.propertyIndex=t.ix,e.or.setGroupProperty(PropertyInterface("Outer Radius",r)),e.os.setGroupProperty(PropertyInterface("Outer Roundness",r)),e.pt.setGroupProperty(PropertyInterface("Points",r)),e.p.setGroupProperty(PropertyInterface("Position",r)),e.r.setGroupProperty(PropertyInterface("Rotation",r)),t.ir&&(e.ir.setGroupProperty(PropertyInterface("Inner Radius",r)),e.is.setGroupProperty(PropertyInterface("Inner Roundness",r))),Object.defineProperties(i,{position:{get:ExpressionPropertyInterface(e.p)},rotation:{get:ExpressionPropertyInterface(e.r)},points:{get:ExpressionPropertyInterface(e.pt)},outerRadius:{get:ExpressionPropertyInterface(e.or)},outerRoundness:{get:ExpressionPropertyInterface(e.os)},innerRadius:{get:ExpressionPropertyInterface(e.ir)},innerRoundness:{get:ExpressionPropertyInterface(e.is)},_name:{value:t.nm}}),i.mn=t.mn,i})(e[a],t[a],r)):"sh"===e[a].ty?i.push(ShapePathInterface(e[a],t[a],r)):"rc"===e[a].ty?i.push(((t,e,r)=>{function i(e){return t.p.ix===e?i.position:t.r.ix===e?i.roundness:t.s.ix===e||"Size"===e||"ADBE Vector Rect Size"===e?i.size:null}return r=propertyGroupFactory(i,r),e="tm"===e.sh.ty?e.sh.prop:e.sh,i.propertyIndex=t.ix,e.p.setGroupProperty(PropertyInterface("Position",r)),e.s.setGroupProperty(PropertyInterface("Size",r)),e.r.setGroupProperty(PropertyInterface("Rotation",r)),Object.defineProperties(i,{position:{get:ExpressionPropertyInterface(e.p)},roundness:{get:ExpressionPropertyInterface(e.r)},size:{get:ExpressionPropertyInterface(e.s)},_name:{value:t.nm}}),i.mn=t.mn,i})(e[a],t[a],r)):"rd"===e[a].ty?i.push(((t,e,r)=>{function i(e){return t.r.ix===e||"Round Corners 1"===e?i.radius:null}return r=propertyGroupFactory(i,r),i.propertyIndex=t.ix,e.rd.setGroupProperty(PropertyInterface("Radius",r)),Object.defineProperties(i,{radius:{get:ExpressionPropertyInterface(e.rd)},_name:{value:t.nm}}),i.mn=t.mn,i})(e[a],t[a],r)):"rp"===e[a].ty?i.push(((t,e,r)=>{function i(e){return t.c.ix===e||"Copies"===e?i.copies:t.o.ix===e||"Offset"===e?i.offset:null}return r=propertyGroupFactory(i,r),i.propertyIndex=t.ix,e.c.setGroupProperty(PropertyInterface("Copies",r)),e.o.setGroupProperty(PropertyInterface("Offset",r)),Object.defineProperties(i,{copies:{get:ExpressionPropertyInterface(e.c)},offset:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm}}),i.mn=t.mn,i})(e[a],t[a],r)):"gf"===e[a].ty?i.push(((e,t,r)=>{function i(e){return"Start Point"===e||"start point"===e?i.startPoint:"End Point"===e||"end point"===e?i.endPoint:"Opacity"===e||"opacity"===e?i.opacity:null}return Object.defineProperties(i,{startPoint:{get:ExpressionPropertyInterface(t.s)},endPoint:{get:ExpressionPropertyInterface(t.e)},opacity:{get:ExpressionPropertyInterface(t.o)},type:{get:function(){return"a"}},_name:{value:e.nm},mn:{value:e.mn}}),t.s.setGroupProperty(PropertyInterface("Start Point",r)),t.e.setGroupProperty(PropertyInterface("End Point",r)),t.o.setGroupProperty(PropertyInterface("Opacity",r)),i})(e[a],t[a],r)):i.push((e[a],t[a],function(){return null})));return i}function o(t,e,r){function i(e){return t.a.ix===e||"Anchor Point"===e?i.anchorPoint:t.o.ix===e||"Opacity"===e?i.opacity:t.p.ix===e||"Position"===e?i.position:t.r.ix===e||"Rotation"===e||"ADBE Vector Rotation"===e?i.rotation:t.s.ix===e||"Scale"===e?i.scale:t.sk&&t.sk.ix===e||"Skew"===e?i.skew:t.sa&&t.sa.ix===e||"Skew Axis"===e?i.skewAxis:null}var n=propertyGroupFactory(i,r);return e.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",n)),e.transform.mProps.p.setGroupProperty(PropertyInterface("Position",n)),e.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",n)),e.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",n)),e.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",n)),e.transform.mProps.sk&&(e.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",n)),e.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",n))),e.transform.op.setGroupProperty(PropertyInterface("Opacity",n)),Object.defineProperties(i,{opacity:{get:ExpressionPropertyInterface(e.transform.mProps.o)},position:{get:ExpressionPropertyInterface(e.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(e.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(e.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(e.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(e.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(e.transform.mProps.sa)},_name:{value:t.nm}}),i.ty="tr",i.mn=t.mn,i.propertyGroup=r,i}return function(e,t,i){var n;function r(e){if("number"==typeof e)return 0===(e=void 0===e?1:e)?i:n[e-1];for(var t=0,r=n.length;t<r;){if(n[t]._name===e)return n[t];t+=1}return null}return r.propertyGroup=propertyGroupFactory(r,function(){return i}),n=s(e,t,r.propertyGroup),r.numProperties=n.length,r._name="Contents",r}})(),TextExpressionInterface=function(t){var r;function i(e){return"ADBE Text Document"!==e?null:i.sourceText}return Object.defineProperty(i,"sourceText",{get:function(){t.textProperty.getValue();var e=t.textProperty.currentData.t;return r&&e===r.value||((r=new String(e)).value=e||new String(e),Object.defineProperty(r,"style",{get:function(){return{fillColor:t.textProperty.currentData.fc}}})),r}}),i};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var FootageInterface=(()=>{function r(e){function t(e){return"Outline"===e?t.outlineInterface():null}function r(e){var t;return a[e]?"object"===_typeof(a=a[n=e])?r:a:-1!==(t=e.indexOf(n))?(e=parseInt(e.substr(t+n.length),10),"object"===_typeof(a=a[e])?r:a):""}var i,n,a;return t._name="Outline",t.outlineInterface=(n="",a=(i=e).getFootageData(),function(){return n="",a=i.getFootageData(),r}),t}return function(e){function t(e){return"Data"===e?t.dataInterface:null}return t._name="Data",t.dataInterface=r(e),t}})(),interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(e){return interfaces[e]||null}var expressionHelpers={searchExpressions:function(e,t,r){t.x&&(r.k=!0,r.x=!0,r.initiateExpression=ExpressionManager.initiateExpression,r.effectsSequence.push(r.initiateExpression(e,t,r).bind(r)))},getSpeedAtTime:function(e){var t=this.getValueAtTime(e),r=this.getValueAtTime(e+-.01),i=0;if(t.length){for(var n=0;n<t.length;n+=1)i+=Math.pow(r[n]-t[n],2);i=100*Math.sqrt(i)}else i=0;return i},getVelocityAtTime:function(e){if(void 0!==this.vel)return this.vel;var t=this.getValueAtTime(e),r=this.getValueAtTime(e+-.001);if(t.length)for(var i=createTypedArray("float32",t.length),n=0;n<t.length;n+=1)i[n]=(r[n]-t[n])/-.001;else i=(r-t)/-.001;return i},getValueAtTime:function(e){return(e=(e*=this.elem.globalData.frameRate)-this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<e?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(e,this._cachingAtTime),this._cachingAtTime.lastFrame=e),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(e){this.propertyGroup=e}};function addPropertyDecorator(){function s(e,t,r){if(!this.k||!this.keyframes)return this.pv;e=e?e.toLowerCase():"";var i,n,a,s,o,l=this.comp.renderedFrame,u=this.keyframes,c=u[u.length-1].t;if(l<=c)return this.pv;if(r?n=c-(i=t?Math.abs(c-this.elem.comp.globalData.frameRate*t):Math.max(0,c-this.elem.data.ip)):((!t||t>u.length-1)&&(t=u.length-1),i=c-(n=u[u.length-1-t].t)),"pingpong"===e){if(Math.floor((l-n)/i)%2!=0)return this.getValueAtTime((i-(l-n)%i+n)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var h=this.getValueAtTime(n/this.comp.globalData.frameRate,0),d=this.getValueAtTime(c/this.comp.globalData.frameRate,0),p=this.getValueAtTime(((l-n)%i+n)/this.comp.globalData.frameRate,0),f=Math.floor((l-n)/i);if(this.pv.length){for(s=(o=new Array(h.length)).length,a=0;a<s;a+=1)o[a]=(d[a]-h[a])*f+p[a];return o}return(d-h)*f+p}if("continue"===e){var m=this.getValueAtTime(c/this.comp.globalData.frameRate,0),g=this.getValueAtTime((c-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=(o=new Array(m.length)).length,a=0;a<s;a+=1)o[a]=m[a]+(m[a]-g[a])*((l-c)/this.comp.globalData.frameRate)/5e-4;return o}return m+(l-c)/.001*(m-g)}}return this.getValueAtTime(((l-n)%i+n)/this.comp.globalData.frameRate,0)}function o(e,t,r){if(!this.k)return this.pv;e=e?e.toLowerCase():"";var i,n,a,s,o,l=this.comp.renderedFrame,u=this.keyframes,c=u[0].t;if(c<=l)return this.pv;if(r?n=c+(i=t?Math.abs(this.elem.comp.globalData.frameRate*t):Math.max(0,this.elem.data.op-c)):i=(n=u[t=!t||t>u.length-1?u.length-1:t].t)-c,"pingpong"===e){if(Math.floor((c-l)/i)%2==0)return this.getValueAtTime(((c-l)%i+c)/this.comp.globalData.frameRate,0)}else{if("offset"===e){var h=this.getValueAtTime(c/this.comp.globalData.frameRate,0),d=this.getValueAtTime(n/this.comp.globalData.frameRate,0),p=this.getValueAtTime((i-(c-l)%i+c)/this.comp.globalData.frameRate,0),f=Math.floor((c-l)/i)+1;if(this.pv.length){for(s=(o=new Array(h.length)).length,a=0;a<s;a+=1)o[a]=p[a]-(d[a]-h[a])*f;return o}return p-(d-h)*f}if("continue"===e){var m=this.getValueAtTime(c/this.comp.globalData.frameRate,0),g=this.getValueAtTime((c+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=(o=new Array(m.length)).length,a=0;a<s;a+=1)o[a]=m[a]+(m[a]-g[a])*(c-l)/.001;return o}return m+(m-g)*(c-l)/.001}}return this.getValueAtTime((i-((c-l)%i+c))/this.comp.globalData.frameRate,0)}function l(e,t){if(!this.k)return this.pv;if(e=.5*(e||.4),(t=Math.floor(t||5))<=1)return this.pv;for(var r,i=this.comp.renderedFrame/this.comp.globalData.frameRate,n=i-e,a=1<t?(i+e-n)/(t-1):1,s=0,o=0,l=this.pv.length?createTypedArray("float32",this.pv.length):0;s<t;){if(r=this.getValueAtTime(n+s*a),this.pv.length)for(o=0;o<this.pv.length;o+=1)l[o]+=r[o];else l+=r;s+=1}if(this.pv.length)for(o=0;o<this.pv.length;o+=1)l[o]/=t;else l/=t;return l}var i=TransformPropertyFactory.getTransformProperty,u=(TransformPropertyFactory.getTransformProperty=function(e,t,r){e=i(e,t,r);return e.dynamicProperties.length?e.getValueAtTime=function(e){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var t,r,i,n,a=this._transformCachingAtTime.v;return a.cloneFromProps(this.pre.props),this.appliedTransformations<1&&(r=this.a.getValueAtTime(e),a.translate(-r[0]*this.a.mult,-r[1]*this.a.mult,r[2]*this.a.mult)),this.appliedTransformations<2&&(r=this.s.getValueAtTime(e),a.scale(r[0]*this.s.mult,r[1]*this.s.mult,r[2]*this.s.mult)),this.sk&&this.appliedTransformations<3&&(r=this.sk.getValueAtTime(e),t=this.sa.getValueAtTime(e),a.skewFromAxis(-r*this.sk.mult,t*this.sa.mult)),this.r&&this.appliedTransformations<4?(r=this.r.getValueAtTime(e),a.rotate(-r*this.r.mult)):!this.r&&this.appliedTransformations<4&&(t=this.rz.getValueAtTime(e),r=this.ry.getValueAtTime(e),i=this.rx.getValueAtTime(e),n=this.or.getValueAtTime(e),a.rotateZ(-t*this.rz.mult).rotateY(r*this.ry.mult).rotateX(i*this.rx.mult).rotateZ(-n[2]*this.or.mult).rotateY(n[1]*this.or.mult).rotateX(n[0]*this.or.mult)),this.data.p&&this.data.p.s?(t=this.px.getValueAtTime(e),r=this.py.getValueAtTime(e),this.data.p.z?(i=this.pz.getValueAtTime(e),a.translate(t*this.px.mult,r*this.py.mult,-i*this.pz.mult)):a.translate(t*this.px.mult,r*this.py.mult,0)):(n=this.p.getValueAtTime(e),a.translate(n[0]*this.p.mult,n[1]*this.p.mult,-n[2]*this.p.mult)),a}.bind(e):e.getValueAtTime=function(){return this.v.clone(new Matrix)}.bind(e),e.setGroupProperty=expressionHelpers.setGroupProperty,e},PropertyFactory.getProp);PropertyFactory.getProp=function(e,t,r,i,n){var i=u(e,t,r,i,n),a=(i.kf?i.getValueAtTime=expressionHelpers.getValueAtTime.bind(i):i.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(i),i.setGroupProperty=expressionHelpers.setGroupProperty,i.loopOut=s,i.loopIn=o,i.smooth=l,i.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(i),i.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(i),i.numKeys=1===t.a?t.k.length:0,i.propertyIndex=t.ix,0);return 0!==r&&(a=createTypedArray("float32",(1===t.a?t.k[0].s:t.k).length)),i._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:a},expressionHelpers.searchExpressions(e,t,i),i.k&&n.addDynamicProperty(i),i};var e=ShapePropertyFactory.getConstructorFunction(),t=ShapePropertyFactory.getKeyframedConstructorFunction();function r(){}r.prototype={vertices:function(e,t){this.k&&this.getValue();for(var r=this.v,i=(r=void 0!==t?this.getValueAtTime(t,0):r)._length,n=r[e],a=r.v,s=createSizedArray(i),o=0;o<i;o+=1)s[o]="i"===e||"o"===e?[n[o][0]-a[o][0],n[o][1]-a[o][1]]:[n[o][0],n[o][1]];return s},points:function(e){return this.vertices("v",e)},inTangents:function(e){return this.vertices("i",e)},outTangents:function(e){return this.vertices("o",e)},isClosed:function(){return this.v.c},pointOnPath:function(e,t){for(var r=this.v,t=(void 0!==t&&(r=this.getValueAtTime(t,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(r)),this._segmentsLength),i=t.lengths,n=t.totalLength*e,a=0,s=i.length,o=0;a<s;){if(o+i[a].addedLength>n){var l=a,u=r.c&&a===s-1?0:a+1,c=(n-o)/i[a].addedLength,h=bez.getPointInSegment(r.v[l],r.v[u],r.o[l],r.i[u],c,i[a]);break}o+=i[a].addedLength,a+=1}return h=h||(r.c?[r.v[0][0],r.v[0][1]]:[r.v[r._length-1][0],r.v[r._length-1][1]])},vectorOnPath:function(e,t,r){1==e?e=this.v.c:0==e&&(e=.999);var i=this.pointOnPath(e,t),e=this.pointOnPath(e+.001,t),t=e[0]-i[0],e=e[1]-i[1],i=Math.sqrt(Math.pow(t,2)+Math.pow(e,2));return 0===i?[0,0]:"tangent"===r?[t/i,e/i]:[-e/i,t/i]},tangentOnPath:function(e,t){return this.vectorOnPath(e,t,"tangent")},normalOnPath:function(e,t){return this.vectorOnPath(e,t,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([r],e),extendPrototype([r],t),t.prototype.getValueAtTime=function(e){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),(e=(e*=this.elem.globalData.frameRate)-this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<e?this._caching.lastIndex:0,this._cachingAtTime.lastTime=e,this.interpolateShape(e,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},t.prototype.initiateExpression=ExpressionManager.initiateExpression;var a=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(e,t,r,i,n){i=a(e,t,r,i,n);return i.propertyIndex=t.ix,i.lock=!1,3===r?expressionHelpers.searchExpressions(e,t.pt,i):4===r&&expressionHelpers.searchExpressions(e,t.ks,i),i.k&&e.addDynamicProperty(i),i}}function initialize$1(){addPropertyDecorator()}function addDecorator(){TextProperty.prototype.getExpressionValue=function(e,t){var r,t=this.calculateExpression(t);return e.t!==t?(this.copyData(r={},e),r.t=t.toString(),r.__complete=!1,r):e},TextProperty.prototype.searchProperty=function(){var e=this.searchKeyframes(),t=this.searchExpressions();return this.kf=e||t,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function(e,t){var r,i,n=createNS("feMerge");for(n.setAttribute("result",e),i=0;i<t.length;i+=1)(r=createNS("feMergeNode")).setAttribute("in",t[i]),n.appendChild(r),n.appendChild(r);return n}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(e,t,r,i,n){this.filterManager=t;t=createNS("feColorMatrix"),t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","linearRGB"),t.setAttribute("values",linearFilterValue+" 1 0"),(this.linearFilter=t).setAttribute("result",i+"_tint_1"),e.appendChild(t),(t=createNS("feColorMatrix")).setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),t.setAttribute("result",i+"_tint_2"),e.appendChild(t),this.matrixFilter=t,t=this.createMergeNode(i,[n,i+"_tint_1",i+"_tint_2"]);e.appendChild(t)}function SVGFillFilter(e,t,r,i){this.filterManager=t;t=createNS("feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),t.setAttribute("result",i),e.appendChild(t),this.matrixFilter=t}function SVGStrokeEffect(e,t,r){this.initialized=!1,this.filterManager=t,this.elem=r,this.paths=[]}function SVGTritoneFilter(e,t,r,i){this.filterManager=t;t=createNS("feColorMatrix"),t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","linearRGB"),t.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),e.appendChild(t),t=createNS("feComponentTransfer"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("result",i),this.matrixFilter=t,i=createNS("feFuncR"),i.setAttribute("type","table"),t.appendChild(i),this.feFuncR=i,i=createNS("feFuncG"),i.setAttribute("type","table"),t.appendChild(i),this.feFuncG=i,i=createNS("feFuncB");i.setAttribute("type","table"),t.appendChild(i),this.feFuncB=i,e.appendChild(t)}function SVGProLevelsFilter(e,t,r,i){this.filterManager=t;var t=this.filterManager.effectElements,n=createNS("feComponentTransfer");(t[10].p.k||0!==t[10].p.v||t[11].p.k||1!==t[11].p.v||t[12].p.k||1!==t[12].p.v||t[13].p.k||0!==t[13].p.v||t[14].p.k||1!==t[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",n)),(t[17].p.k||0!==t[17].p.v||t[18].p.k||1!==t[18].p.v||t[19].p.k||1!==t[19].p.v||t[20].p.k||0!==t[20].p.v||t[21].p.k||1!==t[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",n)),(t[24].p.k||0!==t[24].p.v||t[25].p.k||1!==t[25].p.v||t[26].p.k||1!==t[26].p.v||t[27].p.k||0!==t[27].p.v||t[28].p.k||1!==t[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",n)),(t[31].p.k||0!==t[31].p.v||t[32].p.k||1!==t[32].p.v||t[33].p.k||1!==t[33].p.v||t[34].p.k||0!==t[34].p.v||t[35].p.k||1!==t[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",n)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n)),(t[3].p.k||0!==t[3].p.v||t[4].p.k||1!==t[4].p.v||t[5].p.k||1!==t[5].p.v||t[6].p.k||0!==t[6].p.v||t[7].p.k||1!==t[7].p.v)&&((n=createNS("feComponentTransfer")).setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("result",i),e.appendChild(n),this.feFuncRComposed=this.createFeFunc("feFuncR",n),this.feFuncGComposed=this.createFeFunc("feFuncG",n),this.feFuncBComposed=this.createFeFunc("feFuncB",n))}function SVGDropShadowEffect(e,t,r,i,n){var a=t.container.globalData.renderConfig.filterSize,s=t.data.fs||a,s=(e.setAttribute("x",s.x||a.x),e.setAttribute("y",s.y||a.y),e.setAttribute("width",s.width||a.width),e.setAttribute("height",s.height||a.height),this.filterManager=t,createNS("feGaussianBlur")),a=(s.setAttribute("in","SourceAlpha"),s.setAttribute("result",i+"_drop_shadow_1"),s.setAttribute("stdDeviation","0"),this.feGaussianBlur=s,e.appendChild(s),createNS("feOffset")),t=(a.setAttribute("dx","25"),a.setAttribute("dy","0"),a.setAttribute("in",i+"_drop_shadow_1"),a.setAttribute("result",i+"_drop_shadow_2"),this.feOffset=a,e.appendChild(a),createNS("feFlood")),s=(t.setAttribute("flood-color","#00ff00"),t.setAttribute("flood-opacity","1"),t.setAttribute("result",i+"_drop_shadow_3"),this.feFlood=t,e.appendChild(t),createNS("feComposite")),a=(s.setAttribute("in",i+"_drop_shadow_3"),s.setAttribute("in2",i+"_drop_shadow_2"),s.setAttribute("operator","in"),s.setAttribute("result",i+"_drop_shadow_4"),e.appendChild(s),this.createMergeNode(i,[i+"_drop_shadow_4",n]));e.appendChild(a)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(e){var t,r;(e||this.filterManager._mdf)&&(e=this.filterManager.effectElements[0].p.v,t=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v/100,this.linearFilter.setAttribute("values",linearFilterValue+" "+r+" 0"),this.matrixFilter.setAttribute("values",t[0]-e[0]+" 0 0 0 "+e[0]+" "+(t[1]-e[1])+" 0 0 0 "+e[1]+" "+(t[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 1 0"))},SVGFillFilter.prototype.renderFrame=function(e){var t;(e||this.filterManager._mdf)&&(e=this.filterManager.effectElements[2].p.v,t=this.filterManager.effectElements[6].p.v,this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+t+" 0"))},SVGStrokeEffect.prototype.initialize=function(){var e,t,r,i,n=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(i=this.elem.maskManager.masksProperties.length,r=0):i=(r=this.filterManager.effectElements[0].p.v-1)+1,(t=createNS("g")).setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-dashoffset",1);r<i;r+=1)e=createNS("path"),t.appendChild(e),this.paths.push({p:e,m:r});if(3===this.filterManager.effectElements[10].p.v){var a=createNS("mask"),s=createElementID(),o=(a.setAttribute("id",s),a.setAttribute("mask-type","alpha"),a.appendChild(t),this.elem.globalData.defs.appendChild(a),createNS("g"));for(o.setAttribute("mask","url("+getLocationHref()+"#"+s+")");n[0];)o.appendChild(n[0]);this.elem.layerElement.appendChild(o),this.masker=a,t.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(n=this.elem.layerElement.children||this.elem.layerElement.childNodes;n.length;)this.elem.layerElement.removeChild(n[0]);this.elem.layerElement.appendChild(t),this.elem.layerElement.removeAttribute("mask"),t.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=t},SVGStrokeEffect.prototype.renderFrame=function(e){this.initialized||this.initialize();for(var t,r,i=this.paths.length,n=0;n<i;n+=1)if(-1!==this.paths[n].m&&(a=this.elem.maskManager.viewData[this.paths[n].m],t=this.paths[n].p,(e||this.filterManager._mdf||a.prop._mdf)&&t.setAttribute("d",a.lastPath),e||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||a.prop._mdf)){if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){for(var a=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),s=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),o=t.getTotalLength(),l="0 0 0 "+o*a+" ",u=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,c=Math.floor(o*(s-a)/u),h=0;h<c;h+=1)l+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";l+="0 "+10*o+" 0 0"}else l="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;t.setAttribute("stroke-dasharray",l)}(e||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(e||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),1!==this.filterManager.effectElements[10].p.v&&2!==this.filterManager.effectElements[10].p.v||(e||this.filterManager.effectElements[3].p._mdf)&&(r=this.filterManager.effectElements[3].p.v,this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*r[0])+","+bmFloor(255*r[1])+","+bmFloor(255*r[2])+")"))},SVGTritoneFilter.prototype.renderFrame=function(e){var t,r,i,n;(e||this.filterManager._mdf)&&(e=this.filterManager.effectElements[0].p.v,t=this.filterManager.effectElements[1].p.v,r=(n=this.filterManager.effectElements[2].p.v)[0]+" "+t[0]+" "+e[0],i=n[1]+" "+t[1]+" "+e[1],n=n[2]+" "+t[2]+" "+e[2],this.feFuncR.setAttribute("tableValues",r),this.feFuncG.setAttribute("tableValues",i),this.feFuncB.setAttribute("tableValues",n))},SVGProLevelsFilter.prototype.createFeFunc=function(e,t){e=createNS(e);return e.setAttribute("type","table"),t.appendChild(e),e},SVGProLevelsFilter.prototype.getTableValue=function(e,t,r,i,n){for(var a,s=0,o=Math.min(e,t),l=Math.max(e,t),u=Array.call(null,{length:256}),c=0,h=n-i,d=t-e;s<=256;)a=(a=s/256)<=o?d<0?n:i:l<=a?d<0?i:n:i+h*Math.pow((a-e)/d,1/r),u[c]=a,c+=1,s+=256/255;return u.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(e){var t,r;(e||this.filterManager._mdf)&&(r=this.filterManager.effectElements,this.feFuncRComposed&&(e||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(t=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",t),this.feFuncGComposed.setAttribute("tableValues",t),this.feFuncBComposed.setAttribute("tableValues",t)),this.feFuncR&&(e||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(t=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",t)),this.feFuncG&&(e||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(t=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",t)),this.feFuncB&&(e||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(t=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",t)),this.feFuncA)&&(e||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(t=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",t))},extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(e){var t,r;(e||this.filterManager._mdf)&&((e||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),(e||this.filterManager.effectElements[0].p._mdf)&&(r=this.filterManager.effectElements[0].p.v,this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*r[0]),Math.round(255*r[1]),Math.round(255*r[2])))),(e||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),e||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf)&&(r=this.filterManager.effectElements[3].p.v,e=(this.filterManager.effectElements[2].p.v-90)*degToRads,t=r*Math.cos(e),r=r*Math.sin(e),this.feOffset.setAttribute("dx",t),this.feOffset.setAttribute("dy",r))};var _svgMatteSymbols=[];function SVGMatte3Effect(e,t,r){this.initialized=!1,this.filterManager=t,this.filterElem=e,(this.elem=r).matteElement=createNS("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}function SVGGaussianBlurEffect(e,t,r,i){e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width","300%"),e.setAttribute("height","300%"),this.filterManager=t;t=createNS("feGaussianBlur");t.setAttribute("result",i),e.appendChild(t),this.feGaussianBlur=t}function TransformEffect(){}function SVGTransformEffect(e,t){this.init(t)}function CVTransformEffect(e){this.init(e)}return SVGMatte3Effect.prototype.findSymbol=function(e){for(var t=0,r=_svgMatteSymbols.length;t<r;){if(_svgMatteSymbols[t]===e)return _svgMatteSymbols[t];t+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(e,t){var r=e.layerElement.parentNode;if(r){for(var i,n=r.children,a=0,s=n.length;a<s&&n[a]!==e.layerElement;)a+=1;a<=s-2&&(i=n[a+1]);var o=createNS("use");o.setAttribute("href","#"+t),i?r.insertBefore(o,i):r.appendChild(o)}},SVGMatte3Effect.prototype.setElementAsMask=function(e,t){var r,i,n,a;this.findSymbol(t)||(r=createElementID(),(i=createNS("mask")).setAttribute("id",t.layerId),i.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(t),(a=e.globalData.defs).appendChild(i),(n=createNS("symbol")).setAttribute("id",r),this.replaceInParent(t,r),n.appendChild(t.layerElement),a.appendChild(n),(a=createNS("use")).setAttribute("href","#"+r),i.appendChild(a),t.data.hd=!1,t.show()),e.setMatte(t.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var e=this.filterManager.effectElements[0].p.v,t=this.elem.comp.elements,r=0,i=t.length;r<i;)t[r]&&t[r].data.ind===e&&this.setElementAsMask(this.elem,t[r]),r+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGGaussianBlurEffect.prototype.renderFrame=function(e){var t;(e||this.filterManager._mdf)&&(e=.3*this.filterManager.effectElements[0].p.v,t=this.filterManager.effectElements[1].p.v,this.feGaussianBlur.setAttribute("stdDeviation",(3==t?0:e)+" "+(2==t?0:e)),t=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate",this.feGaussianBlur.setAttribute("edgeMode",t))},TransformEffect.prototype.init=function(e){this.effectsManager=e,this.type=effectTypes.TRANSFORM_EFFECT,this.matrix=new Matrix,this.opacity=-1,this._mdf=!1,this._opMdf=!1},TransformEffect.prototype.renderFrame=function(e){var t,r,i,n,a,s,o;this._opMdf=!1,this._mdf=!1,(e||this.effectsManager._mdf)&&(t=(e=this.effectsManager.effectElements)[0].p.v,r=e[1].p.v,n=1===e[2].p.v,i=e[3].p.v,n=n?i:e[4].p.v,a=e[5].p.v,s=e[6].p.v,o=e[7].p.v,this.matrix.reset(),this.matrix.translate(-t[0],-t[1],t[2]),this.matrix.scale(.01*n,.01*i,1),this.matrix.rotate(-o*degToRads),this.matrix.skewFromAxis(-a*degToRads,(s+90)*degToRads),this.matrix.translate(r[0],r[1],0),this._mdf=!0,this.opacity!==e[8].p.v)&&(this.opacity=e[8].p.v,this._opMdf=!0)},extendPrototype([TransformEffect],SVGTransformEffect),extendPrototype([TransformEffect],CVTransformEffect),registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect$1(20,SVGTintFilter,!0),registerEffect$1(21,SVGFillFilter,!0),registerEffect$1(22,SVGStrokeEffect,!1),registerEffect$1(23,SVGTritoneFilter,!0),registerEffect$1(24,SVGProLevelsFilter,!0),registerEffect$1(25,SVGDropShadowEffect,!0),registerEffect$1(28,SVGMatte3Effect,!1),registerEffect$1(29,SVGGaussianBlurEffect,!0),registerEffect$1(35,SVGTransformEffect,!1),registerEffect(35,CVTransformEffect),lottie})}(lottie$1,lottie$1.exports),lottie$1.exports);let lottie=getDefaultExportFromCjs(lottieExports);for(var ch2={},wk=function(e,t,r,i,n){t=new Worker(ch2[t]||(ch2[t]=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))));return t.onerror=function(e){return n(e.error,null)},t.onmessage=function(e){return n(null,e.data)},t.postMessage(r,i),t},u8$1=Uint8Array,u16$1=Uint16Array,u32$1=Uint32Array,fleb=new u8$1([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8$1([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8$1([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,t){for(var r=new u16$1(31),i=0;i<31;++i)r[i]=t+=1<<e[i-1];for(var n=new u32$1(r[30]),i=1;i<30;++i)for(var a=r[i];a<r[i+1];++a)n[a]=a-r[i]<<5|i;return[r,n]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1],_b=(fl[28]=258,revfl[258]=28,freb(fdeb,0)),fd=_b[0],rev=new u16$1(32768),i$1=0;i$1<32768;++i$1){var x=(43690&i$1)>>>1|(21845&i$1)<<1,x=(52428&x)>>>2|(13107&x)<<2;x=(61680&x)>>>4|(3855&x)<<4,rev[i$1]=((65280&x)>>>8|(255&x)<<8)>>>1}for(var hMap=function(e,t,r){for(var i=e.length,n=0,a=new u16$1(t);n<i;++n)++a[e[n]-1];var s=new u16$1(t);for(n=0;n<t;++n)s[n]=s[n-1]+a[n-1]<<1;if(r){for(var o=new u16$1(1<<t),l=15-t,n=0;n<i;++n)if(e[n])for(var u=n<<4|e[n],c=t-e[n],h=s[e[n]-1]++<<c,d=h|(1<<c)-1;h<=d;++h)o[rev[h]>>>l]=u}else for(o=new u16$1(i),n=0;n<i;++n)e[n]&&(o[n]=rev[s[e[n]-1]++]>>>15-e[n]);return o},flt=new u8$1(288),i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;for(var fdt=new u8$1(32),i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(e){for(var t=e[0],r=1;r<e.length;++r)t<e[r]&&(t=e[r]);return t},bits=function(e,t,r){var i=t/8|0;return(e[i]|e[1+i]<<8)>>(7&t)&r},bits16=function(e,t){var r=t/8|0;return(e[r]|e[1+r]<<8|e[2+r]<<16)>>(7&t)},shft=function(e){return(e/8|0)+(7&e&&1)},slc=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var i=new(e instanceof u16$1?u16$1:e instanceof u32$1?u32$1:u8$1)(r-t);return i.set(e.subarray(t,r)),i},inflt=function(e,r,t){var i=e.length;if(!i||t&&!t.l&&i<5)return r||new u8$1(0);function n(e){var t=r.length;t<e&&((t=new u8$1(Math.max(2*t,e))).set(r),r=t)}var a=!r||t,s=!t||t.i,o=(t=t||{},r=r||new u8$1(3*i),t.f||0),l=t.p||0,u=t.b||0,c=t.l,h=t.d,d=t.m,p=t.n,f=8*i;do{if(!c){t.f=o=bits(e,l,1);var m=bits(e,l+1,3);if(l+=3,!m){var g=e[(E=shft(l)+4)-4]|e[E-3]<<8,v=E+g;if(i<v){if(s)throw"unexpected EOF";break}a&&n(u+g),r.set(e.subarray(E,v),u),t.b=u+=g,t.p=l=8*v;continue}if(1==m)c=flrm,h=fdrm,d=9,p=5;else{if(2!=m)throw"invalid block type";for(var g=bits(e,l,31)+257,y=bits(e,l+10,15)+4,_=g+bits(e,l+5,31)+1,b=(l+=14,new u8$1(_)),x=new u8$1(19),S=0;S<y;++S)x[clim[S]]=bits(e,l+3*S,7);l+=3*y;for(var v=max(x),T=(1<<v)-1,$=hMap(x,v,1),S=0;S<_;){var E,C=$[bits(e,l,T)];if(l+=15&C,(E=C>>>4)<16)b[S++]=E;else{var A=0,w=0;for(16==E?(w=3+bits(e,l,3),l+=2,A=b[S-1]):17==E?(w=3+bits(e,l,7),l+=3):18==E&&(w=11+bits(e,l,127),l+=7);w--;)b[S++]=A}}var P=b.subarray(0,g),M=b.subarray(g),d=max(P),p=max(M),c=hMap(P,d,1),h=hMap(M,p,1)}if(f<l){if(s)throw"unexpected EOF";break}}a&&n(u+131072);for(var B=(1<<d)-1,L=(1<<p)-1,I=l;;I=l){var D=(A=c[bits16(e,l)&B])>>>4;if(f<(l+=15&A)){if(s)throw"unexpected EOF";break}if(!A)throw"invalid length/literal";if(D<256)r[u++]=D;else{if(256==D){I=l,c=null;break}var R=D-254,D=(264<D&&(O=fleb[S=D-257],R=bits(e,l,(1<<O)-1)+fl[S],l+=O),h[bits16(e,l)&L]),k=D>>>4;if(!D)throw"invalid distance";l+=15&D;var O,M=fd[k];if(3<k&&(O=fdeb[k],M+=bits16(e,l)&(1<<O)-1,l+=O),f<l){if(s)throw"unexpected EOF";break}a&&n(u+131072);for(var F=u+R;u<F;u+=4)r[u]=r[u-M],r[u+1]=r[u+1-M],r[u+2]=r[u+2-M],r[u+3]=r[u+3-M];u=F}}t.l=c,t.p=I,t.b=u,c&&(o=1,t.m=d,t.d=h,t.n=p)}while(!o);return u==r.length?r:slc(r,0,u)},et=new u8$1(0),mrg=function(e,t){var r,i={};for(r in e)i[r]=e[r];for(r in t)i[r]=t[r];return i},wcln=function(e,t,r){for(var i=e(),e=e.toString(),n=e.slice(e.indexOf("[")+1,e.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<i.length;++a){var s=i[a],o=n[a];if("function"==typeof s){t+=";"+o+"=";var l=s.toString();if(s.prototype)if(-1!=l.indexOf("[native code]")){var u=l.indexOf(" ",8)+1;t+=l.slice(u,l.indexOf("(",u))}else for(var c in t+=l,s.prototype)t+=";"+o+".prototype."+c+"="+s.prototype[c].toString();else t+=l}else r[o]=s}return[t,r]},ch=[],cbfs=function(e){var t,r=[];for(t in e)(e[t]instanceof u8$1||e[t]instanceof u16$1||e[t]instanceof u32$1)&&r.push((e[t]=new e[t].constructor(e[t])).buffer);return r},wrkr=function(e,t,r,i){var n;if(!ch[r]){for(var a="",s={},o=e.length-1,l=0;l<o;++l)a=(n=wcln(e[l],a,s))[0],s=n[1];ch[r]=wcln(e[o],a,s)}var u=mrg({},ch[r][1]);return wk(ch[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,u,cbfs(u),i)},bInflt=function(){return[u8$1,u16$1,u32$1,fleb,fdeb,clim,fl,fd,flrm,fdrm,rev,hMap,max,bits,bits16,shft,slc,inflt,inflateSync,pbf,gu8]},pbf=function(e){return postMessage(e,[e.buffer])},gu8=function(e){return e&&e.size&&new u8$1(e.size)},cbify=function(e,t,r,i,n,a){var s=wrkr(r,i,n,function(e,t){s.terminate(),a(e,t)});return s.postMessage([e,t],t.consume?[e.buffer]:[]),function(){s.terminate()}},b2=function(e,t){return e[t]|e[t+1]<<8},b4=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},b8=function(e,t){return b4(e,t)+4294967296*b4(e,t+4)};function inflate(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return cbify(e,t,[bInflt],function(e){return pbf(inflateSync(e.data[0],gu8(e.data[1])))},1,r)}function inflateSync(e,t){return inflt(e,t)}var td="undefined"!=typeof TextDecoder&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch(e5){}var dutf8=function(e){for(var t="",r=0;;){var i=e[r++],n=(127<i)+(223<i)+(239<i);if(e.length<r+n)return[t,slc(e,r-1)];n?3==n?(i=((15&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|i>>10,56320|1023&i)):t+=1&n?String.fromCharCode((31&i)<<6|63&e[r++]):String.fromCharCode((15&i)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(i)}};function strFromU8(e,t){if(t){for(var r="",i=0;i<e.length;i+=16384)r+=String.fromCharCode.apply(null,e.subarray(i,i+16384));return r}if(td)return td.decode(e);var t=dutf8(e),n=t[0];if(t[1].length)throw"invalid utf-8 data";return n}var slzh=function(e,t){return t+30+b2(e,t+26)+b2(e,t+28)},zh=function(e,t,r){var i=b2(e,t+28),n=strFromU8(e.subarray(t+46,t+46+i),!(2048&b2(e,t+8))),i=t+46+i,a=b4(e,t+20),r=r&&4294967295==a?z64e(e,i):[a,b4(e,t+24),b4(e,t+42)],a=r[0],s=r[1],r=r[2];return[b2(e,t+10),a,s,n,i+b2(e,t+30)+b2(e,t+32),r]},z64e=function(e,t){for(;1!=b2(e,t);t+=4+b2(e,t+2));return[b8(e,t+12),b8(e,t+4),b8(e,t+20)]};function unzip(l,u){if("function"!=typeof u)throw"no callback";for(var c=[],h=function(){for(var e=0;e<c.length;++e)c[e]()},d={},e=l.length-22;101010256!=b4(l,e);--e)if(!e||65558<l.length-e)return void u("invalid zip file",null);var p=b2(l,e+8),t=(p||u(null,{}),p),f=b4(l,e+16),m=4294967295==f;if(m){if(e=b4(l,e-12),101075792!=b4(l,e))return void u("invalid zip file",null);t=p=b4(l,e+32),f=b4(l,e+48)}for(var r=function(e){function t(e,t){e?(h(),u(e,null)):(d[s]=t,--p||u(null,d))}var r=zh(l,f,m),i=r[0],n=r[1],a=r[2],s=r[3],o=r[4],r=slzh(l,r[5]);f=o;if(i)if(8==i){o=l.subarray(r,r+n);if(n<32e4)try{t(null,inflateSync(o,new u8$1(a)))}catch(e){t(e,null)}else c.push(inflate(o,{size:a},t))}else t("unknown compression type "+i,null);else t(null,slc(l,r,r+n))},i=0;i<t;++i)r();return h}for(var buffer={},base64Js={},lookup=(base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray,[]),revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}function byteLength(e){var e=getLens(e),t=e[0],e=e[1];return 3*(t+e)/4-e}function _byteLength(e,t,r){return 3*(t+r)/4-r}function toByteArray(e){for(var t,r=getLens(e),i=r[0],r=r[1],n=new Arr(_byteLength(e,i,r)),a=0,s=0<r?i-4:i,o=0;o<s;o+=4)t=revLookup[e.charCodeAt(o)]<<18|revLookup[e.charCodeAt(o+1)]<<12|revLookup[e.charCodeAt(o+2)]<<6|revLookup[e.charCodeAt(o+3)],n[a++]=t>>16&255,n[a++]=t>>8&255,n[a++]=255&t;return 2===r&&(t=revLookup[e.charCodeAt(o)]<<2|revLookup[e.charCodeAt(o+1)]>>4,n[a++]=255&t),1===r&&(t=revLookup[e.charCodeAt(o)]<<10|revLookup[e.charCodeAt(o+1)]<<4|revLookup[e.charCodeAt(o+2)]>>2,n[a++]=t>>8&255,n[a++]=255&t),n}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,r){for(var i,n=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),n.push(tripletToBase64(i));return n.join("")}function fromByteArray(e){for(var t,r=e.length,i=r%3,n=[],a=0,s=r-i;a<s;a+=16383)n.push(encodeChunk(e,a,s<a+16383?s:a+16383));return 1==i?(t=e[r-1],n.push(lookup[t>>2]+lookup[t<<4&63]+"==")):2==i&&(t=(e[r-2]<<8)+e[r-1],n.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),n.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var ieee754={read:function(e,t,r,i,n){var a,s,o=8*n-i-1,l=(1<<o)-1,u=l>>1,c=-7,h=r?n-1:0,d=r?-1:1,n=e[t+h];for(h+=d,a=n&(1<<-c)-1,n>>=-c,c+=o;0<c;a=256*a+e[t+h],h+=d,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=i;0<c;s=256*s+e[t+h],h+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(n?-1:1);s+=Math.pow(2,i),a-=u}return(n?-1:1)*s*Math.pow(2,a-i)},write:function(e,t,r,i,n,a){var s,o,l=8*a-n-1,u=(1<<l)-1,c=u>>1,h=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:a-1,p=i?1:-1,a=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(i=Math.pow(2,-s))<1&&(s--,i*=2),2<=(t+=1<=s+c?h/i:h*Math.pow(2,1-c))*i&&(s++,i/=2),u<=s+c?(o=0,s=u):1<=s+c?(o=(t*i-1)*Math.pow(2,n),s+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,n),s=0));8<=n;e[r+d]=255&o,d+=p,o/=256,n-=8);for(s=s<<n|o,l+=n;0<l;e[r+d]=255&s,d+=p,s/=256,l-=8);e[r+d-p]|=128*a}};(r=>{var E=base64Js,a=ieee754,e="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,t=(r.Buffer=h,r.SlowBuffer=function(e){+e!=e&&(e=0);return h.alloc(+e)},r.INSPECT_MAX_BYTES=50,2147483647);function o(e){if(t<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,h.prototype),e}function h(e,t,r){if("number"!=typeof e)return i(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return s(e)}function i(e,t,r){if("string"==typeof e){var i=e,n=t;if(h.isEncoding(n="string"==typeof n&&""!==n?n:"utf8"))return a=0|d(i,n),s=o(a),s=(i=s.write(i,n))!==a?s.slice(0,i):s;throw new TypeError("Unknown encoding: "+n)}var a;if(ArrayBuffer.isView(e))return D(a=e,Uint8Array)?u((i=new Uint8Array(a)).buffer,i.byteOffset,i.byteLength):l(a);if(null!=e){if(D(e,ArrayBuffer)||e&&D(e.buffer,ArrayBuffer))return u(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(D(e,SharedArrayBuffer)||e&&D(e.buffer,SharedArrayBuffer)))return u(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var s=e.valueOf&&e.valueOf();if(null!=s&&s!==e)return h.from(s,t,r);n=(e=>{var t,r;return h.isBuffer(e)?(t=0|c(e.length),0!==(r=o(t)).length&&e.copy(r,0,0,t),r):void 0!==e.length?"number"!=typeof e.length||R(e.length)?o(0):l(e):"Buffer"===e.type&&Array.isArray(e.data)?l(e.data):void 0})(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,r)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function n(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function s(e){return n(e),o(e<0?0:0|c(e))}function l(e){for(var t=e.length<0?0:0|c(e.length),r=o(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function u(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');e=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r);return Object.setPrototypeOf(e,h.prototype),e}function c(e){if(t<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function d(e,t){if(h.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||D(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=2<arguments.length&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return P(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(e).length;default:if(n)return i?-1:P(e).length;t=(""+t).toLowerCase(),n=!0}}function p(e,t,r){var i,n=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var a=this,s=t,o=r,l=a.length;(!o||o<0||l<o)&&(o=l);for(var u="",c=s=!s||s<0?0:s;c<o;++c)u+=k[a[c]];return u;case"utf8":case"utf-8":return C(this,t,r);case"ascii":var h=this,l=t,d=r,p="";d=Math.min(h.length,d);for(var f=l;f<d;++f)p+=String.fromCharCode(127&h[f]);return p;case"latin1":case"binary":var m=this,s=t,g=r,v="";g=Math.min(m.length,g);for(var y=s;y<g;++y)v+=String.fromCharCode(m[y]);return v;case"base64":return _=this,i=r,0===(b=t)&&i===_.length?E.fromByteArray(_):E.fromByteArray(_.slice(b,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var _=t,b=r,x=this.slice(_,b),S="",T=0;T<x.length-1;T+=2)S+=String.fromCharCode(x[T]+256*x[T+1]);return S;default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function f(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function m(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=R(r=+r)?n?0:e.length-1:r)<0&&(r=e.length+r),e.length<=r){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=h.from(t,i)),h.isBuffer(t))return 0===t.length?-1:g(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(n?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):g(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,i,n){var a=1,s=e.length,o=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s/=a=2,o/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(n)for(var u=-1,c=r;c<s;c++)if(l(e,c)===l(t,-1===u?0:c-u)){if(c-(u=-1===u?c:u)+1===o)return u*a}else-1!==u&&(c-=c-u),u=-1;else for(c=r=s<r+o?s-o:r;0<=c;c--){for(var h=!0,d=0;d<o;d++)if(l(e,c+d)!==l(t,d)){h=!1;break}if(h)return c}return-1}function v(e,t,r,i){return I((e=>{for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t})(t),e,r,i)}function y(e,t,r,i){return I(((e,t)=>{for(var r,i,n=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),i=r>>8,n.push(r%256),n.push(i);return n})(t,e.length-r),e,r,i)}function C(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var a,s,o,l,u=e[n],c=null,h=239<u?4:223<u?3:191<u?2:1;if(n+h<=r)switch(h){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[n+1]))&&127<(l=(31&u)<<6|63&a)&&(c=l);break;case 3:a=e[n+1],s=e[n+2],128==(192&a)&&128==(192&s)&&2047<(l=(15&u)<<12|(63&a)<<6|63&s)&&(l<55296||57343<l)&&(c=l);break;case 4:a=e[n+1],s=e[n+2],o=e[n+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&65535<(l=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&o)&&l<1114112&&(c=l)}null===c?(c=65533,h=1):65535<c&&(i.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),i.push(c),n+=h}var d=i,p=d.length;if(p<=_)return String.fromCharCode.apply(String,d);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,d.slice(m,m+=_));return f}r.kMaxLength=t,h.TYPED_ARRAY_SUPPORT=(()=>{try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}})(),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=i,Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(e,t,r){return t=t,r=r,n(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)},h.allocUnsafe=s,h.allocUnsafeSlow=s,h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(D(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),D(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;for(var r=h.allocUnsafe(t),i=0,n=0;n<e.length;++n){var a=e[n];if(D(a,Uint8Array))i+a.length>r.length?h.from(a).copy(r,i):Uint8Array.prototype.set.call(r,a,i);else{if(!h.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i)}i+=a.length}return r},h.byteLength=d,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)f(this,t,t+1);return this},h.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)f(this,t,t+3),f(this,t+1,t+2);return this},h.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)f(this,t,t+7),f(this,t+1,t+6),f(this,t+2,t+5),f(this,t+3,t+4);return this},h.prototype.toLocaleString=h.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):p.apply(this,arguments)},h.prototype.equals=function(e){if(h.isBuffer(e))return this===e||0===h.compare(this,e);throw new TypeError("Argument must be a Buffer")},h.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES,e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim();return this.length>t&&(e+=" ... "),"<Buffer "+e+">"},e&&(h.prototype[e]=h.prototype.inspect),h.prototype.compare=function(e,t,r,i,n){if(D(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),(t=void 0===t?0:t)<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(n<=i&&r<=t)return 0;if(n<=i)return-1;if(r<=t)return 1;if(this===e)return 0;for(var a=(n>>>=0)-(i>>>=0),s=(r>>>=0)-(t>>>=0),o=Math.min(a,s),l=this.slice(i,n),u=e.slice(t,r),c=0;c<o;++c)if(l[c]!==u[c]){a=l[c],s=u[c];break}return a<s?-1:s<a?1:0},h.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},h.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},h.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},h.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||n<r)&&(r=n),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i=i||"utf8";for(var a,s,o,l=!1;;)switch(i){case"hex":var u=this,c=e,h=t,d=r,p=(h=Number(h)||0,u.length-h);(!d||p<(d=Number(d)))&&(d=p),(p=c.length)/2<d&&(d=p/2);for(var f=0;f<d;++f){var m=parseInt(c.substr(2*f,2),16);if(R(m))return f;u[h+f]=m}return f;case"utf8":case"utf-8":return p=t,o=r,I(P(e,(s=this).length-p),s,p,o);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return s=this,o=t,a=r,I(M(e),s,o,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,e,t,r);default:if(l)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),l=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function b(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,r,i,n,a){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<t||t<a)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function S(e,t,r,i){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function T(e,t,r,i,n){return t=+t,r>>>=0,n||S(e,0,r,4),a.write(e,t,r,i,23,4),r+4}function A(e,t,r,i,n){return t=+t,r>>>=0,n||S(e,0,r,8),a.write(e,t,r,i,52,8),r+8}h.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return Object.setPrototypeOf(r,h.prototype),r},h.prototype.readUintLE=h.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i},h.prototype.readUintBE=h.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=this[e+--t],n=1;0<t&&(n*=256);)i+=this[e+--t]*n;return i},h.prototype.readUint8=h.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return(n*=128)<=i&&(i-=Math.pow(2,8*t)),i},h.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var i=t,n=1,a=this[e+--i];0<i&&(n*=256);)a+=this[e+--i]*n;return(n*=128)<=a&&(a-=Math.pow(2,8*t)),a},h.prototype.readInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),a.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),a.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),a.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),a.read(this,e,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||x(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,a=0;for(this[t]=255&e;++a<r&&(n*=256);)this[t+a]=e/n&255;return t+r},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||x(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,a=1;for(this[t+n]=255&e;0<=--n&&(a*=256);)this[t+n]=e/a&255;return t+r},h.prototype.writeUint8=h.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeIntLE=function(e,t,r,i){e=+e,t>>>=0,i||x(this,e,t,r,(i=Math.pow(2,8*r-1))-1,-i);var n=0,a=1,s=0;for(this[t]=255&e;++n<r&&(a*=256);)e<0&&0===s&&0!==this[t+n-1]&&(s=1),this[t+n]=(e/a>>0)-s&255;return t+r},h.prototype.writeIntBE=function(e,t,r,i){e=+e,t>>>=0,i||x(this,e,t,r,(i=Math.pow(2,8*r-1))-1,-i);var n=r-1,a=1,s=0;for(this[t+n]=255&e;0<=--n&&(a*=256);)e<0&&0===s&&0!==this[t+n+1]&&(s=1),this[t+n]=(e/a>>0)-s&255;return t+r},h.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},h.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||x(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeFloatLE=function(e,t,r){return T(this,e,t,!0,r)},h.prototype.writeFloatBE=function(e,t,r){return T(this,e,t,!1,r)},h.prototype.writeDoubleLE=function(e,t,r){return A(this,e,t,!0,r)},h.prototype.writeDoubleBE=function(e,t,r){return A(this,e,t,!1,r)},h.prototype.copy=function(e,t,r,i){if(!h.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,i||0===i||(i=this.length),t>=e.length&&(t=e.length),(i=0<i&&i<r?r:i)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length);var n=(i=e.length-t<i-r?e.length-t+r:i)-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n},h.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i);var n;1===e.length&&(n=e.charCodeAt(0),"utf8"===i&&n<128||"latin1"===i)&&(e=n)}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");var a;if(!(r<=t))if(t>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(e=e||0))for(a=t;a<r;++a)this[a]=e;else{var s=h.isBuffer(e)?e:h.from(e,i),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%o]}return this};var w=/[^+/0-9A-Za-z-_]/g;function P(e,t){t=t||1/0;for(var r,i=e.length,n=null,a=[],s=0;s<i;++s){if(55295<(r=e.charCodeAt(s))&&r<57344){if(!n){if(56319<r){-1<(t-=3)&&a.push(239,191,189);continue}if(s+1===i){-1<(t-=3)&&a.push(239,191,189);continue}n=r;continue}if(r<56320){-1<(t-=3)&&a.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&-1<(t-=3)&&a.push(239,191,189);if(n=null,r<128){if(--t<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function M(e){return E.toByteArray((e=>{if((e=(e=e.split("=")[0]).trim().replace(w,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e})(e))}function I(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function D(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function R(e){return e!=e}var k=(()=>{for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)t[i+n]=e[r]+e[n];return t})()})(buffer);let fetchLottie=async(i,n)=>{var e;n=n||(null==(e=i.split(".").pop())?void 0:e.toLowerCase());let a=200;try{var o,l,u,c=await fetch(i);if(a=c.status,"json"===n)return await c.json();let e=new Uint8Array(await c.arrayBuffer()),s=await new Promise((r,i)=>{unzip(e,(e,t)=>{e&&i(e),r(t)})}),t=strFromU8(s["manifest.json"]),r=JSON.parse(t);if(!("animations"in r))throw new Error("Manifest not found");if(r.animations.length)return o=r.animations[0].id,l=strFromU8(null==s?void 0:s[`animations/${o}.json`]),"assets"in(u=await JSON.parse(l))&&Promise.all(u.assets.map(n=>{let a=n.p;if(a&&null!=s&&s["images/"+a])return new Promise(e=>{var t,r=a.split(".").pop(),i=null==(t=buffer.Buffer.from(null==s?void 0:s["images/"+a]))?void 0:t.toString("base64");switch(r){case"svg":case"svg+xml":n.p="data:image/svg+xml;base64,"+i;break;case"png":case"jpg":case"jpeg":case"gif":case"webp":n.p=`data:image/${r};base64,`+i;break;default:n.p="data:;base64,"+i}n.e=1,e()})})),u;throw new Error("No animations listed in manifest")}catch(e){throw 404===a?new Error("File not found"):new Error("Unable to load file")}};function LottieEl(e){let{visible:t,env:r,trackIndex:i,relativeTime:n}=e,a=e.element;var s=reactExports.useRef();let o=e.store,[l,u]=reactExports.useState(!1),c=reactExports.useRef(),h=reactExports.useRef(),d=reactExports.useRef(),p=reactExports.useMemo(()=>{var e=new Container,t=o.resourceManage.getCacheBlobURLById(a.resourceId),r=(d.current=document.createElement("div"),d.current.style.position="absolute",d.current.style.top="0px",d.current.style.left="0px",d.current.style.width="1px",d.current.style.height="1px",d.current.style.overflow="hidden",document.body.appendChild(d.current),o.renderAsyncMark[a.id]="start",new Image);r.src=config.emptyBase64;let i=Texture.from(r),n=new Sprite(i.clone());h.current=n.texture;r=o.resourceManage.getCacheItemBySourceId(a.resourceId);return fetchLottie(t,null==r?void 0:r.resource.url.split(".").pop()).then(e=>{c.current=lottie.loadAnimation({container:d.current,renderer:"canvas",loop:!0,autoplay:!1,animationData:e}),null!=(e=d.current)&&e.remove();var[e,t]=[a.style.width,a.style.height];c.current.renderer.renderConfig.dpr=1,c.current.resize(e,t),n.texture=Texture.from(c.current.container),h.current=n.texture,i.on("update",()=>{u(!0)}),c.current.goToAndStop(a.initStartFrame||0),c.current.setSpeed(a.lottieSpeed),null!=(e=h.current)&&e.update(),o.renderAsyncMark[a.id]="success"}),i.on("update",()=>{u(!0)}),n.name="element",e.addChild(n),e},[a.resourceId]),[f]=(reactExports.useEffect(()=>{var e;c.current&&(c.current.destroy(),null!=(e=d.current))&&e.remove()},[]),reactExports.useEffect(()=>{var e,t;c.current&&({currentFrame:t,totalFrames:e}=c.current,t=a.initStartFrame+t,c.current.goToAndStop(t%e,!0),c.current.setSpeed(a.lottieSpeed),null!=(t=h.current))&&t.update()},[a.initStartFrame,a.lottieSpeed]),useElementFilter(p,a),reactExports.useEffect(()=>{var e;c.current&&(c.current.resize(a.style.width,a.style.height),null!=(e=h.current))&&e.update()},[a.style.width,a.style.height]),useSyncPixiElement(p,{style:{...a.style},parent:e.parent,animateRef:s,visible:t,hide:e.hide,lock:e.lock,relativeTime:e.relativeTime,store:e.store},["x","y","width","height","alpha","rotation"],a));return reactExports.useEffect(()=>{var e,t,r,i,n=o.resourceManage.getResouceById(a.resourceId);l&&a.cropSize&&n&&(n=p.children.find(e=>"element"===e.name),{x:e,y:t,width:r,height:i}=a.cropSize,n.texture.frame=new Rectangle(e,t,r,i),f({...a.style},p))},[a.cropSize,l]),reactExports.useEffect(()=>{var e,t;"export"===r&&(o.elementReadyMark[a.id]="start"),null!==n&&c.current&&({frameRate:t,totalFrames:e}=c.current,t=~~((n*t+a.initStartFrame)*a.lottieSpeed%e),c.current.goToAndStop(t,!0),null!=(e=h.current))&&e.update(),"export"===r&&(o.elementReadyMark[a.id]="success")},[n]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["editor"===r&&jsxRuntimeExports.jsx(ControlElment,{trackIndex:i,hide:e.hide,lock:e.lock,scale:e.scale,store:e.store,element:a,visible:t}),jsxRuntimeExports.jsx(Animate$1,{ref:s,store:e.store,pixiElem:p,elementData:a,currentTime:e.currentTime,relativeTime:e.relativeTime})]})}var hasElementType="undefined"!=typeof Element,hasMap="function"==typeof Map,hasSet="function"==typeof Set,hasArrayBuffer="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function equal(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,i,n,a;if(Array.isArray(e)){if((r=e.length)!=t.length)return!1;for(i=r;0!=i--;)if(!equal(e[i],t[i]))return!1}else if(hasMap&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(a=e.entries();!(i=a.next()).done;)if(!t.has(i.value[0]))return!1;for(a=e.entries();!(i=a.next()).done;)if(!equal(i.value[1],t.get(i.value[0])))return!1}else if(hasSet&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(a=e.entries();!(i=a.next()).done;)if(!t.has(i.value[0]))return!1}else if(hasArrayBuffer&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((r=e.length)!=t.length)return!1;for(i=r;0!=i--;)if(e[i]!==t[i])return!1}else{if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((r=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,n[i]))return!1;if(hasElementType&&e instanceof Element)return!1;for(i=r;0!=i--;)if(("_owner"!==n[i]&&"__v"!==n[i]&&"__o"!==n[i]||!e.$$typeof)&&!equal(e[n[i]],t[n[i]]))return!1}return!0}return e!=e&&t!=t}var reactFastCompare=function(e,t){try{return equal(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return!1;throw e}};let isEqual=getDefaultExportFromCjs(reactFastCompare);function Stage(r){let{viewSize:i,debug:n,env:e,target:a,options:s,children:t}=r,[o,l]=reactExports.useState(!1),u=reactExports.useRef(null),[,c]=reactExports.useReducer(e=>e+1,0),h=r.store;reactExports.useEffect(()=>{var e=u.current||a||document.body;let t=new Application(Object.assign({...i},{...s},{antialias:!0,powerPreference:"high-performance"}));return t._tempScale=1,n&&(globalThis.__PIXI_APP__=t),e.appendChild(t.view),(h.app=t).stage.sortableChildren=!0,l(!0),pubsub.subscribe(h.events.UPDATE_STAGE,()=>{c()}),(async()=>{if(await sleep(500),Object.keys(h.elementReadyMark).length)for(;0!==Object.keys(h.elementReadyMark).length;){for(var e in h.elementReadyMark)"success"===h.elementReadyMark[e]&&delete h.elementReadyMark[e];if(0===Object.keys(h.elementReadyMark).length)break;await sleep(100)}r.callback&&r.callback(r.store)})(),()=>{pubsub.unsubscribe(h.events.UPDATE_STAGE),t.destroy(!0,{children:!0,texture:!0,baseTexture:!0})}},[]),reactExports.useEffect(()=>{h.data&&(h.app&&!isEqual(i,{width:h.app.renderer.width,height:h.app.renderer.height})&&h.app.renderer.resize(i.width,i.height),h.movieSize.width=h.data.width,h.movieSize.height=h.data.height)},[i]);var d=()=>childrenInjectProps({parent:h.app.stage},t);return"editor"===e?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{ref:u,style:{...i,position:"relative",zIndex:0,transform:"scale(1)",transformOrigin:"0 0"},children:o?d():null})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:o?d():null})}function arrayEach$1(e,t){for(var r=-1,i=null==e?0:e.length;++r<i&&!1!==t(e[r],r,e););return e}var _arrayEach=arrayEach$1,baseAssignValue$1=_baseAssignValue,eq=eq_1,objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function assignValue$2(e,t,r){var i=e[t];hasOwnProperty$2.call(e,t)&&eq(i,r)&&(void 0!==r||t in e)||baseAssignValue$1(e,t,r)}var _assignValue=assignValue$2,assignValue$1=_assignValue,baseAssignValue=_baseAssignValue;function copyObject$4(e,t,r,i){for(var n=!r,a=(r=r||{},-1),s=t.length;++a<s;){var o=t[a],l=i?i(r[o],e[o],o,r,e):void 0;void 0===l&&(l=e[o]),(n?baseAssignValue:assignValue$1)(r,o,l)}return r}var _copyObject=copyObject$4,copyObject$3=_copyObject,keys$1=keys_1;function baseAssign$1(e,t){return e&&copyObject$3(t,keys$1(t),e)}var _baseAssign=baseAssign$1;function nativeKeysIn$1(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var _nativeKeysIn=nativeKeysIn$1,isObject$3=isObject_1,isPrototype$1=_isPrototype,nativeKeysIn=_nativeKeysIn,objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function baseKeysIn$1(e){if(!isObject$3(e))return nativeKeysIn(e);var t,r=isPrototype$1(e),i=[];for(t in e)("constructor"!=t||!r&&hasOwnProperty$1.call(e,t))&&i.push(t);return i}var _baseKeysIn=baseKeysIn$1,arrayLikeKeys=_arrayLikeKeys,baseKeysIn=_baseKeysIn,isArrayLike=isArrayLike_1;function keysIn$3(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var keysIn_1=keysIn$3,copyObject$2=_copyObject,keysIn$2=keysIn_1;function baseAssignIn$1(e,t){return e&&copyObject$2(t,keysIn$2(t),e)}var _baseAssignIn=baseAssignIn$1,_cloneBuffer={exports:{}},_cloneBufferExports=(_cloneBuffer.exports,((e,t)=>{var r=(t=t&&!t.nodeType&&t)&&e&&!e.nodeType&&e,i=(r=r&&r.exports===t?_root.Buffer:void 0)?r.allocUnsafe:void 0;e.exports=function(e,t){return t?e.slice():(t=e.length,t=i?i(t):new e.constructor(t),e.copy(t),t)}})(_cloneBuffer,_cloneBuffer.exports),_cloneBuffer.exports);function copyArray$1(e,t){var r=-1,i=e.length;for(t=t||Array(i);++r<i;)t[r]=e[r];return t}var _copyArray=copyArray$1,copyObject$1=_copyObject,getSymbols$1=_getSymbols;function copySymbols$1(e,t){return copyObject$1(e,getSymbols$1(e),t)}var _copySymbols=copySymbols$1,overArg=_overArg,getPrototype$2=overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype$2,arrayPush=_arrayPush,getPrototype$1=_getPrototype,getSymbols=_getSymbols,stubArray=stubArray_1,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn$2=nativeGetSymbols?function(e){for(var t=[];e;)arrayPush(t,getSymbols(e)),e=getPrototype$1(e);return t}:stubArray,_getSymbolsIn=getSymbolsIn$2,copyObject=_copyObject,getSymbolsIn$1=_getSymbolsIn;function copySymbolsIn$1(e,t){return copyObject(e,getSymbolsIn$1(e),t)}var _copySymbolsIn=copySymbolsIn$1,baseGetAllKeys=_baseGetAllKeys,getSymbolsIn=_getSymbolsIn,keysIn$1=keysIn_1;function getAllKeysIn$1(e){return baseGetAllKeys(e,keysIn$1,getSymbolsIn)}var _getAllKeysIn=getAllKeysIn$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function initCloneArray$1(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var _initCloneArray=initCloneArray$1,Uint8Array$1=_Uint8Array;function cloneArrayBuffer$3(e){var t=new e.constructor(e.byteLength);return new Uint8Array$1(t).set(new Uint8Array$1(e)),t}var _cloneArrayBuffer=cloneArrayBuffer$3,cloneArrayBuffer$2=_cloneArrayBuffer;function cloneDataView$1(e,t){t=t?cloneArrayBuffer$2(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var _cloneDataView=cloneDataView$1,reFlags=/\w*$/;function cloneRegExp$1(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var _cloneRegExp=cloneRegExp$1,Symbol$1=_Symbol,symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function cloneSymbol$1(e){return symbolValueOf?Object(symbolValueOf.call(e)):{}}var _cloneSymbol=cloneSymbol$1,cloneArrayBuffer$1=_cloneArrayBuffer;function cloneTypedArray$1(e,t){t=t?cloneArrayBuffer$1(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray$1,cloneArrayBuffer=_cloneArrayBuffer,cloneDataView=_cloneDataView,cloneRegExp=_cloneRegExp,cloneSymbol=_cloneSymbol,cloneTypedArray=_cloneTypedArray,boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag$1(e,t,r){var i=e.constructor;switch(t){case arrayBufferTag$1:return cloneArrayBuffer(e);case boolTag$1:case dateTag$1:return new i(+e);case dataViewTag$1:return cloneDataView(e,r);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(e,r);case mapTag$2:return new i;case numberTag$1:case stringTag$1:return new i(e);case regexpTag$1:return cloneRegExp(e);case setTag$2:return new i;case symbolTag$1:return cloneSymbol(e)}}var _initCloneByTag=initCloneByTag$1,isObject$2=isObject_1,objectCreate=Object.create,baseCreate$1=(()=>{function t(){}return function(e){if(!isObject$2(e))return{};if(objectCreate)return objectCreate(e);t.prototype=e;e=new t;return t.prototype=void 0,e}})(),_baseCreate=baseCreate$1,baseCreate=_baseCreate,getPrototype=_getPrototype,isPrototype=_isPrototype;function initCloneObject$1(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate(getPrototype(e))}var _initCloneObject=initCloneObject$1,getTag$2=_getTag,isObjectLike$1=isObjectLike_1,mapTag$1="[object Map]";function baseIsMap$1(e){return isObjectLike$1(e)&&getTag$2(e)==mapTag$1}var _baseIsMap=baseIsMap$1,baseIsMap=_baseIsMap,baseUnary$1=_baseUnary,nodeUtil$1=_nodeUtilExports,nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap$1=nodeIsMap?baseUnary$1(nodeIsMap):baseIsMap,isMap_1=isMap$1,getTag$1=_getTag,isObjectLike=isObjectLike_1,setTag$1="[object Set]";function baseIsSet$1(e){return isObjectLike(e)&&getTag$1(e)==setTag$1}var _baseIsSet=baseIsSet$1,baseIsSet=_baseIsSet,baseUnary=_baseUnary,nodeUtil=_nodeUtilExports,nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet$1=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,isSet_1=isSet$1,Stack=_Stack,arrayEach=_arrayEach,assignValue=_assignValue,baseAssign=_baseAssign,baseAssignIn=_baseAssignIn,cloneBuffer=_cloneBufferExports,copyArray=_copyArray,copySymbols=_copySymbols,copySymbolsIn=_copySymbolsIn,getAllKeys=_getAllKeys,getAllKeysIn=_getAllKeysIn,getTag=_getTag,initCloneArray=_initCloneArray,initCloneByTag=_initCloneByTag,initCloneObject=_initCloneObject,isArray$1=isArray_1,isBuffer=isBufferExports,isMap=isMap_1,isObject$1=isObject_1,isSet=isSet_1,keys=keys_1,keysIn=keysIn_1,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$1=4,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};function baseClone$1(r,i,n,e,t,a){var s,o=i&CLONE_DEEP_FLAG$1,l=i&CLONE_FLAT_FLAG,u=i&CLONE_SYMBOLS_FLAG$1;if(void 0===(s=n?t?n(r,e,t,a):n(r):s)){if(!isObject$1(r))return r;e=isArray$1(r);if(e){if(s=initCloneArray(r),!o)return copyArray(r,s)}else{var c=getTag(r),h=c==funcTag||c==genTag;if(isBuffer(r))return cloneBuffer(r,o);if(c==objectTag||c==argsTag||h&&!t){if(s=l||h?{}:initCloneObject(r),!o)return l?copySymbolsIn(r,baseAssignIn(s,r)):copySymbols(r,baseAssign(s,r))}else{if(!cloneableTags[c])return t?r:{};s=initCloneByTag(r,c,o)}}h=(a=a||new Stack).get(r);if(h)return h;a.set(r,s),isSet(r)?r.forEach(function(e){s.add(baseClone$1(e,i,n,e,r,a))}):isMap(r)&&r.forEach(function(e,t){s.set(t,baseClone$1(e,i,n,t,r,a))});var d=e?void 0:(u?l?getAllKeysIn:getAllKeys:l?keysIn:keys)(r);arrayEach(d||r,function(e,t){d&&(e=r[t=e]),assignValue(s,t,baseClone$1(e,i,n,t,r,a))})}return s}cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;var _baseClone=baseClone$1,baseClone=_baseClone,CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(e){return baseClone(e,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var cloneDeep_1=cloneDeep,_dec$2,_dec2$2,_dec3$2,_dec4$2,_dec5$2,_dec6$2,_dec7$2,_dec8$2,_dec9$2,_dec10$2,_dec11$2,_dec12$2,_dec13$2,_dec14$2,_dec15$2,_dec16$1,_dec17$1,_dec18$1,_dec19,_dec20,_dec21,_dec22,_dec23,_dec24,_dec25,_dec26,_dec27,_dec28,_dec29,_dec30,_dec31,_dec32,_dec33,_dec34,_class$2;let cloneDeep$1=getDefaultExportFromCjs(cloneDeep_1);function _applyDecoratedDescriptor$2(r,i,e,t,n){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(r,i,e)||e},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(r,i,a),null):a}let Store=(_dec$2=bindSelf,_dec2$2=bindSelf,_dec3$2=bindSelf,_dec4$2=bindSelf,_dec5$2=bindSelf,_dec6$2=bindSelf,_dec7$2=bindSelf,_dec8$2=bindSelf,_dec9$2=bindSelf,_dec10$2=bindSelf,_dec11$2=bindSelf,_dec12$2=bindSelf,_dec13$2=bindSelf,_dec14$2=bindSelf,_dec15$2=bindSelf,_dec16$1=bindSelf,_dec17$1=bindSelf,_dec18$1=bindSelf,_dec19=bindSelf,_dec20=bindSelf,_dec21=bindSelf,_dec22=bindSelf,_dec23=bindSelf,_dec24=bindSelf,_dec25=bindSelf,_dec26=bindSelf,_dec27=bindSelf,_dec28=bindSelf,_dec29=bindSelf,_dec30=bindSelf,_dec31=bindSelf,_dec32=bindSelf,_dec33=bindSelf,_dec34=bindSelf,_class$2=class Store2{constructor(){this.filters=filters,this.block=null,this.onControlChangeEnd=void 0,this.onControlChangeStart=void 0,this.triggerCurrentTime=void 0,this.onEachSourceProgress=void 0,this.triggerRecordSelectElements=void 0,this.movieId="movieId",this.workerPath="",this.currentTime=0,this._startPlayTime=0,this.times=null,this.controlModeType="editElement",this.bodyContainer=void 0,this.captionContainer=void 0,this.onPause=null,this.data=void 0,this.events=void 0,this.record=void 0,this.resourceManage=void 0,this.movieSize={width:0,height:0},this.app=void 0,this.playing=!1,this.env="editor",this.groups=[],this.zIndexObjects={},this.cacheControlElementIds=[],this._totalTime=0,this.usedMediaInfo={},this.elementReadyMark={},this.renderAsyncMark={},this._hideLockData={},this._checkCanPlayMedias={},this.controlElements=[]}get hideLockData(){return this._hideLockData}getPixiContainerById(t){let r=[];return[...this.captionContainer.children,...this.bodyContainer.children].forEach(e=>{e.children.forEach(e=>{t.includes(e.name)&&r.push(e)})}),r}pixiContainerToImageById(e){var[e]=this.getPixiContainerById([e]);return e?this.app.renderer.extract.image(e):null}updateGroup(){var e=groupByTrackIndex(this.data.elements);this.groups=e,this.zIndexObjects={},e.forEach((e,t)=>{var r=e[0].trackIndex,i=this.getHideLock(r);i?this.setHideLock({...i,trackIndex:r}):this.setHideLock({trackIndex:r}),e.forEach(e=>{this.zIndexObjects[e.id]=config.MAX_TRACKINDEX-t})})}initHideLock(e){this._hideLockData=e}getHideLock(e){return this._hideLockData[e]||{hide:!1,lock:!1}}changeControlMode(e,t){let r=null;if("editElement"===(this.controlModeType=e))r=document.querySelector(`[data-elementid="${t}"]`);else{if("editMask"!==e)return;r=document.querySelector(`[data-maskid="${t}"]`)}r?this.updateControl("trigger",[r]):this.updateControl("trigger",[])}getFrameItem(e){var t;for(t of e.frames||[])if(Math.abs(this.currentTime-(t.startTime+e.startTime))<.1)return t;return null}asyncFrameAnimateStatus(e,t){var r,i,n,a,s,o,l,u,c,h,d,p,f,m,g,v,y,_,b,x;e&&t&&({x:t,y:r,width:i,height:n,alpha:a,rotation:s=0,intensity:o,volume:l,maskX:u,maskY:c,maskBlur:h,maskHeight:d,maskRotation:p,maskAlpha:f,maskWidth:m,textScale:g,textColor:v,textBgColor:y,textBorderColor:_,textGradientStops:b}=t,x=e,void 0!==t&&(x.style.x=t),void 0!==r&&(x.style.y=r),void 0!==i&&(x.style.width=i),void 0!==n&&(x.style.height=n),void 0!==a&&(x.style.alpha=a),void 0!==s&&(x.style.rotation=s),void 0!==o&&(e.intensity=o),void 0!==l&&(e.volume=l),void 0!==g&&(e.textScale=g),void 0!==v&&(e.textStyle.fill=v),void 0!==b&&(e.textStyle.fillGradientStops=b),void 0!==_&&(e.textStyle.stroke=_),void 0!==y&&(e.textStyle.textBgColor=y),x.mask)&&(void 0!==u&&(x.mask.x=u),void 0!==c&&(x.mask.y=c),void 0!==d&&(x.mask.height=d),void 0!==m&&(x.mask.width=m),void 0!==h&&(x.mask.blur=h),void 0!==p&&(x.mask.rotation=p||0),x.mask.alpha=void 0!==f?f:1)}getFrameKeys(e){let t=[];return e.frames&&e.frames.forEach(e=>{t.push(...Object.keys(e))}),[...new Set(t)].filter(e=>!["id","startTime"].includes(e))}getFrameStatusByCurrentTime(e,t){var{startTime:r,duration:i}=e,n=videoAvgSpeed(e),i=r<=(t=void 0===t?this.currentTime:t)&&t<=i/n+r;return this.getFrameStatus(e,i?(t-r)*n:null)}getFrameStatus(e,t){if(null!==t&&e.frames&&0<e.frames.length){var r=[{...e.frames[0],startTime:0,id:"start"},...e.frames,{...e.frames[e.frames.length-1],startTime:e.duration,id:"end"}];for(let e=1;e<r.length;e++)if(r[e].startTime>=t){var i,n=r[e-1],a=r[e],s=Object.keys(Object.assign({...n},{...a})).filter(e=>"id"!==e&&"startTime"!==e),o={id:n.id+"_"+a.id,startTime:t};for(i of s){if(a.startTime===n.startTime)return Object.assign({...n},{...o});var l=(t-n.startTime)/(a.startTime-n.startTime),u=("alpha"===i&&(void 0===n[i]&&(n[i]=1),void 0===a[i])&&(a[i]=1),n[i]||0),c=a[i]||0;o[i]=(c-u)*l+u}return o}}return null}setHideLock(e,t){let r=!1;(r=this._hideLockData[e.trackIndex]?r:!0)?this._hideLockData[e.trackIndex]={hide:e.hide,lock:e.lock}:(void 0!==e.hide&&(this._hideLockData[e.trackIndex].hide=e.hide),void 0!==e.lock&&(this._hideLockData[e.trackIndex].lock=e.lock)),t&&pubsub.publish(this.events.UPDATE_MOVIE)}removeTrackMedias(e,t){this.resourceManage.removeTrackMedias(e,t)}checkSupportTransition(i){var e=groupByTrackIndex(this.data.elements);let n=!1;return e.forEach(r=>{r.forEach((e,t)=>{e.id===i&&(t=r[t+1])&&e.startTime+e.duration===t.startTime&&(n=!0)})}),n}removeInvalidTransition(){var e=groupByTrackIndex(this.data.elements);let n=this.data.transitions;e.forEach(i=>{i.forEach((t,e)=>{var e=i[e+1],r=n.findIndex(e=>e.startElementId===t.id);(-1!==r&&e&&t.startTime+t.duration!==e.startTime||-1!==r&&!e)&&n.splice(r,1)})})}async readyVideoinWeiXin(){let t=[],e=(document.querySelectorAll("._resource_media_"+this.movieId).forEach(e=>{t.push(e.play().then(()=>(e.pause(),!0)).catch(()=>!0))}),await Promise.all(t),[]);for(var r in document.querySelectorAll("._resource_media_"+this.movieId).forEach(r=>{e.push(()=>new Promise(e=>{var t;isIOSWechatBrowser()?setTimeout(()=>{e(!0)},1e3):(t=r.getAttribute("data-key"),this._checkCanPlayMedias[t]={el:r,eventFun:()=>{e(!0)}},r.addEventListener("canplay",this._checkCanPlayMedias[t].eventFun))}))}),await Promise.all(e),this._checkCanPlayMedias){var{el:i,eventFun:n}=this._checkCanPlayMedias[r];i.removeEventListener("canplay",n),this._checkCanPlayMedias[r]=null,delete this._checkCanPlayMedias[r]}}async play(e){e&&e(),await this.readyVideoinWeiXin(),this._totalTime=this.getTotalTime(),this.playing=!0,this._startPlayTime=performance.now()-1e3*this.currentTime,this.runAnimate()}pause(){for(var e in this.onPause&&this.onPause(),this.playing=!1,this.resourceManage.trackMedias){e=this.resourceManage.trackMedias[e].target;e.paused||e.pause()}}sortZIndexNewData(){var e=toJS(this.data);return e.elements.sort((e,t)=>e.trackIndex-t.trackIndex),groupByTrackIndex(e.elements).forEach((e,t)=>{e.forEach(e=>{e.trackIndex=t+1})}),e}step(e){this.pause(),this.triggerCurrentTime&&this.triggerCurrentTime(e)}runAnimate(){var e=(performance.now()-this._startPlayTime)/1e3;e>=this._totalTime?this.pause():(e-this.currentTime>=1/config.fps&&this.triggerCurrentTime&&this.triggerCurrentTime(e),this.playing&&requestAnimationFrame(this.runAnimate.bind(this)))}updateControl(e,t){if("editor"===this.env)switch(e){case"updateTarget":pubsub.publish(this.events.UPDATE_CONTROL_TARGET);break;case"updateList":pubsub.publish(this.events.UPDATE_CONTROL_LIST);break;case"trigger":pubsub.publish(this.events.TRIGGER_CONTROL,t);break;case"triggerNoCallback":pubsub.publish(this.events.TRIGGER_CONTROL_NO_CALLBACK,t);break;case"visible":pubsub.publish(this.events.VISIBLE_CONTROL,t);break;case"stopGroupDrag":pubsub.publish(this.events.STOP_GROUP_DRAG,t)}}updateSortTracks(){pubsub.publish(this.events.SORT_CONTAINER)}getTotalTime(){return getTotalTime(this.data)}getElementDataByIds(e){return getElementsByIds(e,this.data.elements)||getElementsByIds(e,this.data.captions)||getElementsByIds(e,this.data.transitions)}getElementDataByTypes(e,t){return getElementDataByTypes(e,t||this.data)}getCloneData(){var e=toJS(this.data);return e.elements.sort((e,t)=>e.trackIndex-t.trackIndex).forEach((e,t)=>{e.trackIndex=t+1}),e}async addResource(t,e){var r=this.data.resouces.find(e=>e.url===t);return r||(await this.resourceManage.fetchBlob(t),r={id:createID(),name:"mask_image",type:"image",url:t,mustFetch:!0,fileType:getFileTypeFromFileName(t)||"unknown",from:"system",styleSize:e},this.data.resouces.push(r),r)}async addElementByResource(t,e){var r=this.data;let i=r.resouces.find(e=>e.url===t.url);i||(i=cloneDeep$1(t),r.resouces.push(i));var{elementType:n,time:a,duration:s}=e;let o=e.trackIndex;if(void 0===o){var l=(this.groups[0]||[])[0]||{trackIndex:1};o=getInsertTrackIndex(l.trackIndex,"auto",r,e)}else if(o<=0)throw new Error("trackIndex不能是0或者小于0的数");let u;switch(n){case"image":"image"===i.type&&await this.resourceManage.fetchBlob(i.url);var c=calcSizeAndPosition(i.styleSize,{width:r.width,height:r.height});u={id:createID(),name:i.name,_dirty:"1",type:n,trackIndex:o,resourceId:i.id,startTime:a,duration:s||5,blendMode:0,style:{...c},flipx:!1};break;case"lottie":"lottie"===i.type&&await this.resourceManage.fetchBlob(i.url);c=calcSizeAndPosition(i.styleSize,{width:r.width,height:r.height});u={id:createID(),name:i.name,_dirty:"1",type:n,trackIndex:o,resourceId:i.id,startTime:a,duration:s||5,blendMode:0,style:{...c},lottieSpeed:1,initStartFrame:0,flipx:!1};break;case"video":"video"===i.type&&await mediaLazy(i.url).then(e=>{this.resourceManage.medias[i.url]=e});c=calcSizeAndPosition(i.styleSize,{width:r.width,height:r.height});u={id:createID(),name:i.name,_dirty:"1",type:n,trackIndex:o,resourceId:i.id,startTime:a,matting:{enabled:!1,color:"#00FF00",filterType:8,lightLevel:.2,gridSize:.8,emergence:0},duration:s||5,muted:!1,volume:1,speed:1,curveSpeed:!1,clipTime:0,blendMode:0,style:{...c},flipx:!1};break;case"audio":["audio","video"].includes(i.type)&&await mediaLazy(i.url).then(e=>{this.resourceManage.medias[i.url]=e}),u={id:createID(),name:i.name,_dirty:"1",_noControl:!0,type:n,trackIndex:o,resourceId:i.id,startTime:a,duration:s||10,muted:!1,volume:1,speed:1,curveSpeed:!1,clipTime:0,fadeInTime:0,fadeOutTime:0};break;case"filter":"image"===i.type&&await this.resourceManage.fetchBlob(i.url),u={id:createID(),name:i.name,_dirty:"1",_noControl:!0,type:n,trackIndex:o,resourceId:i.id,startTime:a,duration:s||5,intensity:1};break;default:throw new Error("元素类型还没做"+n)}return r.elements.push(u),r.elements.sort((e,t)=>e.trackIndex-t.trackIndex),pubsub.publish(this.events.SORT_CONTAINER),u}async addElementNoSource(e,t){var{elementType:r,time:i,duration:n}=t;let a=t.trackIndex;if(void 0===a){var s=(this.groups[0]||[])[0]||{trackIndex:1};a=getInsertTrackIndex(s.trackIndex,"up",this.data)}else if(a<=0)throw new Error("trackIndex不能是0或者小于0的数");let o;switch(t.elementType){case"text":case"caption":o={id:createID(),name:e.text.slice(0,20),text:e.text,textStyle:{fontSize:48,fill:"#fff",align:"center",fontFamily:"",letterSpacing:0,strokeThickness:6,...e.attrs,lineHeight:0},style:{x:this.data.width/2,y:this.data.height/2},_dirty:"1",type:r,trackIndex:a,startTime:i,duration:n||5};break;case"effect":o={id:createID(),name:e.name,_dirty:"1",_noControl:!0,type:r,jscript:e.jscript,style:{alpha:1},trackIndex:a,startTime:i,duration:n||5};break;default:throw Error("暂无此类型元素的添加方法addElementNoSource:"+t)}return t.onlyGetJSON||(this.data.elements.push(o),this.data.elements.sort((e,t)=>e.trackIndex-t.trackIndex),pubsub.publish(this.events.SORT_CONTAINER)),o}async update(e){if("export"===this.env&&void 0!==e&&(this.currentTime=e),pubsub.publish(this.events.UPDATE_MOVIE),"export"===this.env)for(;;){for(var t in this.renderAsyncMark)"success"===this.renderAsyncMark[t]&&delete this.renderAsyncMark[t];if(0===Object.values(this.renderAsyncMark).length)break;await sleep(8)}"editor"===this.env&&pubsub.publish(this.events.UPDATE_CONTROL_TARGET)}capture(){var e=null==(e=this.app)?void 0:e.view;return e?e.toDataURL("image/png"):""}controlChangeStart(t){t.forEach(e=>{pubsub.publish(this.events.CONTROL_CHANGE_START+"."+e,t)}),this.onControlChangeStart&&this.onControlChangeStart(t)}controlChangeEnd(t){t.forEach(e=>{pubsub.publish(this.events.CONTROL_CHANGE_END+"."+e,t)});var e=[...getAllElements(null,this.data),...this.data.cameras,...this.data.captions];let r=[];e.forEach(e=>{t.includes(e.id)&&r.push(e)}),null!=(e=this.record)&&e.add({desc:"控制器修改元素",type:"elements_update",selecteds:[...t],data:r}),this.onControlChangeEnd&&this.onControlChangeEnd(t)}clearUnUsedResource(){let t=[],r=[];for(var e in this.data.elements.forEach(e=>{e.resourceId&&(t.push(e.trackIndex+"_"+e.resourceId),r.push(e.resourceId))}),this.resourceManage.removeUnuesdCache(),this.resourceManage.trackMedias){var i;t.includes(e)||((i=this.resourceManage.trackMedias[e]).target.removeEventListener("canplay",i.canplayFun),i.target.removeEventListener("waiting",i.waitingFun),i.target.remove(),delete this.resourceManage.trackMedias[e])}return remove$1(this.data.resouces,e=>!r.includes(e.id)),r}destroy(){this.resourceManage.clearTempData(),this.resourceManage.destroy(),this.groups=[],this.data=null,this.app=null}},_applyDecoratedDescriptor$2(_class$2.prototype,"getPixiContainerById",[_dec$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"getPixiContainerById"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"pixiContainerToImageById",[_dec2$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"pixiContainerToImageById"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"updateGroup",[_dec3$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"updateGroup"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"initHideLock",[_dec4$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"initHideLock"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getHideLock",[_dec5$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"getHideLock"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"changeControlMode",[_dec6$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"changeControlMode"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getFrameItem",[_dec7$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"getFrameItem"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"asyncFrameAnimateStatus",[_dec8$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"asyncFrameAnimateStatus"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getFrameKeys",[_dec9$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"getFrameKeys"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getFrameStatusByCurrentTime",[_dec10$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"getFrameStatusByCurrentTime"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getFrameStatus",[_dec11$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"getFrameStatus"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"setHideLock",[_dec12$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"setHideLock"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"checkSupportTransition",[_dec13$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"checkSupportTransition"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"removeInvalidTransition",[_dec14$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"removeInvalidTransition"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"play",[_dec15$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"play"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"pause",[_dec16$1],Object.getOwnPropertyDescriptor(_class$2.prototype,"pause"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"sortZIndexNewData",[_dec17$1],Object.getOwnPropertyDescriptor(_class$2.prototype,"sortZIndexNewData"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"step",[_dec18$1],Object.getOwnPropertyDescriptor(_class$2.prototype,"step"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"runAnimate",[_dec19],Object.getOwnPropertyDescriptor(_class$2.prototype,"runAnimate"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"updateControl",[_dec20],Object.getOwnPropertyDescriptor(_class$2.prototype,"updateControl"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"updateSortTracks",[_dec21],Object.getOwnPropertyDescriptor(_class$2.prototype,"updateSortTracks"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getTotalTime",[_dec22],Object.getOwnPropertyDescriptor(_class$2.prototype,"getTotalTime"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getElementDataByIds",[_dec23],Object.getOwnPropertyDescriptor(_class$2.prototype,"getElementDataByIds"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getElementDataByTypes",[_dec24],Object.getOwnPropertyDescriptor(_class$2.prototype,"getElementDataByTypes"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"getCloneData",[_dec25],Object.getOwnPropertyDescriptor(_class$2.prototype,"getCloneData"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"addResource",[_dec26],Object.getOwnPropertyDescriptor(_class$2.prototype,"addResource"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"addElementByResource",[_dec27],Object.getOwnPropertyDescriptor(_class$2.prototype,"addElementByResource"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"addElementNoSource",[_dec28],Object.getOwnPropertyDescriptor(_class$2.prototype,"addElementNoSource"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"update",[_dec29],Object.getOwnPropertyDescriptor(_class$2.prototype,"update"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"capture",[_dec30],Object.getOwnPropertyDescriptor(_class$2.prototype,"capture"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"controlChangeStart",[_dec31],Object.getOwnPropertyDescriptor(_class$2.prototype,"controlChangeStart"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"controlChangeEnd",[_dec32],Object.getOwnPropertyDescriptor(_class$2.prototype,"controlChangeEnd"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"clearUnUsedResource",[_dec33],Object.getOwnPropertyDescriptor(_class$2.prototype,"clearUnUsedResource"),_class$2.prototype),_applyDecoratedDescriptor$2(_class$2.prototype,"destroy",[_dec34],Object.getOwnPropertyDescriptor(_class$2.prototype,"destroy"),_class$2.prototype),_class$2);var FUNCTION="function",OBJECT="object",STRING="string",NUMBER="number",UNDEFINED="undefined",IS_WINDOW=typeof window!==UNDEFINED,doc=typeof document!==UNDEFINED&&document,OPEN_CLOSED_CHARACTERS=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],TINY_NUM$1=1e-7,DEFAULT_UNIT_PRESETS={cm:function(e){return 96*e/2.54},mm:function(e){return 96*e/254},in:function(e){return 96*e},pt:function(e){return 96*e/72},pc:function(e){return 96*e/6},"%":function(e,t){return e*t/100},vw:function(e,t){return e/100*(t=void 0===t?window.innerWidth:t)},vh:function(e,t){return e/100*(t=void 0===t?window.innerHeight:t)},vmax:function(e,t){return e/100*(t=void 0===t?Math.max(window.innerWidth,window.innerHeight):t)},vmin:function(e,t){return e/100*(t=void 0===t?Math.min(window.innerWidth,window.innerHeight):t)}};function __spreadArrays$2(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,n++)i[n]=a[s];return i}function dot(e,t,r,i){return(e*i+t*r)/(r+i)}function isUndefined(e){return typeof e===UNDEFINED}function isObject(e){return e&&typeof e===OBJECT}function isArray(e){return Array.isArray(e)}function isString(e){return typeof e===STRING}function isNumber(e){return typeof e===NUMBER}function isFunction(e){return typeof e===FUNCTION}function isEqualSeparator(e,t){return(""===t||" "==t)&&(""===e||" "==e)||e===t}function findOpen(e,t,r,i,n){return findIgnore(e,t,r)?r:findClose(e,t,r+1,i,n)}function findIgnore(e,t,r){return e.ignore?(t=t.slice(Math.max(r-3,0),r+3).join(""),new RegExp(e.ignore).exec(t)):null}function findClose(n,a,e,s,o){for(var l,t=e;t<s;++t){var r=(e=>{var t,r,i=a[e].trim();return i!==n.close||findIgnore(n,a,e)?(t=e,-1===(t=(r=find$1(o,function(e){return e.open===i}))?findOpen(r,a,e,s,o):t)?(l=e,"break"):void(l=e=t)):{value:e}})(t),t=l;if("object"==typeof r)return r.value;if("break"===r)break}return-1}function splitText(a,e){var e=isString(e)?{separator:e}:e,t=e.separator,s=void 0===t?",":t,o=e.isSeparateFirst,l=e.isSeparateOnlyOpenClose,t=e.isSeparateOpenClose,u=void 0===t?l:t,t=e.openCloseCharacters,c=void 0===t?OPEN_CLOSED_CHARACTERS:t,e=c.map(function(e){var t=e.open,e=e.close;return t===e?t:t+"|"+e}).join("|"),t=new RegExp("(\\s*"+s+"\\s*|"+e+"|\\s+)","g"),h=a.split(t).filter(function(e){return e&&"undefined"!==e}),d=h.length,p=[],f=[];function m(){return f.length&&(p.push(f.join("")),f=[])}for(var g,r=0;r<d;++r){var i=(e=>{var t=h[e].trim(),r=e,i=find$1(c,function(e){return e.open===t}),n=find$1(c,function(e){return e.close===t});if(i){if(-1!==(r=findOpen(i,h,e,d,c))&&u)return m()&&o||(p.push(h.slice(e,r+1).join("")),e=r,o)?(g=e,"break"):(g=e,"continue")}else{if(n&&!findIgnore(n,h,e))return(i=__spreadArrays$2(c)).splice(c.indexOf(n),1),{value:splitText(a,{separator:s,isSeparateFirst:o,isSeparateOnlyOpenClose:l,isSeparateOpenClose:u,openCloseCharacters:i})};if(isEqualSeparator(t,s)&&!l)return m(),o?(g=e,"break"):(g=e,"continue")}f.push(h.slice(e,(r=-1===r?d-1:r)+1).join("")),g=e=r})(r),r=g;if("object"==typeof i)return i.value;if("break"===i)break}return f.length&&p.push(f.join("")),p}function splitSpace(e){return splitText(e,"")}function splitComma(e){return splitText(e,",")}function splitBracket(e){e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(e);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function splitUnit(e){e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(e);return e?{prefix:e[1],unit:e[3],value:parseFloat(e[2])}:{prefix:"",unit:"",value:NaN}}function camelize(e){return e.replace(/[\s-_]+([^\s-_])/g,function(e,t){return t.toUpperCase()})}function decamelize(e,i){return void 0===i&&(i="-"),e.replace(/([a-z])([A-Z])/g,function(e,t,r){return""+t+i+r.toLowerCase()})}function now(){return Date.now?Date.now():(new Date).getTime()}function findIndex(e,t,r){void 0===r&&(r=-1);for(var i=e.length,n=0;n<i;++n)if(t(e[n],n,e))return n;return r}function find$1(e,t,r){t=findIndex(e,t);return-1<t?e[t]:r}var requestAnimationFrame$1=(()=>{var r=now(),e=IS_WINDOW&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(e){var t=now();return setTimeout(function(){e(t-r)},1e3/60)}})(),cancelAnimationFrame$1=(()=>{var e=IS_WINDOW&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return e?e.bind(window):function(e){clearTimeout(e)}})();function getKeys(e){return Object.keys(e)}function convertUnitSize(e,t){var e=splitUnit(e),r=e.value,e=e.unit;if(isObject(t)){var i=t[e];if(i){if(isFunction(i))return i(r);if(DEFAULT_UNIT_PRESETS[e])return DEFAULT_UNIT_PRESETS[e](r,i)}}else if("%"===e)return r*t/100;return DEFAULT_UNIT_PRESETS[e]?DEFAULT_UNIT_PRESETS[e](r):r}function between(e,t,r){return Math.max(t,Math.min(e,r))}function checkBoundSize(e,i,n,t){return void 0===t&&(t=e[0]/e[1]),[[throttle(i[0],TINY_NUM$1),throttle(i[0]/t,TINY_NUM$1)],[throttle(i[1]*t,TINY_NUM$1),throttle(i[1],TINY_NUM$1)]].filter(function(e){return e.every(function(e,t){var t=i[t],r=throttle(t,TINY_NUM$1);return n?e<=t||e<=r:t<=e||r<=e})})[0]||e}function calculateBoundSize(e,r,i,t){var n,a,s,o,l;return t?(n=e[0],a=e[1],s=(o=checkBoundSize(e,r,!1,t=!0===t?n/a:t))[0],o=o[1],l=(t=checkBoundSize(e,i,!0,t))[0],t=t[1],n<s||a<o?(n=s,a=o):(l<n||t<a)&&(n=l,a=t),[n,a]):e.map(function(e,t){return between(e,r[t],i[t])})}function sum(e){for(var t=0,r=e.length-1;0<=r;--r)t+=e[r];return t}function average(e){for(var t=e.length,r=0,i=t-1;0<=i;--i)r+=e[i];return t?r/t:0}function getRad$1(e,t){var r=t[0]-e[0],t=Math.atan2(t[1]-e[1],r);return 0<=t?t:t+2*Math.PI}function getCenterPoint(e){return[0,1].map(function(t){return average(e.map(function(e){return e[t]}))})}function getShapeDirection(e){var t=getCenterPoint(e),r=getRad$1(t,e[0]),t=getRad$1(t,e[1]);return r<t&&t-r<Math.PI||t<r&&t-r<-Math.PI?1:-1}function getDist$2(e,t){return Math.sqrt(Math.pow((t?t[0]:0)-e[0],2)+Math.pow((t?t[1]:0)-e[1],2))}function throttle(e,t){var r;return t?(r=1/t,Math.round(e/t)/r):e}function throttleArray(r,i){return r.forEach(function(e,t){r[t]=throttle(r[t],i)}),r}function counter(e){for(var t=[],r=0;r<e;++r)t.push(r);return t}function hasClass(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function addClass(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function removeClass(e,t){e.classList?e.classList.remove(t):(t=new RegExp("(\\s|^)"+t+"(\\s|$)"),e.className=e.className.replace(t," "))}function addEvent(e,t,r,i){e.addEventListener(t,r,i)}function removeEvent(e,t,r,i){e.removeEventListener(t,r,i)}function getDocument(e){return(null==e?void 0:e.ownerDocument)||doc}function getDocumentElement(e){return getDocument(e).documentElement}function getDocumentBody(e){return getDocument(e).body}function getWindow(e){return(null==(e=null==e?void 0:e.ownerDocument)?void 0:e.defaultView)||window}function isWindow(e){return e&&"postMessage"in e&&"blur"in e&&"self"in e}function isNode(e){return isObject(e)&&e.nodeName&&e.nodeType&&"ownerDocument"in e}var __assign$7=function(){return(__assign$7=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __spreadArrays$1(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,n++)i[n]=a[s];return i}var EventEmitter=(()=>{function e(){this._events={}}var t=e.prototype;return t.on=function(e,t){if(isObject(e))for(var r in e)this.on(r,e[r]);else this._addEvent(e,t,{});return this},t.off=function(e,t){if(e)if(isObject(e))for(var r in e)this.off(r);else{var i,n;t?(i=this._events[e])&&-1<(n=findIndex(i,function(e){return e.listener===t}))&&i.splice(n,1):this._events[e]=[]}else this._events={};return this},t.once=function(t,e){var r=this;return e&&this._addEvent(t,e,{once:!0}),new Promise(function(e){r._addEvent(t,e,{once:!0})})},t.emit=function(t,r){var e,i=this,n=(void 0===r&&(r={}),this._events[t]);return!t||!n||(e=!1,r.eventType=t,r.stop=function(){e=!0},r.currentTarget=this,__spreadArrays$1(n).forEach(function(e){e.listener(r),e.once&&i.off(t,e.listener)}),!e)},t.trigger=function(e,t){return this.emit(e,t=void 0===t?{}:t)},t._addEvent=function(e,t,r){var i=this._events;i[e]=i[e]||[],i[e].push(__assign$7({listener:t},r))},e})();let EventEmitter$1=EventEmitter;var extendStatics$6=function(e,t){return(extendStatics$6=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)};function __extends$6(e,t){function r(){this.constructor=e}extendStatics$6(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign$6=function(){return(__assign$6=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function getRad(e,t){var r=t[0]-e[0],t=Math.atan2(t[1]-e[1],r);return 0<=t?t:t+2*Math.PI}function getRotatiion(e){return getRad([e[0].clientX,e[0].clientY],[e[1].clientX,e[1].clientY])/Math.PI*180}function isMultiTouch(e){return e.touches&&2<=e.touches.length}function getEventClients(e){return e?e.touches?getClients(e.touches):[getClient$1(e)]:[]}function isMouseEvent(e){return e&&(-1<e.type.indexOf("mouse")||"button"in e)}function getPosition(e,t,r){var i=r.length,e=getAverageClient(e,i),n=e.clientX,a=e.clientY,s=e.originalClientX,e=e.originalClientY,t=getAverageClient(t,i),o=t.clientX,t=t.clientY,r=getAverageClient(r,i);return{clientX:s,clientY:e,deltaX:n-o,deltaY:a-t,distX:n-r.clientX,distY:a-r.clientY}}function getDist$1(e){return Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2))}function getClients(e){for(var t=Math.min(e.length,2),r=[],i=0;i<t;++i)r.push(getClient$1(e[i]));return r}function getClient$1(e){return{clientX:e.clientX,clientY:e.clientY}}function getAverageClient(e,t){void 0===t&&(t=e.length);for(var r={clientX:0,clientY:0,originalClientX:0,originalClientY:0},i=Math.min(e.length,t),n=0;n<i;++n){var a=e[n];r.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,r.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,r.clientX+=a.clientX,r.clientY+=a.clientY}return t?{clientX:r.clientX/t,clientY:r.clientY/t,originalClientX:r.originalClientX/t,originalClientY:r.originalClientY/t}:r}var ClientStore=(()=>{function e(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return e.prototype.getAngle=function(e){return getRotatiion(e=void 0===e?this.prevClients:e)},e.prototype.getRotation=function(e){return getRotatiion(e=void 0===e?this.prevClients:e)-getRotatiion(this.startClients)},e.prototype.getPosition=function(e,t){var r=getPosition((e=void 0===e?this.prevClients:e)||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,n=r.deltaY;return this.movement+=Math.sqrt(i*i+n*n),this.prevClients=e,r},e.prototype.getPositions=function(e){void 0===e&&(e=this.prevClients);for(var t=this.prevClients,r=this.startClients,i=Math.min(this.length,t.length),n=[],a=0;a<i;++a)n[a]=getPosition([e[a]],[t[a]],[r[a]]);return n},e.prototype.getMovement=function(e){var t,r,i=this.movement;return e?(e=getAverageClient(e,this.length),t=getAverageClient(this.prevClients,this.length),r=e.clientX-t.clientX,e=e.clientY-t.clientY,Math.sqrt(r*r+e*e)+i):i},e.prototype.getDistance=function(e){return getDist$1(e=void 0===e?this.prevClients:e)},e.prototype.getScale=function(e){return getDist$1(e=void 0===e?this.prevClients:e)/getDist$1(this.startClients)},e.prototype.move=function(t,r){this.startClients.forEach(function(e){e.clientX-=t,e.clientY-=r}),this.prevClients.forEach(function(e){e.clientX-=t,e.clientY-=r})},e})(),INPUT_TAGNAMES=["textarea","input"],Gesto=(a=>{function e(e,t){void 0===t&&(t={});var r,g=a.call(this)||this,e=(g.options={},g.flag=!1,g.pinchFlag=!1,g.data={},g.isDrag=!1,g.isPinch=!1,g.clientStores=[],g.targets=[],g.prevTime=0,g.doubleFlag=!1,g._useMouse=!1,g._useTouch=!1,g._useDrag=!1,g._dragFlag=!1,g._isTrusted=!1,g._isMouseEvent=!1,g._isSecondaryButton=!1,g._preventMouseEvent=!1,g._prevInputEvent=null,g._isDragAPI=!1,g._isIdle=!0,g._preventMouseEventId=0,g._window=window,g.onDragStart=function(e,t){if(void 0===t&&(t=!0),g.flag||!1!==e.cancelable){var r=-1<=e.type.indexOf("drag");if(!g.flag||!r){g._isDragAPI=!0;var r=g.options,i=r.container,n=r.pinchOutside,a=r.preventWheelClick,s=r.preventRightClick,o=r.preventDefault,l=r.checkInput,u=r.dragFocusedInput,c=r.preventClickEventOnDragStart,h=r.preventClickEventOnDrag,r=r.preventClickEventByCondition,d=g._useTouch,p=!g.flag;if(g._isSecondaryButton=3===e.which||2===e.button,a&&(2===e.which||1===e.button)||s&&(3===e.which||2===e.button))return g.stop(),!1;if(p){a=g._window.document.activeElement,s=e.target;if(s){var f=s.tagName.toLowerCase(),f=-1<INPUT_TAGNAMES.indexOf(f),m=s.isContentEditable;if(f||m){if(l||!u&&a===s)return!1;if(a&&(a===s||m&&a.isContentEditable&&a.contains(s))){if(!u)return!1;s.blur()}}else(o||"touchstart"===e.type)&&a&&(f=a.tagName.toLowerCase(),a.isContentEditable||-1<INPUT_TAGNAMES.indexOf(f))&&a.blur();(c||h||r)&&addEvent(g._window,"click",g._onClick,!0)}g.clientStores=[new ClientStore(getEventClients(e))],g._isIdle=!1,g.flag=!0,g.isDrag=!1,g._isTrusted=t,g._dragFlag=!0,g._prevInputEvent=e,g.data={},g.doubleFlag=now()-g.prevTime<200,g._isMouseEvent=isMouseEvent(e),!g._isMouseEvent&&g._preventMouseEvent&&g._allowMouseEvent(),!1===(g._preventMouseEvent||g.emit("dragStart",__assign$6(__assign$6({data:g.data,datas:g.data,inputEvent:e,isMouseEvent:g._isMouseEvent,isSecondaryButton:g._isSecondaryButton,isTrusted:t,isDouble:g.doubleFlag},g.getCurrentStore().getPosition()),{preventDefault:function(){e.preventDefault()},preventDrag:function(){g._dragFlag=!1}})))&&g.stop(),g._isMouseEvent&&g.flag&&o&&e.preventDefault()}if(!g.flag)return!1;l=0;p?(g._attchDragEvent(),d&&n&&(l=setTimeout(function(){addEvent(i,"touchstart",g.onDragStart,{passive:!1})}))):d&&n&&removeEvent(i,"touchstart",g.onDragStart),g.flag&&isMultiTouch(e)&&(clearTimeout(l),p&&e.touches.length!==e.changedTouches.length||g.pinchFlag||g.onPinchStart(e))}}},g.onDrag=function(e,t){if(g.flag){var r=g.options.preventDefault,r=(!g._isMouseEvent&&r&&e.preventDefault(),getEventClients(g._prevInputEvent=e)),i=g.moveClients(r,e,!1);if(g._dragFlag){if(g.pinchFlag||i.deltaX||i.deltaY)if(!1===(g._preventMouseEvent||g.emit("drag",__assign$6(__assign$6({},i),{isScroll:!!t,inputEvent:e}))))return void g.stop();g.pinchFlag&&g.onPinch(e,r)}g.getCurrentStore().getPosition(r,!0)}},g.onDragEnd=function(e){var t,r,i,n,a,s;g.flag&&(s=(a=g.options).pinchOutside,t=a.container,n=a.preventClickEventOnDragStart,i=a.preventClickEventByCondition,r=g.isDrag,((a=a.preventClickEventOnDrag)||n||i)&&requestAnimationFrame(function(){g._allowClickEvent()}),i||n||!a||r||g._allowClickEvent(),g._useTouch&&s&&removeEvent(t,"touchstart",g.onDragStart),g.pinchFlag&&g.onPinchEnd(e),0!==(i=null!=e&&e.touches?getEventClients(e):[]).length&&g.options.keepDragging?g._addStore(new ClientStore(i)):g.flag=!1,n=g._getPosition(),a=now(),s=!r&&g.doubleFlag,g._prevInputEvent=null,g.prevTime=r||s?0:a,g.flag||(g._dettachDragEvent(),g._preventMouseEvent||g.emit("dragEnd",__assign$6({data:g.data,datas:g.data,isDouble:s,isDrag:r,isClick:!r,isMouseEvent:g._isMouseEvent,isSecondaryButton:g._isSecondaryButton,inputEvent:e,isTrusted:g._isTrusted},n)),g.clientStores=[],g._isMouseEvent||(g._preventMouseEvent=!0,clearTimeout(g._preventMouseEventId),g._preventMouseEventId=setTimeout(function(){g._preventMouseEvent=!1},200)),g._isIdle=!0))},g.onBlur=function(){g.onDragEnd()},g._allowClickEvent=function(){removeEvent(g._window,"click",g._onClick,!0)},g._onClick=function(e){g._allowClickEvent(),g._allowMouseEvent();var t=g.options.preventClickEventByCondition;null!=t&&t(e)||(e.stopPropagation(),e.preventDefault())},g._onContextMenu=function(e){g.options.preventRightClick?g.onDragEnd(e):e.preventDefault()},g._passCallback=function(){},[].concat(e)),i=e[0],i=(g._window=isWindow(i)?i:getWindow(i),g.options=__assign$6({checkInput:!1,container:!i||"document"in i?i:getWindow(i),preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},t),g.options),t=i.container,n=i.events,i=i.checkWindowBlur;return g._useDrag=-1<n.indexOf("drag"),g._useTouch=-1<n.indexOf("touch"),g._useMouse=-1<n.indexOf("mouse"),g.targets=e,g._useDrag&&e.forEach(function(e){addEvent(e,"dragstart",g.onDragStart)}),g._useMouse&&(e.forEach(function(e){addEvent(e,"mousedown",g.onDragStart),addEvent(e,"mousemove",g._passCallback)}),addEvent(t,"contextmenu",g._onContextMenu)),i&&addEvent(getWindow(),"blur",g.onBlur),g._useTouch&&(r={passive:!1},e.forEach(function(e){addEvent(e,"touchstart",g.onDragStart,r),addEvent(e,"touchmove",g._passCallback,r)})),g}return __extends$6(e,a),e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(e){return this.getCurrentStore().getMovement(e)+this.clientStores.slice(1).reduce(function(e,t){return e+t.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(e,t,r,i){void 0===i&&(i=!0),this.flag&&(this.clientStores[0].move(e,t),i)&&this.onDrag(r,!0)},e.prototype.move=function(e,t){var r=e[0],i=e[1],e=this.getCurrentStore().prevClients;return this.moveClients(e.map(function(e){var t=e.clientX,e=e.clientY;return{clientX:t+r,clientY:e+i,originalClientX:t,originalClientY:e}}),t,!0)},e.prototype.triggerDragStart=function(e){this.onDragStart(e,!1)},e.prototype.setEventData=function(e){var t,r=this.data;for(t in e)r[t]=e[t];return this},e.prototype.setEventDatas=function(e){return this.setEventData(e)},e.prototype.getCurrentEvent=function(e){return void 0===e&&(e=this._prevInputEvent),__assign$6(__assign$6({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var t=this,e=this.targets,r=this.options.container;this.off(),removeEvent(this._window,"blur",this.onBlur),this._useDrag&&e.forEach(function(e){removeEvent(e,"dragstart",t.onDragStart)}),this._useMouse&&(e.forEach(function(e){removeEvent(e,"mousedown",t.onDragStart)}),removeEvent(r,"contextmenu",this._onContextMenu)),this._useTouch&&(e.forEach(function(e){removeEvent(e,"touchstart",t.onDragStart)}),removeEvent(r,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(e){var t=this,r=this.options.pinchThreshold;this.isDrag&&this.getMovement()>r||(r=new ClientStore(getEventClients(e)),this.pinchFlag=!0,this._addStore(r),!1===this.emit("pinchStart",__assign$6(__assign$6({data:this.data,datas:this.data,angle:r.getAngle(),touches:this.getCurrentStore().getPositions()},r.getPosition()),{inputEvent:e,isTrusted:this._isTrusted,preventDefault:function(){e.preventDefault()},preventDrag:function(){t._dragFlag=!1}}))&&(this.pinchFlag=!1))},e.prototype.onPinch=function(e,t){var r;!this.flag||!this.pinchFlag||t.length<2||(r=this.getCurrentStore(),this.isPinch=!0,this.emit("pinch",__assign$6(__assign$6({data:this.data,datas:this.data,movement:this.getMovement(t),angle:r.getAngle(t),rotation:r.getRotation(t),touches:r.getPositions(t),scale:r.getScale(t),distance:r.getDistance(t)},r.getPosition(t)),{inputEvent:e,isTrusted:this._isTrusted})))},e.prototype.onPinchEnd=function(e){var t,r;this.pinchFlag&&(t=this.isPinch,this.isPinch=!1,this.pinchFlag=!1,r=this.getCurrentStore(),this.emit("pinchEnd",__assign$6(__assign$6({data:this.data,datas:this.data,isPinch:t,touches:r.getPositions()},r.getPosition()),{inputEvent:e})))},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(e,t,r){var r=this._getPosition(e,r),i=this.isDrag,n=((r.deltaX||r.deltaY)&&(this.isDrag=!0),!1);return!i&&this.isDrag&&(n=!0),__assign$6(__assign$6({data:this.data,datas:this.data},r),{movement:this.getMovement(e),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:t,isTrusted:this._isTrusted,isFirstDrag:n})},e.prototype._addStore=function(e){this.clientStores.splice(0,0,e)},e.prototype._getPosition=function(e,t){var e=this.getCurrentStore().getPosition(e,t),t=this.clientStores.slice(1).reduce(function(e,t){t=t.getPosition();return e.distX+=t.distX,e.distY+=t.distY,e},e),r=t.distX,t=t.distY;return __assign$6(__assign$6({},e),{distX:r,distY:t})},e.prototype._attchDragEvent=function(){var e=this._window,t=this.options.container,r={passive:!1};this._isDragAPI&&(addEvent(t,"dragover",this.onDrag,r),addEvent(e,"dragend",this.onDragEnd)),this._useMouse&&(addEvent(t,"mousemove",this.onDrag),addEvent(e,"mouseup",this.onDragEnd)),this._useTouch&&(addEvent(t,"touchmove",this.onDrag,r),addEvent(e,"touchend",this.onDragEnd,r),addEvent(e,"touchcancel",this.onDragEnd,r))},e.prototype._dettachDragEvent=function(){var e=this._window,t=this.options.container;this._isDragAPI&&(removeEvent(t,"dragover",this.onDrag),removeEvent(e,"dragend",this.onDragEnd)),this._useMouse&&(removeEvent(t,"mousemove",this.onDrag),removeEvent(e,"mouseup",this.onDragEnd)),this._useTouch&&(removeEvent(t,"touchstart",this.onDragStart),removeEvent(t,"touchmove",this.onDrag),removeEvent(e,"touchend",this.onDragEnd),removeEvent(e,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e})(EventEmitter$1);function prefixNames(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return e.map(function(e){return e.split(" ").map(function(e){return e?""+t+e:""}).join(" ")}).join(" ")}function prefixCSS(r,e){return e.replace(/([^}{]*){/gm,function(e,t){return t.replace(/\.([^{,\s\d.]+)/g,"."+r+"$1")+"{"})}function ref(t,r){return function(e){e&&(t[r]=e)}}function refs(t,r,i){return function(e){e&&(t[r][i]=e)}}function Properties(r,i){return function(e){var t=e.prototype;r.forEach(function(e){i(t,e)})}}function withMethods(e,r){return void 0===r&&(r={}),function(t,n){e.forEach(function(i){var e=r[i]||i;e in t||(t[e]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=(r=this[n])[i].apply(r,e);return r===this[n]?this:r})})}}var PolyMap=(()=>{function e(){this.keys=[],this.values=[]}var t=e.prototype;return t.get=function(e){return this.values[this.keys.indexOf(e)]},t.set=function(e,t){var r=this.keys,i=this.values,n=r.indexOf(e),n=-1===n?r.length:n;r[n]=e,i[n]=t},e})(),HashMap=(()=>{function e(){this.object={}}var t=e.prototype;return t.get=function(e){return this.object[e]},t.set=function(e,t){this.object[e]=t},e})(),SUPPORT_MAP="function"==typeof Map,Link=(()=>{function e(){}var t=e.prototype;return t.connect=function(e,t){this.prev=e,this.next=t,e&&(e.next=this),t&&(t.prev=this)},t.disconnect=function(){var e=this.prev,t=this.next;e&&(e.next=t),t&&(t.prev=e)},t.getIndex=function(){for(var e=this,t=-1;e;)e=e.prev,++t;return t},e})();function orderChanged(e,r){var n=[],a=[];return e.forEach(function(e){var t=e[0],e=e[1],r=new Link;a[e]=n[t]=r}),n.forEach(function(e,t){e.connect(n[t-1])}),e.filter(function(e,t){return!r[t]}).map(function(e,t){var r,i=e[0],e=e[1];return i===e?[0,0]:(e=a[e-1],r=(i=n[i]).getIndex(),i.disconnect(),e?i.connect(e,e.next):i.connect(void 0,n[0]),[r,i.getIndex()])})}var Result=(()=>{function e(e,t,r,i,n,a,s,o){this.prevList=e,this.list=t,this.added=r,this.removed=i,this.changed=n,this.maintained=a,this.changedBeforeAdded=s,this.fixed=o}var t=e.prototype;return Object.defineProperty(t,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),t.caculateOrdered=function(){var e=orderChanged(this.changedBeforeAdded,this.fixed),n=this.changed,a=[];this.cacheOrdered=e.filter(function(e,t){var r=e[0],t=n[t],i=t[0];if(r!==e[1])return a.push([i,t[1]]),!0}),this.cachePureChanged=a},e})();function diff$1(e,t,r){var i=SUPPORT_MAP?Map:r?HashMap:PolyMap,r=r||function(e){return e},n=[],a=[],s=[],o=e.map(r),r=t.map(r),l=new i,u=new i,c=[],h=[],d={},p=[],f=0,m=0;return o.forEach(function(e,t){l.set(e,t)}),r.forEach(function(e,t){u.set(e,t)}),o.forEach(function(e,t){e=u.get(e);void 0===e?(++m,a.push(t)):d[e]=m}),r.forEach(function(e,t){e=l.get(e);void 0===e?(n.push(t),++f):(s.push([e,t]),m=d[t]||0,c.push([e-m,t-f]),h.push(t===e),e!==t&&p.push([e,t]))}),a.reverse(),new Result(e,t,n,a,p,s,c,h)}var ListDiffer=(()=>{function e(e,t){void 0===e&&(e=[]),this.findKeyCallback=t,this.list=[].slice.call(e)}return e.prototype.update=function(e){var e=[].slice.call(e),t=diff$1(this.list,e,this.findKeyCallback);return this.list=e,t},e})(),extendStatics$5=function(e,t){return(extendStatics$5=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)};function __extends$5(e,t){function r(){this.constructor=e}extendStatics$5(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var findKeyCallback="function"==typeof Map?void 0:(()=>{var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}})(),ChildrenDiffer=(t=>{function e(e){return t.call(this,e=void 0===e?[]:e,findKeyCallback)||this}return __extends$5(e,t),e})(ListDiffer);function diff(e,t){return diff$1(e,t,findKeyCallback)}let ChildrenDiffer$1=ChildrenDiffer;var extendStatics$4=function(e,t){return(extendStatics$4=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}))(e,t)};function __extends$4(e,t){function r(){this.constructor=e}extendStatics$4(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign$5=function(){return(__assign$5=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function getDefaultScrollPosition$1(e){e=e.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function checkDefaultScrollEvent(e,t){return e.addEventListener("scroll",t),function(){e.removeEventListener("scroll",t)}}function getContainerElement(e){return e?isString(e)?document.querySelector(e):isFunction(e)?e():e instanceof Element?e:"current"in e?e.current:"value"in e?e.value:void 0:null}var DragScroll=(e=>{function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var t=r._currentOptions;!r._lock&&t&&r.emit("scrollDrag",{next:function(e){r.checkScroll({container:t.container,inputEvent:e})}})},r}__extends$4(t,e);var r=t.prototype;return r.dragStart=function(e,t){var r,i,n,a,s=getContainerElement(t.container);s?(a=n=i=r=0,a=s===document.body?(n=window.innerWidth,window.innerHeight):(r=(s=s.getBoundingClientRect()).top,i=s.left,n=s.width,s.height),this._flag=!0,this._startPos=[e.clientX,e.clientY],this._startRect={top:r,left:i,width:n,height:a},this._prevScrollPos=this._getScrollPosition([0,0],t),this._currentOptions=t,this._registerScrollEvent(t)):this._flag=!1},r.drag=function(e,t){var r,i,n,a,s,o;if(clearTimeout(this._timer),this._flag)return r=e.clientX,i=e.clientY,n=void 0===(n=t.threshold)?0:n,a=this._startRect,s=this._startPos,this._currentOptions=t,o=[0,0],a.top>i-n?(s[1]>a.top||i<s[1])&&(o[1]=-1):a.top+a.height<i+n&&(s[1]<a.top+a.height||i>s[1])&&(o[1]=1),r-n<a.left?(s[0]>a.left||r<s[0])&&(o[0]=-1):a.left+a.width<r+n&&(s[0]<a.left+a.width||r>s[0])&&(o[0]=1),!(!o[0]&&!o[1])&&this._continueDrag(__assign$5(__assign$5({},t),{direction:o,inputEvent:e,isDrag:!0}))},r.checkScroll=function(e){var t,r,i,n,a,s,o,l=this;return!(this._isWait||(s=void 0===(s=e.prevScrollPos)?this._prevScrollPos:s,t=void 0===(t=e.throttleTime)?0:t,r=e.inputEvent,i=e.isDrag,a=(n=this._getScrollPosition((o=e.direction)||[0,0],e))[0]-s[0],s=n[1]-s[1],o=o||[a?Math.abs(a)/a:0,s?Math.abs(s)/s:0],this._prevScrollPos=n,this._lock=!1,!a&&!s)||(this.emit("move",{offsetX:o[0]?a:0,offsetY:o[1]?s:0,inputEvent:r}),t&&i&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){l._continueDrag(e)},t)),0))},r.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},r._getScrollPosition=function(e,t){var r=t.container,t=t.getScrollPosition;return(void 0===t?getDefaultScrollPosition$1:t)({container:getContainerElement(r),direction:e})},r._continueDrag=function(e){var t=this,r=e.container,i=e.direction,n=e.throttleTime,a=e.useScroll,s=e.isDrag,o=e.inputEvent;if(!(!this._flag||s&&this._isWait)){var l=now(),n=Math.max(n+this._prevTime-l,0);if(0<n)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){t._continueDrag(e)},n),!1;this._prevTime=l;n=this._getScrollPosition(i,e),l=(this._prevScrollPos=n,s&&(this._isWait=!0),a||(this._lock=!0),{container:getContainerElement(r),direction:i,inputEvent:o});return null!=(s=e.requestScroll)&&s.call(e,l),this.emit("scroll",l),this._isWait=!1,a||this.checkScroll(__assign$5(__assign$5({},e),{prevScrollPos:n,direction:i,inputEvent:o}))}},r._registerScrollEvent=function(e){this._unregisterScrollEvent();var t,r=e.checkScrollEvent;r&&(t=!0===r?checkDefaultScrollEvent:r,e=getContainerElement(e.container),!0!==r||e!==document.body&&e!==document.documentElement?this._unregister=t(e,this._onScroll):this._unregister=checkDefaultScrollEvent(window,this._onScroll))},r._unregisterScrollEvent=function(){var e;null!=(e=this._unregister)&&e.call(this),this._unregister=null},t})(EventEmitter$1);let DragScroll$1=DragScroll;var extendStatics$3=function(e,t){return(extendStatics$3=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function __extends$3(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics$3(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var keycode=createCommonjsModule(function(e,t){function r(e){var t;return"number"==typeof(e=e&&"object"==typeof e&&(t=e.which||e.keyCode||e.charCode)?t:e)?o[e]:(t=String(e),i[t.toLowerCase()]||n[t.toLowerCase()]||(1===t.length?t.charCodeAt(0):void 0))}r.isEventKey=function(e,t){if(e&&"object"==typeof e){e=e.which||e.keyCode||e.charCode;if(null!=e)if("string"==typeof t){var r=i[t.toLowerCase()];if(r)return r===e;if(r=n[t.toLowerCase()])return r===e}else if("number"==typeof t)return t===e;return!1}};for(var i=(t=e.exports=r).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},n=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91},a=97;a<123;a++)i[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)i[a-48]=a;for(a=1;a<13;a++)i["f"+a]=a+111;for(a=0;a<10;a++)i["numpad "+a]=a+96;var s,o=t.names=t.title={};for(a in i)o[i[a]]=a;for(s in n)i[s]=n[s]}),keycode_4=(keycode.code,keycode.names),codeData={"+":"plus","left command":"meta","right command":"meta"},keysSort={shift:1,ctrl:2,alt:3,meta:4},globalKeyController;function getKey(e,t){var r,i=(keycode_4[e]||t||"").toLowerCase();for(r in codeData)i=i.replace(r,codeData[r]);return i.replace(/\s/g,"")}function getCombi(e,t){void 0===t&&(t=getKey(e.keyCode,e.key));e=getModifierCombi(e);return-1===e.indexOf(t)&&e.push(t),e.filter(Boolean)}function getModifierCombi(e){return[e.shiftKey&&"shift",e.ctrlKey&&"ctrl",e.altKey&&"alt",e.metaKey&&"meta"].filter(Boolean)}function getArrangeCombi(e){e=e.slice();return e.sort(function(e,t){return(keysSort[e]||5)-(keysSort[t]||5)}),e}var KeyController=(r=>{function e(e){void 0===e&&(e=window);var t=r.call(this)||this;return t.container=e,t.ctrlKey=!1,t.altKey=!1,t.shiftKey=!1,t.metaKey=!1,t.clear=function(){return t.ctrlKey=!1,t.altKey=!1,t.shiftKey=!1,t.metaKey=!1,t},t.keydownEvent=function(e){t.triggerEvent("keydown",e)},t.keyupEvent=function(e){t.triggerEvent("keyup",e)},t.blur=function(){t.clear(),t.trigger("blur")},addEvent(e,"blur",t.blur),addEvent(e,"keydown",t.keydownEvent),addEvent(e,"keyup",t.keyupEvent),t}__extends$3(e,r);var t=e.prototype;return Object.defineProperty(e,"global",{get:function(){return globalKeyController=globalKeyController||new e},enumerable:!1,configurable:!0}),e.setGlobal=function(){return this.global},t.destroy=function(){var e=this.container;this.clear(),this.off(),removeEvent(e,"blur",this.blur),removeEvent(e,"keydown",this.keydownEvent),removeEvent(e,"keyup",this.keyupEvent)},t.keydown=function(e,t){return this.addEvent("keydown",e,t)},t.offKeydown=function(e,t){return this.removeEvent("keydown",e,t)},t.offKeyup=function(e,t){return this.removeEvent("keyup",e,t)},t.keyup=function(e,t){return this.addEvent("keyup",e,t)},t.addEvent=function(e,t,r){return isArray(t)?this.on("".concat(e,".").concat(getArrangeCombi(t).join(".")),r):isString(t)?this.on("".concat(e,".").concat(t),r):this.on(e,t),this},t.removeEvent=function(e,t,r){return isArray(t)?this.off("".concat(e,".").concat(getArrangeCombi(t).join(".")),r):isString(t)?this.off("".concat(e,".").concat(t),r):this.off(e,t),this},t.triggerEvent=function(e,t){this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey;var r=getKey(t.keyCode,t.key),i={key:r,isToggle:"ctrl"===r||"shift"===r||"meta"===r||"alt"===r,inputEvent:t,keyCode:t.keyCode,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey},t=(this.trigger(e,i),this.trigger("".concat(e,".").concat(r),i),getCombi(t,r));1<t.length&&this.trigger("".concat(e,".").concat(t.join(".")),i)},e})(EventEmitter$1);let KeyController$1=KeyController;function __spreadArrays(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var a=arguments[t],s=0,o=a.length;s<o;s++,n++)i[n]=a[s];return i}function tinyThrottle(e){return throttle(e,TINY_NUM$1)}function isSameConstants(e,r){return e.every(function(e,t){return 0===tinyThrottle(e-r[t])})}function isSamePoint(e,t){return!tinyThrottle(e[0]-t[0])&&!tinyThrottle(e[1]-t[1])}function getAreaSize(r){return r.length<3?0:Math.abs(sum(r.map(function(e,t){t=r[t+1]||r[0];return e[0]*t[1]-t[0]*e[1]})))/2}function fitPoints(e,t){var r=t.width,i=t.height,n=t.left,a=t.top,t=getMinMaxs(e),s=t.minX,o=t.minY,l=r/(t.maxX-s),u=i/(t.maxY-o);return e.map(function(e){return[n+(e[0]-s)*l,a+(e[1]-o)*u]})}function getMinMaxs(e){var t=e.map(function(e){return e[0]}),e=e.map(function(e){return e[1]});return{minX:Math.min.apply(Math,t),minY:Math.min.apply(Math,e),maxX:Math.max.apply(Math,t),maxY:Math.max.apply(Math,e)}}function isInside(i,e,t){var n,a,s=i[0],o=i[1],r=getMinMaxs(e),l=[[r.minX,o],[r.maxX,o]],u=getLinearConstants(l[0],l[1]),r=convertLines(e),c=[];return r.forEach(function(e){var t=getLinearConstants(e[0],e[1]),r=e[0];isSameConstants(u,t)?c.push({pos:i,line:e,type:"line"}):getPointsOnLines(getIntersectionPointsByConstants(u,t),[l,e]).forEach(function(t){e.some(function(e){return isSamePoint(e,t)})?c.push({pos:t,line:e,type:"point"}):0!==tinyThrottle(r[1]-o)&&c.push({pos:t,line:e,type:"intersection"})})}),!(t||!find$1(c,function(e){return e[0]===s}))||(n=0,a={},c.forEach(function(e){var t=e.pos,r=e.type;t[0]>s||("intersection"===r?++n:"line"!==r&&"point"===r&&(r=find$1(e.line,function(e){return e[1]!==o}),e=a[t[0]],r=r[1]>o?1:-1,e?e!==r&&++n:a[t[0]]=r))}),n%2==1)}function getLinearConstants(e,t){var r=e[0],e=e[1],i=t[0]-r,t=t[1]-e,n=(Math.abs(i)<TINY_NUM$1&&(i=0),Math.abs(t)<TINY_NUM$1&&(t=0),0),a=0,s=0;return i?s=t?(a=1,-(n=-t/i)*r-e):(a=1,-e):t&&(n=-1,s=r),[n,a,s]}function getIntersectionPointsByConstants(e,t){var r,i,n=e[0],a=e[1],e=e[2],s=t[0],o=t[1],t=t[2],l=0===n&&0===s,u=0===a&&0===o;return l&&u?[]:l?(l=-e/a)!=-t/o?[]:[[-1/0,l],[1/0,l]]:u?(l=-e/n)!=-t/s?[]:[[l,-1/0],[l,1/0]]:(0===n?[[r=-(o*(i=-e/a)+t)/s,i]]:0===s?[[r=-(a*(i=-t/o)+e)/n,i]]:0===a?[[r=-e/n,i=-(s*r+t)/o]]:0===o?[[r=-t/s,i=-(n*r+e)/a]]:[[r=(a*t-o*e)/(o*n-a*s),i=-(n*r+e)/a]]).map(function(e){return[e[0],e[1]]})}function getPointsOnLines(e,t){var i=t.map(function(t){return[0,1].map(function(e){return[Math.min(t[0][e],t[1][e]),Math.max(t[0][e],t[1][e])]})}),t=[];if(2===e.length){var r=e[0],n=r[0],r=r[1];if(tinyThrottle(n-e[1][0])){if(!tinyThrottle(r-e[1][1])){var a=Math.max.apply(Math,i.map(function(e){return e[0][0]})),s=Math.min.apply(Math,i.map(function(e){return e[0][1]}));if(0<tinyThrottle(a-s))return[];t=[[a,r],[s,r]]}}else{a=Math.max.apply(Math,i.map(function(e){return e[1][0]})),s=Math.min.apply(Math,i.map(function(e){return e[1][1]}));if(0<tinyThrottle(a-s))return[];t=[[n,a],[n,s]]}}return(t=t.length?t:e.filter(function(e){var t=e[0],r=e[1];return i.every(function(e){return 0<=tinyThrottle(t-e[0][0])&&0<=tinyThrottle(e[0][1]-t)&&0<=tinyThrottle(r-e[1][0])&&0<=tinyThrottle(e[1][1]-r)})})).map(function(e){return[tinyThrottle(e[0]),tinyThrottle(e[1])]})}function convertLines(r){return __spreadArrays(r.slice(1),[r[0]]).map(function(e,t){return[r[t],e]})}function getOverlapPointInfos(e,t){var n=e.slice(),s=t.slice(),o=(-1===getShapeDirection(n)&&n.reverse(),-1===getShapeDirection(s)&&s.reverse(),convertLines(n)),l=convertLines(s),e=o.map(function(e){return getLinearConstants(e[0],e[1])}),u=l.map(function(e){return getLinearConstants(e[0],e[1])}),c=[],r=(e.forEach(function(r,i){var n=o[i],a=[];u.forEach(function(e,t){e=getPointsOnLines(getIntersectionPointsByConstants(r,e),[n,l[t]]);a.push.apply(a,e.map(function(e){return{index1:i,index2:t,pos:e,type:"intersection"}}))}),a.sort(function(e,t){return getDist$2(n[0],e.pos)-getDist$2(n[0],t.pos)}),c.push.apply(c,a),isInside(n[1],s)&&c.push({index1:i,index2:-1,pos:n[1],type:"inside"})}),l.forEach(function(e,t){var r,i;isInside(e[1],n)&&(r=!1,-1===(i=findIndex(c,function(e){return e.index2===t?!(r=!0):!!r}))&&(r=!1,i=findIndex(c,function(e){return-1===e.index1&&e.index2+1===t?!(r=!0):!!r})),-1===i?c.push({index1:-1,index2:t,pos:e[1],type:"inside"}):c.splice(i,0,{index1:-1,index2:t,pos:e[1],type:"inside"}))}),{});return c.filter(function(e){e=e.pos,e=e[0]+"x"+e[1];return!r[e]&&(r[e]=!0)})}function getOverlapPoints(e,t){return getOverlapPointInfos(e,t).map(function(e){return e.pos})}function getOverlapSize(e,t){return getAreaSize(getOverlapPoints(e,t))}function add(e,t,r,i,n,a){for(var s=0;s<n;++s){var o=r+s*n,l=i+s*n;e[o]+=e[l]*a,t[o]+=t[l]*a}}function swap(e,t,r,i,n){for(var a=0;a<n;++a){var s=r+a*n,o=i+a*n,l=e[s],u=t[s];e[s]=e[o],e[o]=l,t[s]=t[o],t[o]=u}}function divide(e,t,r,i,n){for(var a=0;a<i;++a){var s=r+a*i;e[s]/=n,t[s]/=n}}function ignoreDimension(e,t,r){void 0===r&&(r=Math.sqrt(e.length));for(var i=e.slice(),n=0;n<r;++n)i[n*r+t-1]=0,i[(t-1)*r+n]=0;return i[(t-1)*(r+1)]=1,i}function invert(e,t){void 0===t&&(t=Math.sqrt(e.length));for(var r=e.slice(),i=createIdentityMatrix(t),n=0;n<t;++n){var a=t*n+n;if(!throttle(r[a],TINY_NUM$1))for(var s=n+1;s<t;++s)if(r[t*n+s]){swap(r,i,n,s,t);break}if(!throttle(r[a],TINY_NUM$1))return[];divide(r,i,n,t,r[a]);for(s=0;s<t;++s){var o=s,l=r[s+n*t];throttle(l,TINY_NUM$1)&&n!==s&&add(r,i,o,n,t,-l)}}return i}function transpose(e,t){void 0===t&&(t=Math.sqrt(e.length));for(var r=[],i=0;i<t;++i)for(var n=0;n<t;++n)r[n*t+i]=e[t*i+n];return r}function getOrigin(e,t){for(var r=[],i=e[(t=void 0===t?Math.sqrt(e.length):t)*t-1],n=0;n<t-1;++n)r[n]=e[t*(t-1)+n]/i;return r[t-1]=0,r}function fromTranslation(e,t){for(var r=createIdentityMatrix(t),i=0;i<t-1;++i)r[t*(t-1)+i]=e[i]||0;return r}function convertPositionMatrix(e,t){for(var r=e.slice(),i=e.length;i<t-1;++i)r[i]=0;return r[t-1]=1,r}function convertDimension(e,t,r){if((t=void 0===t?Math.sqrt(e.length):t)===r)return e;for(var i=createIdentityMatrix(r),n=Math.min(t,r),a=0;a<n-1;++a){for(var s=0;s<n-1;++s)i[a*r+s]=e[a*t+s];i[(a+1)*r-1]=e[(a+1)*t-1],i[(r-1)*r+a]=e[(t-1)*t+a]}return i[r*r-1]=e[t*t-1],i}function multiplies(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var i=createIdentityMatrix(t);return e.forEach(function(e){i=multiply(i,e,t)}),i}function multiply(e,t,r){void 0===r&&(r=Math.sqrt(e.length));var i=[],n=e.length/r,a=t.length/n;if(!n)return t;if(!a)return e;for(var s=0;s<r;++s)for(var o=0;o<a;++o)for(var l=i[o*r+s]=0;l<n;++l)i[o*r+s]+=e[l*r+s]*t[o*n+l];return i}function plus(e,t){for(var r=Math.min(e.length,t.length),i=e.slice(),n=0;n<r;++n)i[n]=i[n]+t[n];return i}function minus(e,t){for(var r=Math.min(e.length,t.length),i=e.slice(),n=0;n<r;++n)i[n]=i[n]-t[n];return i}function convertCSStoMatrix(e,t){return(t=void 0===t?6===e.length:t)?[e[0],e[1],0,e[2],e[3],0,e[4],e[5],1]:e}function convertMatrixtoCSS(e,t){return(t=void 0===t?9===e.length:t)?[e[0],e[1],e[3],e[4],e[6],e[7]]:e}function calculate(e,t,r){var e=multiply(e,t,r=void 0===r?t.length:r),i=e[r-1];return e.map(function(e){return e/i})}function rotateX3d(e,t){return multiply(e,[1,0,0,0,0,Math.cos(t),Math.sin(t),0,0,-Math.sin(t),Math.cos(t),0,0,0,0,1],4)}function rotateY3d(e,t){return multiply(e,[Math.cos(t),0,-Math.sin(t),0,0,1,0,0,Math.sin(t),0,Math.cos(t),0,0,0,0,1],4)}function rotateZ3d(e,t){return multiply(e,createRotateMatrix(t,4))}function scale3d(e,t){var r=t[0],i=t[1],t=t[2];return multiply(e,[void 0===r?1:r,0,0,0,0,void 0===i?1:i,0,0,0,0,void 0===t?1:t,0,0,0,0,1],4)}function rotate(e,t){return calculate(createRotateMatrix(t,3),convertPositionMatrix(e,3))}function translate3d(e,t){var r=t[0],i=t[1],t=t[2];return multiply(e,[1,0,0,0,0,1,0,0,0,0,1,0,void 0===r?0:r,void 0===i?0:i,void 0===t?0:t,1],4)}function matrix3d(e,t){return multiply(e,t,4)}function createRotateMatrix(e,t){var r=Math.cos(e),e=Math.sin(e),i=createIdentityMatrix(t);return i[0]=r,i[1]=e,i[t]=-e,i[t+1]=r,i}function createIdentityMatrix(e){for(var t=e*e,r=[],i=0;i<t;++i)r[i]=i%(e+1)?0:1;return r}function createScaleMatrix(e,t){for(var r=createIdentityMatrix(t),i=Math.min(e.length,t-1),n=0;n<i;++n)r[(t+1)*n]=e[n];return r}function createOriginMatrix(e,t){for(var r=createIdentityMatrix(t),i=Math.min(e.length,t-1),n=0;n<i;++n)r[t*(t-1)+n]=e[n];return r}function createWarpMatrix(e,t,r,i,n,a,s,o){var l=e[0],e=e[1],u=t[0],t=t[1],c=r[0],r=r[1],h=i[0],i=i[1],d=n[0],n=n[1],p=a[0],a=a[1],f=s[0],s=s[1],m=o[0],o=o[1],l=invert([l,0,u,0,c,0,h,0,e,0,t,0,r,0,i,0,1,0,1,0,1,0,1,0,0,l,0,u,0,c,0,h,0,e,0,t,0,r,0,i,0,1,0,1,0,1,0,1,-d*l,-n*l,-p*u,-a*u,-f*c,-s*c,-m*h,-o*h,-d*e,-n*e,-p*t,-a*t,-f*r,-s*r,-m*i,-o*i],8);return l.length?((u=multiply(l,[d,n,p,a,f,s,m,o],8))[8]=1,convertDimension(transpose(u),3,4)):[]}var __assign$4=function(){return(__assign$4=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function createMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function parseMat(e,t){return toMat(parse(e,t=void 0===t?0:t))}function calculateMatrixDist(e,t){e=calculate(e,[t[0],t[1]||0,t[2]||0,1],4),t=e[3]||1;return[e[0]/t,e[1]/t,e[2]/t]}function getDistElementMatrix(e,t){void 0===t&&(t=document.body);for(var r=e,i=createMatrix();r;){i=matrix3d(parseMat(getComputedStyle(r).transform),i);if(r===t)break;r=r.parentElement}return(i=invert(i,4))[12]=0,i[13]=0,i[14]=0,i}function toMat(e){var r=createMatrix();return e.forEach(function(e){var t=e.matrixFunction;t&&(r=t(r,e.functionValue))}),r}function parse(e,u){return void 0===u&&(u=0),(isArray(e)?e:splitSpace(e)).map(function(e){var r,t,i,n,e=splitBracket(e),a=e.prefix,e=e.value,s=null,o=a,l="";return"translate"===a||"translateX"===a||"translate3d"===a?(r=isObject(u)?__assign$4(__assign$4({},u),{"o%":u["%"]}):{"%":u,"o%":u},s=translate3d,l=[(n=splitComma(e).map(function(e,t){return 0===t&&"x%"in r?r["%"]=u["x%"]:1===t&&"y%"in r?r["%"]=u["y%"]:r["%"]=u["o%"],convertUnitSize(e,r)}))[0],void 0===(t=n[1])?0:t,void 0===(t=n[2])?0:t]):"translateY"===a?(s=translate3d,l=[0,convertUnitSize(e,isObject(u)?__assign$4({"%":u["y%"]},u):{"%":u}),0]):"translateZ"===a?(s=translate3d,l=[0,0,parseFloat(e)]):"scale"===a||"scale3d"===a?(s=scale3d,l=[i=(n=splitComma(e).map(function(e){return parseFloat(e)}))[0],void 0===(t=n[1])?i:t,void 0===(t=n[2])?1:t]):"scaleX"===a?(s=scale3d,l=[i=parseFloat(e),1,1]):"scaleY"===a?(s=scale3d,l=[1,parseFloat(e),1]):"scaleZ"===a?(s=scale3d,l=[1,1,parseFloat(e)]):"rotate"===a||"rotateZ"===a||"rotateX"===a||"rotateY"===a?(t=(n=splitUnit(e)).unit,i=n.value,"rotate"===a||"rotateZ"===a?(o="rotateZ",s=rotateZ3d):"rotateX"===a?s=rotateX3d:"rotateY"===a&&(s=rotateY3d),l="rad"===t?i:i*Math.PI/180):"matrix3d"===a?(s=matrix3d,l=splitComma(e).map(function(e){return parseFloat(e)})):"matrix"===a?(s=matrix3d,l=[(n=splitComma(e).map(function(e){return parseFloat(e)}))[0],n[1],0,0,n[2],n[3],0,0,0,0,1,0,n[4],n[5],0,1]):o="",{name:a,functionName:o,value:e,matrixFunction:s,functionValue:l}})}function hash(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0}var stringHash=hash;function getHash(e){return stringHash(e).toString(36)}function getShadowRoot$1(e){if(e&&e.getRootNode){e=e.getRootNode();if(11===e.nodeType)return e}}function replaceStyle(r,e,t){return t.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,function(e,t){t=t.trim();return(t?splitComma(t):[""]).map(function(e){e=e.trim();return 0===e.indexOf("@")?e:-1<e.indexOf(":global")?e.replace(/\:global/g,""):-1<e.indexOf(":host")?"".concat(e.replace(/\:host/g,".".concat(r))):e?".".concat(r," ").concat(e):".".concat(r)}).join(", ")+" {"})}function injectStyle(e,t,r,i,n){var i=getDocument(i),a=i.createElement("style");return a.setAttribute("type","text/css"),a.setAttribute("data-styled-id",e),a.setAttribute("data-styled-count","1"),r.nonce&&a.setAttribute("nonce",r.nonce),a.innerHTML=replaceStyle(e,t,r),(n||i.head||i.body).appendChild(a),a}function styled$1(a){var s="rCS"+getHash(a);return{className:s,inject:function(e,t){void 0===t&&(t={});var r,i=getShadowRoot$1(e),n=(i||e.ownerDocument||document).querySelector('style[data-styled-id="'.concat(s,'"]'));return n?(r=parseFloat(n.getAttribute("data-styled-count"))||0,n.setAttribute("data-styled-count","".concat(r+1))):n=injectStyle(s,a,t,e,i),{destroy:function(){var e,t=parseFloat(n.getAttribute("data-styled-count"))||0;t<=1?(n.remove?n.remove():null!=(e=n.parentNode)&&e.removeChild(n),n=null):n.setAttribute("data-styled-count","".concat(t-1))}}}}}var extendStatics$2=function(e,t){return(extendStatics$2=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function __extends$2(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics$2(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign$3=function(){return(__assign$3=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __rest$2(e,t){var r={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function __decorate$2(e,t,r,i){var n,a=arguments.length,s=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;0<=o;o--)(n=e[o])&&(s=(a<3?n(s):3<a?n(t,r,s):n(t,r))||s);return 3<a&&s&&Object.defineProperty(t,r,s),s}function __spreadArray$1(e,t,r){if(r||2===arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||((i=i||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function getClient(e){var t;return"touches"in e?{clientX:(t=e.touches[0]||e.changedTouches[0]).clientX,clientY:t.clientY}:{clientX:e.clientX,clientY:e.clientY}}function filterDuplicated(r){var t;return"undefined"==typeof Map?r.filter(function(e,t){return r.indexOf(e)===t}):(t=new Map,r.filter(function(e){return!t.has(e)&&(t.set(e,!0),!0)}))}function elementFromPoint(e,t,r){e=getDocument(e);return e.elementFromPoint&&e.elementFromPoint(t,r)||null}function createElement(e,t,r){var i=e.tag,n=e.children,a=e.attributes,s=e.className,o=e.style,l=t||getDocument(r).createElement(i);for(c in a)l.setAttribute(c,a[c]);var u=l.children;if(n.forEach(function(e,t){createElement(e,u[t],l)}),s&&s.split(/\s+/g).forEach(function(e){e&&!hasClass(l,e)&&addClass(l,e)}),o){var c,h=l.style;for(c in o)h[c]=o[c]}return!t&&r&&r.appendChild(l),l}function h(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var t=t||{},n=t.className,a=t.style;return{tag:e,className:void 0===n?"":n,style:void 0===a?{}:a,attributes:__rest$2(t,["className","style"]),children:r}}function diffValue(e,t,r){e!==t&&r(e,t)}function getRect$1(e,t,r){void 0===r&&(r=e.data.boundArea);var i=e.distX,i=void 0===i?0:i,n=e.distY,n=void 0===n?0:n,e=e.data,a=e.startX,e=e.startY;0<t&&(i=(0<=i?1:-1)*(t*(s=Math.sqrt((i*i+n*n)/(1+t*t)))),n=(0<=n?1:-1)*s),i=(0<=i?1:-1)*(r=(s=calculateBoundSize([Math.abs(i),Math.abs(n)],[0,0],[i<0?a-r.left:r.right-a,n<0?e-r.top:r.bottom-e],!!t))[0]),n=(0<=n?1:-1)*(t=s[1]);var s=a+Math.min(0,i),a=e+Math.min(0,n);return{left:s,top:a,right:s+r,bottom:a+t,width:r,height:t}}function getDefaultElementRect(e){var e=e.getBoundingClientRect(),t=e.left,r=e.top,i=e.width,e=e.height;return{pos1:[t,r],pos2:[t+i,r],pos3:[t,r+e],pos4:[t+i,r+e]}}function passTargets(e,t,r){var e=diff(e,t),i=e.list,n=e.prevList,t=e.added,a=e.removed,e=e.maintained;return __spreadArray$1(__spreadArray$1(__spreadArray$1([],t.map(function(e){return i[e]}),!0),a.map(function(e){return n[e]}),!0),r?e.map(function(e){e=e[1];return i[e]}):[],!0)}function getLineSize(e){for(var t=0,r=e.length,i=1;i<r;++i)t=Math.max(getDist$2(e[i],e[i-1]),t);return t}var injector=styled$1("\n:host {\n    position: fixed;\n    display: none;\n    border: 1px solid #4af;\n    background: rgba(68, 170, 255, 0.5);\n    pointer-events: none;\n    will-change: transform;\n    z-index: 100;\n}\n"),CLASS_NAME="selecto-selection ".concat(injector.className),PROPERTIES=["className","boundContainer","selectableTargets","selectByClick","selectFromInside","continueSelect","continueSelectWithoutDeselect","toggleContinueSelect","toggleContinueSelectWithoutDeselect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio","getElementRect","preventDragFromInside","rootContainer","dragCondition","clickBySelectEnd","checkOverflow","innerScrollOptions"],OPTIONS=__spreadArray$1(["dragContainer","cspNonce","preventClickEventOnDrag","preventClickEventOnDragStart","preventRightClick"],PROPERTIES,!0),EVENTS=["dragStart","drag","dragEnd","selectStart","select","selectEnd","keydown","keyup","scroll","innerScroll"],METHODS=["clickTarget","getSelectableElements","setSelectedTargets","getElementPoints","getSelectedTargets","findSelectableTargets","triggerDragStart","checkScroll","selectTargetsByPoints","setSelectedTargetsByPoints"],Selecto$2=(r=>{function e(e){void 0===e&&(e={});var y=r.call(this)||this,t=(y.selectedTargets=[],y.dragScroll=new DragScroll$1,y._onDragStart=function(e,t){var r=e.data,i=e.clientX,n=e.clientY,a=e.inputEvent,s=y.options,o=s.selectFromInside,l=s.selectByClick,u=s.rootContainer,c=s.boundContainer,h=s.preventDragFromInside,h=void 0===h||h,d=s.clickBySelectEnd,s=s.dragCondition;if(!s||s(e)){r.data={};var s=getWindow(y.container),p=(r.innerWidth=s.innerWidth,r.innerHeight=s.innerHeight,y.findSelectableTargets(r),r.startSelectedTargets=y.selectedTargets,r.scaleMatrix=createMatrix(),r.containerX=0,r.containerY=0,y.container),s={left:-1/0,top:-1/0,right:1/0,bottom:1/0},f=(u&&(f=y.container.getBoundingClientRect(),r.containerX=f.left,r.containerY=f.top,r.scaleMatrix=getDistElementMatrix(y.container,u)),c&&(c=(f=isObject(c)&&"element"in c?__assign$3({left:!0,top:!0,bottom:!0,right:!0},c):{element:c,left:!0,top:!0,bottom:!0,right:!0}).element)&&(c=(isString(c)?getDocument(p).querySelector(c):!0===c?y.container:c).getBoundingClientRect(),f.left&&(s.left=c.left),f.top&&(s.top=c.top),f.right&&(s.right=c.right),f.bottom)&&(s.bottom=c.bottom),r.boundArea=s,{left:i,top:n,right:i,bottom:n,width:0,height:0}),c=[],s=l&&!d,m=!1,s=(o&&!s||(m=!!(t=y._findElement(t||a.target,r.selectableTargets)),s&&(c=t?[t]:[])),!o&&m);if(s&&!l)return e.stop(),!1;t=a.type;if(!(!(!e.isClick&&("mousedown"===t||"touchstart"===t))||y.emit("dragStart",__assign$3(__assign$3({},e),{data:r.data}))))return e.stop(),!1;if(y.continueSelect?(c=passTargets(y.selectedTargets,c,y.continueSelectWithoutDeselect),r.startPassedTargets=y.selectedTargets):r.startPassedTargets=[],y._select(c,f,e,!0,s&&l&&!d&&h),r.startX=i,r.startY=n,r.selectFlag=!1,r.preventDragFromInside=!1,a.target&&(o=calculateMatrixDist(r.scaleMatrix,[i-r.containerX,n-r.containerY]),y.target.style.cssText+="position: ".concat(u?"absolute":"fixed",";")+"left:0px;top:0px;"+"transform: translate(".concat(o[0],"px, ").concat(o[1],"px)")),s&&l&&!d)a.preventDefault(),h&&(y._selectEnd(r.startSelectedTargets,r.startPassedTargets,f,e,!0),r.preventDragFromInside=!0);else{r.selectFlag=!0;m=y.options,t=m.scrollOptions,c=m.innerScrollOptions,i=!1;if(c){for(var g=null,v=e.inputEvent.target;v&&v!==getDocument(p).body;){if("visible"!==getComputedStyle(v).overflow){g=v;break}v=v.parentElement}g&&(r.innerScrollOptions=__assign$3({container:g,checkScrollEvent:!0},!0===c?{}:c),y.dragScroll.dragStart(e,r.innerScrollOptions),i=!0)}!i&&t&&t.container&&y.dragScroll.dragStart(e,t),s&&l&&d&&(r.selectFlag=!1,e.preventDrag())}return!0}e.stop()},y._onDrag=function(e){if(e.data.selectFlag){var t=y.scrollOptions,r=e.data.innerScrollOptions;if((r||(null==t?void 0:t.container))&&!e.isScroll&&y.dragScroll.drag(e,r||t))return}y._checkSelected(e)},y._onDragEnd=function(e){var t=e.data,r=e.inputEvent,i=getRect$1(e,y.options.ratio),n=t.selectFlag,a=y.container;r&&y.emit("dragEnd",__assign$3(__assign$3({isDouble:!!e.isDouble,isClick:!!e.isClick,isDrag:!1,isSelect:n},e),{data:t.data,rect:i})),y.target.style.cssText+="display: none;",n?(t.selectFlag=!1,y.dragScroll.dragEnd()):y.selectByClick&&y.clickBySelectEnd&&(n=y._findElement((null==r?void 0:r.target)||elementFromPoint(a,e.clientX,e.clientY),t.selectableTargets),y._select(n?[n]:[],i,e)),t.preventDragFromInside||y._selectEnd(t.startSelectedTargets,t.startPassedTargets,i,e)},y._onKeyDown=function(e){var t,r=y.options,i=!1;y._keydownContinueSelect||(t=y._sameCombiKey(e,r.toggleContinueSelect),y._keydownContinueSelect=t,i=i||t),y._keydownContinueSelectWithoutDeselection||(t=y._sameCombiKey(e,r.toggleContinueSelectWithoutDeselect),y._keydownContinueSelectWithoutDeselection=t,i=i||t),i&&y.emit("keydown",{keydownContinueSelect:y._keydownContinueSelect,keydownContinueSelectWithoutDeselection:y._keydownContinueSelectWithoutDeselection})},y._onKeyUp=function(e){var t,r=y.options,i=!1;y._keydownContinueSelect&&(t=y._sameCombiKey(e,r.toggleContinueSelect,!0),y._keydownContinueSelect=!t,i=i||t),y._keydownContinueSelectWithoutDeselection&&(t=y._sameCombiKey(e,r.toggleContinueSelectWithoutDeselect,!0),y._keydownContinueSelectWithoutDeselection=!t,i=i||t),i&&y.emit("keyup",{keydownContinueSelect:y._keydownContinueSelect,keydownContinueSelectWithoutDeselection:y._keydownContinueSelectWithoutDeselection})},y._onBlur=function(){(y._keydownContinueSelect||y._keydownContinueSelectWithoutDeselection)&&(y._keydownContinueSelect=!1,y._keydownContinueSelectWithoutDeselection=!1,y.emit("keyup",{keydownContinueSelect:y._keydownContinueSelect,keydownContinueSelectWithoutDeselection:y._keydownContinueSelectWithoutDeselection}))},y._onDocumentSelectStart=function(t){var e,r,i=getDocument(y.container);y.gesto.isFlag()&&(i=isNode(e=(e=y.dragContainer)===getWindow(y.container)?i.documentElement:e)?[e]:[].slice.call(e),r=t.target,i.some(function(e){if(e===r||e.contains(r))return t.preventDefault(),!0}))},y.target=e.portalContainer,e.container),e=(y.options=__assign$3({className:"",portalContainer:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,clickBySelectEnd:!1,hitRate:100,continueSelect:!1,continueSelectWithoutDeselect:!1,toggleContinueSelect:null,toggleContinueSelectWithoutDeselect:null,keyContainer:null,scrollOptions:null,checkInput:!1,preventDefault:!1,boundContainer:!1,preventDragFromInside:!0,dragCondition:null,rootContainer:null,checkOverflow:!1,innerScrollOptions:!1,getElementRect:getDefaultElementRect,cspNonce:"",ratio:0},e),y.options.portalContainer);return e&&(t=e.parentElement),y.container=t||document.body,y.initElement(),y.initDragScroll(),y.setKeyController(),y}__extends$2(e,r);var t=e.prototype;return t.setSelectedTargets=function(e){var t=this.selectedTargets,r=diff(t,e),i=r.added,n=r.removed,a=r.prevList,s=r.list;return this.selectedTargets=e,{added:i.map(function(e){return s[e]}),removed:n.map(function(e){return a[e]}),beforeSelected:t,selected:e}},t.setSelectedTargetsByPoints=function(e,t){var r=Math.min(e[0],t[0]),i=Math.min(e[1],t[1]),n=Math.max(e[0],t[0]),e=Math.max(e[1],t[1]),t={left:r,top:i,right:n,bottom:e,width:n-r,height:e-i},n={ignoreClick:!0},r=(this.findSelectableTargets(n),this.hitTest(t,n,!0,null)),e=this.setSelectedTargets(r);return __assign$3(__assign$3({},e),{rect:t})},t.selectTargetsByPoints=function(e,t){var e=new MouseEvent("mousedown",{clientX:e[0],clientY:e[1],cancelable:!0,bubbles:!0}),r=new MouseEvent("mousemove",{clientX:t[0],clientY:t[1],cancelable:!0,bubbles:!0}),t=new MouseEvent("mousemove",{clientX:t[0],clientY:t[1],cancelable:!0,bubbles:!0}),i=this.gesto;!1!==i.onDragStart(e)&&(i.onDrag(r),i.onDragEnd(t))},t.getSelectedTargets=function(){return this.selectedTargets},t.triggerDragStart=function(e){return this.gesto.triggerDragStart(e),this},t.destroy=function(){var e;this.off(),this.keycon&&this.keycon.destroy(),this.gesto.unset(),this.injectResult.destroy(),this.dragScroll.dragEnd(),removeEvent(document,"selectstart",this._onDocumentSelectStart),this.options.portalContainer||null!=(e=this.target.parentElement)&&e.removeChild(this.target),this.keycon=null,this.gesto=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},t.getElementPoints=function(e){var t=this.getElementRect||getDefaultElementRect,r=t(e),r=[r.pos1,r.pos2,r.pos4,r.pos3];return t!==getDefaultElementRect?fitPoints(r,e.getBoundingClientRect()):r},t.getSelectableElements=function(){var r=this.container,i=[];return this.options.selectableTargets.forEach(function(e){var t;isFunction(e)?(t=e())&&i.push.apply(i,[].slice.call(t)):isNode(e)?i.push(e):isObject(e)?i.push(e.value||e.current):(t=[].slice.call(getDocument(r).querySelectorAll(e)),i.push.apply(i,t))}),i},t.checkScroll=function(){var e,t;this.gesto.isFlag()&&(e=this.scrollOptions,(t=this.gesto.getEventData().innerScrollOptions)||(null==e?void 0:e.container))&&this.dragScroll.checkScroll(__assign$3({inputEvent:this.gesto.getCurrentEvent()},t||e))},t.findSelectableTargets=function(e){var s,t=this,r=(void 0===e&&(e=this.gesto.getEventData()),this.getSelectableElements()),i=r.map(function(e){return t.getElementPoints(e)}),i=(e.selectableTargets=r,e.selectablePoints=i,e.selectableParentMap=null,this.options),n=i.checkOverflow||i.innerScrollOptions,o=getDocument(this.container);return n&&(s=new Map,e.selectableInnerScrollParentMap=s,e.selectableInnerScrollPathsList=r.map(function(e,r){for(var i=e.parentElement,n=[],a=[];i&&i!==o.body;)(()=>{var e,t=s.get(i);t||"visible"!==getComputedStyle(i).overflow&&(e=getDefaultElementRect(i),t={parentElement:i,indexes:[],points:[e.pos1,e.pos2,e.pos4,e.pos3],paths:__spreadArray$1([],a,!0)},n.push(i),n.forEach(function(e){s.set(e,t)}),n=[]),(t?(i=t.parentElement,s.get(i).indexes.push(r),a):n).push(i),i=i.parentElement})();return a})),i.checkOverflow||(e.selectableInners=r.map(function(){return!0})),this._refreshGroups(e),r},t.clickTarget=function(e,t){var r=getClient(e),r={data:{selectFlag:!1},clientX:r.clientX,clientY:r.clientY,inputEvent:e,isClick:!0,isTrusted:!1,stop:function(){return!1}};return this._onDragStart(r,t)&&this._onDragEnd(r),this},t.setKeyController=function(){var e=this.options,t=e.keyContainer,r=e.toggleContinueSelect,e=e.toggleContinueSelectWithoutDeselect;this.keycon&&(this.keycon.destroy(),this.keycon=null),(r||e)&&(this.keycon=new KeyController$1(t||getWindow(this.container)),this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on("blur",this._onBlur))},t.setClassName=function(e){this.options.className=e,this.target.setAttribute("class","".concat(CLASS_NAME," ").concat(e||""))},t.setKeyEvent=function(){var e=this.options;!e.toggleContinueSelect&&!e.toggleContinueSelectWithoutDeselect||this.keycon||this.setKeyController()},t.setKeyContainer=function(e){var t=this,r=this.options;diffValue(r.keyContainer,e,function(){r.keyContainer=e,t.setKeyController()})},t.getContinueSelect=function(){var e=this.options,t=e.continueSelect;return e.toggleContinueSelect&&this._keydownContinueSelect?!t:t},t.getContinueSelectWithoutDeselect=function(){var e=this.options,t=e.continueSelectWithoutDeselect;return e.toggleContinueSelectWithoutDeselect&&this._keydownContinueSelectWithoutDeselection?!t:t},t.setToggleContinueSelect=function(e){var t=this,r=this.options;diffValue(r.toggleContinueSelect,e,function(){r.toggleContinueSelect=e,t.setKeyEvent()})},t.setToggleContinueSelectWithoutDeselect=function(e){var t=this,r=this.options;diffValue(r.toggleContinueSelectWithoutDeselect,e,function(){r.toggleContinueSelectWithoutDeselect=e,t.setKeyEvent()})},t.setPreventDefault=function(e){this.gesto.options.preventDefault=e},t.setCheckInput=function(e){this.gesto.options.checkInput=e},t.initElement=function(){var e=this.options,t=e.dragContainer,r=e.checkInput,i=e.preventDefault,n=e.preventClickEventOnDragStart,a=e.preventClickEventOnDrag,s=e.preventClickEventByCondition,o=e.preventRightClick,o=void 0===o||o,e=e.className,l=this.container,e=(this.target=createElement(h("div",{className:"".concat(CLASS_NAME," ").concat(e||"")}),this.target,l),this.target);this.dragContainer="string"==typeof t?[].slice.call(getDocument(l).querySelectorAll(t)):t||this.target.parentNode,this.gesto=new Gesto(this.dragContainer,{checkWindowBlur:!0,container:getWindow(l),checkInput:r,preventDefault:i,preventClickEventOnDragStart:n,preventClickEventOnDrag:a,preventClickEventByCondition:s,preventRightClick:o}).on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd}),addEvent(document,"selectstart",this._onDocumentSelectStart),this.injectResult=injector.inject(e,{nonce:this.options.cspNonce})},t.hitTest=function(e,t,a,r){function i(e,t){var r,i,t=splitUnit("".concat("function"==typeof s?s(t):s)),n=!m&&isInside([p,f],e);return!(a||!o||!n)||!!(n=getOverlapPoints(g,e)).length&&((i=0)===(r=getAreaSize(n))&&0===getAreaSize(e)?(i=getLineSize(e),r=getLineSize(n)):i=getAreaSize(e),"px"===t.unit?r>=t.value:between(Math.round(r/i*100),0,100)>=Math.min(100,t.value))}var n=this.options,s=n.hitRate,o=n.selectByClick,n=e.left,l=e.top,u=e.right,e=e.bottom,c=t.innerGroups,h=t.innerWidth,d=t.innerHeight,p=null==r?void 0:r.clientX,f=null==r?void 0:r.clientY,m=t.ignoreClick,g=[[n,l],[u,l],[u,e],[n,e]],v=t.selectableTargets,y=t.selectablePoints,_=t.selectableInners;if(!c)return v.filter(function(e,t){return!!_[t]&&i(y[t],v[t])});for(var b=[],r=Math.floor(n/h),x=Math.floor(u/h),S=Math.floor(l/d),T=Math.floor(e/d),E=r;E<=x;++E){var C=c[E];if(C)for(var A=S;A<=T;++A){var w=C[A];w&&w.forEach(function(e){var t=y[e],r=_[e],e=v[e];r&&i(t,e)&&b.push(e)})}}return filterDuplicated(b)},t.initDragScroll=function(){var l=this;this.dragScroll.on("scrollDrag",function(e){(0,e.next)(l.gesto.getCurrentEvent())}).on("scroll",function(e){var t=e.container,e=e.direction;l.gesto.getEventData().innerScrollOptions?l.emit("innerScroll",{container:t,direction:e}):l.emit("scroll",{container:t,direction:e})}).on("move",function(e){var t,r,i,n,a=e.offsetX,s=e.offsetY,e=e.inputEvent,o=l.gesto;o&&o.isFlag()&&(o=(t=l.gesto.getEventData()).boundArea,t.startX-=a,t.startY-=s,r=!1,(n=null==(n=l.gesto.getEventData().innerScrollOptions)?void 0:n.container)&&(n=(i=t.selectableInnerScrollParentMap).get(n))&&(n.paths.forEach(function(e){i.get(e).points.forEach(function(e){e[0]-=a,e[1]-=s})}),n.indexes.forEach(function(e){t.selectablePoints[e].forEach(function(e){e[0]-=a,e[1]-=s})}),r=!0),r||t.selectablePoints.forEach(function(e){e.forEach(function(e){e[0]-=a,e[1]-=s})}),l._refreshGroups(t),o.left-=a,o.right-=a,o.top-=s,o.bottom-=s,l.gesto.scrollBy(a,s,e.inputEvent),l._checkSelected(l.gesto.getCurrentEvent()))})},t._select=function(e,t,r,i,n){void 0===n&&(n=!1);var a=r.inputEvent,s=r.data,o=this.setSelectedTargets(e),e=diff(s.startSelectedTargets,e),l=e.added,u=e.removed,c=e.prevList,h=e.list,e={startSelected:c,startAdded:l.map(function(e){return h[e]}),startRemoved:u.map(function(e){return c[e]})};i&&this.emit("selectStart",__assign$3(__assign$3(__assign$3({},o),e),{rect:t,inputEvent:a,data:s.data,isTrusted:r.isTrusted,isDragStartEnd:n})),(o.added.length||o.removed.length)&&this.emit("select",__assign$3(__assign$3(__assign$3({},o),e),{rect:t,inputEvent:a,data:s.data,isTrusted:r.isTrusted,isDragStartEnd:n}))},t._selectEnd=function(e,t,r,i,n){void 0===n&&(n=!1);var a=i.inputEvent,s=i.isDouble,o=i.data,l=a&&a.type,l="mousedown"===l||"touchstart"===l,u=diff(e,this.selectedTargets),c=u.added,h=u.removed,d=u.prevList,p=u.list,u=diff(t,this.selectedTargets),f=u.added,m=u.removed,g=u.prevList,v=u.list;this.emit("selectEnd",{startSelected:e,beforeSelected:t,selected:this.selectedTargets,added:c.map(function(e){return p[e]}),removed:h.map(function(e){return d[e]}),afterAdded:f.map(function(e){return v[e]}),afterRemoved:m.map(function(e){return g[e]}),isDragStart:l&&n,isDragStartEnd:l&&n,isClick:!!i.isClick,isDouble:!!s,rect:r,inputEvent:a,data:o.data,isTrusted:i.isTrusted})},t._checkSelected=function(e,t){void 0===t&&(t=getRect$1(e,this.options.ratio));var r=e.data,i=t.top,n=t.left,a=t.width,s=t.height,o=r.selectFlag,l=r.scaleMatrix,n=calculateMatrixDist(l,[n-r.containerX,i-r.containerY]),i=calculateMatrixDist(l,[a,s]),l=[];o&&(this.target.style.cssText+="display: block;left:0px;top:0px;"+"transform: translate(".concat(n[0],"px, ").concat(n[1],"px);")+"width:".concat(i[0],"px;height:").concat(i[1],"px;"),a=this.hitTest(t,r,!0,e),l=passTargets(r.startPassedTargets,a,this.continueSelect&&this.continueSelectWithoutDeselect)),!1===this.emit("drag",__assign$3(__assign$3({},e),{data:r.data,isSelect:o,rect:t}))?(this.target.style.cssText+="display: none;",e.stop()):o&&this._select(l,t,e)},t._sameCombiKey=function(e,t,r){var i,n;return!!t&&(i=getCombi(e.inputEvent,e.key),t=isArray((t=[].concat(t))[0])?t:[t],r?(n=e.key,t.some(function(e){return e.some(function(e){return e===n})})):t.some(function(e){return e.every(function(e){return-1<i.indexOf(e)})}))},t._findElement=function(e,t){for(var r=e;r&&!(-1<t.indexOf(r));)r=r.parentElement;return r},t._refreshGroups=function(e){var i,n,t,l,u=e.innerWidth,c=e.innerHeight,a=e.selectablePoints;this.options.checkOverflow&&(i=null==(t=this.gesto.getEventData().innerScrollOptions)?void 0:t.container,n=e.selectableInnerScrollParentMap,e.selectableInners=e.selectableInnerScrollPathsList.map(function(e,t){var r=!1;return e.every(function(e){if(!r){if(e===i)return r=!0;e=n.get(e);if(e)if(!getOverlapPoints(a[t],e.points).length)return!1}return!0})})),u&&c?(t=e.selectablePoints,l={},t.forEach(function(e,t){var r=1/0,i=-1/0,n=1/0,a=-1/0;e.forEach(function(e){var t=Math.floor(e[0]/u),e=Math.floor(e[1]/c);r=Math.min(t,r),i=Math.max(t,i),n=Math.min(e,n),a=Math.max(e,a)});for(var s=r;s<=i;++s)for(var o=n;o<=a;++o)l[s]=l[s]||{},l[s][o]=l[s][o]||[],l[s][o].push(t)}),e.innerGroups=l):e.innerGroups=null},__decorate$2([Properties(PROPERTIES,function(e,t){var r={enumerable:!0,configurable:!0,get:function(){return this.options[t]}},i=camelize("get ".concat(t)),n=(e[i]?r.get=function(){return this[i]()}:r.get=function(){return this.options[t]},camelize("set ".concat(t)));e[n]?r.set=function(e){this[n](e)}:r.set=function(e){this.options[t]=e},Object.defineProperty(e,t,r)})],e)})(EventEmitter$1),Selecto$1$1=(e=>{function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$2(t,e),t})(Selecto$2);let VanillaSelecto=Selecto$1$1;var extendStatics$1=function(e,t){return(extendStatics$1=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function __extends$1(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign$2=function(){return(__assign$2=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __decorate$1(e,t,r,i){var n,a=arguments.length,s=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;0<=o;o--)(n=e[o])&&(s=(a<3?n(s):3<a?n(t,r,s):n(t,r))||s);return 3<a&&s&&Object.defineProperty(t,r,s),s}var REACT_EVENTS=EVENTS.map(function(e){return camelize("on ".concat(e))}),Selecto=(e=>{function t(){return null!==e&&e.apply(this,arguments)||this}__extends$1(t,e);var r=t.prototype;return r.render=function(){return reactExports.createElement("div",{className:CLASS_NAME,ref:ref(this,"selectionElement")})},r.componentDidMount=function(){var i=this,t=this.props,r={};OPTIONS.forEach(function(e){e in t&&(r[e]=t[e])}),this.selecto=new VanillaSelecto(__assign$2(__assign$2({},r),{portalContainer:this.selectionElement})),EVENTS.forEach(function(e,r){i.selecto.on(e,function(e){var t=i.props;!1===(t[REACT_EVENTS[r]]&&t[REACT_EVENTS[r]](e))&&e.stop()})})},r.componentDidUpdate=function(t){var r=this.props,i=this.selecto;PROPERTIES.forEach(function(e){t[e]!==r[e]&&(i[e]=r[e])})},r.componentWillUnmount=function(){this.selecto.destroy()},__decorate$1([withMethods(METHODS)],t.prototype,"selecto",void 0),t})(reactExports.PureComponent);let Selecto$1=Selecto;function some(e,t){for(var r=e.length,i=0;i<r;++i)if(t(e[i],i))return!0;return!1}function find(e,t){for(var r=e.length,i=0;i<r;++i)if(t(e[i],i))return e[i];return null}function getUserAgentString(e){if(void 0===e){if("undefined"==typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function execRegExp(e,t){try{return new RegExp(e,"g").exec(t)}catch(e){return null}}function hasUserAgentData(){var e;return!!("undefined"!=typeof navigator&&navigator&&navigator.userAgentData&&(e=(e=navigator.userAgentData).brands||e.uaList)&&e.length)}function findVersion(e,t){e=execRegExp("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))",t);return e?e[3]:""}function convertVersion(e){return e.replace(/_/g,".")}function findPreset(e,r){var i=null,n="-1";return some(e,function(e){var t=execRegExp("("+e.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r);return!(!t||e.brand||(i=e,n=t[3]||"-1",e.versionAlias?n=e.versionAlias:e.versionTest&&(n=findVersion(e.versionTest.toLowerCase(),r)||n),n=convertVersion(n),0))}),{preset:i,version:n}}function findPresetBrand(e,r){var i={brand:"",version:"-1"};return some(e,function(e){var t=findBrand(r,e);return!!t&&(i.brand=e.id,i.version=e.versionAlias||t.version,"-1"!==i.version)}),i}function findBrand(e,t){return find(e,function(e){e=e.brand;return execRegExp(""+t.test,e.toLowerCase())})}var BROWSER_PRESETS=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],CHROMIUM_PRESETS=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],WEBKIT_PRESETS=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],WEBVIEW_PRESETS=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],OS_PRESETS=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function isWebView(e){return!!findPreset(WEBVIEW_PRESETS,e).preset}function getLegacyAgent(e){var e=getUserAgentString(e),t=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:isWebView(e),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},n=findPreset(BROWSER_PRESETS,e),a=n.preset,n=n.version,s=findPreset(OS_PRESETS,e),o=s.preset,s=s.version,l=findPreset(CHROMIUM_PRESETS,e);return r.chromium=!!l.preset,r.chromiumVersion=l.version,r.chromium||(l=findPreset(WEBKIT_PRESETS,e),r.webkit=!!l.preset,r.webkitVersion=l.version),o&&(i.name=o.id,i.version=s,i.majorVersion=parseInt(s,10)),a&&(r.name=a.id,r.version=n,r.webview)&&"ios"===i.name&&"safari"!==r.name&&(r.webview=!1),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:t,isHints:!1}}function getClientHintsAgent(e){var t=navigator.userAgentData,r=(t.uaList||t.brands).slice(),i=e&&e.fullVersionList,n=t.mobile||!1,a=r[0],s=(e&&e.platform||t.platform||navigator.platform).toLowerCase(),t={name:a.brand,version:a.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!findPresetBrand(WEBVIEW_PRESETS,r).brand||isWebView(getUserAgentString())},a={name:"unknown",version:"-1",majorVersion:-1},o=(t.webkit=!t.chromium&&some(WEBKIT_PRESETS,function(e){return findBrand(r,e)}),findPresetBrand(CHROMIUM_PRESETS,r)),o=(t.chromium=!!o.brand,t.chromiumVersion=o.version||"-1",t.chromium||(o=findPresetBrand(WEBKIT_PRESETS,r),t.webkit=!!o.brand,t.webkitVersion=o.version||"-1"),find(OS_PRESETS,function(e){return new RegExp(""+e.test,"g").exec(s)}));return a.name=o?o.id:"",e&&(a.version=e.platformVersion||"-1"),i&&i.length?(o=findPresetBrand(BROWSER_PRESETS,i),t.name=o.brand||t.name,t.version=o.version||t.version):(i=findPresetBrand(BROWSER_PRESETS,r),t.name=i.brand||t.name,t.version=i.brand&&e?e.uaFullVersion:i.version),t.webkit&&(a.name=n?"ios":"mac"),"ios"===a.name&&t.webview&&(t.version="-1"),a.version=convertVersion(a.version),t.version=convertVersion(t.version),a.majorVersion=parseInt(a.version,10),t.majorVersion=parseInt(t.version,10),{browser:t,os:a,isMobile:n,isHints:!0}}function agent$1(e){return void 0===e&&hasUserAgentData()?getClientHintsAgent():getLegacyAgent(e)}var __assign$1=function(){return(__assign$1=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __rest$1(e,t){var r={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function styled(a,e){var s=styled$1(e),o=s.className;return reactExports.forwardRef(function(t,e){var r=t.className,r=void 0===r?"":r,i=__rest$1(t,["className","cspNonce"]),n=reactExports.useRef();return reactExports.useImperativeHandle(e,function(){return n.current},[]),reactExports.useEffect(function(){var e=s.inject(n.current,{nonce:t.cspNonce});return function(){e.destroy()}},[]),reactExports.createElement(a,__assign$1({ref:n,"data-styled-id":o,className:"".concat(r," ").concat(o)},i))})}var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};function __extends(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __rest(e,t){var r={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function __decorate(e,t,r,i){var n,a=arguments.length,s=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;0<=o;o--)(n=e[o])&&(s=(a<3?n(s):3<a?n(t,r,s):n(t,r))||s);return 3<a&&s&&Object.defineProperty(t,r,s),s}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=a.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s}function __spreadArray(e,t,r){if(r||2===arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||((i=i||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function makeAble(e,t){return __assign({events:[],props:[],name:e},t)}var DIRECTIONS4=["n","w","s","e"],DIRECTIONS=["n","w","s","e","nw","ne","sw","se"];function getSVGCursor(e,t){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*e,'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(t,'deg);transform-origin: 16px 16px"></path></svg>')}function getCursorCSS(e){var t=getSVGCursor(1,e),e=45*Math.round(e/45)%180,r="ns-resize";return 135==e?r="nwse-resize":45==e?r="nesw-resize":90==e&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(t,"') 16 16, ").concat(r,";")}var agent=agent$1(),IS_WEBKIT=agent.browser.webkit,IS_WEBKIT605=IS_WEBKIT&&(()=>{var e="undefined"==typeof window?{userAgent:""}:window.navigator;return!!(e=/applewebkit\/([^\s]+)/g.exec(e.userAgent.toLowerCase()))&&parseFloat(e[1])<605})(),browserName=agent.browser.name,browserVersion=parseInt(agent.browser.version,10),IS_CHROME="chrome"===browserName,IS_CHROMIUM=agent.browser.chromium,chromiumVersion=parseInt(agent.browser.chromiumVersion,10)||0,IS_CHROMIUM109=IS_CHROME&&109<=browserVersion||IS_CHROMIUM&&109<=chromiumVersion,IS_FIREFOX="firefox"===browserName,IS_SAFARI_ABOVE15=612<=parseInt(agent.browser.webkitVersion,10)||15<=browserVersion,PREFIX="moveable-",directionCSS=DIRECTIONS.map(function(e){var t="",r="",i="center",n="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return-1<e.indexOf("n")&&(t="top: ".concat(a,";"),n="bottom"),-1<e.indexOf("s")&&(t="top: 0px;",n="top"),-1<e.indexOf("w")&&(r="left: ".concat(a,";"),i="right"),-1<e.indexOf("e")&&(r="left: 0px;",i="left"),'.around-control[data-direction*="'.concat(e,'"] {\n        ').concat(r).concat(t,"\n        transform-origin: ").concat(i," ").concat(n,";\n    }")}).join("\n"),MOVEABLE_CSS="\n{\nposition: absolute;\nwidth: 1px;\nheight: 1px;\nleft: 0;\ntop: 0;\nz-index: 3000;\n--moveable-color: #4af;\n--zoom: 1;\n--zoompx: 1px;\n--moveable-line-padding: 0;\n--moveable-control-padding: 0;\nwill-change: transform;\noutline: 1px solid transparent;\n}\n.control-box {\nz-index: 0;\n}\n.line, .control {\nposition: absolute;\nleft: 0;\ntop: 0;\nwill-change: transform;\n}\n.control {\nwidth: 14px;\nheight: 14px;\nborder-radius: 50%;\nborder: 2px solid #fff;\nbox-sizing: border-box;\nbackground: #4af;\nbackground: var(--moveable-color);\nmargin-top: -7px;\nmargin-left: -7px;\nborder: 2px solid #fff;\nz-index: 10;\n}\n.around-control {\nposition: absolute;\nwill-change: transform;\nwidth: calc(var(--moveable-control-padding, 20) * 1px);\nheight: calc(var(--moveable-control-padding, 20) * 1px);\nleft: calc(var(--moveable-control-padding, 20) * -0.5px);\ntop: calc(var(--moveable-control-padding, 20) * -0.5px);\nbox-sizing: border-box;\nbackground: transparent;\nz-index: 8;\ncursor: alias;\ntransform-origin: center center;\n}\n".concat(directionCSS,"\n.padding {\nposition: absolute;\ntop: 0px;\nleft: 0px;\nwidth: 100px;\nheight: 100px;\ntransform-origin: 0 0;\n}\n.line {\nwidth: 1px;\nheight: 1px;\nbackground: #4af;\nbackground: var(--moveable-color);\ntransform-origin: 0px 50%;\n}\n.line.edge {\nz-index: 1;\nbackground: transparent;\n}\n.line.dashed {\nbox-sizing: border-box;\nbackground: transparent;\n}\n.line.dashed.horizontal {\nborder-top: 1px dashed #4af;\nborder-top-color: #4af;\nborder-top-color: var(--moveable-color);\n}\n.line.dashed.vertical {\nborder-left: 1px dashed #4af;\nborder-left-color: #4af;\nborder-left-color: var(--moveable-color);\n}\n.line.vertical {\ntransform: translateX(-50%);\n}\n.line.horizontal {\ntransform: translateY(-50%);\n}\n.line.vertical.bold {\nwidth: 2px;\n}\n.line.horizontal.bold {\nheight: 2px;\n}\n\n.control.origin {\nborder-color: #f55;\nbackground: #fff;\nwidth: 12px;\nheight: 12px;\nmargin-top: -6px;\nmargin-left: -6px;\npointer-events: none;\n}\n").concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(e){return'\n.direction[data-rotation="'.concat(e,'"], :global .view-control-rotation').concat(e," {\n").concat(getCursorCSS(e),"\n}\n")}).join("\n"),'\n\n.line.direction:before {\ncontent: "";\nposition: absolute;\nwidth: 100%;\nheight: calc(var(--moveable-line-padding, 0) * 1px);\nbottom: 0;\nleft: 0;\n}\n.group {\nz-index: -1;\n}\n.area {\nposition: absolute;\n}\n.area-pieces {\nposition: absolute;\ntop: 0;\nleft: 0;\ndisplay: none;\n}\n.area.avoid, .area.pass {\npointer-events: none;\n}\n.area.avoid+.area-pieces {\ndisplay: block;\n}\n.area-piece {\nposition: absolute;\n}\n\n').concat(IS_WEBKIT605?':global svg *:before {\ncontent:"";\ntransform-origin: inherit;\n}':"","\n"),NEARBY_POS=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],FLOAT_POINT_NUM=1e-4,TINY_NUM=1e-7,MIN_SCALE=1e-9,MAX_NUM=Math.pow(10,10),MIN_NUM=-MAX_NUM,DIRECTION_REGION_TO_DIRECTION={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},DIRECTION_INDEXES={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},DIRECTION_ROTATIONS={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},MOVEABLE_METHODS=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function setCustomDrag(e,t,r,i,n,a){var r=null!=(s=null==(s=t.gestos[a=void 0===a?"draggable":a])?void 0:s.move(r,e.inputEvent))?s:{},s=r.originalDatas||r.datas,s=s[a]||(s[a]={});return __assign(__assign({},n?convertDragDist(t,r):r),{isPinch:!!i,parentEvent:!0,datas:s,originalDatas:e.originalDatas})}var CustomGesto=(()=>{function e(e){var t;this.ableName=e=void 0===e?"draggable":e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=((t={})[e]={},t)}return e.prototype.dragStart=function(e,t){this.isDrag=!1,this.isFlag=!1;var r=t.originalDatas;return(this.datas=r)[this.ableName]||(r[this.ableName]={}),__assign(__assign({},this.move(e,t.inputEvent)),{type:"dragstart"})},e.prototype.drag=function(e,t){return this.move([e[0]-this.prevX,e[1]-this.prevY],t)},e.prototype.move=function(e,t){var r,i,n,a=!1;return this.isFlag?(r=this.isDrag,i=this.prevX+e[0],n=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!r&&this.isDrag&&(a=!0)):(this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],i=e[0],n=e[1],this.isFlag=!0),{type:"drag",clientX:this.prevX=i,clientY:this.prevY=n,inputEvent:t,isFirstDrag:a,isDrag:this.isDrag,distX:i-this.startX,distY:n-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},e})();function calculateElementPosition(e,t,r,i){var n=16===e.length?4:3,r=__read(calculatePoses(e,r,i,n),4),i=__read(r[0],2),a=i[0],i=i[1],s=__read(r[1],2),o=s[0],s=s[1],l=__read(r[2],2),u=l[0],l=l[1],r=__read(r[3],2),c=r[0],r=r[1],t=__read(calculatePosition(e,t,n),2),h=t[0],t=t[1],d=Math.min(a,o,u,c),p=Math.min(i,s,l,r);return{left:d,top:p,right:Math.max(a,o,u,c),bottom:Math.max(i,s,l,r),origin:[h-d||0,t-p||0],pos1:[a-d||0,i-p||0],pos2:[o-d||0,s-p||0],pos3:[u-d||0,l-p||0],pos4:[c-d||0,r-p||0],direction:sign(e[0]*e[1+n])}}function calculatePointerDist(e,t){var r=t.clientX,i=t.datas,e=e.state,n=e.moveableClientRect,a=e.pos1,r=__read(minus(calculateInversePosition(e.rootMatrix,[r-n.left,t.clientY-n.top],e.is3d?4:3),a),2),t=__read(getDragDist({datas:i,distX:r[0],distY:r[1]}),2);return[t[0],t[1]]}function setDragStart(e,t){var t=t.datas,e=e.state,r=e.allMatrix,i=e.beforeMatrix,n=e.is3d,a=e.left,s=e.top,o=e.origin,l=e.offsetMatrix,u=e.targetMatrix,e=e.transformOrigin,c=n?4:3;t.is3d=n,t.matrix=r,t.targetMatrix=u,t.beforeMatrix=i,t.offsetMatrix=l,t.transformOrigin=e,t.inverseMatrix=invert(r,c),t.inverseBeforeMatrix=invert(i,c),t.absoluteOrigin=convertPositionMatrix(plus([a,s],o),c),t.startDragBeforeDist=calculate(t.inverseBeforeMatrix,t.absoluteOrigin,c),t.startDragDist=calculate(t.inverseMatrix,t.absoluteOrigin,c)}function getTransformDirection(e){return calculateElementPosition(e.datas.beforeTransform,[50,50],100,100).direction}function resolveTransformEvent(e,t,r){var i=t.datas,t=t.originalDatas.beforeRenderable,n=i.transformIndex,a=t.nextTransforms,s=a.length,o=t.nextTransformAppendedIndexes,l=-1,a=(-1===n?("translate"===r?l=0:"rotate"===r&&(l=findIndex(a,function(e){return e.match(/scale\(/g)})),-1===l&&(l=a.length),i.transformIndex=l):l=find$1(o,function(e){return e.index===n&&e.functionName===r})?n:n+o.filter(function(e){return e.index<n}).length,convertTransformInfo(a,e.state,l)),e=a.targetFunction,u="rotate"===r?"rotateZ":r;i.beforeFunctionTexts=a.beforeFunctionTexts,i.afterFunctionTexts=a.afterFunctionTexts,i.beforeTransform=a.beforeFunctionMatrix,i.beforeTransform2=a.beforeFunctionMatrix2,i.targetTansform=a.targetFunctionMatrix,i.afterTransform=a.afterFunctionMatrix,i.afterTransform2=a.afterFunctionMatrix2,i.targetAllTransform=a.allFunctionMatrix,e.functionName===u?(i.afterFunctionTexts.splice(0,1),i.isAppendTransform=!1):l<s&&(i.isAppendTransform=!0,t.nextTransformAppendedIndexes=__spreadArray(__spreadArray([],__read(o),!1),[{functionName:r,index:l,isAppend:!0}],!1))}function convertTransformFormat(e,t,r){return"".concat(e.beforeFunctionTexts.join(" ")," ").concat(e.isAppendTransform?r:t," ").concat(e.afterFunctionTexts.join(" "))}function getTransformDist(e){var t=e.datas,e=__read(getBeforeDragDist({datas:t,distX:e.distX,distY:e.distY}),2);return calculate(getTransfromMatrix(t,fromTranslation([e[0],e[1]],4)),convertPositionMatrix([0,0,0],4),4)}function getTransfromMatrix(e,t,r){var i=e.beforeTransform,n=e.afterTransform,a=e.beforeTransform2,s=e.afterTransform2,e=e.targetAllTransform,t=r?multiply(e,t,4):multiply(t,e,4),e=multiply(invert(r?a:i,4),t,4);return multiply(e,invert(r?s:n,4),4)}function getBeforeDragDist(e){var t=e.datas,r=t.inverseBeforeMatrix,i=t.startDragBeforeDist,n=t.is3d?4:3;return minus(calculate(r,plus(t.absoluteOrigin,[e.distX,e.distY]),n),i)}function getDragDist(e,t){var r=e.datas,i=r.inverseBeforeMatrix,n=r.startDragBeforeDist,a=r.startDragDist,s=r.is3d?4:3;return minus(calculate(t?i:r.inverseMatrix,plus(r.absoluteOrigin,[e.distX,e.distY]),s),t?n:a)}function getInverseDragDist(e,t){var r=e.datas,i=r.beforeMatrix,n=r.absoluteOrigin,a=r.is3d?4:3;return minus(calculate(t?i:r.matrix,plus(t?r.startDragBeforeDist:r.startDragDist,[e.distX,e.distY]),a),n)}function calculateTransformOrigin(e,s,o,l,u,c){return void 0===l&&(l=s),void 0===u&&(u=o),void 0===c&&(c=[0,0]),e?e.map(function(e,t){var r=splitUnit(e),i=r.value,r=r.unit,n=t?u:l,a=t?o:s;return"%"===e||isNaN(i)?a*(n?c[t]/n:0):"%"!==r?i:a*i/100}):c}function getPosIndexesByDirection(e){var t=[];return 0<=e[1]&&(0<=e[0]&&t.push(3),e[0]<=0)&&t.push(2),e[1]<=0&&(0<=e[0]&&t.push(1),e[0]<=0)&&t.push(0),t}function getPosesByDirection(t,e){return getPosIndexesByDirection(e).map(function(e){return t[e]})}function getPosByDirection(e,t){var r=(t[0]+1)/2,t=(t[1]+1)/2,i=[dot(e[0][0],e[1][0],r,1-r),dot(e[0][1],e[1][1],r,1-r)],e=[dot(e[2][0],e[3][0],r,1-r),dot(e[2][1],e[3][1],r,1-r)];return[dot(i[0],e[0],t,1-t),dot(i[1],e[1],t,1-t)]}function getDist(e,t,r,i,n,a){t=getPosByDirection(calculatePoses(t,r,i,n),a);return[e[0]-t[0],e[1]-t[1]]}function getNextMatrix(e,t,r,i){return multiply(e,getAbsoluteMatrix(t,i,r),i)}function getNextTransformMatrix(e,t,r,i){var n=e.transformOrigin,a=e.is3d?4:3;return getNextMatrix(e.offsetMatrix,isString(r)?(e=t.beforeTransform,t=t.afterTransform,convertDimension(i?parseMat(r):multiply(multiply(e,parseMat([r]),4),t,4),4,a)):r,n,a)}function scaleMatrix(e,t){var r=e.transformOrigin,i=e.is3d?4:3;return getNextMatrix(e.offsetMatrix,multiply(e.targetAllTransform||e.targetMatrix,createScaleMatrix(t,i),i),r,i)}function fillTransformStartEvent(r,i){var n=getBeforeRenderableDatas(i);return{setTransform:function(e,t){void 0===t&&(t=-1),n.startTransforms=isArray(e)?e:splitSpace(e),setTransformIndex(r,i,t)},setTransformIndex:function(e){setTransformIndex(r,i,e)}}}function setDefaultTransformIndex(e,t,r){setTransformIndex(e,t,findIndex(getBeforeRenderableDatas(t).startTransforms,function(e){return 0===e.indexOf("".concat(r,"("))}))}function setTransformIndex(e,t,r){var i,n=getBeforeRenderableDatas(t),t=t.datas;-1!==(t.transformIndex=r)&&(n=n.startTransforms[r])&&(i=e.state,r=parse([n],{"x%":function(e){return e/100*i.offsetWidth},"y%":function(e){return e/100*i.offsetHeight}}),t.startValue=r[0].functionValue)}function fillOriginalTransform(e,t){getBeforeRenderableDatas(e).nextTransforms=splitSpace(t)}function getBeforeRenderableDatas(e){return e.originalDatas.beforeRenderable}function getNextTransforms(e){return e.originalDatas.beforeRenderable.nextTransforms}function getNextTransformText(e){return(getNextTransforms(e)||[]).join(" ")}function getNextStyle(e){return getBeforeRenderableDatas(e).nextStyle}function fillTransformEvent(e,t,r,i,n){fillOriginalTransform(n,t);e=Draggable.drag(e,setCustomDrag(n,e.state,r,i,!1)),r=e?e.transform:t;return __assign(__assign({transform:t,drag:e},fillCSSObject({transform:r},n)),{afterTransform:r})}function getTranslateFixedPosition(e,t,r,i,n,a){return getDirectionOffset(e,r,i,getNextTransformMatrix(e.state,n,t,a))}function getTranslateDist(e,t,r,i,n,a,s){t=getTranslateFixedPosition(e,t,r,n,a,s),r=e.state,n=r.left,a=e.props.groupable,s=a?n:0,e=a?r.top:0,n=minus(i,t);return minus(n,[s,e])}function getScaleDist(e,t,r,i,n,a,s){return getTranslateDist(e,t,r,i,n,a,s)}function getDirectionByPos(e,t,r){return[t?e[0]/(t/2)-1:0,r?e[1]/(r/2)-1:0]}function getDirectionOffset(e,t,r,i){void 0===i&&(i=e.state.allMatrix);e=e.state;return calculatePosition(i,[e.width/2*(1+t[0])+r[0],e.height/2*(1+t[1])+r[1]],e.is3d?4:3)}function getRotateDist(e,t,r){var i=r.fixedDirection,n=r.fixedPosition,a=r.fixedOffset;return getTranslateDist(e,"rotate(".concat(t,"deg)"),i,n,a,r)}function getResizeDist(e,t,r,i,n,a){var s=e.props.groupable,e=e.state,o=e.transformOrigin,l=a.fixedDirection,u=e.is3d?4:3,c=s?e.left:0,s=s?e.top:0;return minus(getDist(i,getNextMatrix(e.offsetMatrix,a.nextTargetMatrix||e.targetMatrix,calculateTransformOrigin(n,t,r,e.width,e.height,o),u),t,r,u,l),[c,s])}function getAbsolutePosition(e,t){return getPosByDirection(getAbsolutePosesByState(e.state),t)}function getGestoData(e,t){var r,i=e.targetGesto,e=e.controlGesto;return(r=!(r=null!=i&&i.isFlag()?i.getEventData()[t]:r)&&null!=e&&e.isFlag()?e.getEventData()[t]:r)||{}}function getShadowRoot(e){if(e&&e.getRootNode){e=e.getRootNode();if(11===e.nodeType)return e}}function getIndividualTransforms(e){var t=e("scale"),r=e("rotate"),e=e("translate"),i=[];return e&&"0px"!==e&&"none"!==e&&i.push("translate(".concat(e.split(/\s+/).join(","),")")),r&&"1"!==r&&"none"!==r&&i.push("rotate(".concat(r,")")),t&&"1"!==t&&"none"!==t&&i.push("scale(".concat(t.split(/\s+/).join(","),")")),i}function getMatrixStackInfo(e,t,r){for(var i,n,a,s=e,o=[],l=getDocumentElement(e)||getDocumentBody(e),u=!r&&e===t||e===l,c=u,h=!1,d=3,p=!1,f=getOffsetInfo(t,t,!0).offsetParent,m=1;s&&!c;){var c=u,g=getCachedStyle(s),v=g("position"),y=getElementTransform(s),_="fixed"===v,b=getIndividualTransforms(g),y=convertCSStoMatrix(getTransformMatrix(y)),x=void 0,S=!1,T=!1,E=0,C=0,A=0,$=0,w={hasTransform:!1,fixedContainer:null},P=(_&&(p=!0,f=(w=getPositionFixedInfo(s)).fixedContainer),y.length),P=(h||16!==P&&!b.length||(h=!0,d=4,convert3DMatrixes(o),a=a&&convertDimension(a,3,4)),h&&9===P&&(y=convertDimension(y,3,4)),getOffsetPosInfo(s,e)),M=P.tagName,I=P.hasOffset,D=P.isSVG,R=P.origin,B=P.targetOrigin,P=__read(P.offset,2),k=P[0],P=P[1],M=("svg"===M&&a&&(o.push({type:"target",target:s,matrix:getSVGMatrix(s,d)}),o.push({type:"offset",target:s,matrix:createIdentityMatrix(d)})),parseFloat(g("zoom"))||1);if(_)x=w.fixedContainer,S=!0;else{var g=getOffsetInfo(s,t,!1,!0,g),O=g.offsetZoom,x=g.offsetParent,S=g.isEnd,T=g.isStatic;if(m*=O,(g.isCustomElement||1!==O)&&T)k-=x.offsetLeft,P-=x.offsetTop;else if(IS_FIREFOX||IS_CHROMIUM109)if(g.parentSlotElement){for(var F=x,L=0,N=0;F&&getShadowRoot(F);)L+=F.offsetLeft,N+=F.offsetTop,F=F.offsetParent;k-=L,P-=N}}if(!IS_WEBKIT||IS_SAFARI_ABOVE15||!I||D||!T||"relative"!==v&&"static"!==v||(k-=x.offsetLeft,P-=x.offsetTop,u=u||S),_?I&&w.hasTransform&&(A=x.clientLeft,$=x.clientTop):(I&&f!==x&&(E=x.clientLeft,C=x.clientTop),I&&x===l&&(k+=(O=getBodyOffset(s,!1))[0],P+=O[1])),o.push({type:"target",target:s,matrix:getAbsoluteMatrix(y,d,R)}),b.length&&(o.push({type:"offset",target:s,matrix:createIdentityMatrix(d)}),o.push({type:"target",target:s,matrix:getAbsoluteMatrix(parseMat(b),d,R)})),I?(D=(g=s===e)?0:s.scrollLeft,T=g?0:s.scrollTop,o.push({type:"offset",target:s,matrix:createOriginMatrix([k-D+E-A,P-T+C-$],d)})):o.push({type:"offset",target:s,origin:R}),1!==M&&o.push({type:"zoom",target:s,matrix:getAbsoluteMatrix(createScaleMatrix([M,M],d),d,[0,0])}),a=a||y,i=i||R,n=n||B,c||_)break;s=x,u=S,r&&s!==l||(c=u)}return{zoom:m,offsetContainer:f,matrixes:o,targetMatrix:a=a||createIdentityMatrix(d),transformOrigin:i=i||[0,0],targetOrigin:n=n||[0,0],is3d:h,hasFixed:p}}var cacheStyleMap=null,clientRectStyleMap=null,matrixContainerInfos=null;function setStoreCache(e){e?(window.Map&&(cacheStyleMap=new Map,clientRectStyleMap=new Map),matrixContainerInfos=[]):clientRectStyleMap=matrixContainerInfos=cacheStyleMap=null}function getCachedClientRect(e){var t=null==clientRectStyleMap?void 0:clientRectStyleMap.get(e);return t||(t=getClientRect(e,!0),clientRectStyleMap&&clientRectStyleMap.set(e,t),t)}function getCachedMatrixContainerInfo(t,r){if(matrixContainerInfos){var e=find$1(matrixContainerInfos,function(e){return e[0][0]==t&&e[0][1]==r});if(e)return e[1]}e=getMatrixStackInfo(t,r,!0);return matrixContainerInfos&&matrixContainerInfos.push([[t,r],e]),e}function getCachedStyle(e){var t=null==cacheStyleMap?void 0:cacheStyleMap.get(e);if(!t){var r=getWindow(e).getComputedStyle(e);if(!cacheStyleMap)return function(e){return r[e]};cacheStyleMap.set(e,t={style:r,cached:{}})}var i=t.cached,n=t.style;return function(e){return e in i||(i[e]=n[e]),i[e]}}function fillChildEvents(e,r,i){var t=i.originalDatas,t=(t.groupable=t.groupable||{},t.groupable),n=(t.childDatas=t.childDatas||[],t.childDatas);return e.moveables.map(function(e,t){return n[t]=n[t]||{},n[t][r]=n[t][r]||{},__assign(__assign({},i),{isRequestChild:!0,datas:n[t][r],originalDatas:n[t]})})}function triggerChildGesto(e,s,o,l,t,u,c){var h=!!o.match(/Start$/g),d=!!o.match(/End$/g),p=t.isPinch,f=t.datas,t=fillChildEvents(e,s.name,t),m=e.moveables,e=t.map(function(e,t){var r=m[t],i=r.state,n=i.gestos,a=e;if(h)a=new CustomGesto(c).dragStart(l,e);else{if(n[c]||(n[c]=f.childGestos[t]),!n[c])return;a=setCustomDrag(e,i,l,p,u,c)}t=s[o](r,__assign(__assign({},a),{parentFlag:!0}));return d&&(n[c]=null),t});return h&&(f.childGestos=m.map(function(e){return e.state.gestos[c]})),e}function triggerChildAbles(e,n,a,t,s,o){void 0===s&&(s=function(e,t){return t});var l=!!a.match(/End$/g),t=fillChildEvents(e,n.name,t),u=e.moveables;return t.map(function(e,t){var r=u[t],i=s(r,e),i=n[a](r,__assign(__assign({},i),{parentFlag:!0}));return i&&o&&o(r,e,i,t),l&&(r.state.gestos={}),i})}function startChildDist(e,t,r,i){var n=r.fixedDirection,r=r.fixedPosition,t=getPosByDirection(i.datas.startPositions||getAbsolutePosesByState(t.state),n),n=__read(calculate(createRotateMatrix(-e.rotation/180*Math.PI,3),[t[0]-r[0],t[1]-r[1],1],3),2),e=n[0],t=n[1];return i.datas.originalX=e,i.datas.originalY=t,i}function renderDirectionControlsByInfos(e,s,t,o){var r=e.getState(),l=r.renderPoses,u=r.rotation,r=r.direction,c=getProps(e.props,s).zoom,h=absDegree(u/Math.PI*180),d={},e=e.renderState,p=(e.renderDirectionMap||(e.renderDirectionMap={}),e.renderDirectionMap),f=(t.forEach(function(e){e=e.dir;d[e]=!0}),sign(r));return t.map(function(e){var t=e.data,r=e.classNames,e=e.dir,i=DIRECTION_INDEXES[e];if(!i||!d[e])return null;p[e]=!0;var n=(throttle(h,15)+f*DIRECTION_ROTATIONS[e]+720)%180,a={};return getKeys(t).forEach(function(e){a["data-".concat(e)]=t[e]}),o.createElement("div",__assign({className:prefix.apply(void 0,__spreadArray(["control","direction",e,s],__read(r),!1)),"data-rotation":n,"data-direction":e},a,{key:"direction-".concat(e),style:getControlTransform.apply(void 0,__spreadArray([u,c],__read(i.map(function(e){return l[e]})),!1))}))})}function renderDirectionControls(e,t,r,i){var n=getProps(e.props,r),a=n.renderDirections,t=void 0===a?t:a;return t?(a=!0===t?DIRECTIONS:t,__spreadArray(__spreadArray([],__read(n.displayAroundControls?renderAroundControls(e,i,r,a):[]),!1),__read(renderDirectionControlsByInfos(e,r,a.map(function(e){return{data:{},classNames:[],dir:e}}),i)),!1)):[]}function renderLine(e,t,r,i,n,a){for(var s=[],o=6;o<arguments.length;o++)s[o-6]=arguments[o];var l=getRad$1(r,i),u=t?throttle(l/Math.PI*180,15)%180:-1;return e.createElement("div",{key:"line-".concat(a),className:prefix.apply(void 0,__spreadArray(["line","direction",t?"edge":"",t],__read(s),!1)),"data-rotation":u,"data-line-key":a,"data-direction":t,style:getLineStyle(r,i,n,l)})}function renderEdgeLines(n,a,e,s,o){return(!0===e?DIRECTIONS4:e).map(function(e,t){var r=__read(DIRECTION_INDEXES[e],2),i=r[0],r=r[1];if(null!=r)return renderLine(n,e,s[i],s[r],o,"".concat(a,"Edge").concat(t),a)}).filter(Boolean)}function getRenderDirections(i){return function(e,t){var r=getProps(e.props,i).edge;return r&&(!0===r||r.length)?__spreadArray(__spreadArray([],__read(renderEdgeLines(t,i,r,e.getState().renderPoses,e.props.zoom)),!1),__read(renderDiagonalDirections(e,i,t)),!1):renderAllDirections(e,i,t)}}function renderAllDirections(e,t,r){return renderDirectionControls(e,DIRECTIONS,t,r)}function renderDiagonalDirections(e,t,r){return renderDirectionControls(e,["nw","ne","sw","se"],t,r)}function renderAroundControls(e,n,a,t){var r=e.renderState,i=(r.renderDirectionMap||(r.renderDirectionMap={}),e.getState()),s=i.renderPoses,o=i.rotation,r=r.renderDirectionMap,l=e.props.zoom,u=sign(i.direction),c=o/Math.PI*180;return(t||getKeys(r)).map(function(e){var t,r,i=DIRECTION_INDEXES[e];return i?(t=(throttle(c,15)+u*DIRECTION_ROTATIONS[e]+720)%180,r=["around-control"],a&&r.push("direction",a),n.createElement("div",{className:prefix.apply(void 0,__spreadArray([],__read(r),!1)),"data-rotation":t,"data-direction":e,key:"direction-around-".concat(e),style:getControlTransform.apply(void 0,__spreadArray([o,l],__read(i.map(function(e){return s[e]})),!1))})):null})}function checkBoundPoses(e,t,r){var e=e||{},i=e.position,n=e.left,a=e.top,s=e.right,e=e.bottom,i={position:void 0===i?"client":i,left:void 0===n?-1/0:n,top:void 0===a?-1/0:a,right:void 0===s?1/0:s,bottom:void 0===e?1/0:e};return{vertical:checkBounds(i,t,!0),horizontal:checkBounds(i,r,!1)}}function getBounds(e,t){var r=e.state,i=r.containerClientRect,n=i.clientHeight,a=i.clientLeft,s=i.clientTop,r=r.snapOffset,o=r.left,l=r.top,t=t||e.props.bounds||{},e="css"===(t.position||"client"),u=t.left,c=t.top,h=t.right,h=void 0===h?e?-1/0:1/0:h,t=t.bottom,t=void 0===t?e?-1/0:1/0:t;return e&&(h=i.clientWidth+r.right-o-h,t=n+r.bottom-l-t),{left:(void 0===u?-1/0:u)+o-a,right:h+o-a,top:(void 0===c?-1/0:c)+l-s,bottom:t+l-s}}function checkBoundKeepRatio(e,t,r){var i,n,e=getBounds(e),a=e.left,s=e.top,o=e.right,e=e.bottom,l=__read(r,2),u=l[0],l=l[1],t=__read(minus(r,t),2),c=t[0],t=t[1],h=(abs(c)<TINY_NUM&&(c=0),0<(t=abs(t)<TINY_NUM?0:t)),d=0<c,p={isBound:!1,offset:0,pos:0},f={isBound:!1,offset:0,pos:0};return 0===c&&0===t||(0===c?h?e<l&&(f.pos=e,f.offset=l-e):l<s&&(f.pos=s,f.offset=l-s):0===t?d?o<u&&(p.pos=o,p.offset=u-o):u<a&&(p.pos=a,p.offset=u-a):(t=r[1]-(r=t/c)*u,i=c=0,n=!1,d&&o<=u?(c=r*o+t,i=o,n=!0):!d&&u<=a&&(c=r*a+t,i=a,n=!0),(n=n&&(c<s||e<c)?!1:n)||(h&&e<=l?(i=((c=e)-t)/r,n=!0):!h&&l<=s&&(i=((c=s)-t)/r,n=!0)),n&&(p.isBound=!0,p.pos=i,p.offset=u-i,f.isBound=!0,f.pos=c,f.offset=l-c))),{vertical:p,horizontal:f}}function checkBounds(e,t,r){var i=e[r?"left":"top"],e=e[r?"right":"bottom"],r=Math.min.apply(Math,__spreadArray([],__read(t),!1)),t=Math.max.apply(Math,__spreadArray([],__read(t),!1)),n=[];return r<i+1&&n.push({direction:"start",isBound:!0,offset:r-i,pos:i}),e-1<t&&n.push({direction:"end",isBound:!0,offset:t-e,pos:e}),n.length||n.push({isBound:!1,offset:0,pos:0}),n.sort(function(e,t){return abs(t.offset)-abs(e.offset)})}function isBoundRotate$1(e,t,r){return(r?e.map(function(e){return rotate(e,r)}):e).some(function(e){return e[0]<t.left&&.1<abs(e[0]-t.left)||e[0]>t.right&&.1<abs(e[0]-t.right)||e[1]<t.top&&.1<abs(e[1]-t.top)||e[1]>t.bottom&&.1<abs(e[1]-t.bottom)})}function boundRotate(r,t,i){var e=getDistSize(r),e=Math.sqrt(e*e-t*t)||0;return[e,-e].sort(function(e,t){return abs(e-r[i?0:1])-abs(t-r[i?0:1])}).map(function(e){return getRad$1([0,0],i?[e,t]:[t,e])})}function checkRotateBounds(e,n,t,r,i){var a,s,o,l,u;return e.props.bounds&&(a=i*Math.PI/180,e=(i=getBounds(e)).left-r[0],s=i.right-r[0],o=i.top-r[1],i=i.bottom-r[1],isBoundRotate$1(t,l={left:e,top:o,right:s,bottom:i},0))?(u=[],[[e,0],[s,0],[o,1],[i,1]].forEach(function(e){var e=__read(e,2),r=e[0],i=e[1];t.forEach(function(e){var t=getRad$1([0,0],e);u.push.apply(u,__spreadArray([],__read(boundRotate(e,r,i).map(function(e){return a+e-t}).filter(function(e){return!isBoundRotate$1(n,l,e)}).map(function(e){return throttle(180*e/Math.PI,TINY_NUM)})),!1))})}),u):[]}var VERTICAL_NAMES=["left","right","center"],HORIZONTAL_NAMES=["top","bottom","middle"],SNAP_SKIP_NAMES_MAP={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},VERTICAL_NAMES_MAP={start:"left",end:"right",center:"center"},HORIZONTAL_NAMES_MAP={start:"top",end:"bottom",center:"middle"};function getInitialBounds(){return{left:!1,top:!1,right:!1,bottom:!1}}function hasGuidelines(e,t){var r=e.props,i=r.snappable,n=r.bounds,a=r.innerBounds,s=r.verticalGuidelines,o=r.horizontalGuidelines,l=r.snapGridWidth,r=r.snapGridHeight,e=e.state,u=e.guidelines;return!(!i||!e.enableSnap||t&&!0!==i&&i.indexOf(t)<0||!(l||r||n||a||u&&u.length||s&&s.length||o&&o.length))}function getSnapDirections(e){return!1===e?{}:!0!==e&&e?e:{left:!0,right:!0,top:!0,bottom:!0}}function mapSnapDirectionPoses(e,t){var r,i=getSnapDirections(e),n={};for(r in i)r in t&&i[r]&&(n[r]=t[r]);return n}function splitSnapDirectionPoses(e,t){var r=mapSnapDirectionPoses(e,t),e=HORIZONTAL_NAMES.filter(function(e){return e in r}),t=VERTICAL_NAMES.filter(function(e){return e in r});return{horizontalNames:e,verticalNames:t,horizontal:e.map(function(e){return r[e]}),vertical:t.map(function(e){return r[e]})}}function calculateContainerPos(e,t,r){e=calculatePosition(e,[t.clientLeft,t.clientTop],r);return[t.left+e[0],t.top+e[1]]}function solveLineConstants(e){var e=__read(e,2),t=e[0],e=e[1],r=e[0]-t[0],e=e[1]-t[1],i=(Math.abs(r)<TINY_NUM$1&&(r=0),Math.abs(e)<TINY_NUM$1&&(e=0),0),n=0,a=0,a=r?e?(i=-e/r)*t[0]-t[n=1]:-t[n=1]:(i=-1,t[0]);return[i,n,a].map(function(e){return throttle(e,TINY_NUM$1)})}function checkMoveableSnapPoses(e,t,r,i,n,a){void 0===i&&(i=[]),void 0===n&&(n=[]);a=selectValue(a,e.props.snapThreshold,5);return checkSnapPoses(e.state.guidelines,t,r,i,n,a)}function checkSnapPoses(e,t,r,i,n,a){return{vertical:checkSnap(e,"vertical",t,a,i),horizontal:checkSnap(e,"horizontal",r,a,n)}}function checkSnapKeepRatio(e,t,r){var i,n,a,s,o,l=__read(r,2),u=l[0],l=l[1],c=__read(t,2),h=c[0],d=c[1],c=__read(minus(r,t),2),t=c[0],p=0<(c=c[1]),f=0<t,t=getTinyDist(t),c=getTinyDist(c),m={isSnap:!1,offset:0,pos:0},g={isSnap:!1,offset:0,pos:0};return 0===t&&0===c||(s=(e=checkMoveableSnapPoses(e,t?[u]:[],c?[l]:[])).vertical,e=e.horizontal,s.posInfos.filter(function(e){e=e.pos;return f?h<=e:e<=h}),e.posInfos.filter(function(e){e=e.pos;return p?d<=e:e<=d}),s.isSnap=0<s.posInfos.length,e.isSnap=0<e.posInfos.length,i=(s=getNearestSnapGuidelineInfo(s)).isSnap,s=s.guideline,n=(e=getNearestSnapGuidelineInfo(e)).isSnap,e=e.guideline,a=n?e.pos[1]:0,s=i?s.pos[0]:0,0===t?n&&(g.isSnap=!0,g.pos=e.pos[1],g.offset=l-g.pos):0===c?i&&(m.isSnap=!0,m.pos=s,m.offset=u-s):(r=r[1]-(e=c/t)*u,t=c=0,o=!1,i?(c=e*(t=s)+r,o=!0):n&&(t=((c=a)-r)/e,o=!0),o&&(m.isSnap=!0,m.pos=t,m.offset=u-t,g.isSnap=!0,g.pos=c,g.offset=l-c))),{vertical:m,horizontal:g}}function getStringDirection(e){var t="";return-1===e||"top"===e||"left"===e?t="start":0===e||"center"===e||"middle"===e?t="center":1!==e&&"right"!==e&&"bottom"!==e||(t="end"),t}function checkSnaps(e,t,r){t=splitSnapDirectionPoses(e.props.snapDirections,t),e=checkMoveableSnapPoses(e,t.vertical,t.horizontal,t.verticalNames.map(function(e){return getStringDirection(e)}),t.horizontalNames.map(function(e){return getStringDirection(e)}),r),r=getStringDirection(t.horizontalNames[e.horizontal.index]),t=getStringDirection(t.verticalNames[e.vertical.index]);return{vertical:__assign(__assign({},e.vertical),{direction:t}),horizontal:__assign(__assign({},e.horizontal),{direction:r})}}function getNearestSnapGuidelineInfo(e){var t=e.isSnap;return t?{isSnap:t,offset:(e=(t=e.posInfos[0]).guidelineInfos[0]).offset,dist:e.dist,pos:t.pos,guideline:e.guideline}:{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null}}function checkSnap(n,a,e,s,o){var l,t;return void 0===o&&(o=[]),n&&n.length?(l="vertical"===a?0:1,{isSnap:t=0<(e=e.map(function(r,e){var i=o[e]||"",t=n.map(function(e){var t=e.pos,t=r-t[l];return{offset:t,dist:abs(t),guideline:e,direction:i}}).filter(function(e){return!(e.guideline.type!==a||s<e.dist)}).sort(function(e,t){return e.dist-t.dist});return{pos:r,index:e,guidelineInfos:t,direction:i}}).filter(function(e){return 0<e.guidelineInfos.length}).sort(function(e,t){return e.guidelineInfos[0].dist-t.guidelineInfos[0].dist})).length,index:t?e[0].index:-1,direction:null!=(t=null==(t=e[0])?void 0:t.direction)?t:"",posInfos:e}):{isSnap:!1,index:-1,direction:"",posInfos:[]}}function getSnapInfosByDirection(e,t,r,i){void 0===i&&(i=1);var n=[],r=(r[0]&&r[1]?n=[r,[-r[0],r[1]],[r[0],-r[1]]]:r[0]||r[1]?e.props.keepRatio?n.push([-1,-1],[-1,1],[1,-1],[1,1],r):(n.push.apply(n,__spreadArray([],__read(getPosesByDirection([[-1,-1],[1,-1],[-1,-1],[1,1]],r)),!1)),1<n.length&&n.push([(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2])):[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(e,t,r){t=r[t+1]||r[0];n.push(e),n.push([(e[0]+t[0])/2,(e[1]+t[1])/2])}),n.map(function(e){return getPosByDirection(t,e)})),e=checkMoveableSnapPoses(e,r.map(function(e){return e[0]}),r.map(function(e){return e[1]}),n.map(function(e){return getStringDirection(e[0])}),n.map(function(e){return getStringDirection(e[1])}),i),r=getStringDirection(n.map(function(e){return e[0]})[e.vertical.index]),i=getStringDirection(n.map(function(e){return e[1]})[e.horizontal.index]);return{vertical:__assign(__assign({},e.vertical),{direction:r}),horizontal:__assign(__assign({},e.horizontal),{direction:i})}}function checkSnapBoundPriority(e,t){var r=abs(e.offset),i=abs(t.offset);return e.isBound&&t.isBound?i-r:e.isBound?-1:t.isBound?1:e.isSnap&&t.isSnap?i-r:e.isSnap?-1:t.isSnap||r<TINY_NUM?1:i<TINY_NUM?-1:r-i}function getNearOffsetInfo(e,s){return e.slice().sort(function(e,t){var r=e.sign[s],i=t.sign[s],n=e.offset[s],a=t.offset[s];return r?i?checkSnapBoundPriority({isBound:e.isBound,isSnap:e.isSnap,offset:n},{isBound:t.isBound,isSnap:t.isSnap,offset:a}):-1:1})[0]}function getCheckSnapDirections(t,r,e){var i,n=[];return e?(1!==abs(r[0])||1!==abs(r[1])?n.push([r,[-1,-1]],[r,[-1,1]],[r,[1,-1]],[r,[1,1]]):n.push([r,[t[0],-t[1]]],[r,[-t[0],t[1]]]),n.push([r,t])):t[0]&&t[1]||!t[0]&&!t[1]?(i=t[0]?t:[1,1],[1,-1].forEach(function(t){[1,-1].forEach(function(e){e=[t*i[0],e*i[1]];r[0]===e[0]&&r[1]===e[1]||n.push([r,e])})})):t[0]?(1===abs(r[0])?[1]:[1,-1]).forEach(function(e){n.push([[r[0],-1],[e*t[0],-1]],[[r[0],0],[e*t[0],0]],[[r[0],1],[e*t[0],1]])}):t[1]&&(1===abs(r[1])?[1]:[1,-1]).forEach(function(e){n.push([[-1,r[1]],[-1,e*t[1]]],[[0,r[1]],[0,e*t[1]]],[[1,r[1]],[1,e*t[1]]])}),n}function isStartLine(e,t){var r=average([t[0][0],t[1][0]]),t=average([t[0][1],t[1][1]]);return{vertical:r<=e[0],horizontal:t<=e[1]}}function hitTestLine(e,t){var r,t=__read(t,2),i=t[0],t=t[1],n=t[0]-i[0],t=t[1]-i[1];return abs(n)<TINY_NUM&&(n=0),abs(t)<TINY_NUM&&(t=0),t=n?(r=t?t/n*(e[0]-i[0])+i[1]:i[1],e[1]):(r=i[0],e[0]),r-t}function isSameStartLine(e,t,r,i){return void 0===i&&(i=TINY_NUM),e.every(function(e){e=hitTestLine(e,t);return e<=0===r||abs(e)<=i})}function checkInnerBoundDot(e,t,r,i,n){return void 0===n&&(n=0),i&&t-n<=e||!i&&e<=r+n?{isBound:!0,offset:i?t-e:r-e}:{isBound:!1,offset:0}}function checkInnerBound(e,t){var r,i,n,a,s,o,l,u=t.line,c=t.verticalSign,h=t.horizontalSign,d=t.lineConstants,e=e.props.innerBounds;return!e||(o=[[r=e.left,i=e.top],[r,i+(n=e.height)]],a=[[r,i],[r+(e=e.width),i]],l=[[r+e,i],[r+e,i+n]],s=[[r,i+n],[r+e,i+n]],isSameStartLine([[r,i],[r+e,i],[r,i+n],[r+e,i+n]],u,t.centerSign))?{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]}:(r=checkLineBoundCollision(u,d,a,c),e=checkLineBoundCollision(u,d,s,c),i=checkLineBoundCollision(u,d,o,h),n=checkLineBoundCollision(u,d,l,h),t=r.isBound&&e.isBound,a=r.isBound||e.isBound,s=i.isBound&&n.isBound,c=i.isBound||n.isBound,o=maxOffset(r.offset,e.offset),d=!(u=[0,0]),{isAllBound:abs(l=maxOffset(i.offset,n.offset))<abs(o)?(u=[o,0],d=a,t):(u=[0,l],d=c,s),isVerticalBound:a,isHorizontalBound:c,isBound:d,offset:u})}function checkLineBoundCollision(e,t,r,i,n,a){var s,o,t=__read(t,2),l=t[0],t=t[1],e=e[0],u=r[0],r=r[1],c=getTinyDist(r[1]-u[1]),h=t,d=l,l=-l/t;return getTinyDist(r[0]-u[0])?c||a&&!h?{isBound:!1,offset:0}:d?checkInnerBoundDot((u[1]-e[1])/l+e[0],u[0],r[0],i,n):{isBound:o=abs(s=u[1]-e[1])<=(n||0),offset:o?s:0}:a&&!d?{isBound:!1,offset:0}:h?checkInnerBoundDot(l*(u[0]-e[0])+e[1],u[1],r[1],i,n):{isBound:o=abs(s=u[0]-e[0])<=(n||0),offset:o?s:0}}function getInnerBoundInfo(s,e,o){return e.map(function(e){var t=checkInnerBound(s,e),r=t.isBound,i=t.offset,n=t.isVerticalBound,t=t.isHorizontalBound,a=e.multiple,e=getDragDist({datas:o,distX:i[0],distY:i[1]}).map(function(e,t){return e*(a[t]?2/a[t]:0)});return{sign:a,isBound:r,isVerticalBound:n,isHorizontalBound:t,isSnap:!1,offset:e}})}function getInnerBoundDragInfo(e,t,r){var e=getInnerBoundInfo(e,getCheckInnerBoundLineInfos(e,t,[0,0],!1).map(function(e){return __assign(__assign({},e),{multiple:e.multiple.map(function(e){return 2*abs(e)})})}),r),t=getNearOffsetInfo(e,0),e=getNearOffsetInfo(e,1),i=0,n=0,a=t.isVerticalBound||e.isVerticalBound,s=t.isHorizontalBound||e.isHorizontalBound;return(a||s)&&(i=(r=__read(getInverseDragDist({datas:r,distX:-t.offset[0],distY:-e.offset[1]}),2))[0],n=r[1]),{vertical:{isBound:a,offset:i},horizontal:{isBound:s,offset:n}}}function getCheckSnapLineDirections(e,t){var r=[],i=e[0],n=e[1];return i&&n?r.push([[0,2*n],e,[-i,n]],[[2*i,0],e,[i,-n]]):i?(r.push([[2*i,0],[i,1],[i,-1]]),t&&r.push([[0,-1],[i,-1],[-i,-1]],[[0,1],[i,1],[-i,1]])):n?(r.push([[0,2*n],[1,n],[-1,n]]),t&&r.push([[-1,0],[-1,n],[-1,-n]],[[1,0],[1,n],[1,-n]])):r.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),r}function getCheckInnerBoundLineInfos(e,o,t,r){var e=e.state,l=calculatePoses(e.allMatrix,100,100,e.is3d?4:3),u=getPosByDirection(l,[0,0]);return getCheckSnapLineDirections(t,r).map(function(e){var e=__read(e,3),t=e[0],r=e[1],e=e[2],i=[getPosByDirection(l,r),getPosByDirection(l,e)],n=solveLineConstants(i),a=isStartLine(u,i),s=a.vertical,a=a.horizontal;return{multiple:t,centerSign:hitTestLine(u,i)<=0,verticalSign:s,horizontalSign:a,lineConstants:n,line:[getPosByDirection(o,r),getPosByDirection(o,e)]}})}function isBoundRotate(e,r,i,t){e=t?e.map(function(e){return rotate(e,t)}):e;return[[e[0],e[1]],[e[1],e[3]],[e[3],e[2]],[e[2],e[0]]].some(function(e){var t=hitTestLine(i,e)<=0;return!isSameStartLine(r,e,t)})}function getDistPointLine(e){var e=__read(e,2),t=e[0],e=e[1],r=e[0]-t[0],e=e[1]-t[1];return abs(r?e?(-(e=e/r)*t[0]+t[1])/Math.sqrt(Math.pow(e,2)+1):t[1]:t[0])}function solveReverseLine(e){var e=__read(e,2),t=e[0],e=e[1],r=e[0]-t[0],e=e[1]-t[1];return r?e?[-(r=-(e=e/r)*t[0]+t[1])/(e+1/e),r/(e*e+1)]:[0,t[1]]:[t[0],0]}function checkRotateInnerBounds(e,t,r,i,n){var a,s,o,l,u,c,e=e.props.innerBounds,h=n*Math.PI/180;return e&&(a=(n=e.left)-i[0],n=n+e.width-i[0],e=(s=e.top)+e.height-i[1],o=[[a,s=s-i[1]],[n,s],[a,e],[n,e]],l=getPosByDirection(r,[0,0]),isBoundRotate(r,o,l,0))?(u=[],c=o.map(function(e){return[getDistSize(e),getRad$1([0,0],e)]}),[[r[0],r[1]],[r[1],r[3]],[r[3],r[2]],[r[2],r[0]]].forEach(function(e){var r=getRad$1([0,0],solveReverseLine(e)),i=getDistPointLine(e);u.push.apply(u,__spreadArray([],__read(c.filter(function(e){e=__read(e,1)[0];return e&&i<=e}).map(function(e){var e=__read(e,2),t=e[0],e=e[1],t=Math.acos(t?i/t:0);return[h+(e+t)-r,h+(e-t)-r]}).reduce(function(e,t){return e.push.apply(e,__spreadArray([],__read(t),!1)),e},[]).filter(function(e){return!isBoundRotate(t,o,l,e)}).map(function(e){return throttle(180*e/Math.PI,TINY_NUM)})),!1))}),u):[]}function checkInnerBoundPoses(e){var t,s,o,l,u,c,h,d,p,f,m,g,r=e.props.innerBounds,v=getInitialBounds();return r?(t=[(t=e.getRect()).pos1,t.pos2,t.pos3,t.pos4],s=getPosByDirection(t,[0,0]),o=r.left,l=r.top,u=r.width,c=r.height,h=[[o,l],[o,l+c]],d=[[o,l],[o+u,l]],p=[[o+u,l],[o+u,l+c]],r=getCheckInnerBoundLineInfos(e,t,[0,0],!(f=[[o,l+c],[o+u,l+c]])),m=[],g=[],r.forEach(function(e){var t=e.line,e=e.lineConstants,r=isStartLine(s,t),i=r.horizontal,r=r.vertical,n=checkLineBoundCollision(t,e,d,r,1,!0),r=checkLineBoundCollision(t,e,f,r,1,!0),a=checkLineBoundCollision(t,e,h,i,1,!0),t=checkLineBoundCollision(t,e,p,i,1,!0);n.isBound&&!v.top&&(m.push(l),v.top=!0),r.isBound&&!v.bottom&&(m.push(l+c),v.bottom=!0),a.isBound&&!v.left&&(g.push(o),v.left=!0),t.isBound&&!v.right&&(g.push(o+u),v.right=!0)}),{boundMap:v,horizontal:m,vertical:g}):{boundMap:v,vertical:[],horizontal:[]}}function solveEquation(e,t,r,i){var n=t[0]-e[0],a=t[1]-e[1];return abs(n)<TINY_NUM$1&&(n=0),abs(a)<TINY_NUM$1&&(a=0),n?a?(n=e[1]-(a=a/n)*e[0],i?[r,a*(t[0]+r)+n-t[1]]:[(t[1]+r-n)/a-t[0],r]):i?[r,0]:[0,0]:i?[0,0]:[0,r]}function solveNextOffset(e,t,r,i,n){r=solveEquation(e,t,r,i);return r?(i=getDist$2(e,t),e=getDist$2(r,e),t=getDist$2(r,t),e=i<e||i<t,{offset:[(i=__read(getDragDist({datas:n,distX:r[0],distY:r[1]}),2))[0],i[1]],isOutside:e}):{isOutside:!1,offset:[0,0]}}function getSnapBound(e,t){return e.isBound?e.offset:t.isSnap?getNearestSnapGuidelineInfo(t).offset:0}function checkThrottleDragRotate(e,t,r,i,n){var a,s,t=__read(t,2),o=t[0],l=t[1],t=__read(r,2),r=t[0],t=t[1],i=__read(i,2),u=i[0],i=i[1],n=__read(n,2),c=n[0],n=n[1],h=-c,d=-n;return e&&o&&l?(d=h=0,a=[],r&&t?a.push([0,n],[c,0]):r?a.push([c,0]):t?a.push([0,n]):u&&i?a.push([0,n],[c,0]):u?a.push([c,0]):i&&a.push([0,n]),a.length&&(a.sort(function(e,t){return getDistSize(minus([o,l],e))-getDistSize(minus([o,l],t))}),(u=a[0])[0]&&abs(o)>TINY_NUM$1?(h=-u[0],d=l*abs(o+h)/abs(o)-l):u[1]&&abs(l)>TINY_NUM$1&&(d=-u[1],h=o*abs((i=l)+d)/abs(i)-o),e)&&t&&r&&(abs(h)>TINY_NUM$1&&abs(h)<abs(c)?(h*=s=abs(c)/abs(h),d*=s):abs(d)>TINY_NUM$1&&abs(d)<abs(n)?(h*=s=abs(n)/abs(d),d*=s):(h=maxOffset(-c,h),d=maxOffset(-n,d)))):(h=o||r?-c:0,d=l||t?-n:0),[h,d]}function checkSnapBoundsDrag(e,t,r,i,n,a){var s,o,l,u,c,h;return hasGuidelines(e,"draggable")?(s=(l=getRect(c=getAbsolutePoses(a.absolutePoses,[t,r]))).left,o=l.right,h=l.top,l=l.bottom,u={horizontal:c.map(function(e){return e[1]}),vertical:c.map(function(e){return e[0]})},s=(n=checkMoveableSnapBounds(e,n,splitSnapDirectionPoses(getSnapDirections(e.props.snapDirections),{left:s,right:o,top:h,bottom:l,center:(s+o)/2,middle:(h+l)/2}),u)).vertical,o=n.horizontal,l=(h=getInnerBoundDragInfo(e,c,a)).vertical,u=h.horizontal,n=s.isSnap,e=o.isSnap,[{isBound:c=s.isBound||l.isBound,isSnap:n,offset:(h=__read(checkThrottleDragRotate(i,[t,r],[c,a=o.isBound||u.isBound],[n,e],[maxOffset(s.offset,l.offset),maxOffset(o.offset,u.offset)]),2))[0]},{isBound:a,isSnap:e,offset:h[1]}]):[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}]}function checkMoveableSnapBounds(e,t,r,i){void 0===i&&(i=r);var i=checkBoundPoses(getBounds(e),i.vertical,i.horizontal),n=i.horizontal,i=i.vertical,t=t?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:checkMoveableSnapPoses(e,r.vertical,r.horizontal),e=t.horizontal,r=t.vertical,t=getSnapBound(n[0],e),a=getSnapBound(i[0],r),s=abs(t),o=abs(a);return{horizontal:{isBound:n[0].isBound,isSnap:e.isSnap,snapIndex:e.index,offset:t,dist:s,bounds:n,snap:e},vertical:{isBound:i[0].isBound,isSnap:r.isSnap,snapIndex:r.index,offset:a,dist:o,bounds:i,snap:r}}}function checkSnapBounds(e,t,r,i,n){var t=checkBoundPoses(t,r,i),a=t.horizontal,t=t.vertical,e=checkSnapPoses(e,r,i,[],[],n),r=e.horizontal,i=e.vertical,n=getSnapBound(a[0],r),e=getSnapBound(t[0],i),s=abs(n),o=abs(e);return{horizontal:{isBound:a[0].isBound,isSnap:r.isSnap,snapIndex:r.index,offset:n,dist:s,bounds:a,snap:r},vertical:{isBound:t[0].isBound,isSnap:i.isSnap,snapIndex:i.index,offset:e,dist:o,bounds:t,snap:i}}}function checkSnapRightLine(e,t,r,i){var e=getRad$1(e,t)/Math.PI*180,t=r.vertical,n=t.isBound,r=r.horizontal,a=r.isBound,e=e%180,s=e<3||177<e,e=87<e&&e<93;return r.dist<t.dist&&(n||t.isSnap&&!e&&(!i||!s))?"vertical":!a&&(!r.isSnap||s||i&&e)?"":"horizontal"}function getSnapBoundInfo(p,f,e,m,g,v){return e.map(function(e){var t,e=__read(e,2),r=e[0],e=e[1],i=getPosByDirection(f,r),n=getPosByDirection(f,e),a=m?checkSnapBoundsKeepRatio(p,i,n,g):checkMoveableSnapBounds(p,g,{vertical:[n[0]],horizontal:[n[1]]}),s=a.horizontal,o=s.offset,l=s.isBound,s=s.isSnap,u=a.vertical,c=u.offset,h=u.isBound,u=u.isSnap,d=minus(e,r);return c||o?(a=checkSnapRightLine(i,n,a,m))?(a="vertical"===a,t=[0,0],t=(t=m||1!==abs(e[0])||1!==abs(e[1])||r[0]===e[0]||r[1]===e[1]?solveNextOffset(i,n,-(a?c:o),a,v).offset:getDragDist({datas:v,distX:-c,distY:-o})).map(function(e,t){return e*(d[t]?2/d[t]:0)}),{sign:d,isBound:a?h:l,isSnap:a?u:s,offset:t}):{sign:d,isBound:!1,isSnap:!1,offset:[0,0]}:{isBound:h||l,isSnap:u||s,sign:d,offset:[0,0]}})}function getSnapBoundOffset(e,t){return e.isBound?e.offset:t.isSnap?t.offset:0}function checkSnapBoundsKeepRatio(e,t,r,i){var n=checkBoundKeepRatio(e,t,r),a=n.horizontal,n=n.vertical,i=i?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:checkSnapKeepRatio(e,t,r),e=i.horizontal,t=i.vertical,r=getSnapBoundOffset(a,e),i=getSnapBoundOffset(n,t),s=abs(r),o=abs(i);return{horizontal:{isBound:a.isBound,isSnap:e.isSnap,offset:r,dist:s},vertical:{isBound:n.isBound,isSnap:t.isSnap,offset:i,dist:o}}}function checkMaxBounds(e,s,t,o,l){var u,c,h,d,p=[-t[0],-t[1]],r=e.state,f=r.width,m=r.height,r=e.props.bounds,g=1/0,v=1/0;return r&&(e=[[t[0],-t[1]],[-t[0],t[1]]],t=r.left,u=void 0===t?-1/0:t,t=r.top,c=void 0===t?-1/0:t,t=r.right,h=void 0===t?1/0:t,t=r.bottom,d=void 0===t?1/0:t,e.forEach(function(e){var t,r,i=e[0]!==p[0],n=e[1]!==p[1],e=getPosByDirection(s,e),a=360*getRad$1(o,e)/Math.PI;n&&(t=e.slice(),(abs(a-360)<2||abs(a-180)<2)&&(t[1]=o[1]),r=__read((n=solveNextOffset(o,t,(o[1]<e[1]?d:c)-e[1],!1,l)).offset,2)[1],n=n.isOutside,isNaN(r)||(v=m+(n?1:-1)*abs(r))),i&&(t=e.slice(),(abs(a-90)<2||abs(a-270)<2)&&(t[0]=o[0]),r=__read((n=solveNextOffset(o,t,(o[0]<e[0]?h:u)-e[0],!0,l)).offset,1)[0],i=n.isOutside,isNaN(r)||(g=f+(i?1:-1)*abs(r)))})),{maxWidth:g,maxHeight:v}}var Draggable={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(e,t){var r=e.props,i=r.hideThrottleDragRotateLine,n=r.throttleDragRotate,r=r.zoom,e=e.getState(),a=e.dragInfo,e=e.beforeOrigin;return!i&&n&&a&&((i=a.dist)[0]||i[1])?(n=getDistSize(i),a=getRad$1(i,[0,0]),[t.createElement("div",{className:prefix("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(n,"px"),transform:"translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(a,"rad) scaleY(").concat(r,")")}})]):[]},dragStart:function(e,t){var r=t.datas,i=t.parentEvent,n=e.state,a=n.gestos,n=n.style;if(a.draggable)return!1;a.draggable=t.parentGesto||e.targetGesto,r.datas={},r.left=parseFloat(n.left||"")||0,r.top=parseFloat(n.top||"")||0,r.bottom=parseFloat(n.bottom||"")||0,r.right=parseFloat(n.right||"")||0,r.startValue=[0,0],setDragStart(e,t),setDefaultTransformIndex(e,t,"translate"),startCheckSnapDrag(e,r),r.prevDist=[0,0],r.prevBeforeDist=[0,0],r.isDrag=!1,r.deltaOffset=[0,0];n=fillParams(e,t,__assign({set:function(e){r.startValue=e}},fillTransformStartEvent(e,t)));return!1!==(i||triggerEvent(e,"onDragStart",n))?(r.isDrag=!0,e.state.dragInfo={startRect:e.getRect(),dist:[0,0]}):(a.draggable=null,r.isPinch=!1),!!r.isDrag&&n},drag:function(e,t){if(t){resolveTransformEvent(e,t,"translate");var r=t.datas,i=t.parentEvent,n=t.parentFlag,a=t.isPinch,s=t.deltaOffset,o=t.useSnap,l=t.isRequest,u=t.distX,c=t.distY,h=r.isDrag,d=r.prevDist,p=r.prevBeforeDist,f=r.startValue;if(h){s&&(u+=s[0],c+=s[1]);var h=e.props,m=h.parentMoveable,g=!i&&h.throttleDrag||0,v=!i&&h.throttleDragRotate||0,y=0,_=!1,b=!1,x=!1,S=!1,n=(!i&&0<v&&(u||c)&&(h=throttle((h=h.startDragRotate||0)+180*getRad$1([0,0],[u,c])/Math.PI,v)-h,T=c*Math.abs(Math.cos((h-90)/180*Math.PI)),T=getDistSize([u*Math.abs(Math.cos(h/180*Math.PI)),T]),y=h*Math.PI/180,u=T*Math.cos(y),c=T*Math.sin(y)),a||i||n||(_=(T=(h=__read(checkSnapBoundsDrag(e,u,c,v,!o&&l||s,r),2))[0]).isSnap,b=T.isBound,x=(y=h[1]).isSnap,S=y.isBound,u+=T.offset,c+=y.offset),plus(getBeforeDragDist({datas:r,distX:u,distY:c}),f)),o=plus(getTransformDist({datas:r,distX:u,distY:c}),f),l=(throttleArray(o,TINY_NUM),throttleArray(n,TINY_NUM),v||(_||b||(o[0]=throttle(o[0],g),n[0]=throttle(n[0],g)),x)||S||(o[1]=throttle(o[1],g),n[1]=throttle(n[1],g)),minus(n,f)),s=minus(o,f),h=minus(s,d),T=minus(l,p),y=(r.prevDist=s,r.prevBeforeDist=l,r.passDelta=h,r.passDist=s,r.left+l[0]),u=r.top+l[1],c=r.right-l[0],v=r.bottom-l[1],_=convertTransformFormat(r,"translate(".concat(o[0],"px, ").concat(o[1],"px)"),"translate(".concat(s[0],"px, ").concat(s[1],"px)"));if(fillOriginalTransform(t,_),e.state.dragInfo.dist=i?[0,0]:s,i||m||!h.every(function(e){return!e})||!T.some(function(e){return!e}))return x=(b=e.state).width,S=fillParams(e,t,__assign({transform:_,dist:s,delta:h,translate:o,beforeDist:l,beforeDelta:T,beforeTranslate:n,left:y,top:u,right:c,bottom:v,width:x,height:b.height,isPinch:a},fillCSSObject({transform:_},t))),i||triggerEvent(e,"onDrag",S),S}}},dragAfter:function(e,t){var r=t.datas,i=r.deltaOffset;return!(!i[0]&&!i[1])&&(r.deltaOffset=[0,0],this.drag(e,__assign(__assign({},t),{deltaOffset:i})))},dragEnd:function(e,t){var r=t.parentEvent,i=t.datas;if(e.state.dragInfo=null,i.isDrag)return i.isDrag=!1,i=fillEndParams(e,t,{}),r||triggerEvent(e,"onDragEnd",i),i},dragGroupStart:function(e,t){var r=t.datas,i=t.clientX,n=t.clientY,a=this.dragStart(e,t);return!!a&&(i=triggerChildGesto(e,this,"dragStart",[i||0,n||0],t,!1,"draggable"),n=triggerEvent(e,"onDragGroupStart",__assign(__assign({},a),{targets:e.props.targets,events:i})),r.isDrag=!1!==n,!!r.isDrag)&&a},dragGroup:function(e,t){if(t.datas.isDrag){var r=this.drag(e,t),t=triggerChildGesto(e,this,"drag",t.datas.passDelta,t,!1,"draggable");if(r)return triggerEvent(e,"onDragGroup",e=__assign({targets:e.props.targets,events:t},r)),e}},dragGroupEnd:function(e,t){var r,i=t.isDrag;if(t.datas.isDrag)return this.dragEnd(e,t),r=triggerChildGesto(e,this,"dragEnd",[0,0],t,!1,"draggable"),triggerEvent(e,"onDragGroupEnd",fillEndParams(e,t,{targets:e.props.targets,events:r})),i},request:function(e){var t={},r=e.getRect(),i=0,n=0,a=!1;return{isControl:!1,requestStart:function(e){return a=e.useSnap,{datas:t,useSnap:a}},request:function(e){return"x"in e?i=e.x-r.left:"deltaX"in e&&(i+=e.deltaX),"y"in e?n=e.y-r.top:"deltaY"in e&&(n+=e.deltaY),{datas:t,distX:i,distY:n,useSnap:a}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:a}}}},unset:function(e){e.state.gestos.draggable=null,e.state.dragInfo=null}};function getFixedDirectionInfo(e,t){return{fixedPosition:getPosByDirection(e,t),fixedDirection:t,fixedOffset:[0,0]}}function getOffsetFixedDirectionInfo(e,t){return{fixedPosition:calculatePosition(e.allMatrix,[e.width/2*(1+t[0]),e.height/2*(1+t[1])],e.is3d?4:3),fixedDirection:t,fixedOffset:[0,0]}}function getOffsetFixedPositionInfo(e,t){var r=e.allMatrix,i=e.width,n=e.height,e=e.is3d?4:3,a=getDirectionByPos(t,i,n);return{fixedPosition:calculatePosition(r,t,e),fixedDirection:a,fixedOffset:[i?0:t[0],n?0:t[1]]}}var directionCondition$2=getDirectionCondition("resizable"),Resizable={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:getRenderDirections("resizable"),dragControlCondition:directionCondition$2,viewClassName:getDirectionViewClassName("resizable"),dragControlStart:function(t,e){var r=e.inputEvent,i=e.isPinch,n=e.isGroup,a=e.parentGesto,s=e.datas,o=e.parentFixedDirection,l=e.parentEvent,r=getTotalDirection(e.parentDirection,i,r,s),u=t.state,c=u.target,h=u.width,d=u.height,p=u.gestos;if(!r||!c)return!1;if(p.resizable)return!1;p.resizable=a||t.controlGesto,i||setDragStart(t,e),s.datas={},s.direction=r,s.startOffsetWidth=h,s.startOffsetHeight=d,s.prevWidth=0,s.prevHeight=0,s.minSize=[0,0],s.startWidth=u.inlineCSSWidth||u.cssWidth,s.startHeight=u.inlineCSSHeight||u.cssHeight,s.maxSize=[1/0,1/0],n||(s.minSize=[u.minOffsetWidth,u.minOffsetHeight],s.maxSize=[u.maxOffsetWidth,u.maxOffsetHeight]);c=t.props.transformOrigin||"% %";function f(e){s.ratio=e&&isFinite(e)?e:0}function m(e){e=getFixedDirectionInfo(s.startPositions,e);s.fixedDirection=e.fixedDirection,s.fixedPosition=e.fixedPosition,s.fixedOffset=e.fixedOffset}function g(e){e=getOffsetFixedPositionInfo(t.state,e);s.fixedDirection=e.fixedDirection,s.fixedPosition=e.fixedPosition,s.fixedOffset=e.fixedOffset}function v(e){s.minSize=[convertUnitSize("".concat(e[0]),0)||0,convertUnitSize("".concat(e[1]),0)||0]}function y(e){e=[e[0]||1/0,e[1]||1/0];isNumber(e[0])&&!isFinite(e[0])||(e[0]=convertUnitSize("".concat(e[0]),0)||1/0),isNumber(e[1])&&!isFinite(e[1])||(e[1]=convertUnitSize("".concat(e[1]),0)||1/0),s.maxSize=e}s.transformOrigin=c&&isString(c)?c.split(" "):c,s.startOffsetMatrix=u.offsetMatrix,s.startTransformOrigin=u.transformOrigin,s.isWidth=null!=(p=null==e?void 0:e.parentIsWidth)?p:!r[0]&&!r[1]||r[0]||!r[1],s.startPositions=getAbsolutePosesByState(t.state),f(h/d),m(o||[-r[0],-r[1]]),s.setFixedDirection=m,s.setFixedPosition=g,s.setMin=v,s.setMax=y;a=fillParams(t,e,{direction:r,startRatio:s.ratio,set:function(e){var e=__read(e,2),t=e[0],e=e[1];s.startWidth=t,s.startHeight=e},setMin:v,setMax:y,setRatio:f,setFixedDirection:m,setFixedPosition:g,setOrigin:function(e){s.transformOrigin=e},dragStart:Draggable.dragStart(t,(new CustomGesto).dragStart([0,0],e))}),i=l||triggerEvent(t,"onResizeStart",a);return s.startFixedDirection=s.fixedDirection,s.startFixedPosition=s.fixedPosition,!1!==i&&(s.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:r}),!!s.isResize&&a},dragControl:function(e,r){var i=r.datas,t=r.parentFlag,n=r.isPinch,a=r.parentKeepRatio,s=r.dragClient,o=r.parentDist,l=r.useSnap,u=r.isRequest,c=r.isGroup,h=r.parentEvent,d=r.resolveMatrix,p=i.isResize,f=i.transformOrigin,m=i.startWidth,g=i.startHeight,v=i.prevWidth,$=i.prevHeight,y=i.minSize,_=i.maxSize,b=i.ratio,x=i.startOffsetWidth,S=i.startOffsetHeight,T=i.isWidth;if(p){d&&(p=e.state.is3d,d=i.startOffsetMatrix,C=i.startTransformOrigin,p=p?4:3,w=parseMat(getNextTransforms(r)),C=calculatePoses(d=getNextMatrix(d,w=p!==(d=Math.sqrt(w.length))?convertDimension(w,d,p):w,C,p),x,S,p),i.startPositions=C,i.nextTargetMatrix=w,i.nextAllMatrix=d);var p=getProps(e.props,"resizable"),E=p.resizeFormat,C=p.throttleResize,A=void 0===C?t?0:1:C,w=p.parentMoveable,d=p.keepRatioFinally,C=i.direction,P=C,M=0,I=0,D=(C[0]||C[1]||(P=[1,1]),b&&(null!=a?a:p.keepRatio)||!1),a=__read(O(),2),R=a[0],k=a[1],p=(h||(i.setFixedDirection(i.fixedDirection),triggerEvent(e,"onBeforeResize",fillParams(e,r,{startFixedDirection:i.startFixedDirection,startFixedPosition:i.startFixedPosition,setFixedDirection:function(e){return i.setFixedDirection(e),e=__read(O(),2),[R=e[0],k=e[1]]},setFixedPosition:function(e){return i.setFixedPosition(e),e=__read(O(),2),[R=e[0],k=e[1]]},boundingWidth:R,boundingHeight:k,setSize:function(e){e=__read(e,2);R=e[0],k=e[1]}},!0))),s),a=(s||(p=!t&&n?getAbsolutePosition(e,[0,0]):i.fixedPosition),[0,0]),l=(n||(a=checkSnapResize(e,R,k,C,p,!l&&u,i)),o&&(o[0]||(a[0]=0),o[1]||(a[1]=0)),D?(P[0]&&P[1]&&a[0]&&a[1]&&(abs(a[0])>abs(a[1])?a[1]=0:a[0]=0),(s=!a[0]&&!a[1])&&F(),P[0]&&!P[1]||a[0]&&!a[1]||s&&T?(R+=a[0],k=R/b):(!P[0]&&P[1]||!a[0]&&a[1]||s&&!T)&&(k+=a[1],R=k*b)):(R+=a[0],k+=a[1],R=Math.max(0,R),k=Math.max(0,k)),t=__read(calculateBoundSize([R,k],y,_,!!D&&b),2),R=t[0],k=t[1],F(),D&&(c||d)&&(T?k=R/b:R=k*b),[(M=R-x)-v,(I=k-S)-$]),u=(i.prevWidth=M,i.prevHeight=I,getResizeDist(e,R,k,p,f,i));if(w||!l.every(function(e){return!e})||!u.every(function(e){return!e}))return s=(o=Draggable.drag(e,setCustomDrag(r,e.state,u,!!n,!1,"draggable"))).transform,_=fillParams(e,r,__assign({width:a=m+M,height:y=g+I,offsetWidth:Math.round(R),offsetHeight:Math.round(k),startRatio:b,boundingWidth:R,boundingHeight:k,direction:C,dist:[M,I],delta:l,isPinch:!!n,drag:o},fillAfterTransform({style:{width:"".concat(a,"px"),height:"".concat(y,"px")},transform:s},o,r))),h||triggerEvent(e,"onResize",_),_}function O(){var e=i.fixedDirection,t=getOffsetSizeDist(P,D,i,r),t=(M=t.distWidth,I=t.distHeight,P[0]-e[0]||D?Math.max(x+M,TINY_NUM):x),e=P[1]-e[1]||D?Math.max(S+I,TINY_NUM):S;return D&&x&&S&&(T?e=t/b:t=e*b),[t,e]}function F(){var e;E&&(e=__read(E([R,k]),2),R=e[0],k=e[1]),R=throttle(R,A),k=throttle(k,A)}},dragControlAfter:function(e,t){var r,i,n,a,s=t.datas;if(s.isResize&&!1!==e.props.checkResizableError)return r=(i=e.state).width-(s.startOffsetWidth+s.prevWidth),i=i.height-(s.startOffsetHeight+s.prevHeight),n=3<abs(r),a=3<abs(i),n&&(s.startWidth+=r,s.startOffsetWidth+=r,s.prevWidth+=r),a&&(s.startHeight+=i,s.startOffsetHeight+=i,s.prevHeight+=i),n||a?this.dragControl(e,t):void 0},dragControlEnd:function(e,t){var r=t.datas,i=t.parentEvent;if(r.isResize)return r.isResize=!1,r=fillEndParams(e,t,{}),i||triggerEvent(e,"onResizeEnd",r),r},dragGroupControlCondition:directionCondition$2,dragGroupControlStart:function(i,e){var n,a,s,t,o=e.datas,l=this.dragControlStart(i,__assign(__assign({},e),{isGroup:!0}));return!!l&&(n=fillChildEvents(i,"resizable",e),a=o.startOffsetWidth,s=o.startOffsetHeight,t=triggerChildAbles(i,this,"dragControlStart",e,function(e,t){return startChildDist(i,e,o,t)}),r(),u(),o.setFixedDirection=e=function(r){l.setFixedDirection(r),t.forEach(function(e,t){e.setFixedDirection(r),startChildDist(i,e.moveable,o,n[t])})},e=__assign(__assign({},l),{targets:i.props.targets,events:t.map(function(t){return __assign(__assign({},t),{setMin:function(e){t.setMin(e),r()},setMax:function(e){t.setMax(e),u()}})}),setFixedDirection:e,setMin:function(e){l.setMin(e),r()},setMax:function(e){l.setMax(e),u()}}),e=triggerEvent(i,"onResizeGroupStart",e),o.isResize=!1!==e,!!o.isResize)&&l;function r(){var i=o.minSize;n.forEach(function(e){var e=e.datas,t=e.minSize,r=e.startOffsetWidth,e=e.startOffsetHeight,r=a*(r?t[0]/r:0),t=s*(e?t[1]/e:0);i[0]=Math.max(i[0],r),i[1]=Math.max(i[1],t)})}function u(){var i=o.maxSize;n.forEach(function(e){var e=e.datas,t=e.maxSize,r=e.startOffsetWidth,e=e.startOffsetHeight,r=a*(r?t[0]/r:0),t=s*(e?t[1]/e:0);i[0]=Math.min(i[0],r),i[1]=Math.min(i[1],t)})}},dragGroupControl:function(n,t){var e=t.datas;if(e.isResize){var a,s,o,r,i,l=getProps(n.props,"resizable"),u=(catchEvent(n,"onBeforeResize",function(e){triggerEvent(n,"onBeforeResizeGroup",fillParams(n,t,__assign(__assign({},e),{targets:l.targets}),!0))}),this.dragControl(n,__assign(__assign({},t),{isGroup:!0})));if(u)return i=u.boundingWidth,a=l.keepRatio,s=[i/(i-(i=u.dist)[0]),(r=u.boundingHeight)/(r-i[1])],o=e.fixedPosition,r=triggerChildAbles(n,this,"dragControl",t,function(e,t){var r=__read(calculate(createRotateMatrix(n.rotation/180*Math.PI,3),[t.datas.originalX*s[0],t.datas.originalY*s[1],1],3),2),i=r[0],r=r[1];return __assign(__assign({},t),{parentDist:null,parentScale:s,dragClient:plus(o,[i,r]),parentKeepRatio:a})}),i=__assign({targets:l.targets,events:r},u),triggerEvent(n,"onResizeGroup",i),i}},dragGroupControlEnd:function(e,t){var r,i=t.isDrag;if(t.datas.isResize)return this.dragControlEnd(e,t),r=triggerChildAbles(e,this,"dragControlEnd",t),triggerEvent(e,"onResizeGroupEnd",fillEndParams(e,t,{targets:e.props.targets,events:r})),i},request:function(e){var t={},r=0,i=0,n=!1,a=e.getRect();return{isControl:!0,requestStart:function(e){return n=e.useSnap,{datas:t,parentDirection:e.direction||[1,1],parentIsWidth:null==(e=null==e?void 0:e.horizontal)||e,useSnap:n}},request:function(e){return"offsetWidth"in e?r=e.offsetWidth-a.offsetWidth:"deltaWidth"in e&&(r+=e.deltaWidth),"offsetHeight"in e?i=e.offsetHeight-a.offsetHeight:"deltaHeight"in e&&(i+=e.deltaHeight),{datas:t,parentDist:[r,i],parentKeepRatio:e.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}},unset:function(e){e.state.gestos.resizable=null}};function setRotateStartInfo(e,t,r,i,n){var a=e.props.groupable,s=e.state,o=s.is3d?4:3,l=t.origin,e=calculatePosition(e.state.rootMatrix,minus([l[0],l[1]],a?[0,0]:[s.left,s.top]),o),l=plus([n.left,n.top],e);t.startAbsoluteOrigin=l,t.prevDeg=getRad$1(l,[r,i])/Math.PI*180,t.defaultDeg=t.prevDeg,t.prevSnapDeg=0,t.loop=0,t.startDist=getDist$2(l,[r,i])}function getAbsoluteDist(e,t,r){var i=r.defaultDeg,n=r.prevDeg,a=n%360,n=Math.floor(n/360),a=(a<0&&(a+=360),e<a&&270<a&&e<90?++n:a<e&&a<90&&270<e&&--n,t*(360*n+e-i));return r.prevDeg=i+a,a}function getAbsoluteDistByClient(e,t,r,i){return getAbsoluteDist(getRad$1(i.startAbsoluteOrigin,[e,t])/Math.PI*180,r,i)}function getRotateInfo(e,t,r,i,n,a){var s=e.props.throttleRotate,s=void 0===s?0:s,o=r.prevSnapDeg,l=0,u=!1,e=(a&&(u=(a=checkSnapRotate(e,t,i,n+i)).isSnap,l=n+a.dist),(l=u?l:throttle(n+i,s))-n);return[(r.prevSnapDeg=e)-o,e,l]}function getRotationPositions(e,t,r){var i,n,a,t=__read(t,4),s=t[0],o=t[1],l=t[2],u=t[3];return"none"===e?[]:isArray(e)?e.map(function(e){return getRotationPositions(e,[s,o,l,u],r)[0]}):(e=(t=__read((e||"top").split("-"),2))[0],t=t[1],n=[s,o],"left"===e?n=[l,s]:"right"===e?n=[o,u]:"bottom"===e&&(n=[u,l]),a=[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2],i=getRotationRad(n,r),t&&(e="bottom"===e||"left"===e,a=n[(n="top"===t||"left"===t)&&!e||!n&&e?0:1]),[[a,i]])}function dragControlCondition(e,t){var r;return t.isRequest?"rotatable"===t.requestAble:!!(hasClass(r=t.inputEvent.target,prefix("rotation-control"))||e.props.rotateAroundControls&&hasClass(r,prefix("around-control"))||hasClass(r,prefix("control"))&&hasClass(r,prefix("rotatable")))||!!(t=e.props.rotationTarget)&&getRefTargets(t,!0).some(function(e){return!!e&&(r===e||r.contains(e))})}var css=".rotation {\nposition: absolute;\nheight: 40px;\nwidth: 1px;\ntransform-origin: 50% 100%;\nheight: calc(40px * var(--zoom));\ntop: auto;\nleft: 0;\nbottom: 100%;\nwill-change: transform;\n}\n.rotation .rotation-line {\ndisplay: block;\nwidth: 100%;\nheight: 100%;\ntransform-origin: 50% 50%;\n}\n.rotation .rotation-control {\nborder-color: #4af;\nborder-color: var(--moveable-color);\nbackground:#fff;\ncursor: alias;\n}\n:global .view-rotation-dragging, .rotatable.direction.control {\ncursor: alias;\n}\n.rotatable.direction.control.move {\ncursor: move;\n}\n",Rotatable={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[css],viewClassName:function(e){return e.isDragging("rotatable")?prefix("view-rotation-dragging"):""},render:function(e,i){var n,r,t=getProps(e.props,"rotatable"),a=t.rotatable,s=t.rotationPosition,o=t.zoom,l=t.renderDirections,u=t.rotateAroundControls,c=t.resolveAblesWithRotatable,t=e.getState(),h=t.renderPoses;return a?(a=getRotationPositions(s,h,t.direction),n=[],a.forEach(function(e,t){var e=__read(e,2),r=e[0],e=e[1];n.push(i.createElement("div",{key:"rotation".concat(t),className:prefix("rotation"),style:{transform:"translate(-50%) translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(e,"rad)")}},i.createElement("div",{className:prefix("line rotation-line"),style:{transform:"scaleX(".concat(o,")")}}),i.createElement("div",{className:prefix("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(o,")")}})))}),l&&(s=getKeys(c||{}),r={},s.forEach(function(t){c[t].forEach(function(e){r[e]=t})}),h=[],isArray(l)&&(h=l.map(function(e){var t=r[e];return{data:t?{resolve:t}:{},classNames:t?["move"]:[],dir:e}})),n.push.apply(n,__spreadArray([],__read(renderDirectionControlsByInfos(e,"rotatable",h,i)),!1))),u&&n.push.apply(n,__spreadArray([],__read(renderAroundControls(e,i)),!1)),n):null},dragControlCondition:dragControlCondition,dragControlStart:function(n,e){var a,s,o,t,r,l=e.datas,i=e.clientX,u=e.clientY,c=e.parentRotate,h=e.parentFlag,d=e.isPinch,p=e.isRequest,f=n.state,m=f.target,g=f.left,v=f.top,y=f.direction,_=f.beforeDirection,b=f.targetTransform,x=f.moveableClientRect,S=f.offsetMatrix,T=f.targetMatrix,E=f.allMatrix,C=f.width,A=f.height;return!(!p&&!m||(m=n.getRect(),l.rect=m,l.transform=b,l.left=g,l.top=v,t=function(e){var t=getOffsetFixedPositionInfo(n.state,e);l.fixedDirection=t.fixedDirection,l.fixedOffset=t.fixedOffset,l.fixedPosition=t.fixedPosition,r&&r.setFixedPosition(e)},b=function(e){var t=getOffsetFixedDirectionInfo(n.state,e);l.fixedDirection=t.fixedDirection,l.fixedOffset=t.fixedOffset,l.fixedPosition=t.fixedPosition,r&&r.setFixedDirection(e)},a=i,s=u,p||d||h?(l.beforeInfo={origin:m.beforeOrigin,prevDeg:g=c||0,defaultDeg:g,prevSnapDeg:0,startDist:0},l.afterInfo=__assign(__assign({},l.beforeInfo),{origin:m.origin}),l.absoluteInfo=__assign(__assign({},l.beforeInfo),{origin:m.origin,startValue:g})):((i=null==(v=e.inputEvent)?void 0:v.target)&&(u=i.getAttribute("data-direction")||"",p=DIRECTION_REGION_TO_DIRECTION[u])&&(l.isControl=!0,l.isAroundControl=hasClass(i,prefix("around-control")),l.controlDirection=p,(d=i.getAttribute("data-resolve"))&&(l.resolveAble=d),a=(h=__read(getPosByDirection(calculateMoveableClientPositions(f.rootMatrix,f.renderPoses,x),p),2))[0],s=h[1]),l.beforeInfo={origin:m.beforeOrigin},l.afterInfo={origin:m.origin},l.absoluteInfo={origin:m.origin,startValue:m.rotation},o=t,t=function(e){var t=f.is3d?4:3,r=__read(plus(getOrigin(T,t),e),2),i=r[0],i=calculate(S,convertPositionMatrix([i,r[1]],t)),r=calculate(E,convertPositionMatrix([e[0],e[1]],t)),t=(o(e),f.posDelta);l.beforeInfo.origin=minus(i,t),l.afterInfo.origin=minus(r,t),l.absoluteInfo.origin=minus(r,t),setRotateStartInfo(n,l.beforeInfo,a,s,x),setRotateStartInfo(n,l.afterInfo,a,s,x),setRotateStartInfo(n,l.absoluteInfo,a,s,x)},b=function(e){e=getPosByDirection([[0,0],[C,0],[0,A],[C,A]],e);t(e)}),l.startClientX=a,l.startClientY=s,l.direction=y,l.beforeDirection=_,l.startValue=0,l.datas={},setDefaultTransformIndex(n,e,"rotate"),r=c=!1,(r=l.isControl&&l.resolveAble&&"resizable"===l.resolveAble?Resizable.dragControlStart(n,__assign(__assign({},new CustomGesto("resizable").dragStart([0,0],e)),{parentPosition:l.controlPosition,parentFixedPosition:l.fixedPosition})):r)||(c=Draggable.dragStart(n,(new CustomGesto).dragStart([0,0],e))),t(getTotalOrigin(n)),g=fillParams(n,e,__assign(__assign({set:function(e){l.startValue=e*Math.PI/180},setFixedDirection:b,setFixedPosition:t},fillTransformStartEvent(n,e)),{dragStart:c,resizeStart:r})),v=triggerEvent(n,"onRotateStart",g),l.isRotate=!1!==v,f.snapRenderInfo={request:e.isRequest},!l.isRotate))&&g},dragControl:function(e,t){var r=t.datas,i=t.clientDistX,n=t.clientDistY,a=t.parentRotate,s=t.parentFlag,o=t.isPinch,l=t.groupDelta,u=t.resolveMatrix,c=r.beforeDirection,h=r.beforeInfo,d=r.afterInfo,p=r.absoluteInfo,f=r.startValue,m=r.rect,g=r.startClientX,v=r.startClientY;if(r.isRotate){resolveTransformEvent(e,t,"rotate");var y,_,b,x=c*getTransformDirection(t),S=e.props.parentMoveable,T=180/Math.PI*f,f=p.startValue,E=!1,g=g+i,i=v+n;if(!s&&"parentDist"in t?(v=t.parentDist,b=_=y=v):o||s?(y=getAbsoluteDist(a,c,h),_=getAbsoluteDist(a,x,d),b=getAbsoluteDist(a,x,p)):(y=getAbsoluteDistByClient(g,i,c,h),_=getAbsoluteDistByClient(g,i,x,d),b=getAbsoluteDistByClient(g,i,x,p),E=!0),triggerEvent(e,"onBeforeRotate",fillParams(e,t,{beforeRotation:T+y,rotation:T+_,absoluteRotation:f+b,setRotation:function(e){b=y=_=e-T}},!0)),v=(n=__read(getRotateInfo(e,m,h,y,T,E),3))[0],y=n[1],s=n[2],c=(a=__read(getRotateInfo(e,m,d,_,T,E),3))[0],_=a[1],x=a[2],n=(h=__read(getRotateInfo(e,m,p,b,f,E),3))[0],b=h[1],d=h[2],n||c||v||S||u)return a=convertTransformFormat(r,"rotate(".concat(x,"deg)"),"rotate(".concat(_,"deg)")),u&&(r.fixedPosition=getTranslateFixedPosition(e,r.targetAllTransform,r.fixedDirection,r.fixedOffset,r)),f=minus(plus(l||[0,0],m=getRotateDist(e,_,r)),r.prevInverseDist||[0,0]),r.prevInverseDist=m,r.requestValue=null,h=E=fillTransformEvent(e,a,f,o,t),S=getDist$2([g,i],p.startAbsoluteOrigin)-p.startDist,u=void 0,"resizable"===r.resolveAble&&(l=Resizable.dragControl(e,__assign(__assign({},setCustomDrag(t,e.state,[t.deltaX,t.deltaY],!!o,!1,"resizable")),{resolveMatrix:!0,parentDistance:S})))&&(h=fillAfterTransform(h,u=l,t)),triggerEvent(e,"onRotate",m=fillParams(e,t,__assign(__assign({delta:c,dist:_,rotate:x,rotation:x,beforeDist:y,beforeDelta:v,beforeRotate:s,beforeRotation:s,absoluteDist:b,absoluteDelta:n,absoluteRotate:d,absoluteRotation:d,isPinch:!!o,resize:u},E),h))),m}},dragControlEnd:function(e,t){var r=t.datas;if(r.isRotate)return r.isRotate=!1,triggerEvent(e,"onRotateEnd",r=fillEndParams(e,t,{})),r},dragGroupControlCondition:dragControlCondition,dragGroupControlStart:function(e,t){var r=t.datas,i=e.state,n=i.left,a=i.top,s=i.beforeOrigin,i=this.dragControlStart(e,t);if(!i)return!1;i.set(r.beforeDirection*e.rotation);t=triggerChildAbles(e,this,"dragControlStart",t,function(e,t){var e=e.state,r=e.left,i=e.beforeOrigin,r=plus(minus([r,e.top],[n,a]),minus(i,s));return t.datas.startGroupClient=r,t.datas.groupClient=r,__assign(__assign({},t),{parentRotate:0})}),e=triggerEvent(e,"onRotateGroupStart",__assign(__assign({},i),{targets:e.props.targets,events:t}));return r.isRotate=!1!==e,!!r.isRotate&&i},dragGroupControl:function(t,r){var e=r.datas;if(e.isRotate){catchEvent(t,"onBeforeRotate",function(e){triggerEvent(t,"onBeforeRotateGroup",fillParams(t,r,__assign(__assign({},e),{targets:t.props.targets}),!0))});var s,o,l,i=this.dragControl(t,r);if(i)return s=e.beforeDirection,o=i.beforeDist,l=o/180*Math.PI,e=triggerChildAbles(t,this,"dragControl",r,function(e,t){var r=t.datas.startGroupClient,i=__read(t.datas.groupClient,2),n=i[0],i=i[1],r=__read(rotate(r,l*s),2),a=r[0],r=r[1],n=[a-n,r-i];return t.datas.groupClient=[a,r],__assign(__assign({},t),{parentRotate:o,groupDelta:n})}),t.rotation=s*i.beforeRotation,e=__assign({targets:t.props.targets,events:e,set:function(e){t.rotation=e},setGroupRotation:function(e){t.rotation=e}},i),triggerEvent(t,"onRotateGroup",e),e}},dragGroupControlEnd:function(e,t){var r,i=t.isDrag;if(t.datas.isRotate)return this.dragControlEnd(e,t),r=triggerChildAbles(e,this,"dragControlEnd",t),triggerEvent(e,"onRotateGroupEnd",fillEndParams(e,t,{targets:e.props.targets,events:r})),i},request:function(e){var t={},r=0,i=e.getRotation();return{isControl:!0,requestStart:function(){return{datas:t}},request:function(e){return"deltaRotate"in e?r+=e.deltaRotate:"rotate"in e&&(r=e.rotate-i),{datas:t,parentDist:r}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function renderGuideline(e,t){var r=e.direction,i=e.classNames,n=e.size,a=e.pos,s=e.zoom,r="horizontal"===r,o=r?"Y":"X";return t.createElement("div",{key:e.key,className:i.join(" "),style:((t={})[r?"width":"height"]="".concat(n),t.transform="translate(".concat(a[0],", ").concat(a[1],") translate").concat(o,"(-50%) scale").concat(o,"(").concat(s,")"),t)})}function renderInnerGuideline(e,t){return renderGuideline(__assign(__assign({},e),{classNames:__spreadArray([prefix("line","guideline",e.direction)],__read(e.classNames),!1).filter(function(e){return e}),size:e.size||"".concat(e.sizeValue,"px"),pos:e.pos||e.posValue.map(function(e){return"".concat(throttle(e,.1),"px")})}),t)}function renderSnapPoses(e,n,t,a,s,o,l,u){var c=e.props.zoom;return t.map(function(e,t){var r=e.type,e=e.pos,i=[0,0];return i[l]=a,i[l?0:1]=-s+e,renderInnerGuideline({key:"".concat(n,"TargetGuideline").concat(t),classNames:[prefix("target","bold",r)],posValue:i,sizeValue:o,zoom:c,direction:n},u)})}function renderGuidelines(e,a,t,s,r,o){var e=e.props,l=e.zoom,i=e.isDisplayInnerSnapDigit,n="horizontal"===a?VERTICAL_NAMES_MAP:HORIZONTAL_NAMES_MAP,u=r[n.start],c=r[n.end];return t.filter(function(e){var t=e.hide,e=e.elementRect;if(t)return!1;if(i&&e){t=e.rect;if(t[n.start]<=u&&c<=t[n.end])return!1}return!0}).map(function(e,t){var r=e.pos,i=e.size,n=e.element,e=e.className,r=[-s[0]+r[0],-s[1]+r[1]];return renderInnerGuideline({key:"".concat(a,"-default-guideline-").concat(t),classNames:n?[prefix("bold"),e]:[prefix("normal"),e],direction:a,posValue:r,sizeValue:i,zoom:l},o)})}function renderDigitLine(e,t,r,i,n,a,s,o){var e=e.props,l=e.snapDigit,l=void 0===l?0:l,u=e.isDisplaySnapDigit,u=void 0===u||u,c=e.snapDistFormat,c=void 0===c?function(e,t){return e}:c,e=e.zoom,h="horizontal"===t?"X":"Y",d="vertical"===t?"height":"width",n=Math.abs(n),u=u?parseFloat(n.toFixed(l)):0;return o.createElement("div",{key:"".concat(t,"-").concat(r,"-guideline-").concat(i),className:prefix("guideline-group",t),style:((l={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")})[d]="".concat(n,"px"),l)},renderInnerGuideline({direction:t,classNames:[prefix(r),s],size:"100%",posValue:[0,0],sizeValue:n,zoom:e},o),o.createElement("div",{className:prefix("size-value","gap"),style:{transform:"translate".concat(h,"(-50%) scale(").concat(e,")")}},0<u?c(u,t):""))}function groupByElementGuidelines(l,e,t,u){var c="vertical"===l?0:1,h="vertical"===l?1:0,d=c?VERTICAL_NAMES_MAP:HORIZONTAL_NAMES_MAP,p=t[d.start],f=t[d.end];return groupBy(e,function(e){return e.pos[c]}).map(function(e){var s=[],o=[];return e.forEach(function(e){var t,r,i,n=e.element,a=e.elementRect.rect;a[d.end]<p?s.push(e):f<a[d.start]?o.push(e):a[d.start]<=p&&f<=a[d.end]&&u&&(t=e.pos,r={element:n,rect:__assign(__assign({},a),((r={})[d.end]=a[d.start],r))},a={element:n,rect:__assign(__assign({},a),((n={})[d.start]=a[d.end],n))},n=[0,0],(i=[0,0])[c]=t[c],i[h]=t[h],n[c]=t[c],n[h]=t[h]+e.size,s.push({type:l,pos:i,size:0,elementRect:r,direction:"",elementDirection:"end"}),o.push({type:l,pos:n,size:0,elementRect:a,direction:"",elementDirection:"start"}))}),s.sort(function(e,t){return t.pos[h]-e.pos[h]}),o.sort(function(e,t){return e.pos[h]-t.pos[h]}),{total:e,start:s,end:o,inner:[]}})}function renderDashedGuidelines(p,t,f,m,g){var r=p.props.isDisplayInnerSnapDigit,v=[];return["vertical","horizontal"].forEach(function(s){var e=t.filter(function(e){return e.type===s}),o="vertical"===s?1:0,l=o?0:1,e=groupByElementGuidelines(s,e,m,r),u=o?HORIZONTAL_NAMES_MAP:VERTICAL_NAMES_MAP,c=o?VERTICAL_NAMES_MAP:HORIZONTAL_NAMES_MAP,h=m[u.start],d=m[u.end];e.forEach(function(e){var t=e.total,r=e.start,i=e.end,e=e.inner,a=f[l]+t[0].pos[l]-m[c.start],n=m;r.forEach(function(e){var t,r=e.elementRect.rect,i=n[u.start]-r[u.end];0<i&&((t=[0,0])[o]=f[o]+n[u.start]-h-i,t[l]=a,v.push(renderDigitLine(p,s,"dashed",v.length,i,t,e.className,g))),n=r}),n=m,i.forEach(function(e){var t,r=e.elementRect.rect,i=r[u.start]-n[u.end];0<i&&((t=[0,0])[o]=f[o]+n[u.end]-h,t[l]=a,v.push(renderDigitLine(p,s,"dashed",v.length,i,t,e.className,g))),n=r}),e.forEach(function(e){var t=e.elementRect.rect,r=h-t[u.start],t=t[u.end]-d,i=[0,0],n=[0,0];i[o]=f[o]-r,i[l]=a,n[o]=f[o]+d-h,n[l]=a,v.push(renderDigitLine(p,s,"dashed",v.length,r,i,e.className,g)),v.push(renderDigitLine(p,s,"dashed",v.length,t,n,e.className,g))})})}),v}function renderGapGuidelines(p,r,f,i,m){var g=[];return["horizontal","vertical"].forEach(function(t){var e=r.filter(function(e){return e.type===t}).slice(0,1),a="vertical"===t?0:1,s=a?0:1,o=a?HORIZONTAL_NAMES_MAP:VERTICAL_NAMES_MAP,l=a?VERTICAL_NAMES_MAP:HORIZONTAL_NAMES_MAP,u=i[o.start],c=i[o.end],h=i[l.start],d=i[l.end];e.forEach(function(e){var i=e.gap,e=e.gapRects,t=Math.max.apply(Math,__spreadArray([h],__read(e.map(function(e){return e.rect[l.start]})),!1)),r=Math.min.apply(Math,__spreadArray([d],__read(e.map(function(e){return e.rect[l.end]})),!1)),n=(t+r)/2;t!==r&&n!=(h+d)/2&&e.forEach(function(e){var t=e.rect,e=e.className,r=[f[0],f[1]];if(t[o.end]<u)r[a]+=t[o.end]-u;else{if(!(c<t[o.start]))return;r[a]+=t[o.start]-u-i}r[s]+=n-h,g.push(renderDigitLine(p,a?"vertical":"horizontal","gap",g.length,i,r,e,m))})})}),g}function getTotalGuidelines(e){var t=e.state,r=t.containerClientRect,i=t.hasFixed,n=r.overflow,a=r.scrollHeight,s=r.scrollWidth,o=r.clientHeight,l=r.clientWidth,u=r.clientLeft,c=r.clientTop,h=e.props,d=h.snapGap,d=void 0===d||d,p=h.verticalGuidelines,f=h.horizontalGuidelines,m=h.snapThreshold,m=void 0===m?5:m,g=h.snapGridWidth,g=void 0===g?0:g,v=h.snapGridHeight,v=void 0===v?0:v,y=h.maxSnapElementGuidelineDistance,_=void 0===y?1/0:y,y=h.isDisplayGridGuidelines,h=getRect(getAbsolutePosesByState(e.state)),b=h.top,x=h.left,S=h.bottom,h=h.right,T={top:b,left:x,bottom:S,right:h,center:(x+h)/2,middle:(b+S)/2},x=__spreadArray([],__read(getElementGuidelines(e)),!1),h=(d&&x.push.apply(x,__spreadArray([],__read(getGapGuidelines(e,T,m)),!1)),__assign({},t.snapOffset||{left:0,top:0,bottom:0,right:0}));return x.push.apply(x,__spreadArray([],__read(getGridGuidelines(g,v,n?s:l,n?a:o,u,c,h,y)),!1)),i&&(b=r.left,S=r.top,h.left+=b,h.top+=S,h.right+=b,h.bottom+=S),x.push.apply(x,__spreadArray([],__read(getDefaultGuidelines(f||!1,p||!1,n?s:l,n?a:o,u,c,h)),!1)),x=x.filter(function(e){var t=e.element,r=e.elementRect;return!t||!r||(t=r.rect,checkBetweenRects(T,t,e.type,_))})}function getGapGuidelines(e,v,y){var t=e.props,r=t.maxSnapElementGuidelineDistance,_=void 0===r?1/0:r,r=t.maxSnapElementGapDistance,b=void 0===r?1/0:r,a=e.state.elementRects,x=[];return[["vertical",VERTICAL_NAMES_MAP,HORIZONTAL_NAMES_MAP],["horizontal",HORIZONTAL_NAMES_MAP,VERTICAL_NAMES_MAP]].forEach(function(e){var e=__read(e,3),d=e[0],p=e[1],s=e[2],f=v[p.start],m=v[p.end],g=v[p.center],r=v[s.start],i=v[s.end];function n(e){e=e.rect;return e[p.end]<f+y?f-e[p.end]:m-y<e[p.start]?e[p.start]-m:-1}var t=a.filter(function(e){var t=e.rect;return!(t[s.start]>i||t[s.end]<r)&&0<n(e)}).sort(function(e,t){return n(e)-n(t)}),o=[];t.forEach(function(a){t.forEach(function(e){var t,r,i,n;a===e||(i=a.rect,t=e.rect,r=i[s.start],i=i[s.end],n=t[s.start],t[s.end]<r)||i<n||o.push([a,e])})}),o.forEach(function(e){var e=__read(e,2),t=e[0],e=e[1],r=t.rect,i=e.rect,n=r[p.start],r=r[p.end],a=i[p.start],s=i[p.end],o=0,l=0,u=!1,c=!1,h=!1;if(r<=f&&m<=a){if(c=!0,abs((l=r+(o=(a-r-(m-f))/2)+(m-f)/2)-g)>y)return}else if(r<a&&s<f+y){if(u=!0,abs((l=s+(o=a-r))-f)>y)return}else{if(!(r<a&&m-y<n))return;if(h=!0,abs((l=n-(o=a-r))-m)>y)return}!o||!checkBetweenRects(v,i,d,_)||b<o||x.push({type:d,pos:"vertical"===d?[l,0]:[0,l],element:e.element,size:0,className:e.className,isStart:u,isCenter:c,isEnd:h,gap:o,hide:!0,gapRects:[t,e],direction:"",elementDirection:""})})}),x}function getGridGuidelines(e,t,r,i,n,a,s,o){void 0===n&&(n=0),void 0===a&&(a=0);var l=[],u=s.left,c=s.top;if(t)for(var h=0;h<=i;h+=t)l.push({type:"horizontal",pos:[u,throttle(h-a+c,.1)],className:prefix("grid-guideline"),size:r,hide:!o,direction:""});if(e)for(h=0;h<=r;h+=e)l.push({type:"vertical",pos:[throttle(h-n+u,.1),c],className:prefix("grid-guideline"),size:i,hide:!o,direction:""});return l}function checkBetweenRects(e,t,r,i){return"horizontal"===r?abs(e.right-t.left)<=i||abs(e.left-t.right)<=i||e.left<=t.right&&t.left<=e.right:"vertical"!==r||abs(e.bottom-t.top)<=i||abs(e.top-t.bottom)<=i||e.top<=t.bottom&&t.top<=e.bottom}function getElementGuidelines(e){var r,t,i,n,a,v,y,s=e.state,o=e.props.elementGuidelines,o=void 0===o?[]:o;return o.length?(r=(s.elementRects||[]).filter(function(e){return!e.refresh}),t=o.map(function(e){return isObject(e)&&"element"in e?__assign(__assign({},e),{element:getRefTarget(e.element,!0)}):{element:getRefTarget(e,!0)}}).filter(function(e){return e.element}),i=(o=diff(r.map(function(e){return e.element}),t.map(function(e){return e.element}))).maintained,n=o.added,a=[],i.forEach(function(e){var e=__read(e,2),t=e[0];a[e[1]]=r[t]}),getSnapElementRects(e,n.map(function(e){return t[e]})).map(function(e,t){a[n[t]]=e}),s.elementRects=a,v=getSnapDirections(e.props.elementSnapDirections),y=[],a.forEach(function(r){var i=r.element,e=r.top,e=void 0===e?v.top:e,t=r.left,t=void 0===t?v.left:t,n=r.right,n=void 0===n?v.right:n,a=r.bottom,a=void 0===a?v.bottom:a,s=r.center,s=void 0===s?v.center:s,o=r.middle,o=void 0===o?v.middle:o,l=r.className,u=r.rect,e=splitSnapDirectionPoses({top:e,right:n,left:t,bottom:a,center:s,middle:o},u),n=e.horizontal,t=e.vertical,c=e.horizontalNames,h=e.verticalNames,d=u.top,p=u.left,f=u.right-p,m=u.bottom-d,g=[f,m];t.forEach(function(e,t){y.push({type:"vertical",element:i,pos:[throttle(e,.1),d],size:m,sizes:g,className:l,elementRect:r,elementDirection:SNAP_SKIP_NAMES_MAP[h[t]]||h[t],direction:""})}),n.forEach(function(e,t){y.push({type:"horizontal",element:i,pos:[p,throttle(e,.1)],size:f,sizes:g,className:l,elementRect:r,elementDirection:SNAP_SKIP_NAMES_MAP[c[t]]||c[t],direction:""})})}),y):(s.elementRects=[],[])}function getObjectGuidelines(e,r){return e?e.map(function(e){var e=isObject(e)?e:{pos:e},t=e.pos;return isNumber(t)?e:__assign(__assign({},e),{pos:convertUnitSize(t,r)})}):[]}function getDefaultGuidelines(e,t,r,i,n,a,s){void 0===n&&(n=0),void 0===a&&(a=0);var o=[],l=(s=void 0===s?{left:0,top:0,right:0,bottom:0}:s).left,u=s.top,c=s.bottom,h=r+s.right-l,d=i+c-u;return getObjectGuidelines(e,d).forEach(function(e){o.push({type:"horizontal",pos:[l,throttle(e.pos-a+u,.1)],size:h,className:e.className,direction:""})}),getObjectGuidelines(t,h).forEach(function(e){o.push({type:"vertical",pos:[throttle(e.pos-n+l,.1),u],size:d,className:e.className,direction:""})}),o}function getSnapElementRects(e,t){var r,i,a,n,s,o,l,u,c;return t.length?(r=e.props.groupable,i=(e=e.state).containerClientRect,n=e.offsetDelta,s=e.is3d?4:3,e=__read(calculateContainerPos(a=e.rootMatrix,i,s),2),o=e[0],l=e[1],u=r?0:n[0],c=r?0:n[1],t.map(function(e){var t=e.element.getBoundingClientRect(),r=t.left-o-u,i=t.top-l-c,n=i+t.height,t=r+t.width,r=__read(calculateInversePosition(a,[r,i],s),2),i=r[0],r=r[1],t=__read(calculateInversePosition(a,[t,n],s),2),n=t[0],t=t[1];return __assign(__assign({},e),{rect:{left:i,right:n,top:r,bottom:t,center:(i+n)/2,middle:(r+t)/2}})})):[]}function checkSnapInfo(e){var t,r,i,n=e.state,a=n.container,s=e.props.snapContainer||a;return(n.snapContainer!==s||!n.guidelines||!n.guidelines.length)&&(t=n.containerClientRect,r={left:0,top:0,bottom:0,right:0},a!==s&&(a=getRefTarget(s,!0))&&(i=getDragDistByState(n,[(a=getClientRect(a)).left-t.left,a.top-t.top]),a=getDragDistByState(n,[a.right-t.right,a.bottom-t.bottom]),r.left=throttle(i[0],1e-5),r.top=throttle(i[1],1e-5),r.right=throttle(a[0],1e-5),r.bottom=throttle(a[1],1e-5)),n.snapContainer=s,n.snapOffset=r,n.guidelines=getTotalGuidelines(e),n.enableSnap=!0)}function getNextFixedPoses(e,t,r,i,n,a){e=calculatePoses(e,t,r,a?4:3);return getAbsolutePoses(e,minus(n,getPosByDirection(e,i)))}function normalized(e){return e?e/abs(e):0}function getSizeOffsetInfo(e,t,r,i,n,a){var s=getCheckSnapDirections(r,a.fixedDirection,i),r=getCheckInnerBoundLineInfos(e,t,r,i),t=__spreadArray(__spreadArray([],__read(getSnapBoundInfo(e,t,s,i,n,a)),!1),__read(getInnerBoundInfo(e,r,a)),!1),s=getNearOffsetInfo(t,0),i=getNearOffsetInfo(t,1);return{width:{isBound:s.isBound,offset:s.offset[0]},height:{isBound:i.isBound,offset:i.offset[1]}}}function recheckSizeByTwoDirection(e,t,r,i,n,a,s,o,l){var t=getPosByDirection(t,s),e=checkMoveableSnapBounds(e,o,{vertical:[t[0]],horizontal:[t[1]]}),o=e.horizontal.offset,t=e.vertical.offset;return throttle(t,FLOAT_POINT_NUM)||throttle(o,FLOAT_POINT_NUM)?(l=(e=__read(getDragDist({datas:l,distX:-t,distY:-o}),2))[0],t=e[1],[Math.min(n||1/0,r+s[0]*l)-r,Math.min(a||1/0,i+s[1]*t)-i]):[0,0]}function checkSizeDist(e,t,r,i,n,a,s,o){for(var l=getAbsolutePosesByState(e.state),u=e.props.keepRatio,c=0,h=0,d=0;d<2;++d){var p=getSizeOffsetInfo(e,t(c,h),n,u,s,o),f=p.width,p=p.height,m=f.isBound,g=p.isBound,v=f.offset,y=p.offset;if(1===d&&(m||(v=0),g||(y=0)),0===d&&s&&!m&&!g)return[0,0];u&&(f=abs(v)*(r?1/r:1),p=abs(y)*(i?1/i:1),(m&&g?f<p:g||!m&&f<p)?v=r*y/i:y=i*v/r),c+=v,h+=y}return!u&&n[0]&&n[1]&&(a=(l=checkMaxBounds(e,l,n,a,o)).maxWidth,l=l.maxHeight,c+=v=(a=__read(recheckSizeByTwoDirection(e,t(c,h).map(function(e){return e.map(function(e){return throttle(e,FLOAT_POINT_NUM)})}),r+c,i+h,a,l,n,s,o),2))[0],h+=y=a[1]),[c,h]}function absDegree(e){return e<0&&(e=e%360+360),e%=360}function bumpDegree(e,t){t=absDegree(t);var r=Math.floor(e/360),i=360*r+360-t,r=360*r+t;return abs(e-i)<abs(e-r)?i:r}function getMinDegreeDistance(e,t){e=absDegree(e),t=absDegree(t);e=absDegree(e-t);return Math.min(e,360-e)}function checkSnapRotate(e,t,r,i){var n=e.props,a=null!=(a=n[NAME_snapRotationThreshold])?a:5,n=n[NAME_snapRotationDegrees];if(hasGuidelines(e,"rotatable")){var s=t.pos1,o=t.pos2,l=t.pos3,u=t.pos4,c=t.origin,h=r*Math.PI/180,t=[s,o,l,u].map(function(e){return minus(e,c)}),s=t.map(function(e){return rotate(e,h)}),o=__spreadArray(__spreadArray([],__read(checkRotateBounds(e,t,s,c,r)),!1),__read(checkRotateInnerBounds(e,t,s,c,r)),!1),l=(o.sort(function(e,t){return abs(e-r)-abs(t-r)}),0<o.length);if(l)return{isSnap:l,dist:l?o[0]:r}}if(null!=n&&n.length&&a){u=n.slice().sort(function(e,t){return getMinDegreeDistance(e,i)-getMinDegreeDistance(t,i)})[0];if(getMinDegreeDistance(u,i)<=a)return{isSnap:!0,dist:r+bumpDegree(i,u)-i}}return{isSnap:!1,dist:r}}function checkSnapResize(e,r,i,t,n,a,s){var o,l,u,c,h;return hasGuidelines(e,"resizable")?(o=s.fixedDirection,l=s.nextAllMatrix,u=e.state,c=u.allMatrix,h=u.is3d,checkSizeDist(e,function(e,t){return getNextFixedPoses(l||c,r+e,i+t,o,n,h)},r,i,t,n,a,s)):[0,0]}function checkSnapScale(e,r,t,i,n){var a,s,o,l,u;return hasGuidelines(e,"scalable")?(a=n.startOffsetWidth,l=n.fixedDirection,u=n.is3d,[(e=checkSizeDist(e,function(e,t){return getNextFixedPoses(scaleMatrix(n,plus(r,[e/a,t/s])),a,s,l,o,u)},a,s=n.startOffsetHeight,t,o=n.fixedPosition,i,n))[0]/a,e[1]/s]):[0,0]}function startCheckSnapDrag(e,t){t.absolutePoses=getAbsolutePosesByState(e.state)}function getSnapGuidelines(e){var i=[];return e.forEach(function(r){r.guidelineInfos.forEach(function(e){var t=e.guideline;find$1(i,function(e){return e.guideline===t})||(t.direction="",i.push({guideline:t,posInfo:r}))})}),i.map(function(e){var t=e.guideline,e=e.posInfo;return __assign(__assign({},t),{direction:e.direction})})}function addBoundGuidelines(e,t,r,i,n,a){var a=checkBoundPoses(getBounds(e,a),t,r),t=a.vertical,r=a.horizontal,s=getInitialBounds(),a=(t.forEach(function(e){e.isBound&&("start"===e.direction&&(s.left=!0),"end"===e.direction&&(s.right=!0),i.push({type:"bounds",pos:e.pos}))}),r.forEach(function(e){e.isBound&&("start"===e.direction&&(s.top=!0),"end"===e.direction&&(s.bottom=!0),n.push({type:"bounds",pos:e.pos}))}),checkInnerBoundPoses(e)),t=a.boundMap,r=a.vertical,e=a.horizontal;return r.forEach(function(t){0<=findIndex(i,function(e){return"bounds"===e.type&&e.pos===t})||i.push({type:"bounds",pos:t})}),e.forEach(function(t){0<=findIndex(n,function(e){return"bounds"===e.type&&e.pos===t})||n.push({type:"bounds",pos:t})}),{boundMap:s,innerBoundMap:t}}var directionCondition$1=getDirectionCondition("",["resizable","scalable"]),NAME_snapRotationThreshold="snapRotationThreshold",NAME_snapRotationDegrees="snapRotationDegrees",Snappable={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold",NAME_snapRotationThreshold,NAME_snapRotationDegrees,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[":host {\n--bounds-color: #d66;\n}\n.guideline {\npointer-events: none;\nz-index: 2;\n}\n.guideline.bounds {\nbackground: #d66;\nbackground: var(--bounds-color);\n}\n.guideline-group {\nposition: absolute;\ntop: 0;\nleft: 0;\n}\n.guideline-group .size-value {\nposition: absolute;\ncolor: #f55;\nfont-size: 12px;\nfont-size: calc(12px * var(--zoom));\nfont-weight: bold;\n}\n.guideline-group.horizontal .size-value {\ntransform-origin: 50% 100%;\ntransform: translateX(-50%);\nleft: 50%;\nbottom: 5px;\nbottom: calc(2px + 3px * var(--zoom));\n}\n.guideline-group.vertical .size-value {\ntransform-origin: 0% 50%;\ntop: 50%;\ntransform: translateY(-50%);\nleft: 5px;\nleft: calc(2px + 3px * var(--zoom));\n}\n.guideline.gap {\nbackground: #f55;\n}\n.size-value.gap {\ncolor: #f55;\n}\n"],render:function(e,t){var r=e.state,i=r.top,n=r.left,a=r.pos1,s=r.pos2,o=r.pos3,l=r.pos4,u=r.snapRenderInfo,c=e.props.snapRenderThreshold,c=void 0===c?1:c;if(!u||!u.render||!hasGuidelines(e,""))return watchValue(e,"boundMap",getInitialBounds(),function(e){return JSON.stringify(e)}),watchValue(e,"innerBoundMap",getInitialBounds(),function(e){return JSON.stringify(e)}),[];r.guidelines=getTotalGuidelines(e);var r=Math.min(a[0],s[0],o[0],l[0]),a=Math.min(a[1],s[1],o[1],l[1]),s=u.externalPoses||[],o=getAbsolutePosesByState(e.state),h=[],d=[],p=[],f=[],l=[],m=getRect(o),g=m.width,v=m.height,y=m.top,_=m.left,b=m.bottom,m=m.right,x={left:_,right:m,top:y,bottom:b,center:(_+m)/2,middle:(y+b)/2},S=0<s.length,s=S?getRect(s):{},o=(u.request||(u.direction&&l.push(getSnapInfosByDirection(e,o,u.direction,c)),u.snap&&(o=getRect(o),u.center&&(o.middle=(o.top+o.bottom)/2,o.center=(o.left+o.right)/2),l.push(checkSnaps(e,o,c))),S&&(u.center&&(s.middle=(s.top+s.bottom)/2,s.center=(s.left+s.right)/2),l.push(checkSnaps(e,s,c))),l.forEach(function(e){var t=e.vertical.posInfos,e=e.horizontal.posInfos;h.push.apply(h,__spreadArray([],__read(t.filter(function(e){return e.guidelineInfos.some(function(e){return!e.guideline.hide})}).map(function(e){return{type:"snap",pos:e.pos}})),!1)),d.push.apply(d,__spreadArray([],__read(e.filter(function(e){return e.guidelineInfos.some(function(e){return!e.guideline.hide})}).map(function(e){return{type:"snap",pos:e.pos}})),!1)),p.push.apply(p,__spreadArray([],__read(getSnapGuidelines(t)),!1)),f.push.apply(f,__spreadArray([],__read(getSnapGuidelines(e)),!1))})),addBoundGuidelines(e,[_,m],[y,b],h,d)),c=o.boundMap,l=o.innerBoundMap,_=(S&&addBoundGuidelines(e,[s.left,s.right],[s.top,s.bottom],h,d,u.externalBounds),__spreadArray(__spreadArray([],__read(p),!1),__read(f),!1)),m=_.filter(function(e){return e.element&&!e.gapRects}),y=_.filter(function(e){return e.gapRects}).sort(function(e,t){return e.gap-t.gap}),b=(triggerEvent(e,"onSnap",{guidelines:_.filter(function(e){return!e.element}),elements:m,gaps:y},!0),watchValue(e,"boundMap",c,function(e){return JSON.stringify(e)},getInitialBounds())),o=watchValue(e,"innerBoundMap",l,function(e){return JSON.stringify(e)},getInitialBounds());return c!==b&&l!==o||triggerEvent(e,"onBound",{bounds:c,innerBounds:l},!0),__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],__read(renderDashedGuidelines(e,m,[r,a],x,t)),!1),__read(renderGapGuidelines(e,y,[r,a],x,t)),!1),__read(renderGuidelines(e,"horizontal",f,[n,i],x,t)),!1),__read(renderGuidelines(e,"vertical",p,[n,i],x,t)),!1),__read(renderSnapPoses(e,"horizontal",d,r,i,g,0,t)),!1),__read(renderSnapPoses(e,"vertical",h,a,n,v,1,t)),!1)},dragStart:function(e,t){e.state.snapRenderInfo={request:t.isRequest,snap:!0,center:!0},checkSnapInfo(e)},drag:function(e){var t=e.state;checkSnapInfo(e)||(t.guidelines=getTotalGuidelines(e)),t.snapRenderInfo&&(t.snapRenderInfo.render=!0)},pinchStart:function(e){this.unset(e)},dragEnd:function(e){this.unset(e)},dragControlCondition:function(e,t){return!(!directionCondition$1(e,t)&&!dragControlCondition(e,t))||(!t.isRequest&&t.inputEvent?hasClass(t.inputEvent.target,prefix("snap-control")):void 0)},dragControlStart:function(e){e.state.snapRenderInfo=null,checkSnapInfo(e)},dragControl:function(e){this.drag(e)},dragControlEnd:function(e){this.unset(e)},dragGroupStart:function(e,t){this.dragStart(e,t)},dragGroup:function(e){this.drag(e)},dragGroupEnd:function(e){this.unset(e)},dragGroupControlStart:function(e){e.state.snapRenderInfo=null,checkSnapInfo(e)},dragGroupControl:function(e){this.drag(e)},dragGroupControlEnd:function(e){this.unset(e)},unset:function(e){e=e.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function multiply2(e,t){return[e[0]*t[0],e[1]*t[1]]}function prefix(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return prefixNames.apply(void 0,__spreadArray([PREFIX],__read(e),!1))}function defaultSync(e){e()}function getTransformMatrix(e){return e&&"none"!==e?isObject(e)?e:parseMat(e):[1,0,0,1,0,0]}function getAbsoluteMatrix(e,t,r){return multiplies(t,createOriginMatrix(r,t),e,createOriginMatrix(r.map(function(e){return-e}),t))}function measureSVGSize(e,t,r){return"%"===t?getSVGViewBox(e.ownerSVGElement)[r?"width":"height"]/100:1}function getBeforeTransformOrigin(r){return getTransformOrigin(getComputedStyle$1(r,":before")).map(function(e,t){e=splitUnit(e);return e.value*measureSVGSize(r,e.unit,0===t)})}function getTransformOriginArray(e){return e?e.split(" "):["0","0"]}function getTransformOrigin(e){return getTransformOriginArray(e.transformOrigin)}function getElementTransform(e){var t=getCachedStyle(e)("transform");if(t&&"none"!==t)return t;if("transform"in e){var r=e.transform.baseVal;if(!r)return"";var i=r.length;if(!i)return"";for(var n=[],a=0;a<i;++a)(e=>{var t=r[e].matrix;n.push("matrix(".concat(["a","b","c","d","e","f"].map(function(e){return t[e]}).join(", "),")"))})(a);return n.join(" ")}return""}function getOffsetInfo(e,t,r,i,n){for(var a,s,o,l,u=getDocumentElement(e)||getDocumentBody(e),c=!1,h=(l=!e||r?e:(s=null==(s=null==e?void 0:e.assignedSlot)?void 0:s.parentElement,o=e.parentElement,s?(c=!0,a=o,s):o),!1),d=e===t||l===t,p="relative",f=1,m=parseFloat(null==n?void 0:n("zoom"))||1,g=null==n?void 0:n("position");l&&l!==u;){t===l&&(d=!0);var v=getCachedStyle(l),y=l.tagName.toLowerCase(),_=getElementTransform(l),b=v("willChange"),x=parseFloat(v("zoom"))||1,p=v("position");if(i&&1!==x){f=x;break}if(!r&&i&&1!==m&&g&&"absolute"!==g||"svg"===y||"static"!==p||_&&"none"!==_||"transform"===b)break;x=null==(v=null==e?void 0:e.assignedSlot)?void 0:v.parentNode,y=l.parentNode,_=(x&&(c=!0,a=y),y);if(_&&11===_.nodeType){h=!0,p=getCachedStyle(l=_.host)("position");break}l=_,p="relative"}return{offsetZoom:f,hasSlot:c,parentSlotElement:a,isCustomElement:h,isStatic:"static"===p,isEnd:d||!l||l===u,offsetParent:l||u}}function getOffsetPosInfo(e,t){var r,i,n=e.tagName.toLowerCase(),a=e.offsetLeft,s=e.offsetTop,o=getCachedStyle(e),l=isUndefined(a),u=!l;return u||"svg"===n?i=(r=getTransformOriginArray(o("transformOrigin")).map(function(e){return parseFloat(e)})).slice():(i=(r=IS_WEBKIT605?getBeforeTransformOrigin(e):getTransformOriginArray(o("transformOrigin")).map(function(e){return parseFloat(e)})).slice(),u=!0,a=(o=__read(getSVGGraphicsOffset(e,r,e===t&&"g"===t.tagName.toLowerCase()),4))[0],s=o[1],r[0]=o[2],r[1]=o[3]),{tagName:n,isSVG:l,hasOffset:u,offset:[a||0,s||0],origin:r,targetOrigin:i}}function getBodyOffset(e,t){var r=getCachedStyle(e),e=getCachedStyle(getDocumentBody(e)),i=e("position");return t||i&&"static"!==i?(t=parseInt(e("marginLeft"),10),i=parseInt(e("marginTop"),10),"absolute"===r("position")&&("auto"===r("top")&&"auto"===r("bottom")||(i=0),"auto"===r("left")&&"auto"===r("right")||(t=0)),[t,i]):[0,0]}function convert3DMatrixes(e){e.forEach(function(e){var t=e.matrix;t&&(e.matrix=convertDimension(t,3,4))})}function getPositionFixedInfo(e){for(var t=e.parentElement,r=!1,i=getDocumentBody(e);t;){var n=getComputedStyle$1(t).transform;if(n&&"none"!==n){r=!0;break}if(t===i)break;t=t.parentElement}return{fixedContainer:t||i,hasTransform:r}}function makeMatrixCSS(e,t){return void 0===t&&(t=9<e.length),"".concat(t?"matrix3d":"matrix","(").concat(convertMatrixtoCSS(e,!t).join(","),")")}function getSVGViewBox(e){var t=e.clientWidth,r=e.clientHeight;return e?{x:(e=(e=e.viewBox)&&e.baseVal||{x:0,y:0,width:0,height:0}).x,y:e.y,width:e.width||t,height:e.height||r,clientWidth:t,clientHeight:r}:{x:0,y:0,width:0,height:0,clientWidth:t,clientHeight:r}}function getSVGMatrix(e,t){var r,i=getSVGViewBox(e),n=i.width,a=i.height,s=i.clientWidth,i=i.clientHeight,o=s/n,l=i/a,e=e.preserveAspectRatio.baseVal,u=e.align,e=e.meetOrSlice,c=[0,0],h=[o,l],d=[0,0],o=(1!==u&&(r=(u-2)%3,u=Math.floor((u-2)/3),c[0]=n*r/2,c[1]=a*u/2,e=2===e?Math.max(l,o):Math.min(o,l),h[0]=e,h[1]=e,d[0]=(s-n)/2*r,d[1]=(i-a)/2*u),createScaleMatrix(h,t)),l=__read(d,2);return o[t*(t-1)]=l[0],o[t*(t-1)+1]=l[1],getAbsoluteMatrix(o,t,c)}function getSVGGraphicsOffset(e,t,r){var i,n;return!e.getBBox||!r&&"g"===e.tagName.toLowerCase()?[0,0,0,0]:(r="fill-box"===getCachedStyle(e)("transform-box"),n=e.getBBox(),e=getSVGViewBox(e.ownerSVGElement),[i=n.x-e.x,n=n.y-e.y,r?t[0]:t[0]-i,r?t[1]:t[1]-n])}function calculatePosition(e,t,r){return calculate(e,convertPositionMatrix(t,r),r)}function calculatePoses(t,e,r,i){return[[0,0],[e,0],[0,r],[e,r]].map(function(e){return calculatePosition(t,e,i)})}function getRect(e){var t=e.map(function(e){return e[0]}),e=e.map(function(e){return e[1]}),r=Math.min.apply(Math,__spreadArray([],__read(t),!1)),i=Math.min.apply(Math,__spreadArray([],__read(e),!1)),t=Math.max.apply(Math,__spreadArray([],__read(t),!1)),e=Math.max.apply(Math,__spreadArray([],__read(e),!1));return{left:r,top:i,right:t,bottom:e,width:t-r,height:e-i}}function calculateRect(e,t,r,i){return getRect(calculatePoses(e,t,r,i))}function getSVGOffset(e,t,r,i,n){for(var a=e.target,e=e.origin,s=t.matrix,t=getSize(a),o=t.offsetWidth,l=t.offsetHeight,t=r.getBoundingClientRect(),u=[0,0],a=(r===getDocumentBody(r)&&(u=getBodyOffset(a,!0)),a.getBoundingClientRect()),c=a.left-t.left+r.scrollLeft-(r.clientLeft||0)+u[0],h=a.top-t.top+r.scrollTop-(r.clientTop||0)+u[1],t=a.width,r=a.height,u=multiplies(i,n,s),a=calculateRect(u,o,l,i),d=a.left,p=a.top,f=a.width,a=a.height,m=calculatePosition(u,e,i),u=minus(m,[d,p]),g=[c+u[0]*t/f,h+u[1]*r/a],v=[0,0],y=0;++y<10;){var _=invert(n,i),_=__read(minus(calculatePosition(_,g,i),calculatePosition(_,m,i)),2);v[0]=_[0],v[1]=_[1];var _=calculateRect(multiplies(i,n,createOriginMatrix(v,i),s),o,l,i),b=_.left-c,_=_.top-h;if(abs(b)<2&&abs(_)<2)break;g[0]-=b,g[1]-=_}return v.map(function(e){return Math.round(e)})}function calculateMoveableClientPositions(t,e,r){var i=16===t.length?4:3,e=e.map(function(e){return calculatePosition(t,e,i)}),n=r.left,a=r.top;return e.map(function(e){return[e[0]+n,e[1]+a]})}function getDistSize(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function getDiagonalSize(e,t){return getDistSize([t[0]-e[0],t[1]-e[1]])}function getLineStyle(e,t,r,i){void 0===r&&(r=1),void 0===i&&(i=getRad$1(e,t));t=getDiagonalSize(e,t);return{transform:"translateY(-50%) translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(i,"rad) scaleY(").concat(r,")"),width:"".concat(t,"px")}}function getControlTransform(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=r.length,a=r.reduce(function(e,t){return e+t[0]},0)/n,n=r.reduce(function(e,t){return e+t[1]},0)/n;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(n,"px) rotate(").concat(e,"rad) scale(").concat(t,")")}}function getProps(e,t){t=e[t];return isObject(t)?__assign(__assign({},e),t):e}function getSize(e){var t,r,i,n,a,s,o,l,u,c,h=e&&!isUndefined(e.offsetWidth),d=0,p=0,f=0,m=0,g=0,v=0,y=0,_=0,b=0,x=0,S=0,T=0,E=1/0,C=1/0,A=1/0,w=1/0,P=0,M=0,I=!1;return e&&(m=h||"svg"===e.tagName.toLowerCase()?(h=getCachedStyle(e),t=e.style,r="border-box"===h("boxSizing"),a=parseFloat(h("borderLeftWidth"))||0,n=parseFloat(h("borderRightWidth"))||0,s=parseFloat(h("borderTopWidth"))||0,o=parseFloat(h("borderBottomWidth"))||0,a=(i=(parseFloat(h("paddingLeft"))||0)+(parseFloat(h("paddingRight"))||0))+(a+n),s=(n=(parseFloat(h("paddingTop"))||0)+(parseFloat(h("paddingBottom"))||0))+(s+o),o=h("position"),u=l=0,"clientLeft"in e&&(c=null,c="absolute"===o?getOffsetInfo(e,getDocumentBody(e)).offsetParent:e.parentElement)&&(o=getCachedStyle(c),l=parseFloat(o("width")),u=parseFloat(o("height"))),b=Math.max(i,convertUnitSize(h("minWidth"),l)||0),x=Math.max(n,convertUnitSize(h("minHeight"),u)||0),E=convertUnitSize(h("maxWidth"),l),C=convertUnitSize(h("maxHeight"),u),isNaN(E)&&(E=1/0),isNaN(C)&&(C=1/0),P=convertUnitSize(t.width,0)||0,M=convertUnitSize(t.height,0)||0,g=parseFloat(h("width"))||0,v=parseFloat(h("height"))||0,f=d=y=abs(g-P)<1?between(b,P||g,E):g,m=p=_=abs(v-M)<1?between(x,M||v,C):v,r?(A=E,w=C,S=b,T=x,y=d-a,_=p-s):(A=E+a,w=C+s,S=b+a,T=x+s,d=y+a,p=_+s),f=y+i,_+n):(I=!0,g=d=(c=e.getBBox()).width,v=p=c.height,f=y=d,_=p)),{svg:I,offsetWidth:d,offsetHeight:p,clientWidth:f,clientHeight:m,contentWidth:y,contentHeight:_,inlineCSSWidth:P,inlineCSSHeight:M,cssWidth:g,cssHeight:v,minWidth:b,minHeight:x,maxWidth:E,maxHeight:C,minOffsetWidth:S,minOffsetHeight:T,maxOffsetWidth:A,maxOffsetHeight:w}}function getRotationRad(e,t){return getRad$1(0<t?e[0]:e[1],0<t?e[1]:e[0])}function resetClientRect(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function getExtendsRect(e,t){var r=e===getDocumentBody(e)||e===getDocumentElement(e),i={clientLeft:e.clientLeft,clientTop:e.clientTop,clientWidth:e.clientWidth,clientHeight:e.clientHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,overflow:!1};return r&&(i.clientHeight=Math.max(t.height,i.clientHeight),i.scrollHeight=Math.max(t.height,i.scrollHeight)),i.overflow="visible"!==getCachedStyle(e)("overflow"),__assign(__assign({},t),i)}function getClientRectByPosition(e,t,r,i){var n=e.left,a=e.right,s=e.top,e=e.bottom,o=t.top,t=t.left,t={left:t+n,top:o+s,right:t+a,bottom:o+e,width:a-n,height:e-s};return r&&i?getExtendsRect(r,t):t}function getClientRect(e,t){var r=0,i=0,n=0,a=0,s=(e&&(r=(s=e.getBoundingClientRect()).left,i=s.top,n=s.width,a=s.height),{left:r,top:i,width:n,height:a,right:r+n,bottom:i+a});return e&&t?getExtendsRect(e,s):s}function getTotalOrigin(e){var t=e.props,r=t.groupable,t=t.svgOrigin,e=e.getState(),i=e.offsetWidth,n=e.transformOrigin;return!r&&e.svg&&t?convertTransformOriginArray(t,i,e.offsetHeight):n}function getTotalDirection(e,t,r,i){return e||(t?[0,0]:getDirection(r.target,i))}function getDirection(e,t){if(e){var r=e.getAttribute("data-rotation")||"",e=e.getAttribute("data-direction");if(t.deg=r,e)return t=[0,0],-1<e.indexOf("w")&&(t[0]=-1),-1<e.indexOf("e")&&(t[0]=1),-1<e.indexOf("n")&&(t[1]=-1),-1<e.indexOf("s")&&(t[1]=1),t}}function getAbsolutePoses(e,t){return[plus(t,e[0]),plus(t,e[1]),plus(t,e[2]),plus(t,e[3])]}function getAbsolutePosesByState(e){var t=e.left;return getAbsolutePoses([e.pos1,e.pos2,e.pos3,e.pos4],[t,e.top])}function unsetAbles(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(e){e.unset&&e.unset(t)})}function unsetGesto(e,t){var r=t?"controlGesto":"targetGesto",i=e[r];!1===(null==i?void 0:i.isIdle())&&unsetAbles(e,t),null!=i&&i.unset(),e[r]=null}function fillCSSObject(t,e){return e&&((e=getBeforeRenderableDatas(e)).nextStyle=__assign(__assign({},e.nextStyle),t)),{style:t,cssText:getKeys(t).map(function(e){return"".concat(decamelize(e,"-"),": ").concat(t[e],";")}).join("")}}function fillAfterTransform(e,t,r){var i=t.afterTransform||t.transform;return __assign(__assign({},fillCSSObject(__assign(__assign(__assign({},e.style),t.style),{transform:i}),r)),{afterTransform:i,transform:e.transform})}function fillParams(e,t,r,i){var n=t.datas,r=(n.datas||(n.datas={}),__assign(__assign({},r),{target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,moveable:e,datas:n.datas,isRequest:t.isRequest,isRequestChild:t.isRequestChild,isFirstDrag:!!t.isFirstDrag,isTrusted:!1!==t.isTrusted,stopAble:function(){n.isEventStart=!1},stopDrag:function(){var e;null!=(e=t.stop)&&e.call(t)}}));return n.isStartEvent?i||(n.lastEvent=r):n.isStartEvent=!0,r}function fillEndParams(e,t,r){var i=t.datas,n=("isDrag"in r?r:t).isDrag;return i.datas||(i.datas={}),__assign(__assign({isDrag:n},r),{moveable:e,target:e.state.target,clientX:t.clientX,clientY:t.clientY,inputEvent:t.inputEvent,currentTarget:e,lastEvent:i.lastEvent,isDouble:t.isDouble,datas:i.datas,isFirstDrag:!!t.isFirstDrag})}function catchEvent(e,t,r){e._emitter.on(t,r)}function triggerEvent(e,t,r,i,n){return e.triggerEvent(t,r,i,n)}function getComputedStyle$1(e,t){return getWindow(e).getComputedStyle(e,t)}function filterAbles(e,r,i){var n={},a={};return e.filter(function(t){var e=t.name;if(n[e]||!r.some(function(e){return t[e]}))return!1;if(!i&&t.ableGroup){if(a[t.ableGroup])return!1;a[t.ableGroup]=!0}return n[e]=!0})}function equals(e,t){return e===t||null==e&&null==t}function selectValue(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length-1,i=0;i<r;++i){var n=e[i];if(!isUndefined(n))return n}return e[r]}function groupBy(n,a){var s=[],o=[];return n.forEach(function(e,t){var t=a(e,t,n),r=o.indexOf(t),i=s[r]||[];-1===r&&(o.push(t),s.push(i)),i.push(e)}),s}function groupByMap(i,n){var a=[],s={};return i.forEach(function(e,t){var t=n(e,t,i),r=s[t];r||(s[t]=r=[],a.push(r)),r.push(e)}),a}function flat(e){return e.reduce(function(e,t){return e.concat(t)},[])}function maxOffset(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.sort(function(e,t){return abs(t)-abs(e)}),e[0]}function calculateInversePosition(e,t,r){return calculate(invert(e,r),convertPositionMatrix(t,r),r)}function convertDragDist(e,t){var r=e.is3d,e=__read(calculateInversePosition(e.rootMatrix,[t.distX,t.distY],r?4:3),2);return t.distX=e[0],t.distY=e[1],t}function calculatePadding(e,t,r,i){var n,a;return r[0]||r[1]?(n=calculatePosition(e,[normalized(r[0]),0],i),a=calculatePosition(e,[0,normalized(r[1])],i),plus(t,calculatePosition(e,[r[0]/getDistSize(n),r[1]/getDistSize(a)],i))):t}function convertCSSSize(e,t,r){return r?"".concat(e/t*100,"%"):"".concat(e,"px")}function getTinyDist(e){return abs(e)<=TINY_NUM?0:e}function getDirectionViewClassName(t){return function(e){return e.isDragging(t)&&(e=getGestoData(e,t).deg)?prefix("view-control-rotation".concat(e)):""}}function getDirectionCondition(i,n){return void 0===n&&(n=[i]),function(e,t){var r;return t.isRequest?!!n.some(function(e){return t.requestAble===e})&&t.parentDirection:hasClass(r=t.inputEvent.target,prefix("direction"))&&(!i||hasClass(r,prefix(i)))}}function convertTransformInfo(e,t,r){var i=parse(e,{"x%":function(e){return e/100*t.offsetWidth},"y%":function(e){return e/100*t.offsetHeight}}),n=e.slice(0,r<0?void 0:r),a=e.slice(0,r<0?void 0:r+1),s=e[r]||"",o=r<0?[]:e.slice(r),l=r<0?[]:e.slice(r+1),u=i.slice(0,r<0?void 0:r),c=i.slice(0,r<0?void 0:r+1),h=null!=(h=i[r])?h:parse([""])[0],d=r<0?[]:i.slice(r),i=r<0?[]:i.slice(r+1),r=h?[h]:[],h=toMat(u),p=toMat(c),f=toMat(d),m=toMat(i),g=multiply(h,f,4);return{transforms:e,beforeFunctionMatrix:h,beforeFunctionMatrix2:p,targetFunctionMatrix:toMat(r),afterFunctionMatrix:f,afterFunctionMatrix2:m,allFunctionMatrix:g,beforeFunctions:u,beforeFunctions2:c,targetFunction:r[0],afterFunctions:d,afterFunctions2:i,beforeFunctionTexts:n,beforeFunctionTexts2:a,targetFunctionText:s,afterFunctionTexts:o,afterFunctionTexts2:l}}function isArrayFormat(e){return!(!e||!isObject(e)||isNode(e))&&(isArray(e)||"length"in e)}function getRefTarget(e,t){return e?isNode(e)?e:isString(e)?t?document.querySelector(e):e:isFunction(e)?e():!isWindow(e)&&"current"in e?e.current:e:null}function getRefTargets(e,r){return e?(isArrayFormat(e)?[].slice.call(e):[e]).reduce(function(e,t){return isString(t)&&r?__spreadArray(__spreadArray([],__read(e),!1),__read([].slice.call(document.querySelectorAll(t))),!1):(isArray(t)?e.push(getRefTargets(t,r)):e.push(getRefTarget(t,r)),e)},[]):[]}function getAbsoluteRotation(e,t,r){e=getRad$1(e,t)/Math.PI*180;return 0<=(e=0<=r?e:180-e)?e:360+e}function getDragDistByState(e,t){var r=e.rootMatrix,e=e.is3d,r=invert(r,e?4:3);return(r=e?r:convertDimension(r,3,4))[12]=0,r[13]=0,r[14]=0,calculateMatrixDist(r,t)}function getSizeDistByDist(e,t,r,i,n){var a,s,o,e=__read(e,2),l=e[0],e=e[1],u=0,c=0;return n&&l&&e?(n=getRad$1([0,0],t),a=getRad$1([0,0],i),s=getDistSize(t),n=Math.cos(n-a)*s,i[0]?i[1]?(a=i[0]*l,s=i[1]*e,l=Math.atan2(a+t[0],s+t[1]),e=Math.atan2(a,s),l<0&&(l+=2*Math.PI),e<0&&(e+=2*Math.PI),o=0,o=abs(l-e)<Math.PI/2||abs(l-e)>Math.PI/2*3?l-e:l-(e+=Math.PI),2*Math.PI<o?o-=2*Math.PI:o>Math.PI?o=2*Math.PI-o:o<-Math.PI&&(o=-2*Math.PI-o),u=(l=getDistSize([a+t[0],s+t[1]])*Math.cos(o))*Math.sin(e)-a,c=l*Math.cos(e)-s,i[0]<0&&(u*=-1),i[1]<0&&(c*=-1)):c=(u=n)/r:u=(c=n)*r):(u=i[0]*t[0],c=i[1]*t[1]),[u,c]}function getOffsetSizeDist(t,e,r,i){var n,a=r.ratio,s=r.startOffsetWidth,o=r.startOffsetHeight,l=0,u=0,c=i.distX,h=i.distY,d=i.pinchScale,p=i.parentDistance,f=i.parentDist,i=i.parentScale,m=r.fixedDirection,g=[0,1].map(function(e){return abs(t[e]-m[e])}),v=[0,1].map(function(e){e=g[e];return e=0!==e?2/e:e});return f?(l=f[0],u=f[1],e&&(l?u=u||l/a:l=u*a)):u=isNumber(d)?(l=(d-1)*s,(d-1)*o):i?(l=(i[0]-1)*s,(i[1]-1)*o):p?(l=p/(i=getDistSize([f=s*g[0],d=o*g[1]]))*f*v[0],p/i*d*v[1]):(n=getDragDist({datas:r,distX:c,distY:h}),l=(f=__read(getSizeDistByDist([s,o],n=v.map(function(e,t){return n[t]*e}),a,t,e),2))[0],f[1]),{distWidth:l,distHeight:u}}function convertTransformUnit(e,t){var r,i;return t?"left"===e?{x:"0%",y:"50%"}:"top"===e||"center"===e?{x:"50%",y:"50%"}:"right"===e?{x:"100%",y:"50%"}:"bottom"===e?{x:"50%",y:"100%"}:(r=(t=__read(e.split(" "),2))[0],t=t[1],r=convertTransformUnit(r||""),t=convertTransformUnit(t||""),i={x:"50%",y:"50%"},(r=__assign(__assign({},r),t)).x&&(i.x=r.x),r.y&&(i.y=r.y),r.value&&(r.x&&!r.y&&(i.y=r.value),!r.x)&&r.y&&(i.x=r.value),i):"left"===e?{x:"0%"}:"right"===e?{x:"100%"}:"top"===e?{y:"0%"}:"bottom"===e?{y:"100%"}:e?"center"===e?{value:"50%"}:{value:e}:{}}function convertTransformOriginArray(e,t,r){var e=convertTransformUnit(e,!0),i=e.x,e=e.y;return[convertUnitSize(i,t)||0,convertUnitSize(e,r)||0]}function rotatePosesInfo(e,t,r){var e=e.map(function(e){return minus(e,t)}),i=e.map(function(e){return rotate(e,r)});return{prev:e,next:i,result:i.map(function(e){return plus(e,t)})}}function isDeepArrayEquals(e,n){return e.length===n.length&&e.every(function(e,t){var t=n[t],r=isArray(e),i=isArray(t);return r&&i?isDeepArrayEquals(e,t):!r&&!i&&e===t})}function watchValue(e,t,r,i,n){var e=e._store,a=e[t];if(!(t in e)){if(null==n)return e[t]=r;a=e[t]=n}return a===r||i(a)===i(r)?a:e[t]=r}function sign(e){return 0<=e?1:-1}function abs(e){return Math.abs(e)}function countEach(e,t){return counter(e).map(function(e){return t(e)})}function getPaddingBox(e){return isNumber(e)?{top:e,left:e,right:e,bottom:e}:{left:e.left||0,top:e.top||0,right:e.right||0,bottom:e.bottom||0}}var Pinchable=makeAble("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(r,i){var n,e,t,a=i.datas,s=i.targets,o=i.angle,l=i.originalDatas,u=r.props,c=u.pinchable,u=u.ables;return!!c&&(t="onPinch".concat(s?"Group":"","Start"),n="drag".concat(s?"Group":"","ControlStart"),u=(!0===c?r.controlAbles:u.filter(function(e){return-1<c.indexOf(e.name)})).filter(function(e){return e.canPinch&&e[n]}),e=fillParams(r,i,{}),s&&(e.targets=s),s=triggerEvent(r,t,e),a.isPinch=!1!==s,a.ables=u,!!(t=a.isPinch))&&(u.forEach(function(e){var t;l[e.name]=l[e.name]||{},e[n]&&(t=__assign(__assign({},i),{datas:l[e.name],parentRotate:o,isPinch:!0}),e[n](r,t))}),r.state.snapRenderInfo={request:i.isRequest,direction:[0,0]},t)},pinch:function(t,r){var i,e,n,a,s=r.datas,o=r.scale,l=r.originalDatas,u=r.inputEvent,c=r.targets,h=r.angle;if(s.isPinch)return i=r.distance*(1-1/o),e=fillParams(t,r,{}),c&&(e.targets=c),n="onPinch".concat(c?"Group":""),triggerEvent(t,n,e),n=s.ables,a="drag".concat(c?"Group":"","Control"),n.forEach(function(e){e[a]&&e[a](t,__assign(__assign({},r),{datas:l[e.name],inputEvent:u,resolveMatrix:!0,pinchScale:o,parentDistance:i,parentRotate:h,isPinch:!0}))}),e},pinchEnd:function(t,r){var e,i,n,a=r.datas,s=r.isPinch,o=r.inputEvent,l=r.targets,u=r.originalDatas;if(a.isPinch)return i="onPinch".concat(l?"Group":"","End"),e=fillEndParams(t,r,{isDrag:s}),l&&(e.targets=l),triggerEvent(t,i,e),i=a.ables,n="drag".concat(l?"Group":"","ControlEnd"),i.forEach(function(e){e[n]&&e[n](t,__assign(__assign({},r),{isDrag:s,datas:u[e.name],inputEvent:o,isPinch:!0}))}),s},pinchGroupStart:function(e,t){return this.pinchStart(e,__assign(__assign({},t),{targets:e.props.targets}))},pinchGroup:function(e,t){return this.pinch(e,__assign(__assign({},t),{targets:e.props.targets}))},pinchGroupEnd:function(e,t){return this.pinchEnd(e,__assign(__assign({},t),{targets:e.props.targets}))}}),directionCondition=getDirectionCondition("scalable"),Scalable={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:getRenderDirections("scalable"),dragControlCondition:directionCondition,viewClassName:getDirectionViewClassName("scalable"),dragControlStart:function(e,t){var r=t.datas,i=t.isPinch,n=getTotalDirection(t.parentDirection,i,t.inputEvent,r),a=e.state,s=a.width,o=a.height,l=a.targetTransform,u=a.pos1,c=a.pos2,h=a.pos4;if(!n||!a.target)return!1;i||setDragStart(e,t),r.datas={},r.transform=l,r.prevDist=[1,1],r.direction=n,r.startOffsetWidth=s,r.startOffsetHeight=o,r.startValue=[1,1];a=!n[0]&&!n[1]||n[0]||!n[1];function d(e){r.ratio=e&&isFinite(e)?e:0}function p(e){e=getFixedDirectionInfo(r.startPositions,e);r.fixedDirection=e.fixedDirection,r.fixedPosition=e.fixedPosition,r.fixedOffset=e.fixedOffset}setDefaultTransformIndex(e,t,"scale"),r.isWidth=a,r.startPositions=getAbsolutePosesByState(e.state),r.setFixedDirection=p,d(getDist$2(u,c)/getDist$2(c,h)),p([-n[0],-n[1]]);function f(e){r.minScaleSize=e}function m(e){r.maxScaleSize=e}f([-1/0,-1/0]),m([1/0,1/0]);i=fillParams(e,t,__assign(__assign({direction:n,set:function(e){r.startValue=e},setRatio:d,setFixedDirection:p,setMinScaleSize:f,setMaxScaleSize:m},fillTransformStartEvent(e,t)),{dragStart:Draggable.dragStart(e,(new CustomGesto).dragStart([0,0],t))})),l=triggerEvent(e,"onScaleStart",i);return r.startFixedDirection=r.fixedDirection,!1!==l&&(r.isScale=!0,e.state.snapRenderInfo={request:t.isRequest,direction:n}),!!r.isScale&&i},dragControl:function(e,n){resolveTransformEvent(e,n,"scale");var t,a,s,o,r,i,l,u,c,h=n.datas,d=n.parentKeepRatio,p=n.parentFlag,f=n.isPinch,m=n.dragClient,g=n.isRequest,v=n.useSnap,y=n.resolveMatrix,_=h.prevDist,b=h.direction,x=h.startOffsetWidth,S=h.startOffsetHeight,T=h.isScale,E=h.startValue,C=h.isWidth,A=h.ratio;return!(!T||(c=(T=e.props).throttleScale,t=T.parentMoveable,(a=b)[0]||b[1]||(a=[1,1]),s=A&&(null!=d?d:T.keepRatio)||!1,d=e.state,o=[E[0],E[1]],l=w(),!f&&e.props.groupable&&isArray(T=(d.snapRenderInfo||{}).direction)&&(T[0]||T[1])&&(d.snapRenderInfo={direction:b,request:n.isRequest}),triggerEvent(e,"onBeforeScale",fillParams(e,n,{scale:l,setFixedDirection:function(e){return h.setFixedDirection(e),l=w()},startFixedDirection:h.startFixedDirection,setScale:function(e){l=e}},!0)),u=[l[0]/o[0],l[1]/o[1]],T=[0,0],(p=!(d=m)&&!p&&f)||y?d=getTranslateFixedPosition(e,h.targetAllTransform,[0,0],[0,0],h):m||(d=h.fixedPosition),f||(T=checkSnapScale(e,u,b,!v&&g,h)),s?(a[0]&&a[1]&&T[0]&&T[1]&&(Math.abs(T[0]*x)>Math.abs(T[1]*S)?T[1]=0:T[0]=0),(y=!T[0]&&!T[1])&&(C?u[0]=throttle(u[0]*o[0],c)/o[0]:u[1]=throttle(u[1]*o[1],c)/o[1]),a[0]&&!a[1]||T[0]&&!T[1]||y&&C?(u[0]+=T[0],m=x*u[0]*o[0]/A,u[1]=m/S/o[1]):(!a[0]&&a[1]||!T[0]&&T[1]||y&&!C)&&(u[1]+=T[1],v=S*u[1]*o[1]*A,u[0]=v/x/o[0])):(u[0]+=T[0],u[1]+=T[1],T[0]||(u[0]=throttle(u[0]*o[0],c)/o[0]),T[1]||(u[1]=throttle(u[1]*o[1],c)/o[1])),0===u[0]&&(u[0]=sign(_[0])*MIN_SCALE),0===u[1]&&(u[1]=sign(_[1])*MIN_SCALE),l=multiply2(u,[o[0],o[1]]),r=[x,S],i=calculateBoundSize(i=[x*l[0],S*l[1]],h.minScaleSize,h.maxScaleSize,!!s&&A),l=countEach(2,function(e){return r[e]?i[e]/r[e]:i[e]}),u=countEach(2,function(e){return l[e]/o[e]}),g=countEach(2,function(e){return _[e]?u[e]/_[e]:u[e]}),m="scale(".concat(u.join(", "),")"),y="scale(".concat(l.join(", "),")"),C=convertTransformFormat(h,y,m),T=getScaleDist(e,(v=!E[0]||!E[1])?y:m,h.fixedDirection,d,h.fixedOffset,h,v),c=p?T:minus(T,h.prevInverseDist||[0,0]),h.prevDist=u,h.prevInverseDist=T,l[0]===_[0]&&l[1]===_[1]&&c.every(function(e){return!e})&&!t&&!p))&&(triggerEvent(e,"onScale",A=fillParams(e,n,__assign({offsetWidth:x,offsetHeight:S,direction:b,scale:l,dist:u,delta:g,isPinch:!!f},fillTransformEvent(e,C,c,f,n)))),A);function w(){var e=getOffsetSizeDist(a,s,h,n),t=e.distWidth,e=e.distHeight,r=x?(x+t)/x:1,i=S?(S+e)/S:1,t=(E[0]||(o[0]=t/x),E[1]||(o[1]=e/S),(a[0]||s?r:1)*o[0]),e=(a[1]||s?i:1)*o[1];return[t=0===t?sign(_[0])*MIN_SCALE:t,e=0===e?sign(_[1])*MIN_SCALE:e]}},dragControlEnd:function(e,t){var r=t.datas;if(!r.isScale)return!1;r.isScale=!1;r=fillEndParams(e,t,{});return triggerEvent(e,"onScaleEnd",r),r},dragGroupControlCondition:directionCondition,dragGroupControlStart:function(i,e){var n,t,r,a=e.datas,s=this.dragControlStart(i,e);return!!s&&(n=fillChildEvents(i,"resizable",e),a.moveableScale=i.scale,t=triggerChildAbles(i,this,"dragControlStart",e,function(e,t){return startChildDist(i,e,a,t)}),a.setFixedDirection=e=function(r){s.setFixedDirection(r),t.forEach(function(e,t){e.setFixedDirection(r),startChildDist(i,e.moveable,a,n[t])})},e=__assign(__assign({},s),{targets:i.props.targets,events:t,setFixedDirection:e}),r=triggerEvent(i,"onScaleGroupStart",e),a.isScale=!1!==r,!!a.isScale)&&e},dragGroupControl:function(n,t){var e=t.datas;if(e.isScale){catchEvent(n,"onBeforeScale",function(e){triggerEvent(n,"onBeforeScaleGroup",fillParams(n,t,__assign(__assign({},e),{targets:n.props.targets}),!0))});var a,s,o,r,i=this.dragControl(n,t);if(i)return a=i.dist,r=e.moveableScale,n.scale=[a[0]*r[0],a[1]*r[1]],s=n.props.keepRatio,o=e.fixedPosition,r=triggerChildAbles(n,this,"dragControl",t,function(e,t){var r=__read(calculate(createRotateMatrix(n.rotation/180*Math.PI,3),[t.datas.originalX*a[0],t.datas.originalY*a[1],1],3),2),i=r[0],r=r[1];return __assign(__assign({},t),{parentDist:null,parentScale:a,parentKeepRatio:s,dragClient:plus(o,[i,r])})}),e=__assign({targets:n.props.targets,events:r},i),triggerEvent(n,"onScaleGroup",e),e}},dragGroupControlEnd:function(e,t){var r,i=t.isDrag;if(t.datas.isScale)return this.dragControlEnd(e,t),r=triggerChildAbles(e,this,"dragControlEnd",t),triggerEvent(e,"onScaleGroupEnd",fillEndParams(e,t,{targets:e.props.targets,events:r})),i},request:function(){var t={},r=0,i=0,n=!1;return{isControl:!0,requestStart:function(e){return n=e.useSnap,{datas:t,parentDirection:e.direction||[1,1],useSnap:n}},request:function(e){return r+=e.deltaWidth,{datas:t,parentDist:[r,i+=e.deltaHeight],parentKeepRatio:e.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function getMiddleLinePos(e,r){return e.map(function(e,t){return dot(e,r[t],1,2)})}function getTriangleRad(e,t,r){t=getRad$1(e,t),e=getRad$1(e,r)-t;return 0<=e?e:e+2*Math.PI}function isValidPos(e,t){var e=getTriangleRad(e[0],e[1],e[2]),t=getTriangleRad(t[0],t[1],t[2]),r=Math.PI;return!(r<=e&&t<=r||e<=r&&r<=t)}var Warpable={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:getDirectionViewClassName("warpable"),render:function(e,t){var r,i,n,a,s,o,l,u=e.props,c=u.resizable,h=u.zoom;return c||u.scalable||!u.warpable?[]:(u=(c=e.state).pos1,s=c.pos3,l=c.pos4,r=getMiddleLinePos(u,c=c.pos2),i=getMiddleLinePos(c,u),n=getMiddleLinePos(u,s),u=getMiddleLinePos(s,u),a=getMiddleLinePos(s,l),s=getMiddleLinePos(l,s),o=getMiddleLinePos(c,l),l=getMiddleLinePos(l,c),__spreadArray([t.createElement("div",{className:prefix("line"),key:"middeLine1",style:getLineStyle(r,a,h)}),t.createElement("div",{className:prefix("line"),key:"middeLine2",style:getLineStyle(i,s,h)}),t.createElement("div",{className:prefix("line"),key:"middeLine3",style:getLineStyle(n,o,h)}),t.createElement("div",{className:prefix("line"),key:"middeLine4",style:getLineStyle(u,l,h)})],__read(renderAllDirections(e,"warpable",t)),!1))},dragControlCondition:function(e,t){return!t.isRequest&&hasClass(t=t.inputEvent.target,prefix("direction"))&&hasClass(t,prefix("warpable"))},dragControlStart:function(e,t){var r,i,n,a,s,o,l,u,c=t.datas,h=e.props.target,d=getDirection(t.inputEvent.target,c);return!(!d||!h)&&(h=e.state,r=h.transformOrigin,i=h.is3d,n=h.targetTransform,a=h.targetMatrix,s=h.width,o=h.height,l=h.left,u=h.top,c.datas={},c.targetTransform=n,c.warpTargetMatrix=i?a:convertDimension(a,3,4),c.targetInverseMatrix=ignoreDimension(invert(c.warpTargetMatrix,4),3,4),c.direction=d,c.left=l,c.top=u,c.poses=[[0,0],[s,0],[0,o],[s,o]].map(function(e){return minus(e,r)}),c.nextPoses=c.poses.map(function(e){var e=__read(e,2),t=e[0];return calculate(c.warpTargetMatrix,[t,e[1],0,1],4)}),c.startValue=createIdentityMatrix(4),c.prevMatrix=createIdentityMatrix(4),c.absolutePoses=getAbsolutePosesByState(h),c.posIndexes=getPosIndexesByDirection(d),setDragStart(e,t),setDefaultTransformIndex(e,t,"matrix3d"),!(h.snapRenderInfo={request:t.isRequest,direction:d})!==triggerEvent(e,"onWarpStart",fillParams(e,t,__assign({set:function(e){c.startValue=e}},fillTransformStartEvent(e,t))))&&(c.isWarp=!0),c.isWarp)},dragControl:function(e,t){var r=t.datas,i=t.isRequest,n=t.distX,a=t.distY,s=r.targetInverseMatrix,o=r.prevMatrix,l=r.startValue,u=r.poses,c=r.posIndexes,h=r.absolutePoses;if(!r.isWarp)return!1;resolveTransformEvent(e,t,"matrix3d"),hasGuidelines(e,"warpable")&&(1<(d=c.map(function(e){return h[e]})).length&&d.push([(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2]),d=(i=checkMoveableSnapBounds(e,i,{horizontal:d.map(function(e){return e[1]+a}),vertical:d.map(function(e){return e[0]+n})})).horizontal,a-=d.offset,n-=i.vertical.offset);var d,p=getDragDist({datas:r,distX:n,distY:a},!0),f=r.nextPoses.slice();return c.forEach(function(e){f[e]=plus(f[e],p)}),!!NEARBY_POS.every(function(e){return isValidPos(e.map(function(e){return u[e]}),e.map(function(e){return f[e]}))})&&!!(d=createWarpMatrix(u[0],u[2],u[1],u[3],f[0],f[2],f[1],f[3])).length&&(i=getTransfromMatrix(r,multiply(s,d,4),!0),c=multiply(invert(o,4),i,4),s=multiply(l,r.prevMatrix=i,4),fillOriginalTransform(t,d=convertTransformFormat(r,"matrix3d(".concat(s.join(", "),")"),"matrix3d(".concat(i.join(", "),")"))),triggerEvent(e,"onWarp",fillParams(e,t,__assign({delta:c,matrix:s,dist:i,multiply:multiply,transform:d},fillCSSObject({transform:d},t)))),!0)},dragControlEnd:function(e,t){var r=t.datas,i=t.isDrag;return!!r.isWarp&&(r.isWarp=!1,triggerEvent(e,"onWarpEnd",fillEndParams(e,t,{})),i)}},AREA_PIECES=prefix("area-pieces"),AREA_PIECE=prefix("area-piece"),AVOID=prefix("avoid"),VIEW_DRAGGING=prefix("view-dragging");function restoreStyle(e){var t,r=e.areaElement;r&&(t=(e=e.state).width,e=e.height,removeClass(r,AVOID),r.style.cssText+="left: 0px; top: 0px; width: ".concat(t,"px; height: ").concat(e,"px"))}function renderPieces(e){return e.createElement("div",{key:"area_pieces",className:AREA_PIECES},e.createElement("div",{className:AREA_PIECE}),e.createElement("div",{className:AREA_PIECE}),e.createElement("div",{className:AREA_PIECE}),e.createElement("div",{className:AREA_PIECE}))}var DragArea={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(e,t){var r=e.props,i=r.target,n=r.dragArea,a=r.groupable,r=r.passDragArea,s=e.getState(),o=s.width,l=s.height,s=s.renderPoses,r=r?prefix("area","pass"):prefix("area");return a?[t.createElement("div",{key:"area",ref:ref(e,"areaElement"),className:r}),renderPieces(t)]:i&&n?(i=(a=createWarpMatrix([0,0],[o,0],[0,l],[o,l],s[0],s[1],s[2],s[3])).length?makeMatrixCSS(a,!0):"none",[t.createElement("div",{key:"area",ref:ref(e,"areaElement"),className:r,style:{top:"0px",left:"0px",width:"".concat(o,"px"),height:"".concat(l,"px"),transformOrigin:"0 0",transform:i}}),renderPieces(t)]):[]},dragStart:function(e,t){var r=t.datas,i=t.clientX,n=t.clientY;if(!t.inputEvent)return!1;r.isDragArea=!1;var t=e.areaElement,r=e.state,e=r.moveableClientRect,a=r.rootMatrix,s=r.is3d,o=e.left,e=e.top,l=getRect(r.renderPoses),u=l.left,c=l.top,h=l.width,l=l.height,a=__read(calculateInversePosition(a,[i-o,n-e],s?4:3),2),i=a[0],o=a[1],n=[{left:u,top:c,width:h,height:(o-=c)-10},{left:u,top:c,width:(i-=u)-10,height:l},{left:u,top:c+o+10,width:h,height:l-o-10},{left:u+i+10,top:c,width:h-i-10,height:l}],d=[].slice.call(t.nextElementSibling.children);n.forEach(function(e,t){d[t].style.cssText="left: ".concat(e.left,"px;top: ").concat(e.top,"px; width: ").concat(e.width,"px; height: ").concat(e.height,"px;")}),addClass(t,AVOID),r.disableNativeEvent=!0},drag:function(e,t){var r=t.datas,t=t.inputEvent;if(this.enableNativeEvent(e),!t)return!1;r.isDragArea||(r.isDragArea=!0,restoreStyle(e))},dragEnd:function(e,t){if(this.enableNativeEvent(e),!t.inputEvent)return!1;t.datas.isDragArea||restoreStyle(e)},dragGroupStart:function(e,t){return this.dragStart(e,t)},dragGroup:function(e,t){return this.drag(e,t)},dragGroupEnd:function(e,t){return this.dragEnd(e,t)},unset:function(e){restoreStyle(e),e.state.disableNativeEvent=!1},enableNativeEvent:function(e){var t=e.state;t.disableNativeEvent&&requestAnimationFrame$1(function(){t.disableNativeEvent=!1})}},Origin=makeAble("origin",{props:["origin","svgOrigin"],render:function(e,t){var r=e.props,i=r.zoom,n=r.svgOrigin,r=r.groupable,e=e.getState(),a=e.beforeOrigin,s=e.rotation,o=e.is3d,l=e.left,u=e.top;return i=getControlTransform(s,i,!r&&e.svg&&n?minus(calculatePosition(e.allMatrix,[(s=__read(convertTransformOriginArray(n,e.offsetWidth,e.offsetHeight),2))[0],s[1]],o?4:3),[l,u]):a),[t.createElement("div",{className:prefix("control","origin"),style:i,key:"beforeOrigin"})]}});function getDefaultScrollPosition(e){e=e.scrollContainer;return[e.scrollLeft,e.scrollTop]}var Scrollable={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(r,i){var e=r.props,t=e.scrollContainer,t=void 0===t?r.getContainer():t,e=e.scrollOptions,n=new DragScroll$1,t=getRefTarget(t,!0),a=(i.datas.dragScroll=n,r.state.dragScroll=n,i.isControl?"controlGesto":"targetGesto"),s=i.targets;n.on("scroll",function(e){var t=e.container,t=fillParams(r,i,{scrollContainer:t,direction:e.direction}),e=s?"onScrollGroup":"onScroll";s&&(t.targets=s),triggerEvent(r,e,t)}).on("move",function(e){var t=e.offsetX;r[a].scrollBy(t,e.offsetY,e.inputEvent.inputEvent,!1)}).on("scrollDrag",function(e){(0,e.next)(r[a].getCurrentEvent())}),n.dragStart(i,__assign({container:t},e))},checkScroll:function(e,t){var r,i,n,a=t.datas.dragScroll;if(a)return e=void 0===(i=(r=e.props).scrollContainer)?e.getContainer():i,n=void 0===(i=r.getScrollPosition)?getDefaultScrollPosition:i,a.drag(t,__assign({container:e,threshold:void 0===(i=r.scrollThreshold)?0:i,throttleTime:void 0===(a=r.scrollThrottleTime)?0:a,getScrollPosition:function(e){return n({scrollContainer:e.container,direction:e.direction})}},r.scrollOptions)),!0},drag:function(e,t){return this.checkScroll(e,t)},dragEnd:function(e,t){t.datas.dragScroll.dragEnd(),t.datas.dragScroll=null},dragControlStart:function(e,t){return this.dragStart(e,__assign(__assign({},t),{isControl:!0}))},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupStart:function(e,t){return this.dragStart(e,__assign(__assign({},t),{targets:e.props.targets}))},dragGroup:function(e,t){return this.drag(e,__assign(__assign({},t),{targets:e.props.targets}))},dragGroupEnd:function(e,t){return this.dragEnd(e,__assign(__assign({},t),{targets:e.props.targets}))},dragGroupControlStart:function(e,t){return this.dragStart(e,__assign(__assign({},t),{targets:e.props.targets,isControl:!0}))},dragGroupControl:function(e,t){return this.drag(e,__assign(__assign({},t),{targets:e.props.targets}))},dragGroupControEnd:function(e,t){return this.dragEnd(e,__assign(__assign({},t),{targets:e.props.targets}))},unset:function(e){var t,e=e.state;null!=(t=e.dragScroll)&&t.dragEnd(),e.dragScroll=null}},Default={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","requestStyles"],events:["changeTargets"]},Padding=makeAble("padding",{props:["padding"],render:function(e,i){var t,r,n,a,s,o=e.props;return o.dragArea?[]:(t=(o=getPaddingBox(o.padding||{})).left,r=o.top,n=o.right,o=o.bottom,e=e.getState(),a=e.renderPoses,s=[e.pos1,e.pos2,e.pos3,e.pos4],e=[],0<t&&e.push([0,2]),0<r&&e.push([0,1]),0<n&&e.push([1,3]),0<o&&e.push([2,3]),e.map(function(e,t){var e=__read(e,2),r=e[0],e=e[1],r=createWarpMatrix([0,0],[100,0],[0,100],[100,100],s[r],s[e],a[r],a[e]);if(r.length)return i.createElement("div",{key:"padding".concat(t),className:prefix("padding"),style:{transform:makeMatrixCSS(r,!0)}})}))}}),RADIUS_DIRECTIONS=["nw","ne","se","sw"];function calculateRatio(e,t){var r=e[0]+e[1],r=t<r?t/r:1;return e[0]*=r,e[1]=t-e[1]*r,e}var HORIZONTAL_RADIUS_ORDER=[1,2,5,6],VERTICAL_RADIUS_ORDER=[0,3,4,7],HORIZONTAL_RADIUS_DIRECTIONS=[1,-1,-1,1],VERTICAL_RADIUS_DIRECTIONS=[1,1,-1,-1];function getRadiusStyles(e,n,a,s,o,l,u,c){void 0===o&&(o=0),void 0===l&&(l=0),void 0===u&&(u=a),void 0===c&&(c=s);var h=[],d=!1,e=e.filter(function(e){return!e.virtual}),t=e.map(function(e){var t,r=e.horizontal,i=e.vertical,e=e.pos;return i&&!d&&(d=!0,h.push("/")),d?(t=Math.max(0,1===i?e[1]-l:c-e[1]),h.push(convertCSSSize(t,s,n))):(t=Math.max(0,1===r?e[0]-o:u-e[0]),h.push(convertCSSSize(t,a,n))),t});return{radiusPoses:e,styles:h,raws:t}}function getRadiusRange(e){for(var t=[0,0],r=[0,0],i=e.length,n=0;n<i;++n){var a=e[n];a.sub&&(a.horizontal&&(0===t[1]&&(t[0]=n),t[1]=n-t[0]+1,r[0]=n+1),a.vertical)&&(0===r[1]&&(r[0]=n),r[1]=n-r[0]+1)}return{horizontalRange:t,verticalRange:r}}function getRadiusValues(e,i,n,a,s,t,r){void 0===t&&(t=[0,0]),void 0===r&&(r=!1);var o=e.indexOf("/"),o=(-1<o?e.slice(0,o):e).length,l=e.slice(0,o),e=e.slice(o+1),u=l.length,c=e.length,o=0<c,l=__read(l,4),h=l[0],h=void 0===h?"0px":h,d=l[1],d=void 0===d?h:d,p=l[2],p=void 0===p?h:p,l=l[3],l=void 0===l?d:l,e=__read(e,4),f=e[0],f=void 0===f?h:f,m=e[1],m=void 0===m?o?f:d:m,g=e[2],g=void 0===g?o?f:p:g,e=e[3],o=void 0===e?o?m:l:e,v=[h,d,p,l].map(function(e){return convertUnitSize(e,i)}),y=[f,m,g,o].map(function(e){return convertUnitSize(e,n)}),e=v.slice(),h=y.slice(),d=__read(calculateRatio([e[0],e[1]],i),2),m=(e[0]=d[0],e[1]=d[1],p=__read(calculateRatio([e[3],e[2]],i),2),e[3]=p[0],e[2]=p[1],l=__read(calculateRatio([h[0],h[3]],n),2),h[0]=l[0],h[3]=l[1],f=__read(calculateRatio([h[1],h[2]],n),2),h[1]=f[0],h[2]=f[1],r?e:e.slice(0,Math.max(t[0],u))),g=r?h:h.slice(0,Math.max(t[1],c));return __spreadArray(__spreadArray([],__read(m.map(function(e,t){var r=RADIUS_DIRECTIONS[t];return{virtual:u<=t,horizontal:HORIZONTAL_RADIUS_DIRECTIONS[t],vertical:0,pos:[a+e,s+(-1===VERTICAL_RADIUS_DIRECTIONS[t]?n:0)],sub:!0,raw:v[t],direction:r}})),!1),__read(g.map(function(e,t){var r=RADIUS_DIRECTIONS[t];return{virtual:c<=t,horizontal:0,vertical:VERTICAL_RADIUS_DIRECTIONS[t],pos:[a+(-1===HORIZONTAL_RADIUS_DIRECTIONS[t]?i:0),s+e],sub:!0,raw:y[t],direction:r}})),!1)}function removeRadiusPos(e,t,r,i,n){void 0===n&&(n=t.length);var a=getRadiusRange(e.slice(i)),s=a.horizontalRange,a=a.verticalRange,i=r-i,o=0;if(0==i)o=n;else if(0<i&&i<s[1])o=s[1]-i;else{if(!(i>=a[0]))return;o=a[0]+a[1]-i}e.splice(r,o),t.splice(r,o)}function addRadiusPos(e,t,r,i,n,a,s,o,l,u,c){void 0===u&&(u=0),void 0===c&&(c=0);var h=getRadiusRange(e.slice(r)),d=h.horizontalRange,h=h.verticalRange;if(-1<i)for(var p=1===HORIZONTAL_RADIUS_DIRECTIONS[i]?a-u:o-a,f=d[1];f<=i;++f){var m=1===VERTICAL_RADIUS_DIRECTIONS[f]?c:l,g=0;if(i===f?g=a:0===f?g=u+p:-1===HORIZONTAL_RADIUS_DIRECTIONS[f]&&(g=o-(t[r][0]-u)),e.splice(r+f,0,{horizontal:HORIZONTAL_RADIUS_DIRECTIONS[f],vertical:0,pos:[g,m]}),t.splice(r+f,0,[g,m]),0===f)break}else if(-1<n)for(var v=1===VERTICAL_RADIUS_DIRECTIONS[n]?s-c:l-s,y=(0===d[1]&&0===h[1]&&(e.push({horizontal:HORIZONTAL_RADIUS_DIRECTIONS[0],vertical:0,pos:d=[u+v,c]}),t.push(d)),h[0]),f=h[1];f<=n;++f){g=1===HORIZONTAL_RADIUS_DIRECTIONS[f]?u:o,m=0;if(n===f?m=s:0===f?m=c+v:1===VERTICAL_RADIUS_DIRECTIONS[f]?m=t[r+y][1]:-1===VERTICAL_RADIUS_DIRECTIONS[f]&&(m=l-(t[r+y][1]-c)),e.push({horizontal:0,vertical:VERTICAL_RADIUS_DIRECTIONS[f],pos:[g,m]}),t.push([g,m]),0===f)break}}function splitRadiusPoses(e,r){return void 0===r&&(r=e.map(function(e){return e.raw})),{horizontals:e.map(function(e,t){return e.horizontal?r[t]:null}).filter(function(e){return null!=e}),verticals:e.map(function(e,t){return e.vertical?r[t]:null}).filter(function(e){return null!=e})}}var CLIP_DIRECTIONS=[[0,-1,"n"],[1,0,"e"]],CLIP_RECT_DIRECTIONS=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function getClipStyles(e,t,r){var i,n,a,s,o,l,u=e.props.clipRelative,e=e.state,c=e.width,h=e.height,e=t.type,t=t.poses,d="rect"===e,p="circle"===e;return"polygon"===e?r.map(function(e){return"".concat(convertCSSSize(e[0],c,u)," ").concat(convertCSSSize(e[1],h,u))}):d||"inset"===e?(i=r[1][1],n=r[3][0],a=r[7][0],s=r[5][1],d?[i,n,s,a].map(function(e){return"".concat(e,"px")}):(l=[i,c-n,h-s,a].map(function(e,t){return convertCSSSize(e,t%2?c:h,u)}),8<r.length&&(o=(d=__read(minus(r[4],r[0]),2))[0],d=d[1],l.push.apply(l,__spreadArray(["round"],__read(getRadiusStyles(t.slice(8).map(function(e,t){return __assign(__assign({},e),{pos:r[t]})}),u,o,d,a,i,n,s).styles),!1))),l)):p||"ellipse"===e?(t=r[0],o=convertCSSSize(abs(r[1][1]-t[1]),p?Math.sqrt((c*c+h*h)/2):h,u),(l=p?[o]:[convertCSSSize(abs(r[2][0]-t[0]),c,u),o]).push("at",convertCSSSize(t[0],c,u),convertCSSSize(t[1],h,u)),l):void 0}function getRectPoses(e,t,r,i){var a=[i,(i+t)/2,t],s=[e,(e+r)/2,r];return CLIP_RECT_DIRECTIONS.map(function(e){var e=__read(e,3),t=e[0],r=e[1],e=e[2],i=a[t+1],n=s[r+1];return{vertical:abs(r),horizontal:abs(t),direction:e,pos:[i,n]}})}function getControlSize(e){var t=[1/0,-1/0],r=[1/0,-1/0];return e.forEach(function(e){e=e.pos;t[0]=Math.min(t[0],e[0]),t[1]=Math.max(t[1],e[0]),r[0]=Math.min(r[0],e[1]),r[1]=Math.max(r[1],e[1])}),[abs(t[1]-t[0]),abs(r[1]-r[0])]}function getClipPath(e,r,i,t,n){if(e){var a,s,o,l,u,c,h,d,p,f,m,g,v,y,_,b;if((n=n?n:"none"!==(a=(e=getCachedStyle(e))("clipPath"))?a:e("clip"))&&"none"!==n&&"auto"!==n||(n=t))return e=(a=splitBracket(n)).prefix,a=void 0===(t=a.value)?"":t,e="circle"===(t=void 0===e?n:e),s=" ","polygon"===t?(s=",",g=getMinMaxs((b=(m=splitComma(a||"0% 0%, 100% 0%, 100% 100%, 0% 100%")).map(function(e){var e=__read(e.split(" "),2),t=e[0],e=e[1];return{vertical:1,horizontal:1,pos:[convertUnitSize(t,r),convertUnitSize(e,i)]}})).map(function(e){return e.pos})),{type:t,clipText:n,poses:b,splitter:s,left:g.minX,right:g.maxX,top:g.minY,bottom:g.maxY}):e||"ellipse"===t?(d=g="",l=o=0,m=splitSpace(a),l=e?(c=(h=__read(m,4))[0],g=void 0===(p=h[2])?"50%":p,d=void 0===(p=h[3])?"50%":p,o=convertUnitSize(void 0===c?"50%":c,Math.sqrt((r*r+i*i)/2))):(h="",c=(p=__read(m,5))[0],h=void 0===(f=p[1])?"50%":f,g=void 0===(f=p[3])?"50%":f,d=void 0===(f=p[4])?"50%":f,o=convertUnitSize(void 0===c?"50%":c,r),convertUnitSize(h,i)),b=__spreadArray([{vertical:1,horizontal:1,pos:u=[convertUnitSize(g,r),convertUnitSize(d,i)],direction:"nesw"}],__read(CLIP_DIRECTIONS.slice(0,e?1:2).map(function(e){return{vertical:abs(e[1]),horizontal:e[0],direction:e[2],sub:!0,pos:[u[0]+e[0]*o,u[1]+e[1]*l]}})),!1),{type:t,clipText:n,radiusX:o,radiusY:l,left:u[0]-o,top:u[1]-l,right:u[0]+o,bottom:u[1]+l,poses:b,splitter:s}):"inset"===t?(f=(-1<(p=(m=splitSpace(a||"0 0 0 0")).indexOf("round"))?m.slice(0,p):m).length,c=m.slice(f+1),g=(h=__read(m.slice(0,f),4))[0],e=void 0===(d=h[1])?g:d,f=void 0===(p=h[3])?e:p,h=(p=__read([g,void 0===(d=h[2])?g:d].map(function(e){return convertUnitSize(e,i)}),2))[0],y=p[1],_=(g=__read([f,e].map(function(e){return convertUnitSize(e,r)}),2))[0],f=getRadiusValues(c,(d=r-(v=g[1]))-_,(p=i-y)-h,_,h),{type:"inset",clipText:n,poses:b=__spreadArray(__spreadArray([],__read(getRectPoses(h,d,p,_)),!1),__read(f),!1),top:h,left:_,right:d,bottom:p,radius:c,splitter:s}):"rect"===t?(s=",",{type:"rect",clipText:n,poses:b=getRectPoses(g=(e=__read((m=splitComma(a||"0px, ".concat(r,"px, ").concat(i,"px, 0px"))).map(function(e){return splitUnit(e).value}),4))[0],v=e[1],y=e[2],_=e[3]),top:g,right:v,bottom:y,left:_,values:m,splitter:s}):void 0}}function moveControlPos(e,t,s,r,i){var n,a,o,l,u,c,h,d,p=e[t],f=p.direction,p=p.sub,m=e.map(function(){return[0,0]}),g=f?f.split(""):[];return r&&t<8?(r=g.filter(function(e){return"w"===e||"e"===e}),u=g.filter(function(e){return"n"===e||"s"===e}),n=r[0],a=u[0],m[t]=s,u=(r=__read(getControlSize(e),2))[0],r=r[1],(l=u&&r?u/r:0)&&i?(i=e[(t+4)%8].pos,o=[0,0],-1<f.indexOf("w")?o[0]=-1:-1<f.indexOf("e")&&(o[0]=1),-1<f.indexOf("n")?o[1]=-1:-1<f.indexOf("s")&&(o[1]=1),l=u+(u=getSizeDistByDist([u,r],s,l,o,!0))[0],r=r+u[1],u=i[1],c=i[1],h=i[0],i=i[0],-1===o[0]?h=i-l:1===o[0]?i=h+l:(h-=l/2,i+=l/2),-1===o[1]?u=c-r:c=1===o[1]?u+r:(u=c-r/2)+r,d=getRectPoses(u,i,c,h),e.forEach(function(e,t){m[t][0]=d[t].pos[0]-e.pos[0],m[t][1]=d[t].pos[1]-e.pos[1]})):(e.forEach(function(e,t){e=e.direction;e&&(-1<e.indexOf(n)&&(m[t][0]=s[0]),-1<e.indexOf(a))&&(m[t][1]=s[1])}),n&&(m[1][0]=s[0]/2,m[5][0]=s[0]/2),a&&(m[3][1]=s[1]/2,m[7][1]=s[1]/2))):f&&!p?g.forEach(function(n){var a="n"===n||"s"===n;e.forEach(function(e,t){var r=e.direction,i=e.horizontal,e=e.vertical;r&&-1!==r.indexOf(n)&&(m[t]=[a||!i?0:s[0],a&&e?s[1]:0])})}):m[t]=s,m}function addClipPath(e,t){var r=__read(calculatePointerDist(e,t),2),i=r[0],r=r[1],n=t.datas,a=n.clipPath,n=n.clipIndex,s=a.type,o=a.poses,l=a.splitter,u=o.map(function(e){return e.pos});if("polygon"===s)u.splice(n,0,[i,r]);else{if("inset"!==s)return;var c=HORIZONTAL_RADIUS_ORDER.indexOf(n),n=VERTICAL_RADIUS_ORDER.indexOf(n),h=o.length;if(addRadiusPos(o,u,8,c,n,i,r,u[4][0],u[4][1],u[0][0],u[0][1]),h===o.length)return}c=getClipStyles(e,a,u),n="".concat(s,"(").concat(c.join(l),")");triggerEvent(e,"onClip",fillParams(e,t,__assign({clipEventType:"added",clipType:s,poses:u,clipStyles:c,clipStyle:n,distX:0,distY:0},fillCSSObject({clipPath:n},t))))}function removeClipPath(e,t){var r=t.datas,i=r.clipPath,r=r.clipIndex,n=i.type,a=i.poses,s=i.splitter,o=a.map(function(e){return e.pos}),l=o.length;if("polygon"===n)a.splice(r,1),o.splice(r,1);else{if("inset"!==n)return;if(r<8)return;if(removeRadiusPos(a,o,r,8,l),l===a.length)return}r=getClipStyles(e,i,o),l="".concat(n,"(").concat(r.join(s),")");triggerEvent(e,"onClip",fillParams(e,t,__assign({clipEventType:"removed",clipType:n,poses:o,clipStyles:r,clipStyle:l,distX:0,distY:0},fillCSSObject({clipPath:l},t))))}var Clippable={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[".control.clip-control {\nbackground: #6d6;\ncursor: pointer;\n}\n.control.clip-control.clip-radius {\nbackground: #d66;\n}\n.line.clip-line {\nbackground: #6e6;\ncursor: move;\nz-index: 1;\n}\n.clip-area {\nposition: absolute;\ntop: 0;\nleft: 0;\n}\n.clip-ellipse {\nposition: absolute;\ncursor: move;\nborder: 1px solid #6d6;\nborder: var(--zoompx) solid #6d6;\nborder-radius: 50%;\ntransform-origin: 0px 0px;\n}",":host {\n--bounds-color: #d66;\n}",".guideline {\npointer-events: none;\nz-index: 2;\n}",".line.guideline.bounds {\nbackground: #d66;\nbackground: var(--bounds-color);\n}"],render:function(e,a){var t=e.props,r=t.customClipPath,i=t.defaultClipPath,n=t.clipArea,s=t.zoom,t=t.groupable,e=e.getState(),o=e.target,l=e.width,u=e.height,c=e.allMatrix,h=e.is3d,d=e.left,p=e.top,f=e.pos1,m=e.pos2,g=e.pos3,v=e.pos4,y=e.snapBoundInfos,_=e.rotation;if(!o||t)return[];t=getClipPath(o,l,u,i||"inset",e.clipPathState||r);if(!t)return[];var b,x,S,T=h?4:3,o=t.type,i=t.poses.map(function(e){e=calculatePosition(c,e.pos,T);return[e[0]-d,e[1]-p]}),e=[],E=[],r="rect"===o,h="inset"===o,C="polygon"===o;if((r||h||C)&&(b=h?i.slice(0,8):i,E=b.map(function(e,t){var r=0===t?b[b.length-1]:b[t-1],i=getRad$1(r,e),e=getDiagonalSize(r,e);return a.createElement("div",{key:"clipLine".concat(t),className:prefix("line","clip-line","snap-control"),"data-clip-index":t,style:{width:"".concat(e,"px"),transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) rotate(").concat(i,"rad) scaleY(").concat(s,")")}})})),e=i.map(function(e,t){return a.createElement("div",{key:"clipControl".concat(t),className:prefix("control","clip-control","snap-control"),"data-clip-index":t,style:{transform:"translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(_,"rad) scale(").concat(s,")")}})}),h&&e.push.apply(e,__spreadArray([],__read(i.slice(8).map(function(e,t){return a.createElement("div",{key:"clipRadiusControl".concat(t),className:prefix("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+t,style:{transform:"translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(_,"rad) scale(").concat(s,")")}})})),!1)),"circle"===o||"ellipse"===o){var o=t.left,A=t.top,w=t.radiusX,P=t.radiusY,t=__read(minus(calculatePosition(c,[o,A],T),calculatePosition(c,[0,0],T)),2),o=t[0],A=t[1],t="none";if(!n){for(var M=Math.max(10,w/5,P/5),I=[],D=0;D<=M;++D){var R=2*Math.PI/M*D;I.push([w+(w-s)*Math.cos(R),P+(P-s)*Math.sin(R)])}I.push([w,-2]),I.push([-2,-2]),I.push([-2,2*P+2]),I.push([2*w+2,2*P+2]),I.push([2*w+2,-2]),I.push([w,-2]),t="polygon(".concat(I.map(function(e){return"".concat(e[0],"px ").concat(e[1],"px")}).join(", "),")")}e.push(a.createElement("div",{key:"clipEllipse",className:prefix("clip-ellipse","snap-control"),style:{width:"".concat(2*w,"px"),height:"".concat(2*P,"px"),clipPath:t,transform:"translate(".concat(-d+o,"px, ").concat(-p+A,"px) ").concat(makeMatrixCSS(c))}}))}return n&&(o=(t=getRect(__spreadArray([f,m,g,v],__read(i),!1))).width,A=t.height,x=t.left,S=t.top,C||r||h)&&(I=h?i.slice(0,8):i,e.push(a.createElement("div",{key:"clipArea",className:prefix("clip-area","snap-control"),style:{width:"".concat(o,"px"),height:"".concat(A,"px"),transform:"translate(".concat(x,"px, ").concat(S,"px)"),clipPath:"polygon(".concat(I.map(function(e){return"".concat(e[0]-x,"px ").concat(e[1]-S,"px")}).join(", "),")")}}))),y&&["vertical","horizontal"].forEach(function(i){var e=y[i],n="horizontal"===i;e.isSnap&&E.push.apply(E,__spreadArray([],__read(e.snap.posInfos.map(function(e,t){var e=e.pos,r=minus(calculatePosition(c,n?[0,e]:[e,0],T),[d,p]),e=minus(calculatePosition(c,n?[l,e]:[e,u],T),[d,p]);return renderLine(a,"",r,e,s,"clip".concat(i,"snap").concat(t),"guideline")})),!1)),e.isBound&&E.push.apply(E,__spreadArray([],__read(e.bounds.map(function(e,t){var e=e.pos,r=minus(calculatePosition(c,n?[0,e]:[e,0],T),[d,p]),e=minus(calculatePosition(c,n?[l,e]:[e,u],T),[d,p]);return renderLine(a,"",r,e,s,"clip".concat(i,"bounds").concat(t),"guideline","bounds","bold")})),!1))}),__spreadArray(__spreadArray([],__read(e),!1),__read(E),!1)},dragControlCondition:function(e,t){return t.inputEvent&&-1<(t.inputEvent.target.getAttribute("class")||"").indexOf("clip")},dragStart:function(e,t){var r=e.props.dragWithClip;return void 0!==r&&!r&&this.dragControlStart(e,t)},drag:function(e,t){return this.dragControl(e,__assign(__assign({},t),{isDragTarget:!0}))},dragEnd:function(e,t){return this.dragControlEnd(e,t)},dragControlStart:function(e,t){var r=e.state,i=e.props,n=i.defaultClipPath,i=i.customClipPath,a=r.target,s=r.width,o=r.height,l=t.inputEvent?t.inputEvent.target:null,u=l&&l.getAttribute("class")||"",c=t.datas,a=getClipPath(a,s,o,n||"inset",i);return!!a&&(s=a.clipText,!1===triggerEvent(e,"onClipStart",fillParams(e,t,{clipType:a.type,clipStyle:s,poses:a.poses.map(function(e){return e.pos})}))?c.isClipStart=!1:(c.isControl=u&&-1<u.indexOf("clip-control"),c.isLine=-1<u.indexOf("clip-line"),c.isArea=-1<u.indexOf("clip-area")||-1<u.indexOf("clip-ellipse"),c.clipIndex=l?parseInt(l.getAttribute("data-clip-index"),10):-1,c.clipPath=a,c.isClipStart=!0,r.clipPathState=s,setDragStart(e,t),!0))},dragControl:function(e,t){var r,i,n,a,s,o,l,u,c,$,h,d,p,f,m,g,B,L,v,y,_,b,x,S,T,E,C,A,w,N,P,M,I,D,R,k,O=t.datas,F=t.originalDatas,G=t.isDragTarget;return!!O.isClipStart&&(E=O.isControl,c=O.isLine,m=O.isArea,k=O.clipIndex,!!(O=O.clipPath))&&(T=(r=getProps(e.props,"clippable")).keepRatio,a=i=0,F=F.draggable,n=getDragDist(t),a=(G&&F?(s=__read(F.prevBeforeDist,2),i=s[0],s):(s=__read(n,2),i=s[0],s))[1],s=[i,a],o=e.state,l=o.width,u=o.height,m=!m&&!E&&!c,c=O.type,R=O.poses,$=O.splitter,g=R.map(function(e){return e.pos}),m&&(i=-i,a=-a),m=!E||"nesw"===R[k].direction,h="inset"===c||"rect"===c,d=R.map(function(){return[0,0]}),E&&!m?(p=(f=R[k]).horizontal,f=f.vertical,d=moveControlPos(R,k,[i*abs(p),a*abs(f)],h,T)):m&&(d=g.map(function(){return[i,a]})),f=__spreadArray([],__read(p=g.map(function(e,t){return plus(e,d[t])})),!1),o.snapBoundInfos=null,m="circle"===O.type,g="ellipse"===O.type,(m||g)&&(C=abs((S=getRect(p)).bottom-S.top),w=abs(g?S.right-S.left:C),C=p[0][1]+C,A=p[0][0]-w,w=p[0][0]+w,m&&(f.push([w,S.bottom]),d.push([1,0])),f.push([S.left,C]),d.push([0,1]),f.push([A,S.bottom]),d.push([1,0])),B=getDefaultGuidelines((r.clipHorizontalGuidelines||[]).map(function(e){return convertUnitSize("".concat(e),u)}),(r.clipVerticalGuidelines||[]).map(function(e){return convertUnitSize("".concat(e),l)}),l,u),v=[],y=[],y=m||g?(v=[f[4][0],f[2][0]],[f[1][1],f[3][1]]):h?(I=[f[0],f[2],f[4],f[6]],L=[d[0],d[2],d[4],d[6]],v=I.filter(function(e,t){return L[t][0]}).map(function(e){return e[0]}),I.filter(function(e,t){return L[t][1]}).map(function(e){return e[1]})):(v=f.filter(function(e,t){return d[t][0]}).map(function(e){return e[0]}),f.filter(function(e,t){return d[t][1]}).map(function(e){return e[1]})),_=[0,0],P=(D=checkSnapBounds(B,r.clipTargetBounds&&{left:0,top:0,right:l,bottom:u},v,y,5)).horizontal,b=P.offset,x=(D=D.vertical).offset,P.isBound&&(_[1]+=b),D.isBound&&(_[0]+=x),(g||m)&&0===d[0][0]&&0===d[0][1]?(M=(S=getRect(p)).bottom-S.top,S=g?S.right-S.left:M,S-=D.isBound?abs(x):0===D.snapIndex?-x:x,M-=P.isBound?abs(b):0===P.snapIndex?-b:b,m&&(S=M=0<checkSnapBoundPriority(D,P)?M:S),D=f[0],f[1][1]=D[1]-M,f[2][0]=D[0]+S,f[3][1]=D[1]+M,f[4][0]=D[0]-S):h&&T&&E?(M=(P=__read(getControlSize(R),2))[0],D=P[1],S=M&&D?M/D:0,T=R[k].direction||"",E=f[1][1],C=f[5][1],A=f[7][0],w=f[3][0],abs(b)<=abs(x)?b=sign(b)*abs(x)/S:x=sign(x)*abs(b)*S,-1<T.indexOf("w")?A-=x:-1<T.indexOf("e")?w-=x:(A+=x/2,w-=x/2),-1<T.indexOf("n")?E-=b:-1<T.indexOf("s")?C-=b:(E+=b/2,C-=b/2),N=getRectPoses(E,w,C,A),f.forEach(function(e,t){t=__read(N[t].pos,2);e[0]=t[0],e[1]=t[1]})):f.forEach(function(e,t){t=d[t];t[0]&&(e[0]-=x),t[1]&&(e[1]-=b)}),P=getClipStyles(e,O,p),M="".concat(c,"(").concat(P.join($),")"),o.clipPathState=M,y=m||g?(v=[f[4][0],f[2][0]],[f[1][1],f[3][1]]):h?(v=(I=[f[0],f[2],f[4],f[6]]).map(function(e){return e[0]}),I.map(function(e){return e[1]})):(v=f.map(function(e){return e[0]}),f.map(function(e){return e[1]})),o.snapBoundInfos=checkSnapBounds(B,r.clipTargetBounds&&{left:0,top:0,right:l,bottom:u},v,y,1),F&&(D=o.is3d,R=o.allMatrix,k=_,G&&(k=[s[0]+_[0]-n[0],s[1]+_[1]-n[1]]),F.deltaOffset=multiply(R,[k[0],k[1],0,0],D?4:3)),triggerEvent(e,"onClip",fillParams(e,t,__assign({clipEventType:"changed",clipType:c,poses:p,clipStyle:M,clipStyles:P,distX:i,distY:a},fillCSSObject(((S={})["rect"===c?"clip":"clipPath"]=M,S),t)))),!0)},dragControlEnd:function(e,t){this.unset(e);var r=t.isDrag,i=t.datas,n=t.isDouble,a=i.isLine,s=i.isControl;return!!i.isClipStart&&(triggerEvent(e,"onClipEnd",fillEndParams(e,t,{})),n&&(s?removeClipPath(e,t):a&&addClipPath(e,t)),n||r)},unset:function(e){e.state.clipPathState="",e.state.snapBoundInfos=null}},OriginDraggable={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[":host[data-able-origindraggable] .control.origin {\npointer-events: auto;\n}"],dragControlCondition:function(e,t){return t.isRequest?"originDraggable"===t.requestAble:hasClass(t.inputEvent.target,prefix("origin"))},dragControlStart:function(e,t){var r=t.datas,t=(setDragStart(e,t),fillParams(e,t,{dragStart:Draggable.dragStart(e,(new CustomGesto).dragStart([0,0],t))})),i=triggerEvent(e,"onDragOriginStart",t);return r.startOrigin=e.state.transformOrigin,r.startTargetOrigin=e.state.targetOrigin,r.prevOrigin=[0,0],!(r.isDragOrigin=!0)===i?r.isDragOrigin=!1:t},dragControl:function(e,t){var r,i,n,a,s,o,l,u,c,h=t.datas,d=t.isPinch,p=t.isRequest;return!!h.isDragOrigin&&(a=(s=__read(getDragDist(t),2))[0],r=(l=e.state).width,i=l.height,c=l.offsetMatrix,u=l.targetMatrix,n=void 0===(n=e.props.originRelative)||n,l=l.is3d?4:3,a=[a,s[1]],p&&((s=t.distOrigin)[0]||s[1])&&(a=s),p=plus(h.startOrigin,a),s=plus(h.startTargetOrigin,a),o=minus(a,h.prevOrigin),c=getNextMatrix(c,u,p,l),u=e.getRect(),c=getRect(calculatePoses(c,r,i,l)),l=[u.left-c.left,u.top-c.top],h.prevOrigin=a,u=[convertCSSSize(s[0],r,n),convertCSSSize(s[1],i,n)].join(" "),c=Draggable.drag(e,setCustomDrag(t,e.state,l,!!d,!1)),triggerEvent(e,"onDragOrigin",h=fillParams(e,t,__assign(__assign({width:r,height:i,origin:p,dist:a,delta:o,transformOrigin:u,drag:c},fillCSSObject({transformOrigin:u,transform:c.transform},t)),{afterTransform:c.transform}))),h)},dragControlEnd:function(e,t){return!!t.datas.isDragOrigin&&(triggerEvent(e,"onDragOriginEnd",fillEndParams(e,t,{})),!0)},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragGroupControlStart:function(e,t){return!!this.dragControlStart(e,t)},dragGroupControl:function(e,t){t=this.dragControl(e,t);return!!t&&(e.transformOrigin=t.transformOrigin,!0)},request:function(e){var t={},r=e.getRect(),i=0,n=0,a=r.transformOrigin,s=[0,0];return{isControl:!0,requestStart:function(){return{datas:t}},request:function(e){return"deltaOrigin"in e?(s[0]+=e.deltaOrigin[0],s[1]+=e.deltaOrigin[1]):"origin"in e?(s[0]=e.origin[0]-a[0],s[1]=e.origin[1]-a[1]):("x"in e?i=e.x-r.left:"deltaX"in e&&(i+=e.deltaX),"y"in e?n=e.y-r.top:"deltaY"in e&&(n+=e.deltaY)),{datas:t,distX:i,distY:n,distOrigin:s}},requestEnd:function(){return{datas:t,isDrag:!0}}}}};function addBorderRadiusByLine(e,t,r,i){var n=e.filter(function(e){var t=e.virtual;return e.horizontal&&!t}).length,a=e.filter(function(e){var t=e.virtual;return e.vertical&&!t}).length,s=-1;0===t&&(0===n?s=0:1===n&&(s=1)),2===t&&(n<=2?s=2:n<=3&&(s=3)),3===t&&(0===a?s=4:a<4&&(s=7)),1===t&&(a<=1?s=5:a<=2&&(s=6)),-1!==s&&e[s].virtual&&(n=e[s],addBorderRadius(e,s),s<4?n.pos[0]=r:n.pos[1]=i)}function addBorderRadius(e,t){t<4?e.slice(0,t+1).forEach(function(e){e.virtual=!1}):(e[0].virtual&&(e[0].virtual=!1),e.slice(4,t+1).forEach(function(e){e.virtual=!1}))}function removeBorderRadius(e,t){t<4?e.slice(t,4).forEach(function(e){e.virtual=!0}):e.slice(t).forEach(function(e){e.virtual=!0})}function getBorderRadius(e,t,r,i,n){void 0===i&&(i=[0,0]);return getRadiusValues(e&&"0px"!==e?splitSpace(e):[],t,r,0,0,i,n)}function triggerRoundEvent(e,t,r,i,n){var a=e.state,s=a.width,o=a.height,n=getRadiusStyles(n,e.props.roundRelative,s,o),l=n.raws,u=n.styles,n=splitRadiusPoses(n.radiusPoses,l),l=n.horizontals,n=n.verticals,u=u.join(" "),a=(a.borderRadiusState=u,fillParams(e,t,__assign({horizontals:l,verticals:n,borderRadius:u,width:s,height:o,delta:i,dist:r},fillCSSObject({borderRadius:u},t))));return triggerEvent(e,"onRound",a),a}function getStyleBorderRadius(e){var t,r,i=e.getState().style,n=i.borderRadius||"";return!n&&e.props.groupable&&(t=e.moveables[0],r=e.getTargets()[0])&&(n=(null==t?void 0:t.props.target)===r?null!=(e=null==(t=e.moveables[0])?void 0:t.state.style.borderRadius)?e:"":getComputedStyle$1(r).borderRadius,i.borderRadius=n),n}var Roundable={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[".control.border-radius {\nbackground: #d66;\ncursor: pointer;\nz-index: 3;\n}",".control.border-radius.vertical {\nbackground: #d6d;\nz-index: 2;\n}",".control.border-radius.virtual {\nopacity: 0.5;\nz-index: 1;\n}",":host.round-line-clickable .line.direction {\ncursor: pointer;\n}"],className:function(e){e=e.props.roundClickable;return!0===e||"line"===e?prefix("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(e,s){var o,l,u,c,t=e.getState(),r=t.target,i=t.width,n=t.height,h=t.allMatrix,a=t.is3d,d=t.left,p=t.top,f=e.props,m=f.minRoundControls,m=void 0===m?[0,0]:m,g=f.maxRoundControls,v=void 0===g?[4,4]:g,y=f.zoom,g=f.roundPadding,_=void 0===g?0:g,b=f.isDisplayShadowRoundControls,g=f.groupable;return r&&(f=t.borderRadiusState||getStyleBorderRadius(e),o=a?4:3,r=getBorderRadius(f,i,n,m,!0))?(u=l=0,c=g?[0,0]:[d,p],r.map(function(e,t){var r=e.horizontal,i=e.vertical,n=e.direction||"",a=__spreadArray([],__read(e.pos),!1),r=(u+=Math.abs(r),l+=Math.abs(i),r&&-1<n.indexOf("n")&&(a[1]-=_),i&&-1<n.indexOf("w")&&(a[0]-=_),r&&-1<n.indexOf("s")&&(a[1]+=_),i&&-1<n.indexOf("e")&&(a[0]+=_),minus(calculatePosition(h,a,o),c)),i=e.vertical?l<=v[1]&&(b&&"horizontal"!==b||!e.virtual):u<=v[0]&&(b||!e.virtual);return s.createElement("div",{key:"borderRadiusControl".concat(t),className:prefix("control","border-radius",e.vertical?"vertical":"",e.virtual?"virtual":""),"data-radius-index":t,style:{display:i?"block":"none",transform:"translate(".concat(r[0],"px, ").concat(r[1],"px) scale(").concat(y,")")}})})):null},dragControlCondition:function(e,t){return!(!t.inputEvent||t.isRequest)&&(-1<(t=t.inputEvent.target.getAttribute("class")||"").indexOf("border-radius")||-1<t.indexOf("moveable-line")&&-1<t.indexOf("moveable-direction"))},dragGroupControlCondition:function(e,t){return this.dragControlCondition(e,t)},dragControlStart:function(e,t){var r=t.inputEvent,i=t.datas,r=r.target,n=r.getAttribute("class")||"",a=-1<n.indexOf("border-radius"),n=-1<n.indexOf("moveable-line")&&-1<n.indexOf("moveable-direction"),s=a?parseInt(r.getAttribute("data-radius-index"),10):-1,o=-1;if(n&&(r=r.getAttribute("data-line-key")||"")&&(o=parseInt(r.replace(/render-line-/g,""),10),isNaN(o))&&(o=-1),!a&&!n)return!1;r=fillParams(e,t,{});if(!1===triggerEvent(e,"onRoundStart",r))return!1;i.lineIndex=o,i.controlIndex=s,i.isControl=a,i.isLine=n,setDragStart(e,t);o=e.props,s=o.roundRelative,a=o.minRoundControls,n=void 0===a?[0,0]:a,t=e.state,o=t.width,a=t.height;i.isRound=!0,i.prevDist=[0,0];e=getBorderRadius(getStyleBorderRadius(e)||"",o,a,n,!0)||[];return i.controlPoses=e,t.borderRadiusState=getRadiusStyles(e,s,o,a).styles.join(" "),r},dragControl:function(e,t){var r,i,n,a,s,o,l,u,c,h,d,p,f=t.datas,m=f.controlPoses;return!!(f.isRound&&f.isControl&&m.length)&&(r=f.controlIndex,i=(n=__read(getDragDist(t),2))[0],s=minus(a=[i,n=n[1]],f.prevDist),p=e.props.maxRoundControls,o=void 0===p?[4,4]:p,l=(p=e.state).width,u=p.height,p=m[r],c=p.vertical,h=p.horizontal,(d=m.map(function(e){var t=e.horizontal,e=e.vertical,r=[t*h*a[0],e*c*a[1]];if(t){if(1===o[0])return r;if(o[0]<4&&t!==h)return r}else{if(0===o[1])return r[1]=e*h*a[0]/l*u,r;if(c){if(1===o[1])return r;if(o[1]<4&&e!==c)return r}}return[0,0]}))[r]=a,p=m.map(function(e,t){return __assign(__assign({},e),{pos:plus(e.pos,d[t])})}),r<4?p.slice(0,r+1).forEach(function(e){e.virtual=!1}):p.slice(4,r+1).forEach(function(e){e.virtual=!1}),f.prevDist=[i,n],triggerRoundEvent(e,t,a,s,p))},dragControlEnd:function(e,t){var r,i,n,a,s,o,l=e.state,u=(l.borderRadiusState="",t.datas),c=t.isDouble;return!!u.isRound&&(o=u.isControl,r=u.controlIndex,i=u.isLine,n=u.lineIndex,a=(u=u.controlPoses).filter(function(e){return e.virtual}).length,s=void 0===(s=e.props.roundClickable)||s,c&&s&&(!o||!0!==s&&"control"!==s?!i||!0!==s&&"line"!==s||addBorderRadiusByLine(u,n,(c=__read(calculatePointerDist(e,t),2))[0],c[1]):removeBorderRadius(u,r),a!==u.filter(function(e){return e.virtual}).length)&&triggerRoundEvent(e,t,[0,0],[0,0],u),triggerEvent(e,"onRoundEnd",o=fillEndParams(e,t,{})),l.borderRadiusState="",o)},dragGroupControlStart:function(e,t){var r,i,n=this.dragControlStart(e,t);return!!n&&(r=e.moveables,i=e.props.targets,t=fillChildEvents(e,"roundable",t),triggerEvent(e,"onRoundGroupStart",__assign({targets:e.props.targets,events:t.map(function(e,t){return __assign(__assign({},e),{target:i[t],moveable:r[t],currentTarget:r[t]})})},n)),n)},dragGroupControl:function(e,t){var r,i,n=this.dragControl(e,t);return!!n&&(r=e.moveables,i=e.props.targets,t=fillChildEvents(e,"roundable",t),triggerEvent(e,"onRoundGroup",e=__assign({targets:e.props.targets,events:t.map(function(e,t){return __assign(__assign(__assign({},e),{target:i[t],moveable:r[t],currentTarget:r[t]}),fillCSSObject({borderRadius:n.borderRadius},e))})},n)),e)},dragGroupControlEnd:function(t,e){var i=t.moveables,n=t.props.targets,a=fillChildEvents(t,"roundable",e),e=(catchEvent(t,"onRound",function(r){var e=__assign({targets:t.props.targets,events:a.map(function(e,t){return __assign(__assign(__assign({},e),{target:n[t],moveable:i[t],currentTarget:i[t]}),fillCSSObject({borderRadius:r.borderRadius},e))})},r);triggerEvent(t,"onRoundGroup",e)}),this.dragControlEnd(t,e));return!!e&&(e=__assign({targets:t.props.targets,events:a.map(function(e,t){return __assign(__assign({},e),{target:n[t],moveable:i[t],currentTarget:i[t],lastEvent:null==(t=e.datas)?void 0:t.lastEvent})})},e),triggerEvent(t,"onRoundGroupEnd",e),e)},unset:function(e){e.state.borderRadiusState=""}};function isIdentityMatrix(e,t){var r=createIdentityMatrix(t?4:3);return e==="matrix".concat(t?"3d":"","(").concat(r.join(","),")")||"matrix(1,0,0,1,0,0)"===e}var BeforeRenderable={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(e,t){var e=e.state,r=e.is3d,i=e.targetMatrix,e=e.inlineTransform,i=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat(convertMatrixtoCSS(i,!0),")"),e=e&&"none"!==e?e:i;t.datas.startTransforms=isIdentityMatrix(e,r)?[]:splitSpace(e)},resetStyle:function(e){var t=e.datas;t.nextStyle={},t.nextTransforms=e.datas.startTransforms,t.nextTransformAppendedIndexes=[]},fillDragStartParams:function(e,t){return fillParams(e,t,{setTransform:function(e){t.datas.startTransforms=isArray(e)?e:splitSpace(e)},isPinch:!!t.isPinch})},fillDragParams:function(e,t){return fillParams(e,t,{isPinch:!!t.isPinch})},dragStart:function(e,t){this.setTransform(e,t),this.resetStyle(t),triggerEvent(e,"onBeforeRenderStart",this.fillDragStartParams(e,t))},drag:function(e,t){t.datas.startTransforms||this.setTransform(e,t),this.resetStyle(t),triggerEvent(e,"onBeforeRender",fillParams(e,t,{isPinch:!!t.isPinch}))},dragEnd:function(e,t){t.datas.startTransforms||(this.setTransform(e,t),this.resetStyle(t)),triggerEvent(e,"onBeforeRenderEnd",fillParams(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag}))},dragGroupStart:function(e,t){var r=this,i=(this.dragStart(e,t),fillChildEvents(e,"beforeRenderable",t)),n=e.moveables,i=i.map(function(e,t){t=n[t];return r.setTransform(t,e),r.resetStyle(e),r.fillDragStartParams(t,e)});triggerEvent(e,"onBeforeRenderGroupStart",fillParams(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,setTransform:function(){},events:i}))},dragGroup:function(e,t){var r=this,i=(this.drag(e,t),fillChildEvents(e,"beforeRenderable",t)),n=e.moveables,i=i.map(function(e,t){t=n[t];return r.resetStyle(e),r.fillDragParams(t,e)});triggerEvent(e,"onBeforeRenderGroup",fillParams(e,t,{isPinch:!!t.isPinch,targets:e.props.targets,events:i}))},dragGroupEnd:function(e,t){this.dragEnd(e,t),triggerEvent(e,"onBeforeRenderGroupEnd",fillParams(e,t,{isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets}))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)}},Renderable={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(e,t){triggerEvent(e,"onRenderStart",fillParams(e,t,{isPinch:!!t.isPinch}))},drag:function(e,t){triggerEvent(e,"onRender",this.fillDragParams(e,t))},dragAfter:function(e,t){return this.drag(e,t)},dragEnd:function(e,t){triggerEvent(e,"onRenderEnd",this.fillDragEndParams(e,t))},dragGroupStart:function(e,t){triggerEvent(e,"onRenderGroupStart",fillParams(e,t,{isPinch:!!t.isPinch,targets:e.props.targets}))},dragGroup:function(e,t){var r=this,i=fillChildEvents(e,"beforeRenderable",t),n=e.moveables,i=i.map(function(e,t){t=n[t];return r.fillDragParams(t,e)});triggerEvent(e,"onRenderGroup",fillParams(e,t,__assign(__assign({isPinch:!!t.isPinch,targets:e.props.targets,transform:getNextTransformText(t),transformObject:{}},fillCSSObject(getNextStyle(t))),{events:i})))},dragGroupEnd:function(e,t){var r=this,i=fillChildEvents(e,"beforeRenderable",t),n=e.moveables,i=i.map(function(e,t){t=n[t];return r.fillDragEndParams(t,e)});triggerEvent(e,"onRenderGroupEnd",fillParams(e,t,__assign({isPinch:!!t.isPinch,isDrag:t.isDrag,targets:e.props.targets,events:i,transformObject:{},transform:getNextTransformText(t)},fillCSSObject(getNextStyle(t)))))},dragControlStart:function(e,t){return this.dragStart(e,t)},dragControl:function(e,t){return this.drag(e,t)},dragControlAfter:function(e,t){return this.dragAfter(e,t)},dragControlEnd:function(e,t){return this.dragEnd(e,t)},dragGroupControlStart:function(e,t){return this.dragGroupStart(e,t)},dragGroupControl:function(e,t){return this.dragGroup(e,t)},dragGroupControlEnd:function(e,t){return this.dragGroupEnd(e,t)},fillDragParams:function(e,t){var r={};return parse(getNextTransforms(t)||[]).forEach(function(e){r[e.name]=e.functionValue}),fillParams(e,t,__assign({isPinch:!!t.isPinch,transformObject:r,transform:getNextTransformText(t)},fillCSSObject(getNextStyle(t))))},fillDragEndParams:function(e,t){var r={};return parse(getNextTransforms(t)||[]).forEach(function(e){r[e.name]=e.functionValue}),fillParams(e,t,__assign({isPinch:!!t.isPinch,isDrag:t.isDrag,transformObject:r,transform:getNextTransformText(t)},fillCSSObject(getNextStyle(t))))}};function triggerAble(n,e,t,a,s,o,r){o.clientDistX=o.distX,o.clientDistY=o.distY;var l,i,u,c,h,d,p,f,m,g,v,y="Start"===s,_="End"===s,b="After"===s,x=n.state.target,S=o.isRequest,T=-1<a.indexOf("Control");return!(!x||y&&T&&!S&&n.areaElement===o.inputEvent.target||(l=__spreadArray([],__read(e),!1),S&&(i=o.requestAble,l.some(function(e){return e.name===i})||l.push.apply(l,__spreadArray([],__read(n.props.ables.filter(function(e){return e.name===i})),!1))),!l.length)||l.every(function(e){return e.dragRelation})||(x=o.inputEvent,_&&x&&(u=document.elementFromPoint(o.clientX,o.clientY)||x.target),c=!1,h=function(){var e;c=!0,null!=(e=o.stop)&&e.call(o)},(x=!(!y||n.targetGesto&&n.controlGesto&&n.targetGesto.isFlag()&&n.controlGesto.isFlag()))&&n.updateRect(s,!0,!1),d=o.datas,f=n[p=T?"controlGesto":"targetGesto"],m=function(e,t,r){var i;return t in e&&f===n[p]&&(i=e.name,i=d[i]||(d[i]={}),y&&(i.isEventStart=!r||!e[r]||e[r](n,o)),!!i.isEventStart)&&(r=e[t](n,__assign(__assign({},o),{stop:h,datas:i,originalDatas:d,inputTarget:u})),n._emitter.off(),y&&!1===r&&(i.isEventStart=!1),r)},x&&l.forEach(function(e){e.unset&&e.unset(n)}),m(BeforeRenderable,"drag".concat(a).concat(s)),v=g=0,t.forEach(function(e){if(c)return!1;var t="".concat(e).concat(a).concat(s),r="".concat(e).concat(a,"Condition"),i=(""!==s||S||convertDragDist(n.state,o),l.filter(function(e){return e[t]})),e=(i=i.filter(function(e,t){return e.name&&i.indexOf(e)===t})).filter(function(e){return m(e,t,r)}).length;c&&++g,e&&++v,!c&&y&&i.length&&!e&&(g+=i.filter(function(e){var t=e.name;return!!d[t].isEventStart&&"strong"!==e.dragRelation}).length?1:0)}),b&&!v||m(Renderable,"drag".concat(a).concat(s)),T=f!==n[p]||g===t.length,(_||c||T)&&(n.state.gestos={},n.moveables&&n.moveables.forEach(function(e){e.state.gestos={}}),l.forEach(function(e){e.unset&&e.unset(n)})),y&&!T&&!S&&v&&n.props.preventDefault&&null!=o&&o.preventDefault(),n.isUnmounted)||T||((!y&&v&&!r||_)&&(n.props.flushSync||defaultSync)(function(){n.updateRect(_?s:"",!0,!1),n.forceUpdate()}),y||_||b||!v||r||triggerAble(n,e,t,a,s+"After",o),0))}function checkMoveableTarget(n){return function(e){var t,e=e.inputEvent.target,r=n.areaElement,i=n._dragTarget;return!(!i||null!=(t=n.controlGesto)&&t.isFlag())&&(e===i||i.contains(e)||e===r||!n.isMoveableElement(e)&&!n.controlBox.contains(e)||hasClass(e,"moveable-area")||hasClass(e,"moveable-padding")||hasClass(e,"moveable-edgeDraggable"))}}function getTargetAbleGesto(e,t,r){var i=e.controlBox,n=[],a=e.props,s=a.dragArea,o=e.state.target,l=a.dragTarget;return n.push(i),s&&!l||n.push(t),!s&&l&&o&&t!==o&&a.dragTargetSelf&&n.push(o),getAbleGesto(e,n,"targetAbles",r,{dragStart:checkMoveableTarget(e),pinchStart:checkMoveableTarget(e)})}function getAbleGesto(a,e,s,o,l){void 0===l&&(l={});var t="targetAbles"===s,r=a.props,i=r.pinchOutside,n=r.pinchThreshold,u=r.preventClickEventOnDrag,c=r.preventClickDefault,h=r.checkInput,d=r.dragFocusedInput,p=r.preventDefault,p={preventDefault:void 0===p||p,preventRightClick:!0,preventWheelClick:!0,container:getRefTarget(r.dragContainer,!0)||getWindow(a.getControlBoxElement()),pinchThreshold:n,pinchOutside:i,preventClickEventOnDrag:t&&u,preventClickEventOnDragStart:t&&c,preventClickEventByCondition:t?null:function(e){return a.controlBox.contains(e.target)},checkInput:t&&h,dragFocusedInput:d},f=new Gesto(e,p),m="Control"===o;return["drag","pinch"].forEach(function(n){["Start","","End"].forEach(function(i){f.on("".concat(n).concat(i),function(e){var t=e.eventType,r="drag"===n&&e.isPinch;l[t]&&!l[t](e)?e.stop():r||(t="drag"===n?[n]:["drag",n],r=__spreadArray([],__read(a[s]),!1),triggerAble(a,r,t,o,i,e)?(a.props.stopPropagation||"Start"===i&&m)&&null!=(r=null==e?void 0:e.inputEvent)&&r.stopPropagation():e.stop())})})}),f}var EventManager=(()=>{function e(e,t,r){var n=this;this.target=e,this.moveable=t,this.eventName=r,this.ables=[],this._onEvent=function(t){var r=n.eventName,i=n.moveable;i.state.disableNativeEvent||n.ables.forEach(function(e){e[r](i,{inputEvent:t})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return e.prototype.setAbles=function(e){this.ables=e},e.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},e})();function calculateMatrixStack(e,t,r,i){void 0===r&&(r=t);var t=getMatrixStackInfo(e,t),n=t.matrixes,a=t.is3d,s=t.targetMatrix,o=t.transformOrigin,l=t.targetOrigin,u=t.offsetContainer,c=t.hasFixed,t=t.zoom,h=getCachedMatrixContainerInfo(u,r),d=h.matrixes,p=h.is3d,f=h.offsetContainer,h=h.zoom,i=i||p||a,m=i?4:3,g="svg"!==e.tagName.toLowerCase()&&"ownerSVGElement"in e,v=createIdentityMatrix(m),y=createIdentityMatrix(m),_=createIdentityMatrix(m),b=createIdentityMatrix(m),x=n.length,d=d.map(function(e){return __assign(__assign({},e),{matrix:e.matrix?__spreadArray([],__read(e.matrix),!1):void 0})}).reverse(),p=(n.reverse(),!a&&i&&(s=convertDimension(s,3,4),convert3DMatrixes(n)),!p&&i&&convert3DMatrixes(d),d.forEach(function(e){y=multiply(y,e.matrix,m)}),r||getDocumentBody(e)),S=(null==(r=d[0])?void 0:r.target)||getOffsetInfo(p,p,!0).offsetParent,T=d.slice(1).reduce(function(e,t){return multiply(e,t.matrix,m)},createIdentityMatrix(m)),r=(n.forEach(function(e,t){x-2===t&&(_=v.slice()),x-1===t&&(b=v.slice()),e.matrix||(t=getSVGOffset(e,n[t+1],S,m,multiply(T,v,m)),e.matrix=createOriginMatrix(t,m)),v=multiply(v,e.matrix,m)}),!g&&a),s=s||createIdentityMatrix(r?4:3),p=makeMatrixCSS(g&&16===s.length?convertDimension(s,4,3):s,r),d=y,y=ignoreDimension(y,m,m);return{hasZoom:1!==t||1!==h,hasFixed:c,matrixes:n,rootMatrix:y,originalRootMatrix:d,beforeMatrix:_,offsetMatrix:b,allMatrix:v,targetMatrix:s,targetTransform:p,inlineTransform:e.style.transform,transformOrigin:o,targetOrigin:l,is3d:i,offsetContainer:u,offsetRootContainer:f}}function calculateElementInfo(e,t,r,i){void 0===r&&(r=t);var n=0,a=0,s=0,o={},l=getSize(e),t=(e&&(n=l.offsetWidth,a=l.offsetHeight),e&&(t=calculateElementPosition((e=calculateMatrixStack(e,t,r,i)).allMatrix,e.transformOrigin,n,a),o=__assign(__assign({},e),t),s=getRotationRad([(r=calculateElementPosition(e.allMatrix,[50,50],100,100)).pos1,r.pos2],r.direction)),i?4:3);return __assign(__assign(__assign({hasZoom:!1,width:n,height:a,rotation:s},l),{originalRootMatrix:createIdentityMatrix(t),rootMatrix:createIdentityMatrix(t),beforeMatrix:createIdentityMatrix(t),offsetMatrix:createIdentityMatrix(t),allMatrix:createIdentityMatrix(t),targetMatrix:createIdentityMatrix(t),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!i,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),o)}function getMoveableTargetInfo(e,t,r,i,n,a){void 0===a&&(a=[]);var s,o=1,l=[0,0],u=resetClientRect(),c=resetClientRect(),h=resetClientRect(),d=resetClientRect(),p=[0,0],f={},r=calculateElementInfo(t,r,n,!0);return t&&(s=getCachedStyle(t),a.forEach(function(e){f[e]=s(e)}),n=r.is3d?4:3,o=(a=calculateElementPosition(r.offsetMatrix,plus(r.transformOrigin,getOrigin(r.targetMatrix,n)),r.width,r.height)).direction,l=plus(a.origin,[a.left-r.left,a.top-r.top]),d=getClientRect(r.offsetRootContainer),n=getOffsetInfo(i,i,!0).offsetParent||r.offsetRootContainer,r.hasZoom?(a=calculateElementPosition(multiply(r.originalRootMatrix,r.allMatrix),r.transformOrigin,r.width,r.height),i=calculateElementPosition(r.originalRootMatrix,getTransformOriginArray(getCachedStyle(n)("transformOrigin")).map(function(e){return parseFloat(e)}),n.offsetWidth,n.offsetHeight),u=getClientRectByPosition(a,d),h=getClientRectByPosition(i,d,n,!0),e&&(c=getClientRectByPosition({left:a.left,top:i=a.top,bottom:i,right:i},d))):(u=getClientRect(t),h=getCachedClientRect(n),e&&(c=getClientRect(e)),a=h.left,i=h.clientLeft,n=h.clientTop,e=[u.left-a,u.top-h.top],p=minus(calculateInversePosition(r.rootMatrix,e,4),[i+r.left,n+r.top]))),__assign({targetClientRect:u,containerClientRect:h,moveableClientRect:c,rootContainerClientRect:d,beforeDirection:o,beforeOrigin:l,originalBeforeOrigin:l,target:t,style:f,offsetDelta:p},r)}function getPersistState(e){var t,r,i=e.pos1,n=e.pos2,a=e.pos3,s=e.pos4;return i&&n&&a&&s?(t=[(t=getMinMaxs([i,n,a,s])).minX,t.minY],r=minus(e.origin,t),i=minus(i,t),n=minus(n,t),a=minus(a,t),s=minus(s,t),__assign(__assign({},e),{left:e.left,top:e.top,posDelta:t,pos1:i,pos2:n,pos3:a,pos4:s,origin:r,beforeOrigin:r,isPersisted:!0})):null}var MoveableManager=(e=>{function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=__assign({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},getMoveableTargetInfo(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new EventEmitter$1,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){var e;t.isDragging()||((e=t.props.parentMoveable)?e.checkUpdateRect():(cancelAnimationFrame$1(t._observerId),t._observerId=requestAnimationFrame$1(function(){t.isDragging()||t.updateRect()})))},t._onPreventClick=function(e){e.stopPropagation(),e.preventDefault()},t}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=this.getState(),r=e.parentPosition,i=e.className,n=e.target,a=e.zoom,s=e.cspNonce,o=e.translateZ,l=e.cssStyled,u=e.groupable,c=e.linePadding,h=e.controlPadding,r=(this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses(),__read(r||[0,0],2)),d=r[0],r=r[1],p=t.left,f=t.top,m=t.target,g=t.direction,v=t.hasFixed,t=t.offsetDelta,y=e.targets,_=this.isDragging(),b={},x=(this.getEnabledAbles().forEach(function(e){b["data-able-".concat(e.name.toLowerCase())]=!0}),this._getAbleClassName()),y=y&&y.length&&(m||u)||n||!this._hasFirstTarget&&this.state.isPersisted,m=this.controlBox||this.props.firstRenderState||this.props.persistData,n=[p-d,f-r],p=(!u&&e.useAccuratePosition&&(n[0]+=t[0],n[1]+=t[1]),{position:v?"fixed":"absolute",display:y?"block":"none",visibility:m?"visible":"hidden",transform:"translate3d(".concat(n[0],"px, ").concat(n[1],"px, ").concat(o,")"),"--zoom":a,"--zoompx":"".concat(a,"px")});return c&&(p["--moveable-line-padding"]=c),h&&(p["--moveable-control-padding"]=h),reactExports.createElement(l,__assign({cspNonce:s,ref:ref(this,"controlBox"),className:"".concat(prefix("control-box",-1===g?"reverse":"",_?"dragging":"")," ").concat(x," ").concat(i)},b,{onClick:this._onPreventClick,style:p}),this.renderAbles(),this._renderLines())},t.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var e=this.props,t=e.parentMoveable,e=e.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),e||t||this.state.isPersisted||(this.updateRect("",!1,!1),this.forceUpdate())},t.prototype.componentDidUpdate=function(e){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(e)},t.prototype.componentWillUnmount=function(){var e;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),null!=(e=this._reiszeObserver)&&e.disconnect(),null!=(e=this._mutationObserver)&&e.disconnect();this._viewContainer&&this._changeAbleViewClassNames([]),unsetGesto(this,!1),unsetGesto(this,!0);var t,r=this.events;for(t in r){var i=r[t];i&&i.destroy()}},t.prototype.getTargets=function(){var e=this.props.target;return e?[e]:[]},t.prototype.getAble=function(t){return find$1(this.props.ables||[],function(e){return e.name===t})},t.prototype.getContainer=function(){var e=this.props,t=e.parentMoveable,r=e.wrapperMoveable;return e.container||r&&r.getContainer()||t&&t.getContainer()||this.controlBox.parentElement},t.prototype.getControlBoxElement=function(){return this.controlBox},t.prototype.getDragElement=function(){return this._dragTarget},t.prototype.isMoveableElement=function(e){var t;return e&&-1<((null==(t=e.getAttribute)?void 0:t.call(e,"class"))||"").indexOf(PREFIX)},t.prototype.dragStart=function(e){var t=this.targetGesto,r=this.controlGesto;return t&&checkMoveableTarget(this)({inputEvent:e})?t.isFlag()||t.triggerDragStart(e):r&&this.isMoveableElement(e.target)&&(r.isFlag()||r.triggerDragStart(e)),this},t.prototype.hitTest=function(e){var t,r,i=this.state,n=i.target,a=i.pos1,s=i.pos2,o=i.pos3,l=i.pos4,i=i.targetClientRect;return n&&(e=(n=isNode(e)?{left:(n=e.getBoundingClientRect()).left,top:n.top,width:n.width,height:n.height}:__assign({width:0,height:0},e)).left,t=n.top,r=n.width,n=n.height,s=getOverlapSize(a=fitPoints([a,s,l,o],i),[[e,t],[e+r,t],[e+r,t+n],[e,t+n]]),l=getAreaSize(a),s)&&l?Math.min(100,s/l*100):0},t.prototype.isInside=function(e,t){var r=this.state;return!!r.target&&isInside([e,t],fitPoints([r.pos1,r.pos2,r.pos4,r.pos3],r.targetClientRect))},t.prototype.updateRect=function(e,t,r){void 0===r&&(r=!0);var i=this.props,n=!i.parentPosition&&!i.wrapperMoveable,a=(n&&setStoreCache(!0),i.parentMoveable),s=this.state.target||i.target,o=this.getContainer(),l=(a||this)._rootContainer,u=getMoveableTargetInfo(this.controlBox,s,o,o,l||o,this._getRequestStyles());if(!s&&this._hasFirstTarget&&i.persistData){var c,h=getPersistState(i.persistData);for(c in h)u[c]=h[c]}n&&setStoreCache(),this.updateState(u,!a&&r)},t.prototype.isDragging=function(e){var t=this.targetGesto,r=this.controlGesto;return null!=t&&t.isFlag()?!e||!(null==(t=t.getEventData()[e])||!t.isEventStart):!(null==r||!r.isFlag()||e&&(null==(t=r.getEventData()[e])||!t.isEventStart))},t.prototype.updateTarget=function(e){this.updateRect(e,!0)},t.prototype.getRect=function(){var e=this.state,t=getAbsolutePosesByState(this.state),r=__read(t,4),i=r[0],n=r[1],a=r[2],r=r[3],t=getRect(t),s=e.width,o=e.height,l=t.width,u=t.height,c=t.left,t=t.top,h=[e.left,e.top],d=plus(h,e.origin);return{width:l,height:u,left:c,top:t,pos1:i,pos2:n,pos3:a,pos4:r,offsetWidth:s,offsetHeight:o,beforeOrigin:plus(h,e.beforeOrigin),origin:d,transformOrigin:e.transformOrigin,rotation:this.getRotation()}},t.prototype.getManager=function(){return this},t.prototype.stopDrag=function(e){var t;e&&"target"!==e||(!1===(null==(t=this.targetGesto)?void 0:t.isIdle())&&unsetAbles(this,!1),null!=t&&t.stop()),e&&"control"!==e||(!1===(null==(t=this.controlGesto)?void 0:t.isIdle())&&unsetAbles(this,!0),null!=t&&t.stop())},t.prototype.getRotation=function(){var e=this.state;return getAbsoluteRotation(e.pos1,e.pos2,e.direction)},t.prototype.request=function(t,e,r){void 0===e&&(e={});var i,n,a,s,o,l=this,u=l.props,c=u.parentMoveable||u.wrapperMoveable||l,h=c.props.ables,u=u.groupable,h=find$1(h,function(e){return e.name===t});return!this.isDragging()&&h&&h.request?(i=h.request(l),n=r||e.isInstant,h=i.isControl?"controlAbles":"targetAbles",a="".concat(u?"Group":"").concat(i.isControl?"Control":""),s=__spreadArray([],__read(c[h]),!1),o={request:function(e){return triggerAble(l,s,["drag"],a,"",__assign(__assign({},i.request(e)),{requestAble:t,isRequest:!0}),n),o},requestEnd:function(){return triggerAble(l,s,["drag"],a,"End",__assign(__assign({},i.requestEnd()),{requestAble:t,isRequest:!0}),n),o}},triggerAble(l,s,["drag"],a,"Start",__assign(__assign({},i.requestStart(e)),{requestAble:t,isRequest:!0}),n),n?o.request(e).requestEnd():o):{request:function(){return this},requestEnd:function(){return this}}},t.prototype.getMoveables=function(){return[this]},t.prototype.destroy=function(){this.componentWillUnmount()},t.prototype.updateRenderPoses=function(){var e,t,r,i=this.getState(),n=this.props,a=n.padding,s=i.originalBeforeOrigin,o=i.transformOrigin,l=i.allMatrix,u=i.is3d,c=i.pos1,h=i.pos2,d=i.pos3,p=i.pos4,f=i.left,m=i.top,g=i.isPersisted;a?(e=(a=getPaddingBox(a)).left,t=a.top,r=a.bottom,a=a.right,g=multiplies(u=u?4:3,createOriginMatrix((g?o:this.controlBox&&n.groupable?s:plus(s,[f,m])).map(function(e){return-e}),u),l,createOriginMatrix(o,u)),i.renderPoses=[calculatePadding(g,c,[-e,-t],u),calculatePadding(g,h,[a,-t],u),calculatePadding(g,d,[-e,r],u),calculatePadding(g,p,[a,r],u)]):i.renderPoses=[c,h,d,p]},t.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var e=this.props,t=e.target,r=e.container,e=e.parentMoveable,i=this.state,n=i.target,i=i.container;(n||t)&&(this.updateAbles(),(n=!equals(n,t))||!equals(i,r))&&((i=r||this.controlBox)&&this.unsetAbles(),this.updateState({target:t,container:r}),!e&&i&&this.updateRect("End",!1,!1),this._isPropTargetChanged=n)},t.prototype.waitToChangeTarget=function(){return new Promise(function(){})},t.prototype.triggerEvent=function(e,t){var r=this.props;return this._emitter.trigger(e,t),r.parentMoveable&&t.isRequest&&!t.isRequestChild?r.parentMoveable.triggerEvent(e,t,!0):(r=r[e])&&r(t)},t.prototype.useCSS=function(e,t){var r=this.props.customStyledMap,i=e+t;return r[i]||(r[i]=styled(e,t)),r[i]},t.prototype.getState=function(){var e=this.props,t=((e.target||null!=(t=e.targets)&&t.length)&&(this._hasFirstTarget=!0),this.controlBox),r=e.persistData,e=e.firstRenderState;if(e&&!t)return e;if(!this._hasFirstTarget&&r){t=getPersistState(r);if(t)return this.updateState(t,!1),this.state}return this.state.isPersisted=!1,this.state},t.prototype.updateSelectors=function(){},t.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(e){e.unset&&e.unset(t)})},t.prototype.updateAbles=function(e,t){void 0===e&&(e=this.props.ables),void 0===t&&(t="");var r=this.props.triggerAblesSimultaneously,e=this.getEnabledAbles(e),i="drag".concat(t,"Start"),n="pinch".concat(t,"Start"),t="drag".concat(t,"ControlStart"),i=filterAbles(e,[i,n],r),n=filterAbles(e,[t],r);this.enabledAbles=e,this.targetAbles=i,this.controlAbles=n},t.prototype.updateState=function(e,t){if(t)this.isUnmounted||this.setState(e);else{var r,i=this.state;for(r in e)i[r]=e[r]}},t.prototype.getEnabledAbles=function(e){void 0===e&&(e=this.props.ables);var t=this.props;return e.filter(function(e){return e&&(e.always&&!1!==t[e.name]||t[e.name])})},t.prototype.renderAbles=function(){var t=this,e=this.props.triggerAblesSimultaneously,r={createElement:reactExports.createElement};return this.renderState={},groupByMap(flat(filterAbles(this.getEnabledAbles(),["render"],e).map(function(e){return(0,e.render)(t,r)||[]})).filter(function(e){return e}),function(e){return e.key}).map(function(e){return e[0]})},t.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},t.prototype._getRequestStyles=function(){return this.getEnabledAbles().reduce(function(e,t){var r,t=null!=(r=null==(r=t.requestStyle)?void 0:r.call(t))?r:[];return __spreadArray(__spreadArray([],__read(e),!1),__read(t),!1)},__spreadArray([],__read(this.props.requestStyles||[]),!1))},t.prototype._updateObserver=function(e){this._updateResizeObserver(e),this._updateMutationObserver(e)},t.prototype._updateEvents=function(){var e=this.controlBox,t=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget;(!t&&this.targetGesto||this._isTargetChanged(!0))&&(unsetGesto(this,!1),this.updateState({gestos:{}})),r||unsetGesto(this,!0),i&&t&&!this.targetGesto&&(this.targetGesto=getTargetAbleGesto(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=getAbleGesto(this,e,"controlAbles","Control"))},t.prototype._updateTargets=function(){var e=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=e.dragArea,this._propTarget=e.target,this._originalDragTarget=e.dragTarget||e.target,this._dragTarget=getRefTarget(this._originalDragTarget,!0)},t.prototype._renderLines=function(){var i,n,e=this.props,a=e.zoom,t=e.hideDefaultLines,r=e.hideChildMoveableDefaultLines,e=e.parentMoveable;return t||e&&r?[]:(i=this.getState().renderPoses,n={createElement:reactExports.createElement},[[0,1],[1,3],[3,2],[2,0]].map(function(e,t){var e=__read(e,2),r=e[0];return renderLine(n,"",i[r],i[e[1]],a,"render-line-".concat(t))}))},t.prototype._isTargetChanged=function(e){var t=this.props,r=t.dragTarget||t.target,i=this._prevOriginalDragTarget,n=this._prevDragArea,t=t.dragArea;return!t&&i!==r||(e||t)&&n!==t||this._prevPropTarget!=this._propTarget},t.prototype._updateNativeEvents=function(){var n,a=this,s=this.props.dragArea?this.areaElement:this.state.target,o=this.events,e=getKeys(o);if(this._isTargetChanged())for(var t in o){var r=o[t];r&&r.destroy(),o[t]=null}s&&(n=this.enabledAbles,e.forEach(function(e){var t=filterAbles(n,[e]),r=0<t.length,i=o[e];r?(i||(i=new EventManager(s,a,e),o[e]=i),i.setAbles(t)):i&&(i.destroy(),o[e]=null)}))},t.prototype._checkUpdateRootContainer=function(){var e=this.props.rootContainer;!this._rootContainer&&e&&(this._rootContainer=getRefTarget(e,!0))},t.prototype._checkUpdateViewContainer=function(){var e=this.props.viewContainer;!this._viewContainer&&e&&(this._viewContainer=getRefTarget(e,!0)),this._viewContainer&&this._changeAbleViewClassNames(__spreadArray(__spreadArray([],__read(this._getAbleViewClassNames()),!1),[this.isDragging()?VIEW_DRAGGING:""],!1))},t.prototype._changeAbleViewClassNames=function(e){var t=this._viewContainer,r=groupBy(e.filter(Boolean),function(e){return e}).map(function(e){return __read(e,1)[0]}),i=this._viewClassNames,e=diff$1(i,r),n=e.removed,e=e.added;n.forEach(function(e){removeClass(t,i[e])}),e.forEach(function(e){addClass(t,r[e])}),this._viewClassNames=r},t.prototype._getAbleViewClassNames=function(){var r=this;return(this.getEnabledAbles().map(function(e){var t;return(null==(t=e.viewClassName)?void 0:t.call(e,r))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},t.prototype._getAbleClassName=function(i){var n=this,e=(void 0===i&&(i=""),this.getEnabledAbles()),t=this.targetGesto,r=this.controlGesto,a=null!=t&&t.isFlag()?t.getEventData():{},s=null!=r&&r.isFlag()?r.getEventData():{};return e.map(function(e){var t=e.name,r=(null==(r=e.className)?void 0:r.call(e,n))||"";return(null!=(e=a[t])&&e.isEventStart||null!=(e=s[t])&&e.isEventStart)&&(r+=" ".concat(prefix("".concat(t).concat(i,"-dragging")))),r.trim()}).filter(Boolean).join(" ")},t.prototype._updateResizeObserver=function(e){var t=this.props,r=t.target,i=getWindow(this.getControlBoxElement());i.ResizeObserver&&r&&t.useResizeObserver?e.target===r&&this._reiszeObserver||((t=new i.ResizeObserver(this.checkUpdateRect)).observe(r,{box:"border-box"}),this._reiszeObserver=t):null!=(e=this._reiszeObserver)&&e.disconnect()},t.prototype._updateMutationObserver=function(e){var s=this,t=this.props,r=t.target,i=getWindow(this.getControlBoxElement());i.MutationObserver&&r&&t.useMutationObserver?e.target===r&&this._mutationObserver||((t=new i.MutationObserver(function(e){var t,r;try{for(var i=__values(e),n=i.next();!n.done;n=i.next()){var a=n.value;"attributes"===a.type&&"style"===a.attributeName&&s.checkUpdateRect()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}})).observe(r,{attributes:!0}),this._mutationObserver=t):null!=(e=this._mutationObserver)&&e.disconnect()},t.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:defaultSync,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},t})(reactExports.PureComponent),Groupable={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(r,a){var e,i=r.props,t=i.targets||[],n=r.getState(),s=n.left,o=n.top,l=i.zoom||1,u=r.renderGroupRects,c=(null==(e=i.persistData)?void 0:e.children)||[],h=(n.isPersisted?t=c.map(function(){return null}):c=[],watchValue(r,"parentPosition",[s,o],function(e){return e.join(",")})),d=watchValue(r,"requestStyles",r.getRequestChildStyles(),function(e){return e.join(",")});return r.moveables=r.moveables.slice(0,t.length),__spreadArray(__spreadArray([],__read(t.map(function(e,t){return a.createElement(MoveableManager,{key:"moveable"+t,ref:refs(r,"moveables",t),target:e,origin:!1,requestStyles:d,cssStyled:i.cssStyled,customStyledMap:i.customStyledMap,useResizeObserver:i.useResizeObserver,useMutationObserver:i.useMutationObserver,hideChildMoveableDefaultLines:i.hideChildMoveableDefaultLines,parentMoveable:r,parentPosition:[s,o],persistData:c[t],zoom:l})})),!1),__read(flat(u.map(function(e,i){var n=[e.pos1,e.pos2,e.pos3,e.pos4];return[[0,1],[1,3],[3,2],[2,0]].map(function(e,t){var e=__read(e,2),r=e[0],e=e[1];return renderLine(a,"",minus(n[r],h),minus(n[e],h),l,"group-rect-".concat(i,"-").concat(t))})}))),!1)}},Clickable=makeAble("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(e,t){t.datas.inputTarget=t.inputEvent&&t.inputEvent.target},dragEnd:function(e,t){var r=e.props.target,i=t.inputEvent,n=t.inputTarget,a=!e.isMoveableElement(n)&&e.controlBox.contains(n);!i||!n||t.isDrag||e.isMoveableElement(n)||a||(i=r.contains(n),triggerEvent(e,"onClick",fillParams(e,t,{isDouble:t.isDouble,inputTarget:n,isTarget:r===n,moveableTarget:e.props.target,containsTarget:i})))},dragGroupEnd:function(e,t){var r,i,n,a=t.inputEvent,s=t.inputTarget;a&&s&&!t.isDrag&&!e.isMoveableElement(s)&&t.datas.inputTarget!==s&&(i=-1<(r=(a=e.props.targets).indexOf(s)),n=!1,-1===r&&(n=-1<(r=findIndex(a,function(e){return e.contains(s)}))),triggerEvent(e,"onClickGroup",fillParams(e,t,{isDouble:t.isDouble,targets:a,inputTarget:s,targetIndex:r,isTarget:i,containsTarget:n,moveableTarget:a[r]})))},dragControlEnd:function(e,t){this.dragEnd(e,t)},dragGroupControlEnd:function(e,t){this.dragEnd(e,t)}});function getDraggableEvent(e){var t=e.originalDatas.draggable;return t||(e.originalDatas.draggable={},t=e.originalDatas.draggable),__assign(__assign({},e),{datas:t})}var edgeDraggable=makeAble("edgeDraggable",{css:[".edge.edgeDraggable.line {\ncursor: move;\n}"],render:function(e,t){var r=e.props,i=r.edgeDraggable;return i?renderEdgeLines(t,"edgeDraggable",i,e.getState().renderPoses,r.zoom):[]},dragCondition:function(e,t){e=e.props,t=null==(t=t.inputEvent)?void 0:t.target;return!(!e.edgeDraggable||!t)&&!e.draggable&&hasClass(t,prefix("direction"))&&hasClass(t,prefix("edge"))&&hasClass(t,prefix("edgeDraggable"))},dragStart:function(e,t){return Draggable.dragStart(e,getDraggableEvent(t))},drag:function(e,t){return Draggable.drag(e,getDraggableEvent(t))},dragEnd:function(e,t){return Draggable.dragEnd(e,getDraggableEvent(t))},dragGroupCondition:function(e,t){e=e.props,t=null==(t=t.inputEvent)?void 0:t.target;return!(!e.edgeDraggable||!t)&&!e.draggable&&hasClass(t,prefix("direction"))&&hasClass(t,prefix("line"))},dragGroupStart:function(e,t){return Draggable.dragGroupStart(e,getDraggableEvent(t))},dragGroup:function(e,t){return Draggable.dragGroup(e,getDraggableEvent(t))},dragGroupEnd:function(e,t){return Draggable.dragGroupEnd(e,getDraggableEvent(t))},unset:function(e){return Draggable.unset(e)}}),IndividualGroupable={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},MOVEABLE_ABLES=[BeforeRenderable,Default,Snappable,Pinchable,Draggable,edgeDraggable,Resizable,Scalable,Warpable,Rotatable,Scrollable,Padding,Origin,OriginDraggable,Clippable,Roundable,Groupable,IndividualGroupable,Clickable,DragArea,Renderable];function solveConstantsDistance(e,t){var e=__read(e,3),r=e[0],i=e[1];return(r*t[0]+i*t[1]+e[2])/Math.sqrt(r*r+i*i)}function solveC(e,t){e=__read(e,2);return-e[0]*t[0]-e[1]*t[1]}function getMaxPos(e,r){return Math.max.apply(Math,__spreadArray([],__read(e.map(function(e){var e=__read(e,4),t=e[0];return Math.max(t[r],e[1][r],e[2][r],e[3][r])})),!1))}function getMinPos(e,r){return Math.min.apply(Math,__spreadArray([],__read(e.map(function(e){var e=__read(e,4),t=e[0];return Math.min(t[r],e[1][r],e[2][r],e[3][r])})),!1))}function getGroupRect(e,t){var r,i,n,a,s,o,l,u,c,h,d,p=[0,0],f=[0,0],m=[0,0],g=[0,0],v=0,y=0;return e.length?((r=throttle(t,TINY_NUM))%90?(c=r/180*Math.PI,i=Math.tan(c),n=-1/i,a=[MAX_NUM,MIN_NUM],s=[[0,0],[0,0]],o=[MAX_NUM,MIN_NUM],l=[[0,0],[0,0]],e.forEach(function(e){e.forEach(function(e){var t=solveConstantsDistance([-i,1,0],e),r=solveConstantsDistance([-n,1,0],e);t<a[0]&&(s[0]=e,a[0]=t),a[1]<t&&(s[1]=e,a[1]=t),r<o[0]&&(l[0]=e,o[0]=r),o[1]<r&&(l[1]=e,o[1]=r)})}),h=(c=__read(s,2))[0],c=c[1],u=(d=__read(l,2))[0],d=d[1],h=[-i,1,solveC([-i,1],h)],c=[-i,1,solveC([-i,1],c)],p=(d=__read([[h,u=[-n,1,solveC([-n,1],u)]],[h,h=[-n,1,solveC([-n,1],d)]],[c,u],[c,h]].map(function(e){e=__read(e,2);return getIntersectionPointsByConstants(e[0],e[1])[0]}),4))[0],f=d[1],m=d[2],g=d[3],v=o[1]-o[0],y=a[1]-a[0]):(p=[u=getMinPos(e,0),c=getMinPos(e,1)],f=[h=getMaxPos(e,0),c],m=[u,d=getMaxPos(e,1)],g=[h,d],v=h-u,y=d-c,r%180&&(p=(e=__read([m,p,g,f],4))[0],f=e[1],m=e[2],g=e[3],v=d-c,y=h-u)),180<r%360&&(p=(e=__read([g,m,f,p],4))[0],f=e[1],m=e[2],g=e[3]),{pos1:p,pos2:f,pos3:m,pos4:g,width:v,height:y,minX:(d=getMinMaxs([p,f,m,g])).minX,minY:d.minY,maxX:d.maxX,maxY:d.maxY,rotation:t}):{pos1:p,pos2:f,pos3:m,pos4:g,minX:0,minY:0,maxX:0,maxY:0,width:v,height:y,rotation:t}}function findMoveableGroups(i,e){e=e.map(function(t){var e,r;return isArray(t)?1<(r=(e=findMoveableGroups(i,t)).length)?e:1===r?e[0]:null:(r=find$1(i,function(e){return e.manager.props.target===t}))?(r.finded=!0,r.manager):null}).filter(Boolean);return 1===e.length&&isArray(e[0])?e[0]:e}var MoveableGroup=(i=>{function e(){var e=null!==i&&i.apply(this,arguments)||this;return e.differ=new ChildrenDiffer$1,e.moveables=[],e.transformOrigin="50% 50%",e.renderGroupRects=[],e._targetGroups=[],e._hasFirstTargets=!1,e}return __extends(e,i),e.prototype.componentDidMount=function(){i.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,e,r){void 0===r&&(r=!0);var i,o,l,u,c,n,a,s,h,d,p,f,m,g,v,y,_=this.state;this.controlBox&&!_.isPersisted&&(setStoreCache(!0),this.moveables.forEach(function(e){e.updateRect(t,!1,!1)}),y=this.props,m=this.moveables,i=_.target||y.target,d=findMoveableGroups(m=m.map(function(e){return{finded:!1,manager:e}}),f=this.props.targetGroups||[]),o=y.useDefaultGroupRotate,d.push.apply(d,__spreadArray([],__read(m.filter(function(e){return!e.finded}).map(function(e){return e.manager})),!1)),l=[],u=!e||""!==t&&y.updateGroup,c=y.defaultGroupRotate||0,this._hasFirstTargets||null!=(e=null==(m=y.persistData)?void 0:m.rotation)&&(c=e),m=function i(e,n,t){var e=e.map(function(e){var t,r;return isArray(e)?(r=[(t=i(e,n)).pos1,t.pos2,t.pos3,t.pos4],l.push(t),{poses:r,rotation:t.rotation}):{poses:getAbsolutePosesByState(e.state),rotation:e.getRotation()}}),r=e.map(function(e){return e.rotation}),a=0,s=r[0],r=r.every(function(e){return Math.abs(s-e)<.1}),a=u?!o&&r?s:c:o||t||!r?n:s;return getGroupRect(e.map(function(e){return e.poses}),a)}(d,this.rotation,!0),u&&(this.rotation=m.rotation,this.transformOrigin=y.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=f,this.renderGroupRects=l,e=this.transformOrigin,d=this.rotation,y=this.scale,f=m.width,n=m.minX,a=m.minY,s=(h=getMinMaxs(rotatePosesInfo([[0,0],[f,0],[0,m=m.height],[f,m]],convertTransformOriginArray(e,f,m),this.rotation/180*Math.PI).result)).minX,h=h.minY,d=" rotate(".concat(d,"deg)")+" scale(".concat(sign(y[0]),", ").concat(sign(y[1]),")"),p="translate(".concat(-s,"px, ").concat(-h,"px)").concat(d),this.controlBox.style.transform="translate3d(".concat(n,"px, ").concat(a,"px, ").concat(this.props.translateZ||0,")"),i.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(e,";")+"width:".concat(f,"px;height:").concat(m,"px;")+"transform: ".concat(p),_.width=f,_.height=m,e=this.getContainer(),f=[(p=getMoveableTargetInfo(this.controlBox,i,this.controlBox,this.getContainer(),this._rootContainer||e,[])).left,p.top],v=[(v=getMinMaxs([m=(_=__read(getAbsolutePosesByState(p),4))[0],e=_[1],g=_[2],_=_[3]])).minX,v.minY],y=sign(y[0]*y[1]),p.pos1=minus(m,v),p.pos2=minus(e,v),p.pos3=minus(g,v),p.pos4=minus(_,v),p.left=n-p.left+v[0],p.top=a-p.top+v[1],p.origin=minus(plus(f,p.origin),v),p.beforeOrigin=minus(plus(f,p.beforeOrigin),v),p.originalBeforeOrigin=plus(f,p.originalBeforeOrigin),p.transformOrigin=minus(plus(f,p.transformOrigin),v),i.style.transform="translate(".concat(-s-v[0],"px, ").concat(-h-v[1],"px)")+d,setStoreCache(),this.updateState(__assign(__assign({},p),{posDelta:v,direction:y,beforeDirection:y}),r))},e.prototype.getRect=function(){return __assign(__assign({},i.prototype.getRect.call(this)),{children:this.moveables.map(function(e){return e.getRect()})})},e.prototype.triggerEvent=function(e,t,r){if(r||-1<e.indexOf("Group"))return i.prototype.triggerEvent.call(this,e,t);this._emitter.trigger(e,t)},e.prototype.getRequestChildStyles=function(){return this.getEnabledAbles().reduce(function(e,t){var r,t=null!=(r=null==(r=t.requestChildStyle)?void 0:r.call(t))?r:[];return __spreadArray(__spreadArray([],__read(e),!1),__read(t),!1)},[])},e.prototype.getMoveables=function(){return __spreadArray([],__read(this.moveables),!1)},e.prototype.updateAbles=function(){i.prototype.updateAbles.call(this,__spreadArray(__spreadArray([],__read(this.props.ables),!1),[Groupable],!1),"Group")},e.prototype._updateTargets=function(){i.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=getRefTarget(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var e=this.state,t=this.props,r=this._prevDragTarget,i=t.dragTarget||this.areaElement,n=t.targets,a=this.differ.update(n),s=a.added,o=a.changed,s=s.length||a.removed.length,a=(!s&&this._prevOriginalDragTarget===this._originalDragTarget||(unsetGesto(this,!1),unsetGesto(this,!0),this.updateState({gestos:{}})),r!==i&&(e.target=null),e.target||(e.target=this.areaElement,this.controlBox.style.display="block"),e.target&&(this.targetGesto||(this.targetGesto=getTargetAbleGesto(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=getAbleGesto(this,this.controlBox,"controlAbles","GroupControl"))),!equals(e.container,t.container));a&&(e.container=t.container),(a||s||this.transformOrigin!==(t.defaultGroupOrigin||"50% 50%")||o.length||n.length&&!isDeepArrayEquals(this._targetGroups,t.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!s},e.prototype._updateObserver=function(){},e.defaultProps=__assign(__assign({},MoveableManager.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e})(MoveableManager),MoveableIndividualGroup=(t=>{function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moveables=[],e}return __extends(e,t),e.prototype.render=function(){var i=this,n=this.props,e=n.cspNonce,t=n.cssStyled,r=n.persistData,a=n.targets||[],s=a.length,o=this.isUnmounted||!s,l=null!=(r=null==r?void 0:r.children)?r:[];return o&&!s&&l.length?a=l.map(function(){return null}):o||(l=[]),reactExports.createElement(t,{cspNonce:e,ref:ref(this,"controlBox"),className:prefix("control-box")},a.map(function(e,t){var r=null!=(r=null==(r=n.individualGroupableProps)?void 0:r.call(n,e,t))?r:{};return reactExports.createElement(MoveableManager,__assign({key:"moveable"+t,ref:refs(i,"moveables",t)},n,r,{target:e,wrapperMoveable:i,isWrapperMounted:i.isMoveableMounted,persistData:l[t]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(t,r,i){void 0===i&&(i=!0),setStoreCache(!0),this.moveables.forEach(function(e){e.updateRect(t,r,i)}),setStoreCache()},e.prototype.getRect=function(){return __assign(__assign({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(e){return e.getRect()})})},e.prototype.request=function(t,r,e){void 0===r&&(r={});var i=this.moveables.map(function(e){return e.request(t,__assign(__assign({},r),{isInstant:!1}),!1)}),n={request:function(t){return i.forEach(function(e){return e.request(t)}),this},requestEnd:function(){return i.forEach(function(e){return e.requestEnd()}),this}};return e||r.isInstant?n.request(r).requestEnd():n},e.prototype.dragStart=function(e){var i=e.target,t=find$1(this.moveables,function(e){var t=e.getTargets()[0],r=e.getControlBoxElement(),e=e.getDragElement();return!(!t||!e)&&(e===i||e.contains(i)||e!==t&&t===i||t.contains(i)||r===i||r.contains(i))});return t&&t.dragStart(e),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return __spreadArray([],__read(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e})(MoveableManager);function getElementTargets(e,t){var r=[];return e.forEach(function(e){e&&(isString(e)?t[e]&&r.push.apply(r,__spreadArray([],__read(t[e]),!1)):isArray(e)?r.push.apply(r,__spreadArray([],__read(getElementTargets(e,t)),!1)):r.push(e))}),r}function getTargetGroups(e,t){var r=[];return e.forEach(function(e){e&&(isString(e)?t[e]&&r.push.apply(r,__spreadArray([],__read(t[e]),!1)):isArray(e)?r.push(getTargetGroups(e,t)):r.push(e))}),r}function compareRefTargets(e,r){return e.length!==r.length||e.some(function(e,t){t=r[t];return!(!e&&!t)&&e!=t&&(!isArray(e)||!isArray(t)||compareRefTargets(e,t))})}var InitialMoveable=(t=>{function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e._differ=new ChildrenDiffer$1,e._elementTargets=[],e._tmpRefTargets=[],e._tmpSelectorMap={},e._onChangeTargets=null,e}return __extends(e,t),e.makeStyled=function(){var t={},e=(this.getTotalAbles().forEach(function(e){e=e.css;e&&e.forEach(function(e){t[e]=!0})}),getKeys(t).join("\n"));this.defaultStyled=styled("div",prefixCSS(PREFIX,MOVEABLE_CSS+e))},e.getTotalAbles=function(){return __spreadArray([Default,Groupable,IndividualGroupable,DragArea],__read(this.defaultAbles),!1)},e.prototype.render=function(){var t,e=this.constructor,r=(e.defaultStyled||e.makeStyled(),this.props),i=r.ables,n=r.props,r=__rest(r,["ables","props"]),a=__read(this._updateRefs(!0),2),s=a[0],a=a[1],o=getElementTargets(s,a),l=1<o.length,i=__spreadArray(__spreadArray([],__read(e.getTotalAbles()),!1),__read(i||[]),!1),n=__assign(__assign(__assign({},r),n||{}),{ables:i,cssStyled:e.defaultStyled,customStyledMap:e.customStyledMap}),i=(this._elementTargets=o,null),e=this.moveable,u=r.persistData;return null!=u&&u.children&&(l=!0),r.individualGroupable?reactExports.createElement(MoveableIndividualGroup,__assign({key:"individual-group",ref:ref(this,"moveable")},n,{target:null,targets:o})):l?(u=getTargetGroups(s,a),!e||e.props.groupable||e.props.individualGroupable||(l=e.props.target)&&-1<o.indexOf(l)&&(i=__assign({},e.state)),reactExports.createElement(MoveableGroup,__assign({key:"group",ref:ref(this,"moveable")},n,null!=(s=r.groupableProps)?s:{},{target:null,targets:o,targetGroups:u,firstRenderState:i}))):(t=o[0],e&&(e.props.groupable||e.props.individualGroupable)&&(a=find$1(e.moveables||[],function(e){return e.props.target===t}))&&(i=__assign({},a.state)),reactExports.createElement(MoveableManager,__assign({key:"single",ref:ref(this,"moveable")},n,{target:t,firstRenderState:i})))},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var e;return null!=(e=null==(e=this.moveable)?void 0:e.getTargets())?e:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs()},e.prototype.waitToChangeTarget=function(){var t,e=this;return this._onChangeTargets=function(){e._onChangeTargets=null,t()},new Promise(function(e){t=e})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(e){var t=this.refTargets,r=getRefTargets(this.props.target||this.props.targets),i="undefined"!=typeof document,n=compareRefTargets(t,r),a=this.selectorMap,s={};return this.refTargets.forEach(function e(t){isString(t)?a[t]?s[t]=a[t]:i&&(n=!0,s[t]=[].slice.call(document.querySelectorAll(t))):isArray(t)&&t.forEach(e)}),[this._tmpRefTargets=r,this._tmpSelectorMap=s,!e&&n]},e.prototype._checkChangeTargets=function(){this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var e=this._differ.update(this._elementTargets),e=((e.added.length||e.removed.length)&&(null!=(t=(e=this.props).onChangeTargets)&&t.call(e,{moveable:this.moveable,targets:this._elementTargets}),null!=(t=this._onChangeTargets))&&t.call(this),__read(this._updateRefs(),3)),t=e[0],r=e[1],e=e[2];this.refTargets=t,this.selectorMap=r,e&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,__decorate([withMethods(MOVEABLE_METHODS)],e.prototype,"moveable",void 0),e})(reactExports.PureComponent),Moveable=(e=>{function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.defaultAbles=MOVEABLE_ABLES,t})(InitialMoveable);function getSizeFromTarget(e){return{top:Number(e.style.top.replace("px","")),left:Number(e.style.left.replace("px","")),width:Number(e.style.width.replace("px","")),height:Number(e.style.height.replace("px",""))}}function parseTransform(e){for(var t=/(\w+)\(([^\)]+)\)/g,r={translatex:0,translatey:0,scalex:1,scaley:1,rotate:0};i=t.exec(e);){var[,i,n]=i,n=n.split(/\s*,\s*/).map(parseFloat);"translate"===i?(r.translatex=n[0]||0,r.translatey=n[1]||0):"scale"===i?(r.scalex=n[0],r.scaley=n[1]||n[0]):"rotate"===i&&(r.rotate=n[0]||0)}return r}var reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={},hasRequiredScheduler_production_min,hasRequiredScheduler,hasRequiredReactDom_production_min;function requireScheduler_production_min(){var o,e,t,r,l,u,a,c,h,d,p,f,i,m,n,s,g,v,y,_,b,x,S;return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,o=scheduler_production_min,"object"==typeof performance&&"function"==typeof performance.now?(e=performance,o.unstable_now=function(){return e.now()}):(t=Date,r=t.now(),o.unstable_now=function(){return t.now()-r}),l=[],u=[],a=1,c=null,f=p=d=!(h=3),i="function"==typeof setTimeout?setTimeout:null,m="function"==typeof clearTimeout?clearTimeout:null,n="undefined"!=typeof setImmediate?setImmediate:null,"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling),y=!1,_=null,x=5,S=b=-1,s="function"==typeof n?function(){n(D)}:"undefined"!=typeof MessageChannel?(g=new MessageChannel,v=g.port2,g.port1.onmessage=D,function(){v.postMessage(null)}):function(){i(D,0)},o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(e){e.callback=null},o.unstable_continueExecution=function(){p||d||(p=!0,R(M))},o.unstable_forceFrameRate=function(e){e<0||125<e||(x=0<e?Math.floor(1e3/e):5)},o.unstable_getCurrentPriorityLevel=function(){return h},o.unstable_getFirstCallbackNode=function(){return E(l)},o.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var r=h;h=t;try{return e()}finally{h=r}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=h;h=e;try{return t()}finally{h=r}},o.unstable_scheduleCallback=function(e,t,r){var i=o.unstable_now();switch(r="object"==typeof r&&null!==r&&"number"==typeof(r=r.delay)&&0<r?i+r:i,e){case 1:var n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}return e={id:a++,callback:t,priorityLevel:e,startTime:r,expirationTime:n=r+n,sortIndex:-1},i<r?(e.sortIndex=r,T(u,e),null===E(l)&&e===E(u)&&(f?(m(b),b=-1):f=!0,k(P,r-i))):(e.sortIndex=n,T(l,e),p||d||(p=!0,R(M))),e},o.unstable_shouldYield=I,o.unstable_wrapCallback=function(t){var r=h;return function(){var e=h;h=r;try{return t.apply(this,arguments)}finally{h=e}}}),scheduler_production_min;function T(e,t){var r=e.length;for(e.push(t);0<r;){var i=r-1>>>1,n=e[i];if(!(0<A(n,t)))break;e[i]=t,e[r]=n,r=i}}function E(e){return 0===e.length?null:e[0]}function C(e){if(0!==e.length){var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var i=0,n=e.length,a=n>>>1;i<a;){var s=2*(i+1)-1,o=e[s],l=1+s,u=e[l];if(A(o,r)<0)i=l<n&&A(u,o)<0?(e[i]=u,e[l]=r,l):(e[i]=o,e[s]=r,s);else{if(!(l<n&&A(u,r)<0))break;e[i]=u,e[l]=r,i=l}}}}}function A(e,t){var r=e.sortIndex-t.sortIndex;return 0!=r?r:e.id-t.id}function w(e){for(var t=E(u);null!==t;){if(null===t.callback)C(u);else{if(!(t.startTime<=e))break;C(u),t.sortIndex=t.expirationTime,T(l,t)}t=E(u)}}function P(e){var t;f=!1,w(e),p||(null!==E(l)?(p=!0,R(M)):null!==(t=E(u))&&k(P,t.startTime-e))}function M(e,t){p=!1,f&&(f=!1,m(b),b=-1),d=!0;var r=h;try{for(w(t),c=E(l);null!==c&&(!(c.expirationTime>t)||e&&!I());){var i,n=c.callback;"function"==typeof n?(c.callback=null,h=c.priorityLevel,i=n(c.expirationTime<=t),t=o.unstable_now(),"function"==typeof i?c.callback=i:c===E(l)&&C(l),w(t)):C(l),c=E(l)}var a,s=null!==c||(null!==(a=E(u))&&k(P,a.startTime-t),!1);return s}finally{c=null,h=r,d=!1}}function I(){return!(o.unstable_now()-S<x)}function D(){if(null!==_){var e=o.unstable_now(),t=(S=e,!0);try{t=_(!0,e)}finally{t?s():(y=!1,_=null)}}else y=!1}function R(e){_=e,y||(y=!0,s())}function k(e,t){b=i(function(){e(o.unstable_now())},t)}}function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}function requireReactDom_production_min(){if(!hasRequiredReactDom_production_min){hasRequiredReactDom_production_min=1;var a,l,$,B=reactExports,G=requireScheduler(),z=new Set,U={},j=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),V=Object.prototype.hasOwnProperty,H=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,W={},Y={},s={},X=("children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){s[e]=new i(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];s[t]=new i(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){s[e]=new i(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){s[e]=new i(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){s[e]=new i(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){s[e]=new i(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){s[e]=new i(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){s[e]=new i(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){s[e]=new i(e,5,!1,e.toLowerCase(),null,!1,!1)}),/[\-:]([a-z])/g),B=("accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(X,qi);s[t]=new i(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(X,qi);s[t]=new i(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(X,qi);s[t]=new i(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){s[e]=new i(e,1,!1,e.toLowerCase(),null,!1,!1)}),s.xlinkHref=new i("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){s[e]=new i(e,1,!1,e.toLowerCase(),null,!0,!0)}),B.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED),q=Symbol.for("react.element"),K=Symbol.for("react.portal"),Q=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),ee=Symbol.for("react.provider"),te=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),se=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),le=Symbol.iterator,g=Object.assign,ue=!1,ce=Array.isArray,he=($=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((l=l||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=l.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return $(e,t)})}:$),de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"],fe=(Object.keys(de).forEach(function(t){pe.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),de[e]=de[t]})}),g({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0})),me=null,ge=null,ve=null,ye=null,_e=!1,be=!1;if(j)try{var e={};Object.defineProperty(e,"passive",{get:function(){be=!0}}),window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){be=!1}for(var xe,Se,Te,Ee,Ce,Ae,we,Pe,Me=!1,Ie=null,De=!1,Re=null,ke={onError:function(e){Me=!0,Ie=e}},Oe=G.unstable_scheduleCallback,Fe=G.unstable_cancelCallback,$e=G.unstable_shouldYield,Be=G.unstable_requestPaint,m=G.unstable_now,Le=G.unstable_getCurrentPriorityLevel,Ne=G.unstable_ImmediatePriority,Ge=G.unstable_UserBlockingPriority,ze=G.unstable_NormalPriority,Ue=G.unstable_LowPriority,je=G.unstable_IdlePriority,Ve=null,He=null,We=Math.clz32||function(e){return 0==(e>>>=0)?32:31-(Ye(e)/Xe|0)|0},Ye=Math.log,Xe=Math.LN2,qe=64,Ke=4194304,x=0,Qe=!1,Ze=[],Je=null,et=null,tt=null,rt=new Map,it=new Map,nt=[],at="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" "),st=B.ReactCurrentBatchConfig,ot=!0,lt=null,ut=null,ct=null,ht=null,e={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dt=ca(e),t=g({},e,{view:0,detail:0}),pt=ca(t),r=g({},t,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:da,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pe&&(we=Pe&&"mousemove"===e.type?(Ae=e.screenX-Pe.screenX,e.screenY-Pe.screenY):Ae=0,Pe=e),Ae)},movementY:function(e){return"movementY"in e?e.movementY:we}}),ft=ca(r),mt=ca(g({},r,{dataTransfer:0})),gt=ca(g({},t,{relatedTarget:0})),vt=ca(g({},e,{animationName:0,elapsedTime:0,pseudoElement:0})),yt=ca(g({},e,{clipboardData:function(e){return("clipboardData"in e?e:window).clipboardData}})),_t=ca(g({},e,{data:0})),bt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},St={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},Tt=ca(g({},t,{key:function(e){if(e.key){var t=bt[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=oa(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xt[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:da,charCode:function(e){return"keypress"===e.type?oa(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?oa(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Et=ca(g({},r,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ct=ca(g({},t,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:da})),At=ca(g({},e,{propertyName:0,elapsedTime:0,pseudoElement:0})),wt=ca(g({},r,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Pt=[9,13,27,32],Mt=(j&&"CompositionEvent"in window),t=null,It=(j&&"documentMode"in document&&(t=document.documentMode),j&&"TextEvent"in window&&!t),Dt=j&&(!Mt||t&&8<t&&t<=11),Rt=String.fromCharCode(32),kt=!1,Ot=!1,Ft={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},$t=null,Bt=null,Lt=!1,Nt=(j&&(t=j&&((e="oninput"in document)||((r=document.createElement("div")).setAttribute("oninput","return;"),e="function"==typeof r.oninput),e),Lt=t&&(!document.documentMode||9<document.documentMode)),"function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}),Gt=(j&&"documentMode"in document&&document.documentMode<=11),zt=null,Ut=null,jt=null,Vt=!1,Ht={animationend:ka("Animation","AnimationEnd"),animationiteration:ka("Animation","AnimationIteration"),animationstart:ka("Animation","AnimationStart"),transitionend:ka("Transition","TransitionEnd")},Wt={},Yt={},Xt=(j&&(Yt=document.createElement("div").style,"AnimationEvent"in window||(delete Ht.animationend.animation,delete Ht.animationiteration.animation,delete Ht.animationstart.animation),"TransitionEvent"in window||delete Ht.transitionend.transition),Oa("animationend")),qt=Oa("animationiteration"),Kt=Oa("animationstart"),Qt=Oa("transitionend"),Zt=new Map,Jt="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" "),er=0;er<Jt.length;er++){var tr=Jt[er];Fa(tr.toLowerCase(),"on"+(tr[0].toUpperCase()+tr.slice(1)))}Fa(Xt,"onAnimationEnd"),Fa(qt,"onAnimationIteration"),Fa(Kt,"onAnimationStart"),Fa("dblclick","onDoubleClick"),Fa("focusin","onFocus"),Fa("focusout","onBlur"),Fa(Qt,"onTransitionEnd"),Yi("onMouseEnter",["mouseout","mouseover"]),Yi("onMouseLeave",["mouseout","mouseover"]),Yi("onPointerEnter",["pointerout","pointerover"]),Yi("onPointerLeave",["pointerout","pointerover"]),Wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ir=new Set("cancel close invalid load scroll toggle".split(" ").concat(rr)),nr="_reactListening"+Math.random().toString(36).slice(2),ar=/\r\n?/g,sr=/\u0000|\uFFFD/g,or=null,lr=null,ur="function"==typeof setTimeout?setTimeout:void 0,cr="function"==typeof clearTimeout?clearTimeout:void 0,hr="function"==typeof Promise?Promise:void 0,dr="function"==typeof queueMicrotask?queueMicrotask:void 0!==hr?function(e){return hr.resolve(null).then(e).catch(Ka)}:ur,r=Math.random().toString(36).slice(2),pr="__reactFiber$"+r,fr="__reactProps$"+r,mr="__reactContainer$"+r,gr="__reactEvents$"+r,vr="__reactListeners$"+r,yr="__reactHandles$"+r,_r=[],br=-1,xr={},v=ns(xr),y=ns(!1),Sr=xr,Tr=null,Er=!1,Cr=!1,Ar=[],wr=0,Pr=null,Mr=0,Ir=[],Dr=0,Rr=null,kr=1,Or="",Fr=null,_=null,L=!1,$r=null,Br=B.ReactCurrentBatchConfig,Lr=Ms(!0),Nr=Ms(!1),Gr=ns(null),zr=null,Ur=null,jr=null,Vr=null,Hr=!1,Wr={},Yr=ns(Wr),Xr=ns(Wr),qr=ns(Wr),b=ns(0),Kr=[],Qr=B.ReactCurrentDispatcher,Zr=B.ReactCurrentBatchConfig,Jr=0,S=null,T=null,E=null,ei=!1,ti=!1,ri=0,ii=0,ni={readContext:Os,useCallback:n,useContext:n,useEffect:n,useImperativeHandle:n,useInsertionEffect:n,useLayoutEffect:n,useMemo:n,useReducer:n,useRef:n,useState:n,useDebugValue:n,useDeferredValue:n,useTransition:n,useMutableSource:n,useSyncExternalStore:n,useId:n,unstable_isNewReconciler:!1},ai={readContext:Os,useCallback:function(e,t){return ro().memoizedState=[e,void 0===t?null:t],e},useContext:Os,useEffect:bo,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,yo(4194308,4,Eo.bind(null,t,e),r)},useLayoutEffect:function(e,t){return yo(4194308,4,e,t)},useInsertionEffect:function(e,t){return yo(4,2,e,t)},useMemo:function(e,t){var r=ro();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=ro();return t=void 0!==r?r(t):t,i.memoizedState=i.baseState=t,e=(i.queue=e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=function(e,t,r){var i=Il(e);r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},Do(e)?Ro(t,r):null!==(r=$s(e,t,r,i))&&(Dl(r,e,i,f()),ko(r,t,i))}.bind(null,S,e),[i.memoizedState,e]},useRef:function(e){return ro().memoizedState=e={current:e}},useState:mo,useDebugValue:Ao,useDeferredValue:function(e){return ro().memoizedState=e},useTransition:function(){var e=(t=mo(!1))[0],t=function(e,t){var r=x,i=(x=0!==r&&r<4?r:4,e(!0),Zr.transition);Zr.transition={};try{e(!1),t()}finally{x=r,Zr.transition=i}}.bind(null,t[1]);return[e,ro().memoizedState=t]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=S,n=ro();if(L){if(void 0===r)throw Error(N(407));r=r()}else{if(r=t(),null===p)throw Error(N(349));0==(30&Jr)&&uo(i,t,r)}var a={value:n.memoizedState=r,getSnapshot:t};return bo(ho.bind(null,i,n.queue=a,e),[e]),i.flags|=2048,go(9,co.bind(null,i,a,r,t),void 0,null),r},useId:function(){var e,t=ro(),r=p.identifierPrefix;return L?(e=Or,r=":"+r+"R"+(e=(kr&~(1<<32-We(kr)-1)).toString(32)+e),0<(e=ri++)&&(r+="H"+e.toString(32)),r+=":"):r=":"+r+"r"+(e=ii++).toString(32)+":",t.memoizedState=r},unstable_isNewReconciler:!1},si={readContext:Os,useCallback:wo,useContext:Os,useEffect:xo,useImperativeHandle:Co,useInsertionEffect:So,useLayoutEffect:To,useMemo:Po,useReducer:ao,useRef:vo,useState:function(){return ao(no)},useDebugValue:Ao,useDeferredValue:function(e){return Mo(io(),T.memoizedState,e)},useTransition:function(){return[ao(no)[0],io().memoizedState]},useMutableSource:oo,useSyncExternalStore:lo,useId:Io,unstable_isNewReconciler:!1},oi={readContext:Os,useCallback:wo,useContext:Os,useEffect:xo,useImperativeHandle:Co,useInsertionEffect:So,useLayoutEffect:To,useMemo:Po,useReducer:so,useRef:vo,useState:function(){return so(no)},useDebugValue:Ao,useDeferredValue:function(e){var t=io();return null===T?t.memoizedState=e:Mo(t,T.memoizedState,e)},useTransition:function(){return[so(no)[0],io().memoizedState]},useMutableSource:oo,useSyncExternalStore:lo,useId:Io,unstable_isNewReconciler:!1},li={isMounted:function(e){return!!(e=e._reactInternals)&&On(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=f(),n=Il(e),a=Gs(i,n);a.payload=t,null!=r&&(a.callback=r),null!==(t=zs(e,a,n))&&(Dl(t,e,n,i),Us(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=f(),n=Il(e),a=Gs(i,n);a.tag=1,a.payload=t,null!=r&&(a.callback=r),null!==(t=zs(e,a,n))&&(Dl(t,e,n,i),Us(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=f(),i=Il(e),n=Gs(r,i);n.tag=2,null!=t&&(n.callback=t),null!==(t=zs(e,n,i))&&(Dl(t,e,i,r),Us(t,e,i))}},ui="function"==typeof WeakMap?WeakMap:Map,ci=B.ReactCurrentOwner,C=!1,hi={dehydrated:null,treeContext:null,retryLane:0},di=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r=(r.child.return=r).child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},pi=function(){},fi=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,Ws(Yr.current);var a,s=null;switch(r){case"input":n=on(e,n),i=on(e,i),s=[];break;case"select":n=g({},n,{value:void 0}),i=g({},i,{value:void 0}),s=[];break;case"textarea":n=fn(e,n),i=fn(e,i),s=[];break;default:"function"!=typeof n.onClick&&"function"==typeof i.onClick&&(e.onclick=Xa)}for(u in Tn(r,i),r=null,n)if(!i.hasOwnProperty(u)&&n.hasOwnProperty(u)&&null!=n[u])if("style"===u){var o=n[u];for(a in o)o.hasOwnProperty(a)&&(r=r||{},r[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(U.hasOwnProperty(u)?s=s||[]:(s=s||[]).push(u,null));for(u in i){var l=i[u],o=null!=n?n[u]:void 0;if(i.hasOwnProperty(u)&&l!==o&&(null!=l||null!=o))if("style"===u)if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r=r||{},r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r=r||{},r[a]=l[a])}else r||(s=s||[]).push(u,r),r=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,o=o?o.__html:void 0,null!=l&&o!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(U.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&c("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},mi=function(e,t,r,i){r!==i&&(t.flags|=4)},gi=!1,A=!1,vi="function"==typeof WeakSet?WeakSet:Set,w=null,yi=!1,u=null,_i=!1,bi=Math.ceil,xi=B.ReactCurrentDispatcher,Si=B.ReactCurrentOwner,Ti=B.ReactCurrentBatchConfig,P=0,p=null,M=null,I=0,Ei=0,Ci=ns(0),D=0,Ai=null,wi=0,Pi=0,Mi=0,Ii=null,o=null,Di=0,Ri=1/0,ki=null,Oi=!1,Fi=null,$i=null,Bi=!1,Li=null,Ni=0,Gi=0,zi=null,Ui=-1,ji=0,Vi=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||y.current)C=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags)){C=!1;{var i=e;var n=t;var a=r;switch(n.tag){case 3:tl(n),Es();break;case 5:qs(n);break;case 1:k(n.type)&&us(n);break;case 4:Ys(n,n.stateNode.containerInfo);break;case 10:var s=n.type._context,o=n.memoizedProps.value;R(Gr,s._currentValue),s._currentValue=o;break;case 13:if(null!==(s=n.memoizedState))return null!==s.dehydrated?(R(b,1&b.current),n.flags|=128,null):0!=(a&n.child.childLanes)?nl(i,n,a):(R(b,1&b.current),null!==(i=hl(i,n,a))?i.sibling:null);R(b,1&b.current);break;case 19:if(s=0!=(a&n.childLanes),0!=(128&i.flags)){if(s)return ul(i,n,a);n.flags|=128}if(null!==(o=n.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),R(b,b.current),s)break;return null;case 22:case 23:return n.lanes=0,Ko(i,n,a)}return hl(i,n,a);return}}C=0!=(131072&e.flags)}else C=!1,L&&0!=(1048576&t.flags)&&fs(t,Mr,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type,u=(cl(e,t),e=t.pendingProps,as(t,v.current)),c=(ks(t,r),u=eo(null,t,l,e,u,r),to());return t.flags|=1,t="object"==typeof u&&null!==u&&"function"==typeof u.render&&void 0===u.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,k(l)?(c=!0,us(t)):c=!1,t.memoizedState=null!=u.state?u.state:null,Ls(t),u.updater=li,No((t.stateNode=u)._reactInternals=t,l,e,r),el(null,t,l,!0,c,r)):(t.tag=0,L&&c&&ms(t),O(null,t,u,r),t.child);case 16:l=t.elementType;e:{switch(cl(e,t),e=t.pendingProps,l=(u=l._init)(l._payload),t.type=l,u=t.tag=(e=>{if("function"==typeof e)return tu(e)?1:0;if(null!=e){if((e=e.$$typeof)===re)return 11;if(e===ae)return 14}return 2})(l),e=Oo(l,e),u){case 0:t=Zo(null,t,l,e,r);break e;case 1:t=Jo(null,t,l,e,r);break e;case 11:t=Yo(null,t,l,e,r);break e;case 14:t=Xo(null,t,l,Oo(l.type,e),r);break e}throw Error(N(306,l,""))}return t;case 0:return l=t.type,u=t.pendingProps,Zo(e,t,l,u=t.elementType===l?u:Oo(l,u),r);case 1:return l=t.type,u=t.pendingProps,Jo(e,t,l,u=t.elementType===l?u:Oo(l,u),r);case 3:e:{if(tl(t),null===e)throw Error(N(387));l=t.pendingProps,u=(c=t.memoizedState).element,Ns(e,t),Vs(t,l,null,r);var h=t.memoizedState,l=h.element;if(c.isDehydrated){if(c={element:l,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=c,t.memoizedState=c,256&t.flags){t=rl(e,t,l,r,u=Go(Error(N(423)),t));break e}if(l!==u){t=rl(e,t,l,r,u=Go(Error(N(424)),t));break e}for(_=Za(t.stateNode.containerInfo.firstChild),L=!0,r=Nr(Fr=t,$r=null,l,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(Es(),l===u){t=hl(e,t,r);break e}O(e,t,l,r)}t=t.child}return t;case 5:return qs(t),null===e&&bs(t),l=t.type,u=t.pendingProps,c=null!==e?e.memoizedProps:null,h=u.children,qa(l,u)?h=null:null!==c&&qa(l,c)&&(t.flags|=32),Qo(e,t),O(e,t,h,r),t.child;case 6:return null===e&&bs(t),null;case 13:return nl(e,t,r);case 4:return Ys(t,t.stateNode.containerInfo),l=t.pendingProps,null===e?t.child=Lr(t,null,l,r):O(e,t,l,r),t.child;case 11:return l=t.type,u=t.pendingProps,Yo(e,t,l,u=t.elementType===l?u:Oo(l,u),r);case 7:return O(e,t,t.pendingProps,r),t.child;case 8:case 12:return O(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(l=t.type._context,u=t.pendingProps,c=t.memoizedProps,h=u.value,R(Gr,l._currentValue),l._currentValue=h,null!==c)if(Nt(c.value,h)){if(c.children===u.children&&!y.current){t=hl(e,t,r);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var d=c.dependencies;if(null!==d)for(var p,f,h=c.child,m=d.firstContext;null!==m;){if(m.context===l){1===c.tag&&((m=Gs(-1,r&-r)).tag=2,null!==(p=c.updateQueue))&&(null===(f=(p=p.shared).pending)?m.next=m:(m.next=f.next,f.next=m),p.pending=m),c.lanes|=r,null!==(m=c.alternate)&&(m.lanes|=r),Rs(c.return,r,t),d.lanes|=r;break}m=m.next}else if(10===c.tag)h=c.type===t.type?null:c.child;else if(18===c.tag){if(null===(h=c.return))throw Error(N(341));h.lanes|=r,null!==(d=h.alternate)&&(d.lanes|=r),Rs(h,r,t),h=c.sibling}else h=c.child;if(null!==h)h.return=c;else for(h=c;null!==h;){if(h===t){h=null;break}if(null!==(c=h.sibling)){c.return=h.return,h=c;break}h=h.return}c=h}O(e,t,u.children,r),t=t.child}return t;case 9:return u=t.type,l=t.pendingProps.children,ks(t,r),l=l(u=Os(u)),t.flags|=1,O(e,t,l,r),t.child;case 14:return u=Oo(l=t.type,t.pendingProps),Xo(e,t,l,u=Oo(l.type,u),r);case 15:return qo(e,t,t.type,t.pendingProps,r);case 17:return l=t.type,u=t.pendingProps,u=t.elementType===l?u:Oo(l,u),cl(e,t),t.tag=1,k(l)?(e=!0,us(t)):e=!1,ks(t,r),Bo(t,l,u),No(t,l,u,r),el(null,t,l,!0,e,r);case 19:return ul(e,t,r);case 22:return Ko(e,t,r)}throw Error(N(156,t.tag))},Hi="function"==typeof reportError?reportError:function(e){},e=(vu.prototype.render=gu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(N(409));du(e,t,null,null)},vu.prototype.unmount=gu.prototype.unmount=function(){var e,t=this._internalRoot;null!==t&&(this._internalRoot=null,e=t.containerInfo,Nl(function(){du(null,t,null,null)}),e[mr]=null)},vu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ee();e={blockedOn:null,target:e,priority:t};for(var r=0;r<nt.length&&0!==t&&t<nt[r].priority;r++);nt.splice(r,0,e),0===r&&qn(e)}},xe=function(r){switch(r.tag){case 3:var e,t=r.stateNode;t.current.memoizedState.isDehydrated&&0!==(e=Ln(t.pendingLanes))&&(Hn(t,1|e),Rl(t,m()),0==(6&P))&&(Ri=m()+500,ds());break;case 13:Nl(function(){var e,t=Bs(r,1);null!==t&&(e=f(),Dl(t,r,1,e))}),mu(r,1)}},Se=function(e){var t;13===e.tag&&(null!==(t=Bs(e,134217728))&&Dl(t,e,134217728,f()),mu(e,134217728))},Te=function(e){var t,r;13===e.tag&&(null!==(r=Bs(e,t=Il(e)))&&Dl(r,e,t,f()),mu(e,t))},Ee=function(){return x},Ce=function(e,t){var r=x;try{return x=e,t()}finally{x=r}},In=Nl,{usingClientEntryPoint:!(ge=function(e,t,r){switch(t){case"input":if(cn(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=is(i);if(!n)throw Error(N(90));an(i),cn(i,n)}}}break;case"textarea":gn(e,r);break;case"select":null!=(t=r.value)&&pn(e,!!r.multiple,t,!1)}}),Events:[ts,rs,is,wn,Pn,Mn=Ll]}),t={findFiberByHostInstance:es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},j={bundleType:t.bundleType,version:t.version,rendererPackageName:t.rendererPackageName,rendererConfig:t.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:B.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Bn(e))?null:e.stateNode},findFiberByHostInstance:t.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){r=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!r.isDisabled&&r.supportsFiber)try{Ve=r.inject(j),He=r}catch(e){}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e,reactDom_production_min.createPortal=function(e,t){if(yu(t))return function(e,t,r,i){return{$$typeof:K,key:null==(i=3<arguments.length&&void 0!==i?i:null)?null:""+i,children:e,containerInfo:t,implementation:r}}(e,t,null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);throw Error(N(200))},reactDom_production_min.createRoot=function(e,t){var r,i,n;if(yu(e))return r=!1,i="",n=Hi,null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError)&&(n=t.onRecoverableError),t=uu(e,1,!1,null,0,r,0,i,n),e[mr]=t.current,Na(8===e.nodeType?e.parentNode:e),new gu(t);throw Error(N(299))},reactDom_production_min.findDOMNode=function(e){if(null==e)return null;if(1!==e.nodeType){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(N(188));throw e=Object.keys(e).join(","),Error(N(268,e))}e=null===(e=Bn(t))?null:e.stateNode}return e},reactDom_production_min.flushSync=Nl,reactDom_production_min.hydrate=function(e,t,r){if(_u(t))return xu(null,e,t,!0,r);throw Error(N(200))},reactDom_production_min.hydrateRoot=function(e,t,r){if(!yu(e))throw Error(N(405));var i=null!=r&&r.hydratedSources||null,n=!1,a="",s=Hi;if(null!=r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onRecoverableError)&&(s=r.onRecoverableError),t=hu(t,null,e,1,null!=r?r:null,n,0,a,s),e[mr]=t.current,Na(e),i)for(e=0;e<i.length;e++)n=(n=(r=i[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new vu(t)},reactDom_production_min.render=function(e,t,r){if(_u(t))return xu(null,e,t,!1,r);throw Error(N(200))},reactDom_production_min.unmountComponentAtNode=function(e){if(_u(e))return!!e._reactRootContainer&&(Nl(function(){xu(null,null,e,!1,function(){e._reactRootContainer=null,e[mr]=null})}),!0);throw Error(N(40))},reactDom_production_min.unstable_batchedUpdates=Ll,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!_u(r))throw Error(N(200));if(null==e||void 0===e._reactInternals)throw Error(N(38));return xu(e,t,r,!1,i)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426"}return reactDom_production_min;function N(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Wi(e,t){Yi(e,t),Yi(e+"Capture",t)}function Yi(e,t){for(U[e]=t,e=0;e<t.length;e++)z.add(t[e])}function Xi(e,t,r,i){if(null==t||((e,t,r,i)=>{if(null===r||0!==r.type)switch(typeof t){case"function":case"symbol":return 1;case"boolean":return i?void 0:null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e;default:return}})(e,t,r,i))return 1;if(!i&&null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||t<1}}function i(e,t,r,i,n,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}function qi(e){return e[1].toUpperCase()}function Ki(e,t,r,i){var n,a=s.hasOwnProperty(t)?s[t]:null;(null!==a?0!==a.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(Xi(t,r,a,i)&&(r=null),i||null===a?(n=t,(V.call(Y,n)||!V.call(W,n)&&(H.test(n)?Y[n]=!0:void(W[n]=!0)))&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r))):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,i=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}function Qi(e){return null!==e&&"object"==typeof e&&"function"==typeof(e=le&&e[le]||e["@@iterator"])?e:null}function Zi(e){if(void 0===a)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);a=t&&t[1]||""}return"\n"+a+e}function Ji(t,e){if(!t||ue)return"";ue=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(e){var i=e}Reflect.construct(t,[],e)}else{try{e.call()}catch(e){i=e}t.call(e.prototype)}else{try{throw Error()}catch(e){i=e}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var n,a=e.stack.split("\n"),s=i.stack.split("\n"),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(1!==o||1!==l)do{if(o--,--l<0||a[o]!==s[l])return n="\n"+a[o].replace(" at new "," at "),n=t.displayName&&n.includes("<anonymous>")?n.replace("<anonymous>",t.displayName):n}while(1<=o&&0<=l);break}}}finally{ue=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Zi(t):""}function en(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return function e(t){if(null!=t){if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case Q:return"Fragment";case K:return"Portal";case J:return"Profiler";case Z:return"StrictMode";case ie:return"Suspense";case ne:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case te:return(t.displayName||"Context")+".Consumer";case ee:return(t._context.displayName||"Context")+".Provider";case re:var r=t.render;return t=(t=t.displayName)||(""!==(t=r.displayName||r.name||"")?"ForwardRef("+t+")":"ForwardRef");case ae:return null!==(r=t.displayName||null)?r:e(t.type)||"Memo";case se:r=t._payload,t=t._init;try{return e(t(r))}catch(e){}}}return null}(t);case 8:return t===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function tn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function rn(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function nn(e){e._valueTracker||(e._valueTracker=(e=>{var t,r,i=rn(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),a=""+e[i];if(!e.hasOwnProperty(i)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set)return t=n.get,r=n.set,Object.defineProperty(e,i,{configurable:!0,get:function(){return t.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,i,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[i]}}})(e))}function an(e){var t,r,i;if(e)return(t=e._valueTracker)?(r=t.getValue(),i="",(e=i=e?rn(e)?e.checked?"true":"false":e.value:i)!==r&&(t.setValue(e),1)):1}function sn(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function on(e,t){var r=t.checked;return g({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function ln(e,t){var r=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked,r=tn(null!=t.value?t.value:r);e._wrapperState={initialChecked:i,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function un(e,t){null!=(t=t.checked)&&Ki(e,"checked",t,!1)}function cn(e,t){un(e,t);var r=tn(t.value),i=t.type;if(null!=r)"number"===i?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?dn(e,t.type,r):t.hasOwnProperty("defaultValue")&&dn(e,t.type,tn(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function hn(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(("submit"===i||"reset"===i)&&null==t.value)return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function dn(e,t,r){"number"===t&&sn(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}function pn(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+tn(r),t=null,n=0;n<e.length;n++){if(e[n].value===r)return e[n].selected=!0,void(i&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function fn(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(N(91));return g({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mn(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(N(92));if(ce(r)){if(1<r.length)throw Error(N(93));r=r[0]}t=r}r=t=null==t?"":t}e._wrapperState={initialValue:tn(r)}}function gn(e,t){var r=tn(t.value),i=tn(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue)&&e.defaultValue!==r&&(e.defaultValue=r),null!=i&&(e.defaultValue=""+i)}function vn(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function yn(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _n(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?yn(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}function bn(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}function xn(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function Sn(e,t){for(var r in e=e.style,t){var i,n;t.hasOwnProperty(r)&&(i=0===r.indexOf("--"),n=xn(r,t[r],i),"float"===r&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n)}}function Tn(e,t){if(t){if(fe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(N(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(N(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(N(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(N(62))}}function En(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Cn(e){return 3===(e=(e=e.target||e.srcElement||window).correspondingUseElement?e.correspondingUseElement:e).nodeType?e.parentNode:e}function An(e){if(e=ts(e)){if("function"!=typeof ge)throw Error(N(280));var t=e.stateNode;t&&(t=is(t),ge(e.stateNode,e.type,t))}}function wn(e){ve?ye?ye.push(e):ye=[e]:ve=e}function Pn(){if(ve){var e=ve,t=ye;if(ye=ve=null,An(e),t)for(e=0;e<t.length;e++)An(t[e])}}function Mn(e,t){return e(t)}function In(){}function Dn(e,t,r){if(_e)return e(t,r);_e=!0;try{Mn(e,t,r)}finally{_e=!1,null===ve&&null===ye||(In(),Pn())}}function Rn(e,t){var r=e.stateNode;if(null===r)return null;var i=is(r);if(null===i)return null;switch(r=i[t],t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":e=!(i=(i=!i.disabled)?i:!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e));break;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(N(231,t,typeof r));return r}function kn(e,t,r,i,n,a,s,o,l){Me=!1,Ie=null,function(e,t,r,i,n,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(e){this.onError(e)}}.apply(ke,arguments)}function On(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else for(e=t;0!=(4098&(t=e).flags)&&(r=t.return),e=t.return;);return 3===t.tag?r:null}function Fn(e){if(13===e.tag){var t=e.memoizedState;if(null!==(t=null===t&&null!==(e=e.alternate)?e.memoizedState:t))return t.dehydrated}return null}function $n(e){if(On(e)!==e)throw Error(N(188))}function Bn(e){return null!==(e=(e=>{var t=e.alternate;if(!t){if(null===(t=On(e)))throw Error(N(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(null===n)break;var a=n.alternate;if(null===a){if(null===(i=n.return))break;r=i}else{if(n.child===a.child){for(a=n.child;a;){if(a===r)return $n(n),e;if(a===i)return $n(n),t;a=a.sibling}throw Error(N(188))}if(r.return!==i.return)r=n,i=a;else{for(var s=!1,o=n.child;o;){if(o===r){s=!0,r=n,i=a;break}if(o===i){s=!0,i=n,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,i=n;break}if(o===i){s=!0,i=a,r=n;break}o=o.sibling}if(!s)throw Error(N(189))}}if(r.alternate!==i)throw Error(N(190))}}if(3!==r.tag)throw Error(N(188));return r.stateNode.current===r?e:t})(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var r=e(t);if(null!==r)return r;t=t.sibling}return null}(e):null}function Ln(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Nn(e,t){var r=e.pendingLanes;if(0===r)return 0;var i,n=0,a=e.suspendedLanes,s=e.pingedLanes,o=268435455&r;if(0!=o?0!=(i=o&~a)?n=Ln(i):0!==(s&=o)&&(n=Ln(s)):0!=(o=r&~a)?n=Ln(o):0!==s&&(n=Ln(s)),0===n)return 0;if(0!==t&&t!==n&&0==(t&a)&&((s=t&-t)<=(a=n&-n)||16===a&&0!=(4194240&s)))return t;if(0!=(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)n|=e[r=31-We(t)],t&=~(a=1<<r);return n}function Gn(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-We(a),o=1<<s,l=n[s];-1===l?0!=(o&r)&&0==(o&i)||(n[s]=((e,t)=>{switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;default:return-1}})(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function zn(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Un(){var e=qe;return 0==(4194240&(qe<<=1))&&(qe=64),e}function jn(e){for(var t=[],r=0;r<31;r++)t.push(e);return t}function Vn(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-We(t)]=r}function Hn(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-We(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}function Wn(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}function Yn(e,t){switch(e){case"focusin":case"focusout":Je=null;break;case"dragenter":case"dragleave":et=null;break;case"mouseover":case"mouseout":tt=null;break;case"pointerover":case"pointerout":rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":it.delete(t.pointerId)}}function Xn(e,t,r,i,n,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:a,targetContainers:[n]},null!==t&&null!==(t=ts(t))&&Se(t)):(e.eventSystemFlags|=i,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n)),e}function qn(e){var t=es(e.target);if(null!==t){var r=On(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Fn(r)))return e.blockedOn=t,void Ce(e.priority,function(){Te(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Kn(e){if(null===e.blockedOn){for(var t=e.targetContainers;0<t.length;){var r=na(e.domEventName,0,t[0],e.nativeEvent);if(null!==r)return null!==(t=ts(r))&&Se(t),e.blockedOn=r,0;var i=new(r=e.nativeEvent).constructor(r.type,r);me=i,r.target.dispatchEvent(i),me=null,t.shift()}return 1}}function Qn(e,t,r){Kn(e)&&r.delete(t)}function Zn(){Qe=!1,null!==Je&&Kn(Je)&&(Je=null),null!==et&&Kn(et)&&(et=null),null!==tt&&Kn(tt)&&(tt=null),rt.forEach(Qn),it.forEach(Qn)}function Jn(e,t){e.blockedOn===t&&(e.blockedOn=null,Qe||(Qe=!0,G.unstable_scheduleCallback(G.unstable_NormalPriority,Zn)))}function ea(t){function e(e){return Jn(e,t)}if(0<Ze.length){Jn(Ze[0],t);for(var r=1;r<Ze.length;r++){var i=Ze[r];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Je&&Jn(Je,t),null!==et&&Jn(et,t),null!==tt&&Jn(tt,t),rt.forEach(e),it.forEach(e),r=0;r<nt.length;r++)(i=nt[r]).blockedOn===t&&(i.blockedOn=null);for(;0<nt.length&&null===(r=nt[0]).blockedOn;)qn(r),null===r.blockedOn&&nt.shift()}function ta(e,t,r,i){var n=x,a=st.transition;st.transition=null;try{x=1,ia(e,t,r,i)}finally{x=n,st.transition=a}}function ra(e,t,r,i){var n=x,a=st.transition;st.transition=null;try{x=4,ia(e,t,r,i)}finally{x=n,st.transition=a}}function ia(e,t,r,i){if(ot){var n=na(e,0,0,i);if(null===n)za(e,t,i,lt,r),Yn(e,i);else if(((e,t,r,i,n)=>{switch(t){case"focusin":return Je=Xn(Je,e,t,r,i,n),1;case"dragenter":return et=Xn(et,e,t,r,i,n),1;case"mouseover":return tt=Xn(tt,e,t,r,i,n),1;case"pointerover":var a=n.pointerId;return rt.set(a,Xn(rt.get(a)||null,e,t,r,i,n)),1;case"gotpointercapture":return a=n.pointerId,it.set(a,Xn(it.get(a)||null,e,t,r,i,n)),1}})(n,e,t,r,i))i.stopPropagation();else if(Yn(e,i),4&t&&-1<at.indexOf(e)){for(;null!==n;){var a=ts(n);if(null!==a&&xe(a),null===(a=na(e,0,0,i))&&za(e,t,i,lt,r),a===n)break;n=a}null!==n&&i.stopPropagation()}else za(e,t,i,null,r)}}function na(e,t,r,i){if((lt=null)!==(e=es(e=Cn(i))))if(null===(t=On(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Fn(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return lt=e,null}function aa(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Le()){case Ne:return 1;case Ge:return 4;case ze:case Ue:return 16;case je:return 536870912;default:return 16}default:return 16}}function sa(){if(ht)return ht;for(var e=ct,t=e.length,r=("value"in ut?ut.value:ut.textContent),i=r.length,n=0;n<t&&e[n]===r[n];n++);for(var a=t-n,s=1;s<=a&&e[t-s]===r[i-s];s++);return ht=r.slice(n,1<s?1-s:void 0)}function oa(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,32<=(e=10===e?13:e)||13===e?e:0}function la(){return!0}function ua(){return!1}function ca(s){function e(e,t,r,i,n){for(var a in this._reactName=e,this._targetInst=r,this.type=t,this.nativeEvent=i,this.target=n,this.currentTarget=null,s)s.hasOwnProperty(a)&&(e=s[a],this[a]=e?e(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?la:ua,this.isPropagationStopped=ua,this}return g(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=la)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=la)},persist:function(){},isPersistent:la}),e}function ha(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=St[e])&&!!t[e]}function da(){return ha}function pa(e,t){switch(e){case"keyup":return-1!==Pt.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return 1;default:return}}function fa(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}function ma(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?Ft[e.type]:"textarea"===t}function ga(e,t,r,i){wn(i),0<(t=ja(t,"onChange")).length&&(r=new dt("onChange","change",null,r,i),e.push({event:r,listeners:t}))}function va(e){Ba(e,0)}function ya(e){if(an(rs(e)))return e}function _a(e,t){if("change"===e)return t}function ba(){$t&&($t.detachEvent("onpropertychange",xa),Bt=$t=null)}function xa(e){var t;"value"===e.propertyName&&ya(Bt)&&(ga(t=[],Bt,e,Cn(e)),Dn(va,t))}function Sa(e,t,r){"focusin"===e?(ba(),Bt=r,($t=t).attachEvent("onpropertychange",xa)):"focusout"===e&&ba()}function Ta(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return ya(Bt)}function Ea(e,t){if("click"===e)return ya(t)}function Ca(e,t){if("input"===e||"change"===e)return ya(t)}function Aa(e,t){if(!Nt(e,t)){if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!V.call(t,n)||!Nt(e[n],t[n]))return!1}}return!0}function wa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Pa(e,t){var r,i=wa(e);for(e=0;i;){if(3===i.nodeType){if(r=e+i.textContent.length,e<=t&&t<=r)return{node:i,offset:t-e};e=r}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=wa(i)}}function Ma(){for(var e=window,t=sn();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(e){r=!1}if(!r)break;t=sn((e=t.contentWindow).document)}return t}function Ia(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Da(e){var t,r,i,n=Ma(),a=e.focusedElem,s=e.selectionRange;if(n!==a&&a&&a.ownerDocument&&function e(t,r){return!(!t||!r)&&(t===r||(!t||3!==t.nodeType)&&(r&&3===r.nodeType?e(t,r.parentNode):"contains"in t?t.contains(r):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(r))))}(a.ownerDocument.documentElement,a)){null!==s&&Ia(a)&&(n=s.start,void 0===(e=s.end)&&(e=n),"selectionStart"in a?(a.selectionStart=n,a.selectionEnd=Math.min(e,a.value.length)):(e=(n=a.ownerDocument||document)&&n.defaultView||window).getSelection&&(e=e.getSelection(),r=a.textContent.length,t=Math.min(s.start,r),s=void 0===s.end?t:Math.min(s.end,r),!e.extend&&s<t&&(r=s,s=t,t=r),r=Pa(a,t),i=Pa(a,s),r)&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((n=n.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s<t?(e.addRange(n),e.extend(i.node,i.offset)):(n.setEnd(i.node,i.offset),e.addRange(n)))),n=[];for(e=a;e=e.parentNode;)1===e.nodeType&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof a.focus&&a.focus(),a=0;a<n.length;a++)(e=n[a]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}function Ra(e,t,r){var i=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;Vt||null==zt||zt!==sn(i)||(i="selectionStart"in(i=zt)&&Ia(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},jt&&Aa(jt,i))||(jt=i,0<(i=ja(Ut,"onSelect")).length&&(t=new dt("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=zt))}function ka(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}function Oa(e){if(Wt[e])return Wt[e];if(Ht[e]){var t,r=Ht[e];for(t in r)if(r.hasOwnProperty(t)&&t in Yt)return Wt[e]=r[t]}return e}function Fa(e,t){Zt.set(e,t),Wi(t,[e])}function $a(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,function(){var e;kn.apply(this,arguments),Me&&(e=Ie,Me=!1,Ie=null,De||(De=!0,Re=e))}(i,t,void 0,e),e.currentTarget=null}function Ba(e,t){t=0!=(4&t);for(var r=0;r<e.length;r++){var i=(n=e[r]).event,n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=(u=n[s]).instance,l=u.currentTarget,u=u.listener;if(o!==a&&i.isPropagationStopped())break e;$a(i,u,l),a=o}else for(s=0;s<n.length;s++){if(o=(u=n[s]).instance,l=u.currentTarget,u=u.listener,o!==a&&i.isPropagationStopped())break e;$a(i,u,l),a=o}}}if(De)throw e=Re,De=!1,Re=null,e}function c(e,t){var r=t[gr],i=e+"__bubble";(r=void 0===r?t[gr]=new Set:r).has(i)||(Ga(t,e,2,!1),r.add(i))}function La(e,t,r){var i=0;t&&(i|=4),Ga(r,e,i,t)}function Na(t){var e;t[nr]||(t[nr]=!0,z.forEach(function(e){"selectionchange"!==e&&(ir.has(e)||La(e,!1,t),La(e,!0,t))}),null===(e=9===t.nodeType?t:t.ownerDocument))||e[nr]||La("selectionchange",!(e[nr]=!0),e)}function Ga(e,t,r,i){switch(aa(t)){case 1:var n=ta;break;case 4:n=ra;break;default:n=ia}r=n.bind(null,t,r,e),n=!be||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t?void 0:!0,i?void 0!==n?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):void 0!==n?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function za(g,v,y,e,t){var _=e;if(0==(1&v)&&0==(2&v)&&null!==e)e:for(;;){if(null===e)return;var r=e.tag;if(3===r||4===r){var i=e.stateNode.containerInfo;if(i===t||8===i.nodeType&&i.parentNode===t)break;if(4===r)for(r=e.return;null!==r;){var n=r.tag;if((3===n||4===n)&&((n=r.stateNode.containerInfo)===t||8===n.nodeType&&n.parentNode===t))return;r=r.return}for(;null!==i;){if(null===(r=es(i)))return;if(5===(n=r.tag)||6===n){e=_=r;continue e}i=i.parentNode}}e=e.return}Dn(function(){var e,t,r,i=_,n=Cn(y),a=[];e:{var s=Zt.get(g);if(void 0!==s){var o=dt,l=g;switch(g){case"keypress":if(0===oa(y))break e;case"keydown":case"keyup":o=Tt;break;case"focusin":l="focus",o=gt;break;case"focusout":l="blur",o=gt;break;case"beforeblur":case"afterblur":o=gt;break;case"click":if(2===y.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=ft;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=mt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Ct;break;case Xt:case qt:case Kt:o=vt;break;case Qt:o=At;break;case"scroll":o=pt;break;case"wheel":o=wt;break;case"copy":case"cut":case"paste":o=yt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Et}for(var u=!(h=0!=(4&v))&&"scroll"===g,c=h?null!==s?s+"Capture":null:s,h=[],d=i;null!==d;){var p,f=(p=d).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==c)&&null!=(f=Rn(d,c))&&h.push(Ua(d,f,p)),u)break;d=d.return}0<h.length&&(s=new o(s,l,null,y,n),a.push({event:s,listeners:h}))}}if(0==(7&v)){if(o="mouseout"===g||"pointerout"===g,(!(s="mouseover"===g||"pointerover"===g)||y===me||!(l=y.relatedTarget||y.fromElement)||!es(l)&&!l[mr])&&(o||s)&&(s=n.window===n?n:(s=n.ownerDocument)?s.defaultView||s.parentWindow:window,o?(o=i,null!==(l=(l=y.relatedTarget||y.toElement)?es(l):null)&&(l!==(u=On(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(o=null,l=i),o!==l)){if(h=ft,f="onMouseLeave",c="onMouseEnter",d="mouse","pointerout"!==g&&"pointerover"!==g||(h=Et,f="onPointerLeave",c="onPointerEnter",d="pointer"),u=null==o?s:rs(o),p=null==l?s:rs(l),(s=new h(f,d+"leave",o,y,n)).target=u,s.relatedTarget=p,f=null,es(n)===i&&((h=new h(c,d+"enter",l,y,n)).target=p,h.relatedTarget=u,f=h),u=f,o&&l)e:{for(c=l,d=0,p=h=o;p;p=Va(p))d++;for(p=0,f=c;f;f=Va(f))p++;for(;0<d-p;)h=Va(h),d--;for(;0<p-d;)c=Va(c),p--;for(;d--;){if(h===c||null!==c&&h===c.alternate)break e;h=Va(h),c=Va(c)}h=null}else h=null;null!==o&&Ha(a,s,o,h,!1),null!==l&&null!==u&&Ha(a,u,l,h,!0)}switch("select"===(o=(s=i?rs(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===o&&"file"===s.type?e=_a:ma(s)?Lt?e=Ca:(e=Ta,t=Sa):!(o=s.nodeName)||"input"!==o.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type||(e=Ea),(e=e&&e(g,i))?ga(a,e,y,n):(t&&t(g,s,i),"focusout"===g&&(t=s._wrapperState)&&t.controlled&&"number"===s.type&&dn(s,"number",s.value)),t=i?rs(i):window,g){case"focusin":!ma(t)&&"true"!==t.contentEditable||(zt=t,Ut=i,jt=null);break;case"focusout":jt=Ut=zt=null;break;case"mousedown":Vt=!0;break;case"contextmenu":case"mouseup":case"dragend":Vt=!1,Ra(a,y,n);break;case"selectionchange":if(Gt)break;case"keydown":case"keyup":Ra(a,y,n)}if(Mt)e:{switch(g){case"compositionstart":var m="onCompositionStart";break e;case"compositionend":m="onCompositionEnd";break e;case"compositionupdate":m="onCompositionUpdate";break e}m=void 0}else Ot?pa(g,y)&&(m="onCompositionEnd"):"keydown"===g&&229===y.keyCode&&(m="onCompositionStart");m&&(Dt&&"ko"!==y.locale&&(Ot||"onCompositionStart"!==m?"onCompositionEnd"===m&&Ot&&(r=sa()):(ct="value"in(ut=n)?ut.value:ut.textContent,Ot=!0)),0<(t=ja(i,m)).length)&&(m=new _t(m,g,null,y,n),a.push({event:m,listeners:t}),r||null!==(r=fa(y)))&&(m.data=r),(r=(It?(e,t)=>{switch(e){case"compositionend":return fa(t);case"keypress":return 32!==t.which?null:(kt=!0,Rt);case"textInput":return(e=t.data)===Rt&&kt?null:e;default:return null}}:(e,t)=>{if(Ot)return"compositionend"===e||!Mt&&pa(e,t)?(e=sa(),ht=ct=ut=null,Ot=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dt&&"ko"!==t.locale?null:t.data;default:return null}})(g,y))&&0<(i=ja(i,"onBeforeInput")).length&&(n=new _t("onBeforeInput","beforeinput",null,y,n),a.push({event:n,listeners:i}),n.data=r)}Ba(a,v)})}function Ua(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ja(e,t){for(var r=t+"Capture",i=[];null!==e;){var n=e,a=n.stateNode;5===n.tag&&null!==a&&(n=a,null!=(a=Rn(e,r))&&i.unshift(Ua(e,a,n)),null!=(a=Rn(e,t)))&&i.push(Ua(e,a,n)),e=e.return}return i}function Va(e){if(null===e)return null;for(;(e=e.return)&&5!==e.tag;);return e||null}function Ha(e,t,r,i,n){for(var a=t._reactName,s=[];null!==r&&r!==i;){var o=r,l=o.alternate,u=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==u&&(o=u,n?null!=(l=Rn(r,a))&&s.unshift(Ua(r,l,o)):null!=(l=Rn(r,a))&&s.push(Ua(r,l,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}function Wa(e){return("string"==typeof e?e:""+e).replace(ar,"\n").replace(sr,"")}function Ya(e,t,r){if(t=Wa(t),Wa(e)!==t&&r)throw Error(N(425))}function Xa(){}function qa(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}function Ka(e){setTimeout(function(){throw e})}function Qa(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===i)return e.removeChild(n),void ea(t);i--}else"$"!==r&&"$?"!==r&&"$!"!==r||i++}while(r=n);ea(t)}function Za(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function Ja(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}function es(e){var t=e[pr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[mr]||r[pr]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=Ja(e);null!==e;){if(r=e[pr])return r;e=Ja(e)}return t}r=(e=r).parentNode}return null}function ts(e){return!(e=e[pr]||e[mr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function rs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(N(33))}function is(e){return e[fr]||null}function ns(e){return{current:e}}function h(e){br<0||(e.current=_r[br],_r[br]=null,br--)}function R(e,t){_r[++br]=e.current,e.current=t}function as(e,t){var r=e.type.contextTypes;if(!r)return xr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n,a={};for(n in r)a[n]=t[n];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function k(e){return null!=(e=e.childContextTypes)}function ss(){h(y),h(v)}function os(e,t,r){if(v.current!==xr)throw Error(N(168));R(v,t),R(y,r)}function ls(e,t,r){var i,n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(i in n=n.getChildContext())if(!(i in t))throw Error(N(108,en(e)||"Unknown",i));return g({},r,n)}function us(e){e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||xr,Sr=v.current,R(v,e),R(y,y.current)}function cs(e,t,r){var i=e.stateNode;if(!i)throw Error(N(169));r?(e=ls(e,t,Sr),i.__reactInternalMemoizedMergedChildContext=e,h(y),h(v),R(v,e)):h(y),R(y,r)}function hs(e){null===Tr?Tr=[e]:Tr.push(e)}function ds(){if(!Cr&&null!==Tr){Cr=!0;var t=0,e=x;try{var r=Tr;for(x=1;t<r.length;t++)for(var i=r[t];null!==(i=i(!0)););Tr=null,Er=!1}catch(e){throw null!==Tr&&(Tr=Tr.slice(t+1)),Oe(Ne,ds),e}finally{x=e,Cr=!1}}return null}function ps(e,t){Ar[wr++]=Mr,Ar[wr++]=Pr,Pr=e,Mr=t}function fs(e,t,r){Ir[Dr++]=kr,Ir[Dr++]=Or,Ir[Dr++]=Rr,Rr=e;var i,n=kr,a=(e=Or,32-We(n)-1),s=(n&=~(1<<a),r+=1,32-We(t)+a);Or=30<s?(s=(n&(1<<(i=a-a%5))-1).toString(32),n>>=i,a-=i,kr=1<<32-We(t)+a|r<<a|n,s+e):(kr=1<<s|r<<a|n,e)}function ms(e){null!==e.return&&(ps(e,1),fs(e,1,0))}function gs(e){for(;e===Pr;)Pr=Ar[--wr],Ar[wr]=null,Mr=Ar[--wr],Ar[wr]=null;for(;e===Rr;)Rr=Ir[--Dr],Ir[Dr]=null,Or=Ir[--Dr],Ir[Dr]=null,kr=Ir[--Dr],Ir[Dr]=null}function vs(e,t){var r=eu(5,null,null,0);r.elementType="DELETED",r.stateNode=t,null===(t=(r.return=e).deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function ys(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Fr=e,_=Za(t.firstChild),1);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Fr=e,_=null,1);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Rr?{id:kr,overflow:Or}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=eu(18,null,null,0)).stateNode=t,(r.return=e).child=r,Fr=e,_=null,1);default:return}}function _s(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function bs(e){if(L)if(_){var t=_;if(!ys(e,_)){if(_s(e))throw Error(N(418));var r=Za(t.nextSibling),i=Fr;r&&ys(e,r)?vs(i,t):(e.flags=-4097&e.flags|2,L=!1,Fr=e)}}else{if(_s(e))throw Error(N(418));e.flags=-4097&e.flags|2,L=!1,Fr=e}}function xs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Fr=e}function Ss(e){if(e!==Fr)return!1;if(!L)return xs(e),!(L=!0);var t;if(t=(t=(t=3!==e.tag)&&!(t=5!==e.tag)?"head"!==(t=e.type)&&"body"!==t&&!qa(e.type,e.memoizedProps):t)&&_){if(_s(e))throw Ts(),Error(N(418));for(;t;)vs(e,t),t=Za(t.nextSibling)}if(xs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(N(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){_=Za(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}_=null}}else _=Fr?Za(e.stateNode.nextSibling):null;return!0}function Ts(){for(var e=_;e;)e=Za(e.nextSibling)}function Es(){_=Fr=null,L=!1}function Cs(e){null===$r?$r=[e]:$r.push(e)}function As(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(N(309));var i=r.stateNode}var n,a;if(i)return n=i,a=""+e,null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=n.refs;null===e?delete t[a]:t[a]=e})._stringRef=a,t);throw Error(N(147,e))}if("string"!=typeof e)throw Error(N(284));if(!r._owner)throw Error(N(290,e))}return e}function ws(e,t){throw e=Object.prototype.toString.call(t),Error(N(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ps(e){return(0,e._init)(e._payload)}function Ms(P){function M(e,t){var r;P&&(null===(r=e.deletions)?(e.deletions=[t],e.flags|=16):r.push(t))}function I(e,t){if(P)for(;null!==t;)M(e,t),t=t.sibling;return null}function D(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function R(e,t){return(e=ru(e,t)).index=0,e.sibling=null,e}function k(e,t,r){if(e.index=r,P){if(null!==(r=e.alternate))return(r=r.index)<t?(e.flags|=2,t):r;e.flags|=2}else e.flags|=1048576;return t}function O(e){return P&&null===e.alternate&&(e.flags|=2),e}function a(e,t,r,i){return null===t||6!==t.tag?(t=su(r,e.mode,i)).return=e:(t=R(t,r)).return=e,t}function s(e,t,r,i){var n=r.type;return n===Q?l(e,t,r.props.children,i,r.key):(null!==t&&(t.elementType===n||"object"==typeof n&&null!==n&&n.$$typeof===se&&Ps(n)===t.type)?(i=R(t,r.props)).ref=As(0,t,r):(i=iu(r.type,r.key,r.props,null,e.mode,i)).ref=As(0,t,r),i.return=e,i)}function o(e,t,r,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?(t=ou(r,e.mode,i)).return=e:(t=R(t,r.children||[])).return=e,t}function l(e,t,r,i,n){return null===t||7!==t.tag?(t=nu(r,e.mode,i,n)).return=e:(t=R(t,r)).return=e,t}function F(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=su(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case q:return(r=iu(t.type,t.key,t.props,null,e.mode,r)).ref=As(0,null,t),r.return=e,r;case K:return(t=ou(t,e.mode,r)).return=e,t;case se:return F(e,(0,t._init)(t._payload),r)}if(ce(t)||Qi(t))return(t=nu(t,e.mode,r,null)).return=e,t;ws(0,t)}return null}function $(e,t,r,i){var n=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==n?null:a(e,t,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case q:return r.key===n?s(e,t,r,i):null;case K:return r.key===n?o(e,t,r,i):null;case se:return $(e,t,(n=r._init)(r._payload),i)}if(ce(r)||Qi(r))return null!==n?null:l(e,t,r,i,null);ws(0,r)}return null}function B(e,t,r,i,n){if("string"==typeof i&&""!==i||"number"==typeof i)return a(t,e=e.get(r)||null,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case q:return s(t,e=e.get(null===i.key?r:i.key)||null,i,n);case K:return o(t,e=e.get(null===i.key?r:i.key)||null,i,n);case se:return B(e,t,r,(0,i._init)(i._payload),n)}if(ce(i)||Qi(i))return l(t,e=e.get(r)||null,i,n,null);ws(0,i)}return null}return function e(t,r,i,n){if("object"==typeof(i="object"==typeof i&&null!==i&&i.type===Q&&null===i.key?i.props.children:i)&&null!==i){switch(i.$$typeof){case q:e:{for(var a=i.key,s=r;null!==s;){if(s.key===a){if((a=i.type)===Q){if(7===s.tag){I(t,s.sibling),(r=R(s,i.props.children)).return=t,t=r;break e}}else if(s.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===se&&Ps(a)===s.type){I(t,s.sibling),(r=R(s,i.props)).ref=As(0,s,i),r.return=t,t=r;break e}I(t,s);break}M(t,s),s=s.sibling}t=i.type===Q?((r=nu(i.props.children,t.mode,n,i.key)).return=t,r):((n=iu(i.type,i.key,i.props,null,t.mode,n)).ref=As(0,r,i),n.return=t,n)}return O(t);case K:e:{for(s=i.key;null!==r;){if(r.key===s){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){I(t,r.sibling),(r=R(r,i.children||[])).return=t,t=r;break e}I(t,r);break}M(t,r),r=r.sibling}(r=ou(i,t.mode,n)).return=t,t=r}return O(t);case se:return e(t,r,(s=i._init)(i._payload),n)}if(ce(i)){for(var o=t,l=r,u=i,c=n,h=null,d=null,p=l,f=l=0,m=null;null!==p&&f<u.length;f++){p.index>f?(m=p,p=null):m=p.sibling;var g=$(o,p,u[f],c);if(null===g){null===p&&(p=m);break}P&&p&&null===g.alternate&&M(o,p),l=k(g,l,f),null===d?h=g:d.sibling=g,d=g,p=m}if(f===u.length)I(o,p);else if(null===p)for(;f<u.length;f++)null!==(p=F(o,u[f],c))&&(l=k(p,l,f),null===d?h=p:d.sibling=p,d=p);else{for(p=D(o,p);f<u.length;f++)null!==(m=B(p,o,f,u[f],c))&&(P&&null!==m.alternate&&p.delete(null===m.key?f:m.key),l=k(m,l,f),null===d?h=m:d.sibling=m,d=m);P&&p.forEach(function(e){return M(o,e)})}return L&&ps(o,f),h}if(Qi(i)){var v=t,y=r,_=i,b=n,x=Qi(_);if("function"!=typeof x)throw Error(N(150));if(null==(_=x.call(_)))throw Error(N(151));for(var S=x=null,T=y,E=y=0,C=null,A=_.next();null!==T&&!A.done;E++,A=_.next()){T.index>E?(C=T,T=null):C=T.sibling;var w=$(v,T,A.value,b);if(null===w){null===T&&(T=C);break}P&&T&&null===w.alternate&&M(v,T),y=k(w,y,E),null===S?x=w:S.sibling=w,S=w,T=C}if(A.done)I(v,T);else if(null===T)for(;!A.done;E++,A=_.next())null!==(A=F(v,A.value,b))&&(y=k(A,y,E),null===S?x=A:S.sibling=A,S=A);else{for(T=D(v,T);!A.done;E++,A=_.next())null!==(A=B(T,v,E,A.value,b))&&(P&&null!==A.alternate&&T.delete(null===A.key?E:A.key),y=k(A,y,E),null===S?x=A:S.sibling=A,S=A);P&&T.forEach(function(e){return M(v,e)})}return L&&ps(v,E),x}ws(0,i)}return"string"==typeof i&&""!==i||"number"==typeof i?(i=""+i,(r=null!==r&&6===r.tag?(I(t,r.sibling),R(r,i)):(I(t,r),su(i,t.mode,n))).return=t,O(t=r)):I(t,r)}}function Is(){jr=Ur=zr=null}function Ds(e){var t=Gr.current;h(Gr),e._currentValue=t}function Rs(e,t,r){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function ks(e,t){(jr=Ur=null)!==(e=(zr=e).dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(C=!0),e.firstContext=null)}function Os(e){var t=e._currentValue;if(jr!==e)if(e={context:e,memoizedValue:t,next:null},null===Ur){if(null===zr)throw Error(N(308));Ur=e,zr.dependencies={lanes:0,firstContext:e}}else Ur=Ur.next=e;return t}function Fs(e){null===Vr?Vr=[e]:Vr.push(e)}function $s(e,t,r,i){var n=t.interleaved;return null===n?(r.next=r,Fs(t)):(r.next=n.next,n.next=r),t.interleaved=r,Bs(e,i)}function Bs(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),e=(r=e).return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),e=(r=e).return;return 3===r.tag?r.stateNode:null}function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ns(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,r){var i,n=e.updateQueue;return null===n?null:(n=n.shared,0!=(2&P)?(null===(i=n.pending)?t.next=t:(t.next=i.next,i.next=t),n.pending=t):(null===(i=n.interleaved)?(t.next=t,Fs(n)):(t.next=i.next,i.next=t),n.interleaved=t),Bs(e,r))}function Us(e,t,r){var i;null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))&&(i=t.lanes,i&=e.pendingLanes,Hn(e,t.lanes=r|=i))}function js(e,t){var r=e.updateQueue,i=e.alternate;if(null!==i&&r===(i=i.updateQueue)){var n=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null}}while(null===a?n=a=s:a=a.next=s,null!==(r=r.next));null===a?n=a=t:a=a.next=t}else n=a=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:i.shared,effects:i.effects},e.updateQueue=r}else null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vs(e,t,r,i){var n,a,s=e.updateQueue,o=(Hr=!1,s.firstBaseUpdate),l=s.lastBaseUpdate;if(null!==(h=s.shared.pending)&&(s.shared.pending=null,a=(n=h).next,(n.next=null)===l?o=a:l.next=a,l=n,null!==(c=e.alternate))&&(h=(c=c.updateQueue).lastBaseUpdate)!==l&&(null===h?c.firstBaseUpdate=a:h.next=a,c.lastBaseUpdate=n),null!==o){for(var u=s.baseState,l=0,c=a=n=null,h=o;;){var d=h.lane,p=h.eventTime;if((i&d)===d){null!==c&&(c=c.next={eventTime:p,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var f=e,m=h,d=t,p=r;switch(m.tag){case 1:if("function"==typeof(f=m.payload)){u=f.call(p,u,d);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(d="function"==typeof(f=m.payload)?f.call(p,u,d):f))break e;u=g({},u,d);break e;case 2:Hr=!0}}null!==h.callback&&0!==h.lane&&(e.flags|=64,null===(d=s.effects)?s.effects=[h]:d.push(h))}else p={eventTime:p,lane:d,tag:h.tag,payload:h.payload,callback:h.callback,next:null},null===c?(a=c=p,n=u):c=c.next=p,l|=d;if(null===(h=h.next)){if(null===(h=s.shared.pending))break;h=(d=h).next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}if(null===c&&(n=u),s.baseState=n,s.firstBaseUpdate=a,s.lastBaseUpdate=c,null!==(t=s.shared.interleaved))for(s=t;l|=s.lane,(s=s.next)!==t;);else null===o&&(s.shared.lanes=0);wi|=l,e.lanes=l,e.memoizedState=u}}function Hs(e,t,r){if(e=t.effects,(t.effects=null)!==e)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(null!==n){if(i.callback=null,i=r,"function"!=typeof n)throw Error(N(191,n));n.call(i)}}}function Ws(e){if(e===Wr)throw Error(N(174));return e}function Ys(e,t){switch(R(qr,t),R(Xr,e),R(Yr,Wr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_n(null,"");break;default:t=_n(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}h(Yr),R(Yr,t)}function Xs(){h(Yr),h(Xr),h(qr)}function qs(e){Ws(qr.current);var t=Ws(Yr.current),r=_n(t,e.type);t!==r&&(R(Xr,e),R(Yr,r))}function Ks(e){Xr.current===e&&(h(Yr),h(Xr))}function Qs(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t=(t.child.return=t).child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Zs(){for(var e=0;e<Kr.length;e++)Kr[e]._workInProgressVersionPrimary=null;Kr.length=0}function n(){throw Error(N(321))}function Js(e,t){if(null!==t){for(var r=0;r<t.length&&r<e.length;r++)if(!Nt(e[r],t[r]))return;return 1}}function eo(e,t,r,i,n,a){if(Jr=a,(S=t).memoizedState=null,t.updateQueue=null,t.lanes=0,Qr.current=null===e||null===e.memoizedState?ai:si,e=r(i,n),ti){a=0;do{if(ti=!1,ri=0,25<=a)throw Error(N(301))}while(a+=1,E=T=null,t.updateQueue=null,Qr.current=oi,e=r(i,n),ti)}if(Qr.current=ni,t=null!==T&&null!==T.next,Jr=0,E=T=S=null,ei=!1,t)throw Error(N(300));return e}function to(){var e=0!==ri;return ri=0,e}function ro(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===E?S.memoizedState=E=e:E=E.next=e,E}function io(){e=null===T?null!==(e=S.alternate)?e.memoizedState:null:T.next;var e,t=null===E?S.memoizedState:E.next;if(null!==t)E=t,T=e;else{if(null===e)throw Error(N(310));e={memoizedState:(T=e).memoizedState,baseState:T.baseState,baseQueue:T.baseQueue,queue:T.queue,next:null},null===E?S.memoizedState=E=e:E=E.next=e}return E}function no(e,t){return"function"==typeof t?t(e):t}function ao(e){var t=io(),r=t.queue;if(null===r)throw Error(N(311));r.lastRenderedReducer=e;var i,n=(s=T).baseQueue;if(null!==(a=r.pending)&&(null!==n&&(i=n.next,n.next=a.next,a.next=i),s.baseQueue=n=a,r.pending=null),null!==n){var a=n.next,s=s.baseState,o=i=null,l=null,u=a;do{var c,h=u.lane}while((Jr&h)===h?(null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action)):(c={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(o=l=c,i=s):l=l.next=c,S.lanes|=h,wi|=h),null!==(u=u.next)&&u!==a);null===l?i=s:l.next=o,Nt(s,t.memoizedState)||(C=!0),t.memoizedState=s,t.baseState=i,t.baseQueue=l,r.lastRenderedState=s}if(null!==(e=r.interleaved))for(n=e;a=n.lane,S.lanes|=a,wi|=a,(n=n.next)!==e;);else null===n&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function so(e){var t=io(),r=t.queue;if(null===r)throw Error(N(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,a=t.memoizedState;if(null!==n){r.pending=null;for(var s=n=n.next;a=e(a,s.action),(s=s.next)!==n;);Nt(a,t.memoizedState)||(C=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,i]}function oo(){}function lo(e,t){var r=S,i=io(),n=t(),a=!Nt(i.memoizedState,n);if(a&&(i.memoizedState=n,C=!0),i=i.queue,xo(ho.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==E&&1&E.memoizedState.tag){if(r.flags|=2048,go(9,co.bind(null,r,i,n,t),void 0,null),null===p)throw Error(N(349));0==(30&Jr)&&uo(r,t,n)}return n}function uo(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=S.updateQueue)?(S.updateQueue=t={lastEffect:null,stores:null}).stores=[e]:null===(r=t.stores)?t.stores=[e]:r.push(e)}function co(e,t,r,i){t.value=r,t.getSnapshot=i,po(t)&&fo(e)}function ho(e,t,r){return r(function(){po(t)&&fo(e)})}function po(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Nt(e,r)}catch(e){return 1}}function fo(e){var t=Bs(e,1);null!==t&&Dl(t,e,1,-1)}function mo(e){var t=ro();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(t.queue=e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:no,lastRenderedState:e}).dispatch=function(e,t,r){var i=Il(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(Do(e))Ro(t,n);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s,o=t.lastRenderedState,l=a(o,r);if(n.hasEagerState=!0,n.eagerState=l,Nt(l,o))return null===(s=t.interleaved)?(n.next=n,Fs(t)):(n.next=s.next,s.next=n),void(t.interleaved=n)}catch(e){}null!==(r=$s(e,t,n,i))&&(n=f(),Dl(r,e,i,n),ko(r,t,i))}}.bind(null,S,e),[t.memoizedState,e]}function go(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},null===(t=S.updateQueue)?(S.updateQueue=t={lastEffect:null,stores:null}).lastEffect=e.next=e:null===(r=t.lastEffect)?t.lastEffect=e.next=e:(i=r.next,(r.next=e).next=i,t.lastEffect=e),e}function vo(){return io().memoizedState}function yo(e,t,r,i){var n=ro();S.flags|=e,n.memoizedState=go(1|t,r,void 0,void 0===i?null:i)}function _o(e,t,r,i){var n=io(),a=(i=void 0===i?null:i,void 0);if(null!==T){var s=T.memoizedState,a=s.destroy;if(null!==i&&Js(i,s.deps))return void(n.memoizedState=go(t,r,a,i))}S.flags|=e,n.memoizedState=go(1|t,r,a,i)}function bo(e,t){return yo(8390656,8,e,t)}function xo(e,t){return _o(2048,8,e,t)}function So(e,t){return _o(4,2,e,t)}function To(e,t){return _o(4,4,e,t)}function Eo(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Co(e,t,r){return r=null!=r?r.concat([e]):null,_o(4,4,Eo.bind(null,t,e),r)}function Ao(){}function wo(e,t){var r=io(),i=(t=void 0===t?null:t,r.memoizedState);return null!==i&&null!==t&&Js(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function Po(e,t){var r=io(),i=(t=void 0===t?null:t,r.memoizedState);return null!==i&&null!==t&&Js(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function Mo(e,t,r){return 0==(21&Jr)?(e.baseState&&(e.baseState=!1,C=!0),e.memoizedState=r):(Nt(r,t)||(r=Un(),S.lanes|=r,wi|=r,e.baseState=!0),t)}function Io(){return io().memoizedState}function Do(e){var t=e.alternate;return e===S||null!==t&&t===S}function Ro(e,t){ti=ei=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function ko(e,t,r){var i;0!=(4194240&r)&&(i=t.lanes,i&=e.pendingLanes,Hn(e,t.lanes=r|=i))}function Oo(e,t){if(e&&e.defaultProps)for(var r in t=g({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}function Fo(e,t,r,i){r=null==(r=r(i,t=e.memoizedState))?t:g({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}function $o(e,t,r,i,n,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,a,s):!(t.prototype&&t.prototype.isPureReactComponent&&Aa(r,i)&&Aa(n,a))}function Bo(e,t,r){var i=!1,n=xr,a=t.contextType;t=new t(r,a="object"==typeof a&&null!==a?Os(a):(n=k(t)?Sr:v.current,(i=null!=(i=t.contextTypes))?as(e,n):xr)),e.memoizedState=null!=t.state?t.state:null,t.updater=li,(e.stateNode=t)._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a)}function Lo(e,t,r,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&li.enqueueReplaceState(t,t.state,null)}function No(e,t,r,i){var n=e.stateNode,a=(n.props=r,n.state=e.memoizedState,n.refs={},Ls(e),t.contextType);"object"==typeof a&&null!==a?n.context=Os(a):(a=k(t)?Sr:v.current,n.context=as(e,a)),n.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Fo(e,0,a,r),n.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(t=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&li.enqueueReplaceState(n,n.state,null),Vs(e,r,n,i),n.state=e.memoizedState),"function"==typeof n.componentDidMount&&(e.flags|=4194308)}function Go(e,t){try{for(var r="",i=t;r+=(e=>{switch(e.tag){case 5:return Zi(e.type);case 16:return Zi("Lazy");case 13:return Zi("Suspense");case 19:return Zi("SuspenseList");case 0:case 2:case 15:return e=Ji(e.type,!1);case 11:return e=Ji(e.type.render,!1);case 1:return e=Ji(e.type,!0);default:return""}})(i),i=i.return;);var n=r}catch(e){n="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:n,digest:null}}function zo(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function Uo(e,t,r){(r=Gs(-1,r)).tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){Oi||(Oi=!0,Fi=i)},r}function jo(e,t,r){(r=Gs(-1,r)).tag=3;var i,n=e.type.getDerivedStateFromError,e=("function"==typeof n&&(i=t.value,r.payload=function(){return n(i)},r.callback=function(){}),e.stateNode);return null!==e&&"function"==typeof e.componentDidCatch&&(r.callback=function(){"function"!=typeof n&&(null===$i?$i=new Set([this]):$i.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function Vo(e,t,r){var i,n=e.pingCache;null===n?(n=e.pingCache=new ui).set(t,i=new Set):void 0===(i=n.get(t))&&n.set(t,i=new Set),i.has(r)||(i.add(r),e=function(e,t,r){var i=e.pingCache;null!==i&&i.delete(t),t=f(),e.pingedLanes|=e.suspendedLanes&r,p===e&&(I&r)===r&&(4===D||3===D&&(130023424&I)===I&&m()-Di<500?zl(e,0):Mi|=r),Rl(e,t)}.bind(null,e,t,r),t.then(e,e))}function Ho(e){do{var t;if(t=(t=13===e.tag)?null===(t=e.memoizedState)||null!==t.dehydrated:t)return e}while(null!==(e=e.return));return null}function Wo(e,t,r,i,n){if(0==(1&e.mode))return e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Gs(-1,1)).tag=2,zs(r,t,1))),r.lanes|=1);e.flags|=65536,e.lanes=n}function O(e,t,r,i){t.child=null===e?Nr(t,null,r,i):Lr(t,e.child,r,i)}function Yo(e,t,r,i,n){r=r.render;var a=t.ref;return ks(t,n),i=eo(e,t,r,i,a,n),r=to(),null===e||C?(L&&r&&ms(t),t.flags|=1,O(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,hl(e,t,n))}function Xo(e,t,r,i,n){var a;if(null===e)return"function"!=typeof(a=r.type)||tu(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=iu(r.type,null,i,t,t.mode,n)).ref=t.ref,(e.return=t).child=e):(t.tag=15,t.type=a,qo(e,t,a,i,n));if(a=e.child,0==(e.lanes&n)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:Aa)(s,i)&&e.ref===t.ref)return hl(e,t,n)}return t.flags|=1,(e=ru(a,i)).ref=t.ref,(e.return=t).child=e}function qo(e,t,r,i,n){if(null!==e){var a=e.memoizedProps;if(Aa(a,i)&&e.ref===t.ref){if(C=!1,t.pendingProps=i=a,0==(e.lanes&n))return t.lanes=e.lanes,hl(e,t,n);0!=(131072&e.flags)&&(C=!0)}}return Zo(e,t,r,i,n)}function Ko(e,t,r){var i=t.pendingProps,n=i.children,a=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},R(Ci,Ei),Ei|=r;else{if(0==(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,R(Ci,Ei),Ei|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==a?a.baseLanes:r,R(Ci,Ei),Ei|=i}else null!==a?(i=a.baseLanes|r,t.memoizedState=null):i=r,R(Ci,Ei),Ei|=i;return O(e,t,n,r),t.child}function Qo(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Zo(e,t,r,i,n){var a=as(t,k(r)?Sr:v.current);return ks(t,n),r=eo(e,t,r,i,a,n),i=to(),null===e||C?(L&&i&&ms(t),t.flags|=1,O(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,hl(e,t,n))}function Jo(e,t,r,i,n){var a,s,o,l,u,c,h,d,p,f;return k(r)?(a=!0,us(t)):a=!1,ks(t,n),i=null===t.stateNode?(cl(e,t),Bo(t,r,i),No(t,r,i,n),!0):null===e?((s=t.stateNode).props=o=t.memoizedProps,d=s.context,l="object"==typeof(l=r.contextType)&&null!==l?Os(l):as(t,l=k(r)?Sr:v.current),(c="function"==typeof(u=r.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||o===i&&d===l||Lo(0,s,i,l),Hr=!1,s.state=h=t.memoizedState,Vs(t,i,s,n),d=t.memoizedState,o!==i||h!==d||y.current||Hr?("function"==typeof u&&(Fo(t,0,u,i),d=t.memoizedState),(o=Hr||$o(t,r,o,i,h,d,l))?(c||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=d),s.props=i,s.state=d,s.context=l,o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),!1)):(s=t.stateNode,Ns(e,t),o=t.memoizedProps,l=t.type===t.elementType?o:Oo(t.type,o),s.props=l,c=t.pendingProps,h=s.context,d="object"==typeof(d=r.contextType)&&null!==d?Os(d):as(t,d=k(r)?Sr:v.current),(u="function"==typeof(p=r.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||o===c&&h===d||Lo(0,s,i,d),Hr=!1,s.state=h=t.memoizedState,Vs(t,i,s,n),f=t.memoizedState,o!==c||h!==f||y.current||Hr?("function"==typeof p&&(Fo(t,0,p,i),f=t.memoizedState),(l=Hr||$o(t,r,l,i,h,f,d)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,f,d),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,f,d)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),s.props=i,s.state=f,s.context=d,l):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),!1)),el(e,t,r,i,a,n)}function el(e,t,r,i,n,a){Qo(e,t);var s=0!=(128&t.flags);if(!i&&!s)return n&&cs(t,r,!1),hl(e,t,a);i=t.stateNode,ci.current=t;var o=s&&"function"!=typeof r.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=Lr(t,e.child,null,a),t.child=Lr(t,null,o,a)):O(e,t,o,a),t.memoizedState=i.state,n&&cs(t,r,!0),t.child}function tl(e){var t=e.stateNode;t.pendingContext?os(0,t.pendingContext,t.pendingContext!==t.context):t.context&&os(0,t.context,!1),Ys(e,t.containerInfo)}function rl(e,t,r,i,n){return Es(),Cs(n),t.flags|=256,O(e,t,r,i),t.child}function il(e){return{baseLanes:e,cachePool:null,transitions:null}}function nl(e,t,r){var i,n,a=t.pendingProps,s=b.current,o=!1,l=0!=(128&t.flags);if((n=(n=l)||(null===e||null!==e.memoizedState)&&0!=(2&s))?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),R(b,1&s),null===e)return bs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0==(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=au(l,a,0,null),e=nu(e,a,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=il(r),t.memoizedState=hi,e):al(t,l));if(null===(s=e.memoizedState)||null===(n=s.dehydrated))return o?(o=a.fallback,l=t.mode,n=(s=e.child).sibling,u={mode:"hidden",children:a.children},0==(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=u,t.deletions=null):(a=ru(s,u)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=ru(n,o):(o=nu(o,l,r,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,l=null===(l=e.child.memoizedState)?il(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},(o=t.child).memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=hi):(e=(o=e.child).sibling,a=ru(o,{mode:"visible",children:a.children}),0==(1&t.mode)&&(a.lanes=r),a.return=t,(a.sibling=null)!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null),a;var u=e,o=t,e=a,c=n,t=s,a=r;if(l)return 256&o.flags?(o.flags&=-257,e=zo(Error(N(422))),sl(u,o,a,e)):null!==o.memoizedState?(o.child=u.child,o.flags|=128,null):(t=e.fallback,c=o.mode,e=au({mode:"visible",children:e.children},c,0,null),(t=nu(t,c,a,null)).flags|=2,e.return=o,t.return=o,e.sibling=t,o.child=e,0!=(1&o.mode)&&Lr(o,u.child,null,a),o.child.memoizedState=il(a),o.memoizedState=hi,t);if(0==(1&o.mode))return sl(u,o,a,null);if("$!"===c.data)return e=i=(e=c.nextSibling&&c.nextSibling.dataset)?e.dgst:i,t=Error(N(419)),e=zo(t,e,void 0),sl(u,o,a,e);if(i=0!=(a&u.childLanes),C||i){if(null!==(e=p)){switch(a&-a){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}0!==(c=0!=(c&(e.suspendedLanes|a))?0:c)&&c!==t.retryLane&&(t.retryLane=c,Bs(u,c),Dl(e,u,c,-1))}return Vl(),e=zo(Error(N(421))),sl(u,o,a,e)}return"$?"===c.data?(o.flags|=128,o.child=u.child,o=function(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ql(e,r)}.bind(null,u),c._reactRetry=o,null):(u=t.treeContext,_=Za(c.nextSibling),Fr=o,L=!0,($r=null)!==u&&(Ir[Dr++]=kr,Ir[Dr++]=Or,Ir[Dr++]=Rr,kr=u.id,Or=u.overflow,Rr=o),(o=al(o,e.children)).flags|=4096,o)}function al(e,t){return((t=au({mode:"visible",children:t},e.mode,0,null)).return=e).child=t}function sl(e,t,r,i){return null!==i&&Cs(i),Lr(t,e.child,null,r),(e=al(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ol(e,t,r){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Rs(e.return,t,r)}function ll(e,t,r,i,n){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=r,a.tailMode=n)}function ul(e,t,r){var i=t.pendingProps,n=i.revealOrder,a=i.tail;if(O(e,t,i.children,r),0!=(2&(i=b.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ol(e,r,t);else if(19===e.tag)ol(e,r,t);else if(null!==e.child){e=(e.child.return=e).child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(R(b,i),0==(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;null!==r;)null!==(e=r.alternate)&&null===Qs(e)&&(n=r),r=r.sibling;null===(r=n)?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),ll(t,!1,n,r,a);break;case"backwards":for(n=t.child,t.child=r=null;null!==n;){if(null!==(e=n.alternate)&&null===Qs(e)){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}ll(t,!0,r,null,a);break;case"together":ll(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function cl(e,t){0==(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hl(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),wi|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(N(153));if(null!==t.child){for(r=ru(e=t.child,e.pendingProps),(t.child=r).return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=ru(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function dl(e,t){if(!L)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":for(var r=e.tail,i=null;null!==r;)null!==r.alternate&&(i=r),r=r.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function d(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;null!==n;)r|=n.lanes|n.childLanes,i=(i|=14680064&n.subtreeFlags)|14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)r|=n.lanes|n.childLanes,i=(i|=n.subtreeFlags)|n.flags,n.return=e,n=n.sibling;e.subtreeFlags|=i,e.childLanes=r}function pl(t,r){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){F(t,r,e)}else e.current=null}function fl(t,r,e){try{e()}catch(e){F(t,r,e)}}function ml(e,t,r){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var n,a=i=i.next;do{}while((a.tag&e)===e&&(n=a.destroy,(a.destroy=void 0)!==n)&&fl(t,r,n),(a=a.next)!==i)}}function gl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r,i=t=t.next;do{}while((i.tag&e)===e&&(r=i.create,i.destroy=r()),(i=i.next)!==t)}}function vl(e){var t=e.ref;null!==t&&(e=e.stateNode,"function"==typeof t?t(e):t.current=e)}function yl(e){return 5===e.tag||3===e.tag||4===e.tag}function _l(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||yl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e=(e.child.return=e).child}if(!(2&e.flags))return e.stateNode}}function bl(e,t,r){for(r=r.child;null!==r;)xl(e,t,r),r=r.sibling}function xl(e,t,r){if(He&&"function"==typeof He.onCommitFiberUnmount)try{He.onCommitFiberUnmount(Ve,r)}catch(e){}switch(r.tag){case 5:A||pl(r,t);case 6:var i=u,n=_i;u=null,bl(e,t,r),_i=n,null!==(u=i)&&(_i?(e=u,r=r.stateNode,(8===e.nodeType?e.parentNode:e).removeChild(r)):u.removeChild(r.stateNode));break;case 18:null!==u&&(_i?(e=u,r=r.stateNode,8===e.nodeType?Qa(e.parentNode,r):1===e.nodeType&&Qa(e,r),ea(e)):Qa(u,r.stateNode));break;case 4:i=u,n=_i,u=r.stateNode.containerInfo,_i=!0,bl(e,t,r),u=i,_i=n;break;case 0:case 11:case 14:case 15:if(!A&&null!==(i=r.updateQueue)&&null!==(i=i.lastEffect)){n=i=i.next;do{var a=n.destroy,s=n.tag}while(void 0===a||0==(2&s)&&0==(4&s)||fl(r,t,a),(n=n.next)!==i)}bl(e,t,r);break;case 1:if(!A&&(pl(r,t),"function"==typeof(i=r.stateNode).componentWillUnmount))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(e){F(r,t,e)}bl(e,t,r);break;case 21:bl(e,t,r);break;case 22:1&r.mode?(A=(i=A)||null!==r.memoizedState,bl(e,t,r),A=i):bl(e,t,r);break;default:bl(e,t,r)}}function Sl(r){var i,e=r.updateQueue;null!==e&&((r.updateQueue=null)===(i=r.stateNode)&&(i=r.stateNode=new vi),e.forEach(function(e){var t=function(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;null!==n&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(N(314))}null!==i&&i.delete(t),Ql(e,r)}.bind(null,r,e);i.has(e)||(i.add(e),e.then(t,t))}))}function Tl(e,t){var r=t.deletions;if(null!==r)for(var i=0;i<r.length;i++){var n=r[i];try{var a=e,s=t,o=s;e:for(;null!==o;){switch(o.tag){case 5:u=o.stateNode,_i=!1;break e;case 3:case 4:u=o.stateNode.containerInfo,_i=!0;break e}o=o.return}if(null===u)throw Error(N(160));xl(a,s,n),u=null,_i=!1;var l=n.alternate;null!==l&&(l.return=null),n.return=null}catch(e){F(n,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)El(t,e),t=t.sibling}function El(t,e){var r=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Tl(e,t),Cl(t),4&i){try{ml(3,t,t.return),gl(3,t)}catch(e){F(t,t.return,e)}try{ml(5,t,t.return)}catch(e){F(t,t.return,e)}}break;case 1:Tl(e,t),Cl(t),512&i&&null!==r&&pl(r,r.return);break;case 5:if(Tl(e,t),Cl(t),512&i&&null!==r&&pl(r,r.return),32&t.flags){var n=t.stateNode;try{bn(n,"")}catch(e){F(t,t.return,e)}}if(4&i&&null!=(n=t.stateNode)){var a=t.memoizedProps,s=null!==r?r.memoizedProps:a,o=t.type,l=t.updateQueue;if((t.updateQueue=null)!==l)try{"input"===o&&"radio"===a.type&&null!=a.name&&un(n,a),En(o,s);for(var u=En(o,a),s=0;s<l.length;s+=2){var c=l[s],h=l[s+1];"style"===c?Sn(n,h):"dangerouslySetInnerHTML"===c?he(n,h):"children"===c?bn(n,h):Ki(n,c,h,u)}switch(o){case"input":cn(n,a);break;case"textarea":gn(n,a);break;case"select":var d=n._wrapperState.wasMultiple,p=(n._wrapperState.wasMultiple=!!a.multiple,a.value);null!=p?pn(n,!!a.multiple,p,!1):d!==!!a.multiple&&(null!=a.defaultValue?pn(n,!!a.multiple,a.defaultValue,!0):pn(n,!!a.multiple,a.multiple?[]:"",!1))}n[fr]=a}catch(e){F(t,t.return,e)}}break;case 6:if(Tl(e,t),Cl(t),4&i){if(null===t.stateNode)throw Error(N(162));n=t.stateNode,a=t.memoizedProps;try{n.nodeValue=a}catch(e){F(t,t.return,e)}}break;case 3:if(Tl(e,t),Cl(t),4&i&&null!==r&&r.memoizedState.isDehydrated)try{ea(e.containerInfo)}catch(e){F(t,t.return,e)}break;case 4:Tl(e,t),Cl(t);break;case 13:Tl(e,t),Cl(t),8192&(n=t.child).flags&&(a=null!==n.memoizedState,!(n.stateNode.isHidden=a)||null!==n.alternate&&null!==n.alternate.memoizedState||(Di=m())),4&i&&Sl(t);break;case 22:if(c=null!==r&&null!==r.memoizedState,1&t.mode?(A=(u=A)||c,Tl(e,t),A=u):Tl(e,t),Cl(t),8192&i){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!c&&0!=(1&t.mode))for(c=(w=t).child;null!==c;){for(h=w=c;null!==w;){switch(p=(d=w).child,d.tag){case 0:case 11:case 14:case 15:ml(4,d,d.return);break;case 1:pl(d,d.return);var f=d.stateNode;if("function"==typeof f.componentWillUnmount){r=(i=d).return;try{e=i,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(e){F(i,r,e)}}break;case 5:pl(d,d.return);break;case 22:if(null!==d.memoizedState){Pl(h);continue}}null!==p?(p.return=d,w=p):Pl(h)}c=c.sibling}e:for(c=null,h=t;;){if(5===h.tag){if(null===c){c=h;try{n=h.stateNode,u?"function"==typeof(a=n.style).setProperty?a.setProperty("display","none","important"):a.display="none":(o=h.stateNode,s=null!=(l=h.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,o.style.display=xn("display",s))}catch(e){F(t,t.return,e)}}}else if(6===h.tag){if(null===c)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(e){F(t,t.return,e)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===t)&&null!==h.child){h=(h.child.return=h).child;continue}if(h===t)break;for(;null===h.sibling;){if(null===h.return||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Tl(e,t),Cl(t),4&i&&Sl(t);break;case 21:break;default:Tl(e,t),Cl(t)}}function Cl(t){var e=t.flags;if(2&e){try{e:{for(var r=t.return;null!==r;){if(yl(r)){var i=r;break e}r=r.return}throw Error(N(160))}switch(i.tag){case 5:var n=i.stateNode;32&i.flags&&(bn(n,""),i.flags&=-33),!function e(t,r,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,r?i.insertBefore(t,r):i.appendChild(t);else if(4!==n&&null!==(t=t.child))for(e(t,r,i),t=t.sibling;null!==t;)e(t,r,i),t=t.sibling}(t,_l(t),n);break;case 3:case 4:var a=i.stateNode.containerInfo;!function e(t,r,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,r?(8===i.nodeType?i.parentNode:i).insertBefore(t,r):(8===i.nodeType?(r=i.parentNode).insertBefore(t,i):(r=i).appendChild(t),null==(i=i._reactRootContainer)&&null===r.onclick&&(r.onclick=Xa));else if(4!==n&&null!==(t=t.child))for(e(t,r,i),t=t.sibling;null!==t;)e(t,r,i),t=t.sibling}(t,_l(t),a);break;default:throw Error(N(161))}}catch(e){F(t,t.return,e)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function Al(e){!function e(t,r,i){for(var n=0!=(1&t.mode);null!==w;){var a=w,s=a.child;if(22===a.tag&&n){var o=null!==a.memoizedState||gi;if(!o){var l=a.alternate,u=null!==l&&null!==l.memoizedState||A,c=(l=gi,A);if(gi=o,(A=u)&&!c)for(w=a;null!==w;)u=(o=w).child,(22!==o.tag||null===o.memoizedState)&&null!==u?(u.return=o,w=u):Ml(a);for(;null!==s;)e(w=s),s=s.sibling;w=a,gi=l,A=c}wl(t)}else 0!=(8772&a.subtreeFlags)&&null!==s?(s.return=a,w=s):wl(t)}}(w=e)}function wl(e){for(;null!==w;){var t=w;if(0!=(8772&t.flags)){var r,i,n,a=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:A||gl(5,t);break;case 1:var s,o=t.stateNode,l=(4&t.flags&&!A&&(null===a?o.componentDidMount():(s=t.elementType===t.type?a.memoizedProps:Oo(t.type,a.memoizedProps),o.componentDidUpdate(s,a.memoizedState,o.__reactInternalSnapshotBeforeUpdate))),t.updateQueue);null!==l&&Hs(0,l,o);break;case 3:var u=t.updateQueue;if(null!==u){if((a=null)!==t.child)switch(t.child.tag){case 5:case 1:a=t.child.stateNode}Hs(0,u,a)}break;case 5:var c=t.stateNode;if(null===a&&4&t.flags){var a=c,h=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&a.focus();break;case"img":h.src&&(a.src=h.src)}}break;case 6:case 4:case 12:break;case 13:null===t.memoizedState&&null!==(r=t.alternate)&&null!==(i=r.memoizedState)&&null!==(n=i.dehydrated)&&ea(n);break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}A||512&t.flags&&vl(t)}catch(e){F(t,t.return,e)}}if(t===e){w=null;break}if(null!==(a=t.sibling)){a.return=t.return,w=a;break}w=t.return}}function Pl(e){for(;null!==w;){var t=w;if(t===e){w=null;break}var r=t.sibling;if(null!==r){r.return=t.return,w=r;break}w=t.return}}function Ml(e){for(;null!==w;){var t=w;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{gl(4,t)}catch(e){F(t,r,e)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var n=t.return;try{i.componentDidMount()}catch(e){F(t,n,e)}}var a=t.return;try{vl(t)}catch(e){F(t,a,e)}break;case 5:var s=t.return;try{vl(t)}catch(e){F(t,s,e)}}}catch(e){F(t,t.return,e)}if(t===e){w=null;break}var o=t.sibling;if(null!==o){o.return=t.return,w=o;break}w=t.return}}function f(){return 0!=(6&P)?m():-1!==Ui?Ui:Ui=m()}function Il(e){return 0==(1&e.mode)?1:0!=(2&P)&&0!==I?I&-I:null!==Br.transition?ji=0===ji?Un():ji:0===(e=x)?void 0===(e=window.event)?16:aa(e.type):e}function Dl(e,t,r,i){if(50<Gi)throw Gi=0,zi=null,Error(N(185));Vn(e,r,i),0!=(2&P)&&e===p||(e===p&&(0==(2&P)&&(Pi|=r),4===D)&&$l(e,I),Rl(e,i),1===r&&0===P&&0==(1&t.mode)&&(Ri=m()+500,Er)&&ds())}function Rl(e,t){var r,i=e.callbackNode,n=(Gn(e,t),Nn(e,e===p?I:0));if(0===n)null!==i&&Fe(i),e.callbackNode=null,e.callbackPriority=0;else if(e.callbackPriority!==(t=n&-n)){if(null!=i&&Fe(i),1===t)0===e.tag?(r=Bl.bind(null,e),Er=!0,hs(r)):hs(Bl.bind(null,e)),dr(function(){0==(6&P)&&ds()}),i=null;else{switch(Wn(n)){case 1:i=Ne;break;case 4:i=Ge;break;case 16:i=ze;break;case 536870912:i=je;break;default:i=ze}i=Zl(i,kl.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function kl(t,e){if(Ui=-1,(ji=0)!=(6&P))throw Error(N(327));var r=t.callbackNode;if(ql()&&t.callbackNode!==r)return null;var i=Nn(t,t===p?I:0);if(0===i)return null;if(0!=(30&i)||0!=(i&t.expiredLanes)||e)e=Hl(t,i);else{e=i;var n=P,a=(P|=2,jl());for(p===t&&I===e||(ki=null,Ri=m()+500,zl(t,e));;)try{for(;null!==M&&!$e();)Wl(M);break}catch(e){Ul(t,e)}Is(),xi.current=a,P=n,e=null!==M?0:(p=null,I=0,D)}if(0!==e){if(1===(e=2===e&&0!==(n=zn(t))?Ol(t,i=n):e))throw r=Ai,zl(t,0),$l(t,i),Rl(t,m()),r;if(6===e)$l(t,i);else{if(n=t.current.alternate,0==(30&i)&&!(e=>{for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var i=0;i<r.length;i++){var n=r[i],a=n.getSnapshot;n=n.value;try{if(!Nt(a(),n))return}catch(e){return}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return 1;t=t.return}t.sibling.return=t.return,t=t.sibling}}return 1})(n)&&1===(e=2===(e=Hl(t,i))&&0!==(a=zn(t))?Ol(t,i=a):e))throw r=Ai,zl(t,0),$l(t,i),Rl(t,m()),r;switch(t.finishedWork=n,t.finishedLanes=i,e){case 0:case 1:throw Error(N(345));case 2:Xl(t,o,ki);break;case 3:if($l(t,i),(130023424&i)===i&&10<(e=Di+500-m())){if(0!==Nn(t,0))break;if(((n=t.suspendedLanes)&i)!==i){f(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=ur(Xl.bind(null,t,o,ki),e)}else Xl(t,o,ki);break;case 4:if($l(t,i),(4194240&i)!==i){for(e=t.eventTimes,n=-1;0<i;){var s=31-We(i),a=1<<s;n<(s=e[s])&&(n=s),i&=~a}i=n,10<(i=((i=m()-i)<120?120:i<480?480:i<1080?1080:i<1920?1920:i<3e3?3e3:i<4320?4320:1960*bi(i/1960))-i)?t.timeoutHandle=ur(Xl.bind(null,t,o,ki),i):Xl(t,o,ki)}break;case 5:Xl(t,o,ki);break;default:throw Error(N(329))}}}return Rl(t,m()),t.callbackNode===r?kl.bind(null,t):null}function Ol(e,t){var r=Ii;return e.current.memoizedState.isDehydrated&&(zl(e,t).flags|=256),2!==(e=Hl(e,t))&&(t=o,o=r,null!==t)&&Fl(t),e}function Fl(e){null===o?o=e:o.push.apply(o,e)}function $l(e,t){for(t=t&~Mi&~Pi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-We(t),i=1<<r;e[r]=-1,t&=~i}}function Bl(e){if(0!=(6&P))throw Error(N(327));ql();var t=Nn(e,0);if(0!=(1&t)){var r,i=Hl(e,t);if(1===(i=0!==e.tag&&2===i&&0!==(r=zn(e))?Ol(e,t=r):i))throw i=Ai,zl(e,0),$l(e,t),Rl(e,m()),i;if(6===i)throw Error(N(345));e.finishedWork=e.current.alternate,e.finishedLanes=t,Xl(e,o,ki)}return Rl(e,m()),null}function Ll(e,t){var r=P;P|=1;try{return e(t)}finally{0===(P=r)&&(Ri=m()+500,Er)&&ds()}}function Nl(e){null!==Li&&0===Li.tag&&0==(6&P)&&ql();var t=P,r=(P|=1,Ti.transition),i=x;try{if(Ti.transition=null,x=1,e)return e()}finally{x=i,Ti.transition=r,0==(6&(P=t))&&ds()}}function Gl(){Ei=Ci.current,h(Ci)}function zl(e,t){e.finishedWork=null,e.finishedLanes=0;var r,i,n,a=e.timeoutHandle;if(-1!==a&&(e.timeoutHandle=-1,cr(a)),null!==M)for(a=M.return;null!==a;){var s=a;switch(gs(s),s.tag){case 1:null!=(s=s.type.childContextTypes)&&ss();break;case 3:Xs(),h(y),h(v),Zs();break;case 5:Ks(s);break;case 4:Xs();break;case 13:case 19:h(b);break;case 10:Ds(s.type._context);break;case 22:case 23:Gl()}a=a.return}if(M=e=ru((p=e).current,null),I=Ei=t,Mi=Pi=wi=D=0,(o=Ii=Ai=null)!==Vr){for(t=0;t<Vr.length;t++)null!==(s=(a=Vr[t]).interleaved)&&(a.interleaved=null,r=s.next,null!==(i=a.pending)&&(n=i.next,i.next=r,s.next=n),a.pending=s);Vr=null}return e}function Ul(e,t){do{var r=M;try{if(Is(),Qr.current=ni,ei){for(var i=S.memoizedState;null!==i;){var n=i.queue;null!==n&&(n.pending=null),i=i.next}ei=!1}if(E=T=S=null,ti=!1,ri=Jr=0,(Si.current=null)===r||null===r.return){D=1,Ai=t,M=null;break}e:{var a=e,s=r.return,o=t;if(t=I,(g=r).flags|=32768,null!==o&&"object"==typeof o&&"function"==typeof o.then){var l,u=o,c=g,h=c.tag,d=(0!=(1&c.mode)||0!==h&&11!==h&&15!==h||((l=c.alternate)?(c.updateQueue=l.updateQueue,c.memoizedState=l.memoizedState,c.lanes=l.lanes):(c.updateQueue=null,c.memoizedState=null)),Ho(s));if(null!==d){d.flags&=-257,Wo(d,s,g,0,t),1&d.mode&&Vo(a,u,t);var p,o=u,f=(t=d).updateQueue;null===f?((p=new Set).add(o),t.updateQueue=p):f.add(o);break e}if(0==(1&t)){Vo(a,u,t),Vl();break e}o=Error(N(426))}else if(L&&1&g.mode){var m=Ho(s);if(null!==m){0==(65536&m.flags)&&(m.flags|=256),Wo(m,s,g,0,t),Cs(Go(o,g));break e}}a=o=Go(o,g),4!==D&&(D=2),null===Ii?Ii=[a]:Ii.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,js(a,Uo(0,o,t));break e;case 1:var g=o,v=a.type,y=a.stateNode;if(0==(128&a.flags)&&("function"==typeof v.getDerivedStateFromError||null!==y&&"function"==typeof y.componentDidCatch&&(null===$i||!$i.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,js(a,jo(a,g,t));break e}}}while(null!==(a=a.return))}Yl(r)}catch(e){t=e,M===r&&null!==r&&(M=r.return);continue}break}while(1)}function jl(){var e=xi.current;return xi.current=ni,null===e?ni:e}function Vl(){0!==D&&3!==D&&2!==D||(D=4),null===p||0==(268435455&wi)&&0==(268435455&Pi)||$l(p,I)}function Hl(t,e){var r=P,i=(P|=2,jl());for(p===t&&I===e||(ki=null,zl(t,e));;)try{for(;null!==M;)Wl(M);break}catch(e){Ul(t,e)}if(Is(),P=r,xi.current=i,null!==M)throw Error(N(261));return p=null,I=0,D}function Wl(e){var t=Vi(e.alternate,e,Ei);e.memoizedProps=e.pendingProps,null===t?Yl(e):M=t,Si.current=null}function Yl(e){var t=e;do{var r=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(r=((e,t,r)=>{var i=t.pendingProps;switch(gs(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return d(t),null;case 1:return k(t.type)&&ss(),d(t),null;case 3:return i=t.stateNode,Xs(),h(y),h(v),Zs(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(Ss(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==$r&&(Fl($r),$r=null))),pi(e,t),d(t),null;case 5:Ks(t);var n,a=Ws(qr.current);if(r=t.type,null!==e&&null!=t.stateNode)fi(e,t,r,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(N(166));return d(t),null}if(e=Ws(Yr.current),Ss(t)){i=t.stateNode,r=t.type;var s,o,l=t.memoizedProps;switch(i[pr]=t,i[fr]=l,e=0!=(1&t.mode),r){case"dialog":c("cancel",i),c("close",i);break;case"iframe":case"object":case"embed":c("load",i);break;case"video":case"audio":for(a=0;a<rr.length;a++)c(rr[a],i);break;case"source":c("error",i);break;case"img":case"image":case"link":c("error",i),c("load",i);break;case"details":c("toggle",i);break;case"input":ln(i,l),c("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!l.multiple},c("invalid",i);break;case"textarea":mn(i,l),c("invalid",i)}for(s in Tn(r,l),a=null,l)l.hasOwnProperty(s)&&(o=l[s],"children"===s?"string"==typeof o?i.textContent!==o&&(!0!==l.suppressHydrationWarning&&Ya(i.textContent,o,e),a=["children",o]):"number"==typeof o&&i.textContent!==""+o&&(!0!==l.suppressHydrationWarning&&Ya(i.textContent,o,e),a=["children",""+o]):U.hasOwnProperty(s)&&null!=o&&"onScroll"===s&&c("scroll",i));switch(r){case"input":nn(i),hn(i,l,!0);break;case"textarea":nn(i),vn(i);break;case"select":case"option":break;default:"function"==typeof l.onClick&&(i.onclick=Xa)}i=a,null!==(t.updateQueue=i)&&(t.flags|=4)}else{s=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===(e="http://www.w3.org/1999/xhtml"===e?yn(r):e)?"script"===r?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=s.createElement(r,{is:i.is}):(e=s.createElement(r),"select"===r&&(s=e,i.multiple?s.multiple=!0:i.size&&(s.size=i.size))):e=s.createElementNS(e,r),e[pr]=t,e[fr]=i,di(e,t,!1,!1),t.stateNode=e;e:{switch(s=En(r,i),r){case"dialog":c("cancel",e),c("close",e),a=i;break;case"iframe":case"object":case"embed":c("load",e),a=i;break;case"video":case"audio":for(a=0;a<rr.length;a++)c(rr[a],e);a=i;break;case"source":c("error",e),a=i;break;case"img":case"image":case"link":c("error",e),c("load",e),a=i;break;case"details":c("toggle",e),a=i;break;case"input":ln(e,i),a=on(e,i),c("invalid",e);break;case"option":a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=g({},i,{value:void 0}),c("invalid",e);break;case"textarea":mn(e,i),a=fn(e,i),c("invalid",e);break;default:a=i}for(l in Tn(r,a),o=a)o.hasOwnProperty(l)&&(n=o[l],"style"===l?Sn(e,n):"dangerouslySetInnerHTML"===l?null!=(n=n?n.__html:void 0)&&he(e,n):"children"===l?"string"==typeof n?"textarea"===r&&""===n||bn(e,n):"number"==typeof n&&bn(e,""+n):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(U.hasOwnProperty(l)?null!=n&&"onScroll"===l&&c("scroll",e):null!=n&&Ki(e,l,n,s)));switch(r){case"input":nn(e),hn(e,i,!1);break;case"textarea":nn(e),vn(e);break;case"option":null!=i.value&&e.setAttribute("value",""+tn(i.value));break;case"select":e.multiple=!!i.multiple,null!=(l=i.value)?pn(e,!!i.multiple,l,!1):null!=i.defaultValue&&pn(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=Xa)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return d(t),null;case 6:if(e&&null!=t.stateNode)mi(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(N(166));if(r=Ws(qr.current),Ws(Yr.current),Ss(t)){if(i=t.stateNode,r=t.memoizedProps,i[pr]=t,(l=i.nodeValue!==r)&&null!==(e=Fr))switch(e.tag){case 3:Ya(i.nodeValue,r,0!=(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ya(i.nodeValue,r,0!=(1&e.mode))}l&&(t.flags|=4)}else((i=(9===r.nodeType?r:r.ownerDocument).createTextNode(i))[pr]=t).stateNode=i}return d(t),null;case 13:if(h(b),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(L&&null!==_&&0!=(1&t.mode)&&0==(128&t.flags))Ts(),Es(),t.flags|=98560,l=!1;else if(l=Ss(t),null!==i&&null!==i.dehydrated){if(null===e){if(!l)throw Error(N(318));if(!(l=null!==(l=t.memoizedState)?l.dehydrated:null))throw Error(N(317));l[pr]=t}else Es(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;d(t),l=!1}else null!==$r&&(Fl($r),$r=null),l=!0;if(!l)return 65536&t.flags?t:null}return 0!=(128&t.flags)?(t.lanes=r,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!=(1&t.mode))&&(null===e||0!=(1&b.current)?0===D&&(D=3):Vl()),null!==t.updateQueue&&(t.flags|=4),d(t),null);case 4:return Xs(),pi(e,t),null===e&&Na(t.stateNode.containerInfo),d(t),null;case 10:return Ds(t.type._context),d(t),null;case 17:return k(t.type)&&ss(),d(t),null;case 19:if(h(b),null===(l=t.memoizedState));else{if(i=0!=(128&t.flags),null===(s=l.rendering))if(i)dl(l,!1);else{if(0!==D||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Qs(e))){for(t.flags|=128,dl(l,!1),null!==(i=s.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;null!==r;)e=i,(l=r).flags&=14680066,null===(s=l.alternate)?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,l.type=s.type,e=s.dependencies,l.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return R(b,1&b.current|2),t.child}e=e.sibling}null!==l.tail&&m()>Ri&&(t.flags|=128,dl(l,!(i=!0)),t.lanes=4194304)}else{if(!i)if(null!==(e=Qs(s))){if(t.flags|=128,i=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),dl(l,!0),null===l.tail&&"hidden"===l.tailMode&&!s.alternate&&!L)return d(t),null}else 2*m()-l.renderingStartTime>Ri&&1073741824!==r&&(t.flags|=128,dl(l,!(i=!0)),t.lanes=4194304);l.isBackwards?(s.sibling=t.child,t.child=s):(null!==(r=l.last)?r.sibling=s:t.child=s,l.last=s)}if(null!==l.tail)return t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=m(),t.sibling=null,r=b.current,R(b,i?1&r|2:1&r),t}return d(t),null;case 22:case 23:return Gl(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!=(1&t.mode)?0!=(1073741824&Ei)&&(d(t),6&t.subtreeFlags)&&(t.flags|=8192):d(t),null;case 24:case 25:return null}throw Error(N(156,t.tag))})(r,t,Ei)))return void(M=r)}else{if(null!==(r=((e,t)=>{switch(gs(t),t.tag){case 1:return k(t.type)&&ss(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),h(y),h(v),Zs(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ks(t),null;case 13:if(h(b),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(N(340));Es()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return h(b),null;case 4:return Xs(),null;case 10:return Ds(t.type._context),null;case 22:case 23:return Gl(),null;default:return null}})(r,t)))return r.flags&=32767,void(M=r);if(null===e)return D=6,void(M=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(M=t)}while(M=t=e,null!==t);0===D&&(D=5)}function Xl(e,t,r){var i=x,n=Ti.transition;try{Ti.transition=null,x=1;for(var a=e,s=t,o=r,l=i;ql(),null!==Li;);if(0!=(6&P))throw Error(N(327));o=a.finishedWork;var u=a.finishedLanes;if(null!==o){if(a.finishedWork=null,a.finishedLanes=0,o===a.current)throw Error(N(177));a.callbackNode=null,a.callbackPriority=0;var c,h,d=o.lanes|o.childLanes;if(((e,t)=>{var r=e.pendingLanes&~t,i=(e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements,e.eventTimes);for(e=e.expirationTimes;0<r;){var n=31-We(r),a=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~a}})(a,d),a===p&&(M=p=null,I=0),0==(2064&o.subtreeFlags)&&0==(2064&o.flags)||Bi||(Bi=!0,Zl(ze,function(){return ql(),null})),d=0!=(15990&o.flags),0!=(15990&o.subtreeFlags)||d?(d=Ti.transition,Ti.transition=null,c=x,x=1,h=P,P|=4,Si.current=null,((e,t)=>{if(or=ot,Ia(e=Ma())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:if((a=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection())&&0!==a.rangeCount){var r=a.anchorNode,i=a.anchorOffset,n=a.focusNode,a=a.focusOffset;try{r.nodeType,n.nodeType}catch(e){r=null;break e}var s,o=0,l=-1,u=-1,c=0,h=0,d=e,p=null;t:for(;;){for(;d!==r||0!==i&&3!==d.nodeType||(l=o+i),d!==n||0!==a&&3!==d.nodeType||(u=o+a),3===d.nodeType&&(o+=d.nodeValue.length),null!==(s=d.firstChild);)p=d,d=s;for(;;){if(d===e)break t;if(p===r&&++c===i&&(l=o),p===n&&++h===a&&(u=o),null!==(s=d.nextSibling))break;p=(d=p).parentNode}d=s}r=-1===l||-1===u?null:{start:l,end:u}}else r=null;r=r||{start:0,end:0}}else r=null;for(ot=!(lr={focusedElem:e,selectionRange:r}),w=t;null!==w;)if(e=(t=w).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,w=e;else for(;null!==w;){t=w;try{var f,m,g,v,y=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:break;case 1:null!==y&&(f=y.memoizedProps,m=y.memoizedState,v=(g=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?f:Oo(t.type,f),m),g.__reactInternalSnapshotBeforeUpdate=v);break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(e){F(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,w=e;break}w=t.return}y=yi,yi=!1})(a,o),El(o,a),Da(lr),ot=!!or,lr=or=null,Al(a.current=o),Be(),P=h,x=c,Ti.transition=d):a.current=o,Bi&&(Bi=!1,Li=a,Ni=u),0===(d=a.pendingLanes)&&($i=null),(e=>{if(He&&"function"==typeof He.onCommitFiberRoot)try{He.onCommitFiberRoot(Ve,e,void 0,128==(128&e.current.flags))}catch(e){}})(o.stateNode),Rl(a,m()),null!==s)for(l=a.onRecoverableError,o=0;o<s.length;o++)l((u=s[o]).value,{componentStack:u.stack,digest:u.digest});if(Oi)throw Oi=!1,a=Fi,Fi=null,a;0!=(1&Ni)&&0!==a.tag&&ql(),0!=(1&(d=a.pendingLanes))?a===zi?Gi++:(Gi=0,zi=a):Gi=0,ds()}}finally{Ti.transition=n,x=i}return null}function ql(){if(null!==Li){var e=Wn(Ni),t=Ti.transition,r=x;try{if(Ti.transition=null,x=e<16?16:e,null===Li)var i=!1;else{if(e=Li,Li=null,(Ni=0)!=(6&P))throw Error(N(331));var n=P;for(P|=4,w=e.current;null!==w;){var a=w,s=a.child;if(0!=(16&w.flags)){var o=a.deletions;if(null!==o){for(var l=0;l<o.length;l++){var u=o[l];for(w=u;null!==w;){switch((h=w).tag){case 0:case 11:case 15:ml(8,h,a)}var c=h.child;if(null!==c)c.return=h,w=c;else for(;null!==w;){var h,d=(h=w).sibling,p=h.return;if(!function e(t){var r=t.alternate;null!==r&&(t.alternate=null,e(r)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(r=t.stateNode)&&(delete r[pr],delete r[fr],delete r[gr],delete r[vr],delete r[yr]),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}(h),h===u){w=null;break}if(null!==d){d.return=p,w=d;break}w=p}}}var f=a.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var g=m.sibling}while((m.sibling=null)!==(m=g))}}w=a}}if(0!=(2064&a.subtreeFlags)&&null!==s)s.return=a,w=s;else for(;null!==w;){if(0!=(2048&(a=w).flags))switch(a.tag){case 0:case 11:case 15:ml(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,w=v;break}w=a.return}}var y=e.current;for(w=y;null!==w;){var _=(s=w).child;if(0!=(2064&s.subtreeFlags)&&null!==_)_.return=s,w=_;else for(s=y;null!==w;){if(0!=(2048&(o=w).flags))try{switch(o.tag){case 0:case 11:case 15:gl(9,o)}}catch(e){F(o,o.return,e)}if(o===s){w=null;break}var b=o.sibling;if(null!==b){b.return=o.return,w=b;break}w=o.return}}if(P=n,ds(),He&&"function"==typeof He.onPostCommitFiberRoot)try{He.onPostCommitFiberRoot(Ve,e)}catch(e){}i=!0}return i}finally{x=r,Ti.transition=t}}}function Kl(e,t,r){e=zs(e,t=Uo(0,t=Go(r,t),1),1),t=f(),null!==e&&(Vn(e,1,t),Rl(e,t))}function F(e,t,r){if(3===e.tag)Kl(e,e,r);else for(;null!==t;){if(3===t.tag){Kl(t,e,r);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===$i||!$i.has(i))){t=zs(t,e=jo(t,e=Go(r,e),1),1),e=f(),null!==t&&(Vn(t,1,e),Rl(t,e));break}}t=t.return}}function Ql(e,t){0===t&&(0==(1&e.mode)?t=1:(t=Ke,0==(130023424&(Ke<<=1))&&(Ke=4194304)));var r=f();null!==(e=Bs(e,t))&&(Vn(e,t,r),Rl(e,r))}function Zl(e,t){return Oe(e,t)}function Jl(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function eu(e,t,r,i){return new Jl(e,t,r,i)}function tu(e){return(e=e.prototype)&&e.isReactComponent}function ru(e,t){var r=e.alternate;return null===r?((r=eu(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,(r.alternate=e).alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,r.dependencies=null===(t=e.dependencies)?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function iu(e,t,r,i,n,a){var s=2;if("function"==typeof(i=e))tu(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case Q:return nu(r.children,n,a,t);case Z:n|=s=8;break;case J:return(e=eu(12,r,t,2|n)).elementType=J,e.lanes=a,e;case ie:return(e=eu(13,r,t,n)).elementType=ie,e.lanes=a,e;case ne:return(e=eu(19,r,t,n)).elementType=ne,e.lanes=a,e;case oe:return au(r,n,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case ee:s=10;break e;case te:s=9;break e;case re:s=11;break e;case ae:s=14;break e;case se:s=16,i=null;break e}throw Error(N(130,null==e?e:typeof e,""))}return(t=eu(s,r,t,n)).elementType=e,t.type=i,t.lanes=a,t}function nu(e,t,r,i){return(e=eu(7,e,i,t)).lanes=r,e}function au(e,t,r,i){return(e=eu(22,e,i,t)).elementType=oe,e.lanes=r,e.stateNode={isHidden:!1},e}function su(e,t,r){return(e=eu(6,e,null,t)).lanes=r,e}function ou(e,t,r){return(t=eu(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function lu(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jn(0),this.expirationTimes=jn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jn(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function uu(e,t,r,i,n,a,s,o,l){return e=new lu(e,t,0,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=eu(3,null,null,t),(e.current=a).stateNode=e,a.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ls(a),e}function cu(e){if(!e)return xr;e:{if(On(e=e._reactInternals)!==e||1!==e.tag)throw Error(N(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(k(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}}while(null!==(t=t.return));throw Error(N(171))}if(1===e.tag){var r=e.type;if(k(r))return ls(e,r,t)}return t}function hu(e,t,r,i,n,a,s,o,l){return(e=uu(r,i,!0,e,0,a,0,o,l)).context=cu(null),r=e.current,(a=Gs(i=f(),n=Il(r))).callback=null!=t?t:null,zs(r,a,n),e.current.lanes=n,Vn(e,n,i),Rl(e,i),e}function du(e,t,r,i){var n=t.current,a=f(),s=Il(n);r=cu(r),null===t.context?t.context=r:t.pendingContext=r,(t=Gs(a,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=zs(n,t,s))&&(Dl(e,n,s,a),Us(e,n,s))}function pu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function fu(e,t){var r;null!==(e=e.memoizedState)&&null!==e.dehydrated&&(r=e.retryLane,e.retryLane=0!==r&&r<t?r:t)}function mu(e,t){fu(e,t),(e=e.alternate)&&fu(e,t)}function gu(e){this._internalRoot=e}function vu(e){this._internalRoot=e}function yu(e){return e&&(1===e.nodeType||9===e.nodeType||11===e.nodeType)}function _u(e){return e&&(1===e.nodeType||9===e.nodeType||11===e.nodeType||8===e.nodeType&&" react-mount-point-unstable "===e.nodeValue)}function bu(){}function xu(e,t,r,i,n){var a,s,o=r._reactRootContainer;return o?("function"==typeof n&&(s=n,n=function(){var e=pu(a);s.call(e)}),du(t,a=o,e,n)):a=((e,t,r,i,n)=>{var a,s,o;if(n)return"function"==typeof i&&(a=i,i=function(){var e=pu(s);a.call(e)}),s=hu(t,i,e,0,null,!1,0,"",bu),e._reactRootContainer=s,e[mr]=s.current,Na(8===e.nodeType?e.parentNode:e),Nl(),s;for(;n=e.lastChild;)e.removeChild(n);"function"==typeof i&&(o=i,i=function(){var e=pu(l);o.call(e)});var l=uu(e,0,!1,null,0,!1,0,"",bu);return e._reactRootContainer=l,e[mr]=l.current,Na(8===e.nodeType?e.parentNode:e),Nl(function(){du(t,l,r,i)}),l})(r,t,e,n,i),pu(a)}}function checkDCE(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){}}checkDCE(),reactDom.exports=requireReactDom_production_min();var reactDomExports=reactDom.exports,_dec$1,_dec2$1,_dec3$1,_dec4$1,_dec5$1,_dec6$1,_dec7$1,_dec8$1,_dec9$1,_dec10$1,_dec11$1,_dec12$1,_dec13$1,_dec14$1,_dec15$1,_class$1;let rotateBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAB6NJREFUeF7tm3uMXFUdx7+/M7tVLA2oQWJDamln7r3Lktpmd+6UCjqNjwgRFRVCNJUCBnUjClSMUURJIfEtbkCJxAWVR5BoSTdpfRBc5LHMnQ7SNnXm3JlNVposasQSTUrtzpyf3tlume7cx7k7j93avf9tzu/8Hp/zu79zz2/OEk7xh07x+LEEYCkDTnECXX0F+voG3qqUeDsz1gBijQCvYeA0ECaZ8TcBmoKquVUknq9Ucv/qxtp0FIBlbVytlNpKhH4wBgGs1gzqFQBjBNqd6FU7DxzI/1VzXmyxjgBIpdLrBXAViLYCODO2VydOOAJglERie6k0vr9FXU3T2wrAsjIDSqnrCHRdux0F4TAxDVOiOlwsFl5ql/62AOhfe0FyOlG9uSOBz42U8CIxDy9foYYLhcJ0qyDaAsA0MrsAvrhVZ2LNJ36+VhNbKpXcn2PNmyPcMgAv7VnxHl0nGDgIcIlIFAHex0wvEXM/E51NrAZAtBKAoaOPgQNK0RWtQGgdQHIwy0L8IcxhAnaAMTKteO/ERP5gVHBWcjCrhMgS87tAlA2TbxVCywBM8x0rwNMv+lZ7xoMQGJHSeSIq6KBx08zcAOavh+0mrUBoGYDnuGnal4P5boDO8v4m0L2kMFKs5J6bb+CN8+rbKpEH4cNB+jwIQtFNpUrud3FstgWAZ3DdunXLjx5elkZPz2Sp9NxkHCd0Zc1U+hYQbQ+R3wfqvVDKZ/6tq7NtAHQNtipnpezrmTAcqIfoRilzd+raOekAeIFZqfRWJrovIMhXFPPmcjn/gg4EbQDeey6l86iO0m7ImKn01SAaCbD1mHSdy3T80AJgGJlbCbxVJKY3F4t/+ouO4m7IWEb6YQZd6WeLQZ903dwvovyIBGAY9kUEjAEQ3l4uy861UUq7Nd7XN3i+qoknAbzJx+aj0nWuiPIlEoBlZH7P4PccV0S8Rcr8A1GKuzVumvbtYHzVx94RkeixisVnQzM2FIBl2F9h4I4TlDPKEL1ZKZ+Z6laQYXYsyzZYwSt4p82VI+D6kuvcFTY/EICVtC9gUU/9ZXMVMPgnrpv/9GIA4PlgmvaPwfhMkz+Eh6R0PjEvAKZh7wbw/qDJDL7SdfOPLAYIhjF4MUHs8vGlKF3nvNgATNP+EhjfigiuWK31ZCcmnv37YoBgGvbLfsXwP0ePvnFy8gWvxeb7NL0CpmkPguupvzwqMALfXXLzn4uS68a4mbIfAKEp3UmpzaXKHi8ePQCGYY8S8AFdp4npY6Vy7le68p2Ss1KZLzLxd5rrFa5yXefnWgAMw76RgO/HdHLfstcty+7f//ShmPPaKm4YmS0Ebg6U+WuynL89EsCxI6eXKmfE9oz5h7KcvyH2vDZOCCyEER9vx2uA14VpSh8hvuB3Bvfeq7myVfDBSqUw0caYAlWtX73+zFd7e3dACECp1+T8ukfMTe8/Md82WxdCP4TMVPoHIGpaWWL+aKmc/3U3gg2ykUqlPyKI4tcewqiUzgdn9YYCCKwJhM9K6dyzkAA826aR9rpQQzH8mAZhk5TO8SZueAbUW134pU9lvc11nW/EMNwR0fPPzZxd7eWnGUhqGSB8WUrnhO+b8LNAYMubdks3d4mW0Q4LWSn740x4UMPME9J13j1XLvI0aBr2YZ+Dxj+l67xZw2hXREwzPQKmq8OMMfBO13Weig3AMuwnvclNExU2lSrOeFcijDDS17fpbapW3Ru4hTNtl+XcrX5qIjPAMuzvMXBTcx2g+103F0q9m3BMM3MNmH/qY3OfdJ0NABr2y4adM8pJK5l5Hwv+rZ8cg9/ruvnHo3R0a9w07Z1gXNpoj6Eucd093snW94nMgJntxvbSa12TBsaoLL+2p3Yr0CA7hjFgERLF2XGdw5oeADOzHcy3+COka6XMBXVnu87ETNk3g/BtgKZOX1FNFQoFr4gHPloAksnBDQkhvArqd0SWjNqFrlv4R9ejDTBoGPY4wHfqNGy0ANRfg5CfpRhYFB9G81kAbQDZbLZnaurwUwRs9C+IJycEbQD1LDAzHwLzY0GkGfiZENhWKjlee+qkeGIBmIEQ2S/cI5i3Fcv5P7aTwMxNFHXN/84m5wG0S5adpu7PfOzFBnBsW/QOSJeHGDzC4G2um//RfJxqnJNKbewjUkMEHgJINIxp/fITZX9eADQheBclHoeq3RHWlAxysP55W60OgeAdd0/3k6sp6m/lfpCnc94AvFugXKvdF3WH55jjk159ALDXdZ0dfsHM3CqtrSUSq5h5FaEe+FtC9/CIjm/U6rcEYFa5adj3AviUjrETZGZbVTO3wlYBeH1cHSTEua3eRpl3BjQ6q3ORKW5wUfLt+vZoCwDPWZ2LTFFBaY0zj1GCvlkqOb4HNC0dDUJtAzCr0zDSQ1Q/PtPauM5EyE8Q0z2lcu677dTbdgCec8nkhrN6kOiHEJ9nQOuqSkBQL4NoJzOPrlz5htGxsbFqO4NvSxGMcmjmIrUaJKiLCDTAQCa0sgM5BfxGCIxXqzTe6X+c6EgGREFp/BGmRj2vJhLqULU6feicc8441IlVjgAe5e7/9/iCZMBiQroEYDGtxkL4spQBC0F9MdlcyoDFtBoL4ct/AcSWvV9Ck7m2AAAAAElFTkSuQmCC";function Control(t){let c=t.store,i=reactExports.useRef(),r=reactExports.useRef(),{rootContainer:e,dragContainer:n,onSelectElements:a}=t,[s,o]=reactExports.useState(1),h=t.scale,[l,u]=reactExports.useState([]),[d,p]=reactExports.useState(!1),f=reactExports.useRef(!1),[m,g]=reactExports.useState(!1),v=e=>{if(1===e.length){let[t]=e;var r=c.data.elements.find(e=>e.id===S({target:t}));r&&r.controlUnKeepRatio?p(!1):p(!0)}u(e)};var y=reactExports.useMemo(()=>{let t=[];return document.querySelectorAll("div[data-pixi]").forEach(e=>{e&&"1"===e.style.opacity&&t.push(e)}),t},[s]),_=e=>{e=S(e);syncControlToElement(e,c),c.controlChangeEnd([e])},b=e=>{let t=[];e.events.forEach(e=>{e=S(e);e&&(t.push(e),syncControlToElement(e,c))}),c.controlChangeEnd(t)};let x=e=>{let t=[];e.targets?e.targets.forEach(e=>{e=S({target:e});e&&(t.push(e),syncControlToElement(e,c))}):e.target&&t.push(S(e)),c.controlChangeStart(t)},S=(reactExports.useEffect(()=>{i.current.moveable.controlBox.style.display=l.length?"block":"none";var e=l.map(e=>S({target:e})).filter(e=>e);return!f.current&&a&&a(e),pubsub.subscribe(c.events.VISIBLE_CONTROL,(e,t)=>{var[r]=l.map(e=>S({target:e})).filter(e=>e);void 0===r&&void 0===t.elementId?i.current.moveable.controlBox.style.display="none":r===t.elementId&&(i.current.moveable.controlBox.style.display=t.visible?"block":"none")}),()=>{pubsub.unsubscribe(c.events.VISIBLE_CONTROL)}},[l]),reactExports.useEffect(()=>(pubsub.subscribe(c.events.UPDATE_CONTROL_TARGET,()=>{var e;null!=(e=null==(e=i.current)?void 0:e.moveable)&&e.updateTarget()}),pubsub.subscribe(c.events.UPDATE_CONTROL_LIST,()=>{var e;null!=(e=null==(e=i.current)?void 0:e.moveable)&&e.updateSelectors()}),pubsub.subscribe(c.events.TRIGGER_CONTROL,(e,t)=>{f.current=!0,"string"==typeof t[0]?v(getTargetByIds(t)):v(t)}),pubsub.subscribe(c.events.TRIGGER_CONTROL_NO_CALLBACK,(e,t)=>{f.current=!0,"string"==typeof t[0]?v(getTargetByIds(t)):v(t)}),pubsub.subscribe(c.events.STOP_GROUP_DRAG,(e,t)=>{g(t)}),()=>{pubsub.unsubscribe(c.events.STOP_GROUP_DRAG),pubsub.unsubscribe(c.events.UPDATE_CONTROL_TARGET),pubsub.unsubscribe(c.events.UPDATE_CONTROL_LIST),pubsub.unsubscribe(c.events.TRIGGER_CONTROL),pubsub.unsubscribe(c.events.TRIGGER_CONTROL_NO_CALLBACK)}),[]),reactExports.useEffect(()=>{i.current.moveable.updateTarget()},[t.viewSize]),e=>{var t;return(null==(t=null==(t=e.target)?void 0:t.dataset)?void 0:t.elementid)||(null==(e=null==(t=e.target)?void 0:t.dataset)?void 0:e.maskid)}),T=!0;t.stopControl&&(T=!1),c.cacheControlElementIds=l.map(e=>e?"string"==typeof e?e:S({target:e})||"":"").filter(e=>e);let[E]=l;var C=[...c.data.elements,...c.data.captions].find(e=>e.id===S({target:E}));return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("style",{dangerouslySetInnerHTML:{__html:`
      .moveable-control-box .moveable-rotation { height: calc(25px * var(--zoom));}
      .moveable-control-box .moveable-control { border: 1px solid #3f99f7; background: #fff; border-radius: 1000px; }
      .moveable-control-box .moveable-control[data-direction="s"], .moveable-control-box .moveable-control[data-direction="n"] { width: 24px; margin-left: -12px; height: 8px; margin-top: -4px; }
      .moveable-control-box .moveable-control[data-direction="w"], .moveable-control-box .moveable-control[data-direction="e"] { height: 24px; margin-top: -12px; width: 8px; margin-left: -4px; }
      .moveable-control-box .moveable-line { background: #3f99f7; height: 2px; }
      .moveable-control-box .moveable-rotation .moveable-rotation-control { border: none; background-image: url(${rotateBase64}); background-repeat: no-repeat; background-size: 80%; background-position: center; background-color: #fff; width: 20px; height: 20px; margin-top: -10px; margin-left: -10px; }
      .moveable-control-box .moveable-rotation .moveable-rotation-line { transform: scaleX(2)!important; display: none; }
      `}}),jsxRuntimeExports.jsx(Moveable,{ref:i,rootContainer:e,pinchable:T,draggable:T,resizable:T,keepRatio:d,rotatable:T,origin:T,throttleResize:1,padding:{left:0,top:0,right:0,bottom:0},renderDirections:C&&["text","caption"].includes(C.type)?["nw","ne","se","sw"]:["n","nw","ne","s","se","sw","e","w"],rotationPosition:"bottom",flushSync:reactDomExports.flushSync,zoom:1,target:l,snappable:!0,snapThreshold:5,isDisplaySnapDigit:!1,elementGuidelines:y,snapGap:!0,snapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},onBeforeRotate:e=>{e.setRotation(throttle(e.rotation,5))},throttleRotate:0,onRenderStart:e=>{c.controlElements=[],x(e),o(+new Date)},onRender:e=>{var t=S(e),r=Number(e.target.dataset.scale||1),{left:i,top:n,width:a,height:s}=getSizeFromTarget(e.target),{translatex:e,translatey:o,rotate:l}=parseTransform(e.target.style.transform),i=i+e+a/2,e=n+o+s/2,n=toNum(l*Math.PI/180,2);c.controlElements=[{elementId:t,x:i/h,y:e/h,width:a/h/r,height:s/h/r,rotation:n}],syncControlToElement(t,c),pubsub.publish(c.events.UPDATE_STAGE)},onDrag:e=>{e.target.style.transform=e.transform},onResizeStart:e=>{["nw","ne","se","sw"].includes(e.inputEvent.target.dataset.direction)?p(!0):p(!1)},onResize:e=>{e.target.style.width=e.width+"px",e.target.style.height=e.height+"px",e.target.style.transform=e.drag.transform},onRotate:e=>{e.target.style.transform=e.drag.transform},onDragEnd:_,onRotateEnd:_,onResizeEnd:_,onResizeGroup:e=>{e.events.forEach(e=>{e.target.style.width=e.width+"px",e.target.style.height=e.height+"px",e.target.style.transform=e.drag.transform})},onRotateGroup:e=>{e.events.forEach(e=>{e.target.style.transform=e.drag.transform})},onDragGroup:e=>{e.events.forEach(e=>{e.target.style.transform=e.transform})},onScrollGroup:({scrollContainer:e,direction:t})=>{e.scrollBy(10*t[0],10*t[1])},defaultGroupRotate:0,defaultGroupOrigin:"50% 50%",onClickGroup:e=>{r.current.clickTarget(e.inputEvent,e.inputTarget)},onRenderGroupStart:e=>{x(e),o(+new Date),c.controlElements=[]},onRenderGroup:e=>{let u=[];e.events.forEach(e=>{e.target.style.transform=e.transform;var t,r,i,n,a,s,o=Number(e.target.dataset.scale||1),l=S(e);l&&({left:a,top:s,width:t,height:r}=getSizeFromTarget(e.target),{translatex:e,translatey:i,rotate:n}=parseTransform(e.target.style.transform),a=a+e+t/2,e=s+i+r/2,s=n*Math.PI/180,u.push({elementId:l,x:a/h,y:e/h,width:t/h/o,height:r/h/o,rotation:s}))}),c.controlElements=[...u],c.controlElements.forEach(({elementId:e})=>{syncControlToElement(e,c)}),pubsub.publish(c.events.UPDATE_STAGE)},onDragGroupEnd:b,onRotateGroupEnd:b,onResizeGroupEnd:b}),jsxRuntimeExports.jsx(Selecto$1,{ref:r,rootContainer:e,dragContainer:n,selectableTargets:["div[data-pixi]"],hitRate:0,ratio:0,onDrag:e=>{m&&e.stop()},selectByClick:T,selectFromInside:!1,toggleContinueSelect:["shift"],onDragStart:e=>{if(t.stopControl)e.stop();else{var r=i.current;let t=e.inputEvent.target;("editMask"===c.controlModeType||r.isMoveableElement(t)||l.some(e=>e===t||e.contains(t)))&&e.stop()}},onSelectEnd:e=>{let t=i.current;f.current=!1,v([...e.selected.filter(e=>{let t=!1;return e.dataset.elementid&&"editElement"===c.controlModeType&&(t=!0),(t=e.dataset.maskid&&"editMask"===c.controlModeType?!0:t)&&"1"===e.style.opacity&&"none"!==e.style.display&&"none"!==e.style.pointerEvents})]),e.isDragStart&&(e.inputEvent.preventDefault(),t.waitToChangeTarget().then(()=>{t.dragStart(e.inputEvent)}))}})]})}class Node{constructor(e){__publicField(this,"value"),__publicField(this,"next"),this.value=e}}class Queue{constructor(){__privateAdd2(this,_head,void 0),__privateAdd2(this,_tail,void 0),__privateAdd2(this,_size,void 0),this.clear()}enqueue(e){e=new Node(e);__privateGet2(this,_head)?__privateGet2(this,_tail).next=e:__privateSet2(this,_head,e),__privateSet2(this,_tail,e),__privateWrapper2(this,_size)._++}dequeue(){var e=__privateGet2(this,_head);if(e)return __privateSet2(this,_head,__privateGet2(this,_head).next),__privateWrapper2(this,_size)._--,e.value}peek(){if(__privateGet2(this,_head))return __privateGet2(this,_head).value}clear(){__privateSet2(this,_head,void 0),__privateSet2(this,_tail,void 0),__privateSet2(this,_size,0)}get size(){return __privateGet2(this,_size)}*[Symbol.iterator](){let e=__privateGet2(this,_head);for(;e;)yield e.value,e=e.next}*drain(){for(;__privateGet2(this,_head);)yield this.dequeue()}}function pLimit(a){validateConcurrency(a);let s=new Queue,o=0,l=()=>{o<a&&0<s.size&&(s.dequeue()(),o++)},n=()=>{o--,l()},u=async(e,t,r)=>{var i=(async()=>e(...r))();t(i);try{await 0}catch{}n()};var e=(i,...n)=>new Promise(e=>{var t,r;t=i,e=e,r=n,new Promise(e=>{s.enqueue(e)}).then(u.bind(void 0,t,e,r)),(async()=>{await Promise.resolve(),o<a&&l()})()});return Object.defineProperties(e,{activeCount:{get:()=>o},pendingCount:{get:()=>s.size},clearQueue:{value(){s.clear()}},concurrency:{get:()=>a,set(e){validateConcurrency(e),a=e,queueMicrotask(()=>{for(;o<a&&0<s.size;)l()})}}}),e}function validateConcurrency(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(0<e))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}function _applyDecoratedDescriptor$1(r,i,e,t,n){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(r,i,e)||e},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(r,i,a),null):a}_head=new WeakMap,_tail=new WeakMap,_size=new WeakMap;let ResourceManage=(_dec$1=bindSelf,_dec2$1=bindSelf,_dec3$1=bindSelf,_dec4$1=bindSelf,_dec5$1=bindSelf,_dec6$1=bindSelf,_dec7$1=bindSelf,_dec8$1=bindSelf,_dec9$1=bindSelf,_dec10$1=bindSelf,_dec11$1=bindSelf,_dec12$1=bindSelf,_dec13$1=bindSelf,_dec14$1=bindSelf,_dec15$1=bindSelf,_class$1=class ResourceManage2{set resourceHost(e){this._resourceHost=e}get resourceHost(){return this._resourceHost}constructor(e){this._store=void 0,this._resourceHost="",this.tempData={},this._cacheBolbURL={},this.medias={},this.trackMedias={},this.destroy=()=>{for(var e in this._store=null,this._cacheBolbURL)URL.revokeObjectURL(this._cacheBolbURL[e]),delete this._cacheBolbURL[e]},this._store=e,this.fetchBlob(config.img404)}setTempData(e,t){this.tempData[e]||(this.tempData[e]=t)}getTempData(e){return this.tempData[e]}removeTempData(e){this.tempData[e]&&delete this.tempData[e]}async cacheMedia(t){await mediaLazy(t).then(e=>{this.medias[t]=e})}clearTempData(){for(var e in this.tempData)this.tempData[e].destroy&&this.tempData[e].destroy(),delete this.tempData[e]}get img404(){return this._cacheBolbURL[config.img404]}removeTrackMedias(i,n){if(!n)return!1;let a=0,s=(e,r)=>{e.forEach(e=>{(r=r||e.trackIndex)===i&&e.resourceId===n&&a++;var t=e.children;t&&s(t,e.trackIndex)})};var e;return s(this._store.data.elements),1<=a&&((e=this.trackMedias[i+"_"+n]).target&&(e.target.onwaiting=null,e.target.oncanplay=null,e.target.remove()),delete this.trackMedias[i+"_"+n],!0)}removeUnuesdCache(){var e=this.getUsedResource();return null!=e&&e.forEach(e=>{this._cacheBolbURL[e.id]||(URL.revokeObjectURL(this._cacheBolbURL[e.id]),delete this._cacheBolbURL[e.id])}),e}getBlobURLBySourceId(e){e=this.getResouceById(e);return e?this._cacheBolbURL[this._resourceHost+e.url]||this._resourceHost+e.url:null}getCacheItemBySourceId(e){e=this.getResouceById(e);return e?{resource:e,url:/^http/.test(e.url)?e.url:this.resourceHost+e.url,bolbURL:this._cacheBolbURL[e.url]}:null}fetchBlob(l,u){return new Promise(o=>{var e=this._cacheBolbURL[l];if(e){if("loading"!==e)return u&&u(1),o(e)}else{this._cacheBolbURL[l]="loading";let e=l;/^http/.test(l)||(e=this.resourceHost+l),fetch(e).then(s=>{var t;if(s.ok){let r=Number(s.headers.get("content-length")),i=0,e=null==(t=s.body)?void 0:t.getReader(),n=[],a=()=>{null!=e&&e.read().then(async({done:e,value:t})=>{e?(e=new Blob(n,{type:s.headers.get("content-type")}),e=URL.createObjectURL(e),this._cacheBolbURL[l]=e,u&&u(1),o(e)):(i+=t.length,n.push(t),e=i/r,u&&e<=1&&u(e),a())})};a()}}).catch(e=>{})}})}async loadUsedResource(o,l,e){var t=this.getUsedResource();if(t){let n=pLimit(e||10),a=[],s=0;o(0),t.forEach(r=>{let e=l?!0:!1,t=(r.mustFetch&&(e=!0),r.url),i=getFileTypeFromFileName(t=/^http/.test(t)?t:this.resourceHost+t)||"";e?a.push(n(()=>this.fetchBlob(t,e=>{var t;null!=(t=this._store)&&t.onEachSourceProgress&&this._store.onEachSourceProgress({src:r.url,p:e,total:a.length})}).then(async e=>{var t;return["video","audio"].includes(i)&&(t=await mediaLazy(e,0,i),this.medias[r.url]&&this.medias[r.url].remove(),this.medias[r.url]=t),s++,o(s/a.length),e}).catch(e=>{window.nodeConsole&&window.nodeConsole("资源加载异常",e)}))):["video","audio"].includes(getFileTypeFromFileName(r.url)||"")&&a.push(n(()=>mediaLazy(t,0,i).then(e=>(this.medias[r.url]&&this.medias[r.url].remove(),this.medias[r.url]=e,s++,o(s/a.length),e))))}),await Promise.all(a)}}getResouceById(t){var e;return null==(e=this._store)?void 0:e.data.resouces.find(e=>e.id===t)}async getTextureById(e){return Assets.load(e)}getCacheBlobURLById(t,e){var r=this.getResouceById(t);if(r){if(["video","audio"].includes(r.type)){var i=e+"_"+r.id;if(!this.trackMedias[i]){var n=this.medias[r.url];if(!n)return this.trackMedias[i];var n=n.cloneNode(),a=()=>{},s=()=>{};n&&(n.onwaiting=a,n.oncanplay=s,n.className="_resource_media_"+this._store.movieId,n.crossOrigin="anonymous",n.style.width="1px",n.style.overflow="hidden",n.style.display="inline-block",n.style.height="1px",n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.opacity="0",n.setAttribute("playsinline",""),n.setAttribute("webkit-playsinline",""),n.setAttribute("x5-video-player-type","h5"),n.setAttribute("x5-video-player-fullscreen","false"),n.setAttribute("data-id",t),n.setAttribute("data-key",i),document.body.appendChild(n)),this.trackMedias[i]={target:n,src:r.url,trackIndex:e,waitingFun:a,canplayFun:s}}return this.trackMedias[i]}{t=this._cacheBolbURL[r.url];let e=null==r?void 0:r.url;return/^http/.test(e)||(e=this.resourceHost+e),t||e}}return this.img404}getUsedResource(){let r=[];if(!this._store.data)throw new Error("必须在store设置data之后调用getUsedResource");if(this._store.data.elements.forEach(e=>{var{resourceId:e,mask:t}=e;e&&r.push(e),t&&r.push(t.resourceId)}),0===r.length)return null;r=[...new Set(r)];let e=[];return this._store.data.resouces.forEach(t=>{r.find(e=>e===t.id)&&e.push(t)}),e}},_applyDecoratedDescriptor$1(_class$1.prototype,"setTempData",[_dec$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"setTempData"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getTempData",[_dec2$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getTempData"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"removeTempData",[_dec3$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"removeTempData"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"cacheMedia",[_dec4$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"cacheMedia"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"clearTempData",[_dec5$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"clearTempData"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"removeTrackMedias",[_dec6$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"removeTrackMedias"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"removeUnuesdCache",[_dec7$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"removeUnuesdCache"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getBlobURLBySourceId",[_dec8$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getBlobURLBySourceId"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getCacheItemBySourceId",[_dec9$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getCacheItemBySourceId"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"fetchBlob",[_dec10$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"fetchBlob"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"loadUsedResource",[_dec11$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"loadUsedResource"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getResouceById",[_dec12$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getResouceById"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getTextureById",[_dec13$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getTextureById"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getCacheBlobURLById",[_dec14$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getCacheBlobURLById"),_class$1.prototype),_applyDecoratedDescriptor$1(_class$1.prototype,"getUsedResource",[_dec15$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"getUsedResource"),_class$1.prototype),_class$1);class EventsName{constructor(e){this._id=createID(),e&&(this._id=e)}get UPDATE_STAGE(){return"update_stage_"+this._id}get VISIBLE_CONTROL(){return"visible_control_"+this._id}get STOP_GROUP_DRAG(){return"stop_group_drag_"+this._id}get SORT_CONTAINER(){return"sort_container_"+this._id}get UPDATE_CONTROL_TARGET(){return"update_control_target_"+this._id}get UPDATE_CONTROL_LIST(){return"update_control_list_"+this._id}get TRIGGER_CONTROL(){return"trigger_control_"+this._id}get TRIGGER_CONTROL_NO_CALLBACK(){return"trigger_control_no_callback"+this._id}get UPDATE_MOVIE(){return"update_movie_"+this._id}get CONTROL_CHANGE_END(){return"control_change_end"+this._id}get CONTROL_CHANGE_START(){return"control_change_start"+this._id}}var undoRedoManager2={exports:{}},undoRedoManager2Exports=((()=>{function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i,t,r;self,undoRedoManager2.exports=((i={d:(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}).r(t={}),i.d(t,{default:()=>r}),r=(()=>{function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.options=Object.assign({limit:50,onChange:function(){}},e||{}),this._stacks=[],this._pointer=-1}return e(t.prototype,[{key:"current",get:function(){return this._stacks[this._pointer]}},{key:"canUndo",get:function(){return 0<this._pointer}},{key:"canRedo",get:function(){return this._pointer<this._stacks.length-1}},{key:"count",get:function(){return this._stacks.length}},{key:"stacks",get:function(){return this._stacks}},{key:"destroy",value:function(){this._stacks=null,this.options=null,this._pointer=null}},{key:"add",value:function(e){return this._stacks.splice(this._pointer+1,this._stacks.length-this._pointer-1),this._stacks.length===this.options.limit?(this._stacks.shift(),this._pointer=this.options.limit-1):this._pointer++,this._stacks.push(e),this.options.onChange(this),this.current}},{key:"undo",value:function(){if(this.canUndo)return this._pointer--,this.options.onChange(this),this.current}},{key:"redo",value:function(){if(this.canRedo)return this._pointer++,this.options.onChange(this),this.current}}]),t})(),t)})(),undoRedoManager2.exports);let UndoRedoManager=getDefaultExportFromCjs(undoRedoManager2Exports);function RecordManager(r){let i=reactExports.useRef(),n=r.store;return reactExports.useEffect(()=>{i.current=new UndoRedoManager({limit:30});var e=e=>{i.current.add({id:createID(),type:"global",desc:e.desc,selecteds:e.selecteds,mdata:toJS(r.store.data)})};let t=(e,t)=>!!e&&(e.mdata&&objectCopyValue(e.mdata,n.data),n.update(),n.triggerRecordSelectElements&&n.triggerRecordSelectElements([...e.selecteds||[]]),!0);return n.record={add:e,redo:()=>{var e=i.current.redo();t(e)},undo:()=>{var e=i.current.undo();t(e)},debounceAdd:debounce$1(e,500),manager:i.current},()=>{i.current.destroy()}},[]),null}function filterData(i){if(i.version||(i.version="1.1.0"),!Array.isArray(i.captions)){let{style:t,textStyle:r,texts:e}=i.captions;e.forEach(e=>{e.textStyle=toJS(r||{}),e.style=toJS(t||{})}),i.captions=e}return i}let Watermark=i=>(reactExports.useEffect(()=>{var e=new Image,e=(e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAACgCAYAAAAisjrVAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDA2IDc5LjE2NDc1MywgMjAyMS8wMi8xNS0xMTo1MjoxMyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkY1Mzk0QjVBMzYwMDExRjA4MTQwREFENUM5QUVFRjY5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkY1Mzk0QjVCMzYwMDExRjA4MTQwREFENUM5QUVFRjY5Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjUzOTRCNTgzNjAwMTFGMDgxNDBEQUQ1QzlBRUVGNjkiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjUzOTRCNTkzNjAwMTFGMDgxNDBEQUQ1QzlBRUVGNjkiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5LCTLwAAAZfklEQVR42uydTWwURxbH28SAAYMntkU8FgEHkLEXli/BCmF2Fy6OhEIkBCcuKCDlGCFySFAOUS7JIcq3comESHLgQiIkglC4QEQwm5WRAS8JxEKs7Tj2LLGNDQbbYDPbD2qiYaaq+quq+mP+P6kPHts91dVV9a9X9eq9smw2awEAAABemYEqAAAAAAEBAAAAAQEAAAABAQAAAAEBAAAAICAAAAAgIAAAACAgAAAAICAAAAAgIAAAAAAEBAAAAAQEAAAABAQAAAAEBAAAAAQEAAAAgIAAAACAgAAAAICAAAAAgIAAAACAgAAAAAAQEAAAABAQAAAAEBAAAAAQEAAAABAQAAAAAAICAAAAAgIAAAACAgAAAAICAAAAAgIAAABAQAAAAOilnPdhWVkZagYAAGJINpsNV0AAACDmqJwFZ0uobBAQdBJMwlAFJUmNfVXlXaoYs6/RvGsyQmWbKCjbPaMDEM/c8bmEhcHMzICmqyEmCRUdHm0+XmK+1L4WG/ieKfvqsq9bESwb0WWP6f1xEJBn7CuFwcwV+YPZUAw6SZKgDt9nX90Q8Fi3/aj1i19cikgYZTMmIn4FpNq+Gu2rAv3DM732dRPiYZwRNnO8DwGPXdt3EvS/hjQxaXewbsMqG9Fuj+3al7P8uPGSeKyGePhmMRNfr50EA1cwyFreYF9zIR6htv2liu/5XEjPUu7CAq0Jsa6NWMdeBeQZH4MfKKbevuqi1hhKAGrva+1rFgQ8VBEJOrCW5V1h9o3agrIUXrVhCkhZHjpV1KuqwfJQJyIZCIhxZrFJ0FUIeKizY6/7Ia73nvbu3Vvx5ZdfblJV2Nu3b49VV1df5PxqIbtcs2XLlvIff/xxi6qy3bt3b6KysvIngWX2p3Vma8ife1HZbFbZXpQfAQFqWMBmKU5eKsJZlt0QtqIa+R3+zJkzfbt3785IZo41HgYxtHv1AuLFamz0YrF/9dVXEx999NHYs88+W6misHQfEiW6b9B7HThwQKlV0tXVNeihzquYmPTaY4eSvSglAjIwMLC2rq4uhX7B58MPP7z8+uuvj3B+RXV2GzWkFurwu3btarp27Vqqubn5umRG60ZAIOABsAerHwTjiJvJE4mHr32r9vb2TGtr63JVz7Fnz55aW0D6gt5n5cqVSsfJY8eOZXz822L7vZTb7bcr6PcjFhZILE1NTXUdHR3LYVXElkbLp9PD0aNHB1UWZOPGjXUq7rNs2TJlFggtX7333ntjPv+93haRwM8EAQGJZt26dYto3Znzq3n2NRM1FFlobPI9wNFyEy1lqrRqaRkryD0OHz5cO3PmTGXRPzwsXwlFBAICgAM7d+4UrYVXonYiS2ALkZaxVBaIlrGC/P/mzZuV7n/4XL7KZ0FQDy3EwgJ/cuHChW7e52vWrKmbN29ehYnvq66urqClJ7yNkoe7V9DW1tZgD8QNYRSI9lSy2ezyqFTQu+++u8G+XP2trn1YrwIyynux9kvNpNPpkSCV0dzcXKvKa6IQWiu8cuVKJqwX3dnZKfLemIhSj21paeEKyMDAQEqHgIi+b3h4uFJXW/BBlrX7Kl6nxDjvi1ELAS8TgR8BKULiLumasbExbbNOWisUDVYhQiEQxtEEORUzOTkVwQGvSEAEMzrgcxwB8WOGjxf/QHUhaHNKxww3x6VLl0bQiQDeFeoThCsg0/alPMrjjh07tJ4hOXLkSBQFpB/NLzbQeZFeVIMSei19UXmBYfxsondbT05RV6sqhOrDNfmQK9/58+ejtiRCp0Cx/BEvbrL+Uo+qCDRpcnsCmvrHksIPv/jii8xPP/2EvuOR48ePi1yaA7k6+/XC6rSvBtaZZgV9OJWHa4rUrrs7So3tFutE6ADxhE7u3mHtfgGqwzV3WLv3slfKXeZi4UQmUKVKuJfNZh+GISA5S4SuOdYTzyw3exhFM4pDhw5VqjxcU8jZs2dFh216DL6oEdYhHqHNxp4Mu8osgaspKGr7fjyuHrEJ10JUoTYC70WpGLjHLXfeRNxw2Fu3btXaCSWeMjQjmkQbAj6hQRFxzPTSzxMQmnS+9tpry6Nc8JGRkYlTp05l/HrqffPNN3UtLS1KPFPT6fRlSf2GLiBu4S5TrVixQpuAZDKZEYlJDfEAINpwT0nX1taWRz14q12+x7HYtm3b1rd+/fobPgb9CgPPGDhjoSkBoURU3DXj+vp6bZV08+bNEYlZDQqgqMq8z2tqaiqT8H0AmIZisbW1tU1F8ByaEkwJCFckPvjgg5TO/Y+TJ0+K9j/gh86fNaWS/H0AhMHGjRsXWU/2iyEgPuEGRtu0aZO2AeThw4dTklDHsEAAAEagSTJNlmk/xE3uJEEOlZIWEO7+x9KlS7UJSH9/v0gkhq0nByIBACWOZJ/08VKqzhUSWCDumG0JksLoXML49ddfsf8BAJAi8VB6vMR+8ODBtailcAWEu3xFyVV0fukPP/wgEgrsfwiIQjh3nd8HgBdoyckWEFREyALCtTLWrVunzfqQpHp8BAERE5Vw7rq+LwAz2EQIm/7BwaHaEhaQWawj0VXp4X+KaGho0NYZf/vtN9n5jyiYpKN5F/ZjogsJB+XlRoIrdeSiUUQirE82m92KV6JfQGaxjqRk2YlyVOtMGPTzzz+PeLGGQiBXDorpQ4eMBtEUIykeGyzB/h0IzEJ2UXBFRDqOcSdxIx4bVIkH8corr2gdyL/77ru4bJTTMs0q+1qKphg5GiEeRlhqYWkw0QLSaCmIuJuP6uTy+dD+B4vYGScWqxRoEJgaC8tWJkGI/IQKyCwdA9vzzz+vbcZB6WvRiUBAqlAFqG/gTLnpF1ui6WvRiRLwLtra2hpQNcGghFCcFQI6K0ZpIcZNl0fkSp5j8+bNeOeqBaSjo2N5Op32tQk+e/Zsra7DO3fubNi+ffuiKFf6p59+eoPjZkwBJ+fb1100y1ApE7V7DCbBYdkEeUvMFWEIiFOQw2w2i3ceQEC4IkHiEdVAeDq9u1RB4ah9vg8AAIiNgIASgkI3mLQaTX8fAAACAjRhOu4P4gyBsBHlpAEQEAD8QKlqKUJA0T6ILHKrDLKodCytksv63bt3Y+WyPjg4OCX41VQY5UFOGr0CQh2pqILb2toy6XTac2fSGSSPOtOVK1cyhZ/r2vikwUSS8VBKZ2enqNNPoElGAq6AyCK3yqD81rt27WpSXUi7H/a9+OKLfQmobwrnA+eRhApIEbt37874+bIHDx5o844i8eB5VOjyoiDxUJymknK0j6NJRkZAlLFy5Uots1xJxOmSrm9gjhkuXuwDFV906NAhrclZmHsgOhFQwYhKa1DHwVlJxOk40o8ml0wLZJq93MCz+JdeeklbqA5KX0ux+xPaiYRr8rLUl7qWTQr59ttvr8ss0tOnTy9qbW1dHmYZHIRC1O677Gu1iomTjmVbScTpuEGBFEOLHoGDhHoFhKAKXmBf1UG+KKT0tXHhpiUPa80VkDDFg0T77bffvuw0C6Y1+mvXrlU2NTVpiy1Fz2o/s9el1TtMnEVQ6uNO60ksON8CsHXrVi3tXhJxOi5EIhK16YOEfvfRosoMl3/XyYTE93JWSOlrow7lRLhsOYezdr28FSXxyNHc3HzdJqOzTExEvIiUm2UTEpF21v57mMjLriJWrFihpd1LIk47lskQojrqYfXZbiGNQUlYIPmWCF0UsyYlmZUtKfxAdGBMFRHbTOxx2bm8ZGUbYiKzOGzxuH379tj7779/3ev6O4mIbYlYEbFESDzcCto0E5Jhyd9QGJq/835RX1+f0vEOBBGnH7AJSY6/hdgP6Ln/w9ougID8ybgl9hZq5H24bds2reHbI7iZ+F/F96O8FFIPNgr0p3u9lgaul19++fL58+d9+exHSERUnzngioQux5Hu7m6Z9ZFjphV+PpPnICAQkMAdKaT0tUmBBgFK6CVcbrQH5Sadg7IK8TAtIvbgPSaZWOQsuZuKvpK7P6XLcUQScXrQqS8ePny41q575YcaBXsJyHEDAXHNPN6MJ8T0tRAPRdD+BQ38Dn/Wm2d5zZGV24SIvPPOOxSi4rIhEeEO1rocR44cOSJq86NOfbuqqqpch6W6d+9eXph2ev81cbNCTOdJp3AqcT0RP0PhvbizMKSvLRnxoIE4y6779nXRkuzx0D3JqtFVblo6IhGhZSTJny22HPaVXEC5LBbwfqFjUKAICAIrkOp8Mu/nEZP9Zc+ePbVexgWQDFQKCLezrFu3TpuASDYTk0Bj2OJx6dKlPhfi0SWYxTuKCC2JRUBEgubk5g6QuhxHJOFzCj+nfcoir0nqLzrqXOJthmUsCIh/AWlsbNTWgCSbiXEnJRvUTIgHHc5bv379DRfiIXOHlYoIzaQjIiL1qtu9LscRScSFIReioq3fLFmypFZiSc/GUAsBkUH7H7MKP0T6Wt/Uhy0eDl5MJAi/WO7OUsRBRIIssxhzHHGIuMD7fNBkv6ENeg31CyKMqk10bgPZsWOH1v0PyWZi3KkKQzxogPrss8+uuggLQ2cibnm4NYkILYX9RSYiJ06cWKvL4SInIv39/RcV5uQ26jgiibhAp+qnOZ9zD6Du379/cN++fcrrmC1X80Sr1mN7ycH1+KOQ8H5D67tBx70lYexpEz2MYwijWZuoCAh35qErCilBM9agLqURZQ7P5Cdr7tSpUxm6dH0xhZl3uadUyyxOL5EJbrH21igTkZ07d1bG6F0ZdRyRRFwQneieZOI9lzdIqt7kl1hdfr/nLhPGZ/I/JM86+9IWEsR0uBEXS8VaBCRKFgi3geiIQpo3G09qGIRx1vGfEhE2sEfJYYAGzz+8Tu5EApITEfsKw6r0G0rfqOOIJOKCbDCgfrKYM1kYVC0gZHXRRIczCZnF2oufQYv+p9oCiRUQahhFeym6opDmSED4dqeXu9DPP6o+kU6eWIIZkh8BEXosbdq0SdlgNjAwMOExsKLfzmTMcUQSceGRQ/lHRWLU2tqqvOHSsrUtIBnBu/dTz3/wBITC9rS0tNRZoLDtj509e3bQYRmaBF7J+KlKQIrQFYU0RwLCt8vo9ysgqg+vSTZc/QwG3LKReKgUPbaGnfFY314x6jgiibjg1A9GmMg8NckjMXrrrbcmVJd1w4YNtYK6p897fdySW750Ol2BdLTFUJ3YFvCi7du3y85v3clms9Mqvk+FFxb3JeqKQkr09PQkPYondfqbfhuQyoKcO3dOtMGXlGRGTqH0PU2cdDmOSCIuOPWFadHz6QgDJAkeSYct4c5rCHK26ejoEOXhUWYhBxWQZ0QCoiMKaY4Yh2/3As3WaDOPNp8n3fyD6sNrtGwi2FSPe/rdSct9KH3LSyfU5TgiOUHuxhIc9ChKviFvN0k7hDuvQcgSIYuYN+6XlZXNj4KApCzB/ofO9LUJygXtxhKh8xb/sq9/29cVdnEHPZX7CA4z1NEY1+e/WX3+YgVbBzbmOOIQvv2ei1tw39fHH3+sxZKXHKLEkpNhJCFmlLyLoIO88f0POquQoFzQXsgPo/8C7w9U73/09vaK6vluzOvRUtDujTmOuAzfLjUmmdg8tWdDXm8kTqrPrEjceWkw6/J4O67nITlKuD2voXJZl8afoaEhLeOPjj2dysrKck1jv5KbcB949erV2sKXJCB9bVBo2dBI8D6JpVfq78DoxMll+PZ8yvL6Zoq1mfsWZ9OfxEm1gND96DAl55yWH3de7rMzLztHRwlaTjt48OBaVc924sSJGx49/FxjIiGcaoIsYRmNQprj4sWLpZ4GMyXqKIYsvUcxt0C0vQNdjiOSiAsP7SvNLFIaeGig3GJf/7SvNeyiDKGLRGUml08dZT5w4ICqsCbcoJBu2bNnT4PKPqFLPIienp7YBYYNIiBGo5DmSHD49kD1rnr/Q2Km34EFyD/YpsNxRBK+3WICsYKJRB0TCU+rCuQOTwOj6nJLnAn81JEfN+vHY5HKyWx7e3ufBZQJSMrEQJaPxCvoQQm9MyPJiyRhw0dLvM8YTV8reQ/K0LEsvGzZMpEFUm0VhCZxQbclz0lvxPp44403ICC6BaS5uVnb/keAw1RJmv0aWTaUnPQvdQExmr7WRMQFHW7xJKaS6Md+2monExJXk0XV1sfVq1czCY29Fwi/Myba/zCevvbChQuDEgFZWALvy8j+R25pAwISngWYm/XqiLhAZwNWr15dsWrVqkry0tE16SNRFeyj+U1zSwLyGxPx3JXSbX0Qn3zySZ/iyWsiXJr9Ckgo6Wtd5oKOAi84/D4Xi2ZcRb2rXjaU5Oagz6et0sWo40iQpaXcpILaxpw5c8rT6XTl/Pnztebn8SCqQeqK2t8w6/MbTVgflNZZEqX6vz7Gn2dLXUC4Mxbd6WsluaDvR6hOl3j4WzLH+9nMKjKzX8m5g1K2PmjtvtGUBUjIlpbI2qfQ90uWLKmguFDV1dUVqVSqoqamRushXi/QIC5w56XVC4oldi/A7anOK0xYH19//bXI+hj00Seo3OmkdIryAC+vCB1Z2FwManHe/yC/+AY2q+10+Ftj+x+KAygmgXpLEoZeV/ravr6+CRKn3FJTbqIQpyCCtCphC8igwJoOIiDPm7A+yAtOcnB5wOPtKKz+0iR1DD8CIoxCqnP/Q+KvnoQN9GomJN1eRVvH7FcSQLEUz39UysRD58Rp3759q+JeeZs3b661xFkK+33etsYytPdx9OjRbsm442UfJ5U08fArIKGkry2BTV2a5dIG4bSXele9/5HgAIpB3osQ3Y4jOqF3fffu3QnKITE+Pj5FFo5q60YSGyx3Qt7PnhrX+qBJrMry07K5ZNzpU9mOSklAuC9IZ/paScybO2xgK0vAu8iFeRj2Uu+q9z8SGEAxKNKT07odR1SLBLkFU35u3rLM6dOnF6kWENq0J3dezvfNYG3aqzeW0Pp48803lVofZ86cEYkETbBue7gVPWsivUT9CEitx5lGYCSHqUJbvqKBm7L/+flfScY8kYAY2/9IaABFv8y0nizZFlkdx44dWxWVDWsvIuGwXDPY2tq6XHX5KEaYoCxVPgREaH1QDgyVdSoJW9Lt0XKqEpWZ3KlzP9NeV9IFhBuFVFcWthwnT54cjNqsmAZuv4O3JGNelRfrQ8f+BwIoPsVDNtt8qm2TVxG5xJoUD1UiIYOWLj///HPlWQpZcNU+wWTUS+I0Y9bH999/3y341ZRH60PYf1999dU6lZk44yIgRUhizgfvwfLw7aUyqBnZ/0AAReEkpWhApaU+lTNeUyLhhI7nkky0vLrzGrE+qB9IcqWQEE5awJeAGE9fKzlMNWyVzqE2I/sfkrou5QCWJCDPFX5I2fz8DFq0MTs5OTmVW5YNQyRkULQH1QJCHD58uHb//v1B3HnnmrI+KGiiJGzJH5ANxRZISOlrS2VQIwcBI/sfv//+O/Y/+AJSBM1Qd+3a5SgSY2NjU1evXh3r7OyckJxmjgwU7WHfvn3K78sOGYsExI07b5UJ64OQBE3st4KdXSlpAaEcukVRNHWnr6WNPS8du1SsDx37H5LAfaVsgQiz+VGIi+Hh4YmIi8QEu3JhaOhdTrGfN1oFMe10ZSlsbGykZe4bboXB7d+ptj7onUqsj/9BMgpmt9lstvjDMq5XLHmktBR+mAupoKuAAj9sWpM/VzjJ4TUy3flJ/CBZsuixnsTWKbRA/hlykc+xOg8KxQBaE+Jz8OrX1fhnRduPXyYS2Yg/Fw3K11z8HYX/WKG7fx8/flwUMomcXq6rbPeFXlg6kExqrthj/+2g9/ciIBabscyLQIe5ZV+/FHxGpzwXx1zQKZwJz413vSVYxjIAnbXpUHQv8uD7RwTr1wny/vlrTEVCBp1N+EvIz0U50t0sYZGl9LcQy/kfy18E4Si0e+6k0B77A08KvS49jUZEQP4nKFucmZA8Q3+IAtKv8F6P2EyuLmL168QQG7BTBsqoWiSc+vOU5T8mnqoyuOE+m8yE0Q+8hi3htftbVnQOE95SIR5+BKQ/AiZvr+BlDrHfxdUKuWGJvcoyrOOYrvt+i39eJeiMc4HFySdjYKY7HfD/N1jBkrBZTAym8gZO3SIhY5I9V1hWCH33PY/tcUFIfVNFX4qKgCibFHpdwrIsh8ikBh68y+Fvor5eLRJFNweqTC7TuS2TX5O+0ZAlMsHazLCCe81l5XayRPJFIicOOesiG8H2t5A9l0lLxO3SVdj92285eUQhGu9Ne8zvDVNAiEr2EmnT2sSS1h2Ps+E6Vr4FVnSZZgMMPdegh/+rsZ7OyKZ6OSF3DRmoA13Pkv8cI5b680Jz88o8GRORcGJ2wbtQ7RgzUfBegrjD6u7f9/L6purzOam8sXO2QUvz8fPY471Sj0q/ApLPTA2NLZ+RAB2yzIpm5i8acFScrVAdRDLMga8sIc+RFOLQtnT0bxKMh4bqeI4lSIqlUrjtMV5bFG0VAgIAACAi8MZ0XcxAdQMAAPBDedgKBgAAIJ7AAgEAAAABAQAAAAEBAAAAAQEAAAABAQAAACAgAAAAICAAAAAgIAAAACAgAAAAICAAAAAABAQAAAAEBAAAAAQEAAAABAQAAAAEBAAAAICAAAAAgIAAAACAgAAAAICAAAAAgIAAAAAAEBAAAAAQEAAAABAQAAAAEBAAAAAQEAAAAAACAgAAAAICAAAAAgIAAAACAgAAAAICAAAAQEAAAABAQAAAAEBAAAAAQEAAAABAQAAAAADP/F+AAQCbO0xKoApBBwAAAABJRU5ErkJggg==",Texture.from(e));let t=new Sprite(e);t.name="watermark",t.zIndex=99999999;var[e,r]=i.size;return t.width=e/5,t.height=160*t.width/400,t.x=e-t.width-10,t.y=r-t.height-10,i.parent.addChild(t),()=>{t.destroy({texture:!0,baseTexture:!0})}},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})),EModule=(window.EModuleEffectSourcePath="https://cdn.h5ds.com/assets/effectcanvas/",(()=>{let a={};function s(e){var t,e=a[e];return e.loaded||(t=e.dependencies.map(e=>s(e)),e.exports=e.factory.apply(null,t),e.loaded=!0),e.exports}return{define:function(e,t,r){2===arguments.length&&(r=t,t=[]),a[e]={name:e,dependencies:t,factory:r,exports:null,loaded:!1}},require:s,import:function(i){e=window.EModuleEffectSourcePath,t=(t=[i]).join("/");let n=e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"");var e,t;return new Promise((e,t)=>{var r;a[i]?e(s(i)):(r=document.createElement("script"),window.EModuleEffectSourcePathDEV?r.src=n+".js":r.src=n+".txt",r.onload=()=>{setTimeout(()=>{a[i]?e(s(i)):t(new Error(`Module ${i} not defined`))},0)},r.onerror=()=>t(new Error("Failed to load "+i)),document.head.appendChild(r))})}}})());function Movie(m,e){let{env:g,data:t,target:r,currentTime:i,triggerCurrentTime:n,onSourceProgress:a,onEachSourceProgress:s,triggerRecordSelectElements:o,fetchSourceBeforeRender:l,onPause:u,scale:v=1,registerId:c,times:h,workerPath:d="worker/decode.worker.js",movieId:p="movieId",resourceHost:f="",EModuleEffectSourcePath:y="/assets/effectcanvas/"}=m,[_,b]=(window.EModuleEffectSourcePath=y,reactExports.useState(0)),[x,S]=reactExports.useState(!1),[T,E]=reactExports.useState(!1),[C,A]=reactExports.useState(1),[,w]=reactExports.useReducer(e=>e+1,0);var P=reactExports.useRef();P.current||(P.current=new Store,o&&(P.current.triggerRecordSelectElements=o),P.current.movieId=p,P.current.workerPath=d,s&&(P.current.onEachSourceProgress=s),P.current.events=new EventsName(P.current.movieId),P.current.resourceManage=new ResourceManage(P.current));let M=P.current,I=(reactExports.useImperativeHandle(e,()=>M),"export"!==g&&(M.currentTime=i||0),h&&(M.times=h),M.onPause=u||null,n&&!M.triggerCurrentTime&&(M.triggerCurrentTime=n),reactExports.useCallback(async()=>{filterData(t),M.data=t,M.env=g,m.initSuccess&&m.initSuccess(),m.onControlChangeEnd&&(M.onControlChangeEnd=m.onControlChangeEnd),f&&(M.resourceManage.resourceHost=f),await M.resourceManage.loadUsedResource(e=>{b(100*e),a&&a(e)},!!l,10),S(!0),setTimeout(()=>{E(!0)},500)},[]));if(reactExports.useEffect(()=>(I(),pubsub.subscribe(M.events.UPDATE_MOVIE,()=>{w()}),pubsub.subscribe(M.events.SORT_CONTAINER,()=>{A(+new Date)}),()=>{document.querySelectorAll("._resource_media_"+m.movieId).forEach(e=>{e.remove()}),M.pause(),M.destroy(),pubsub.unsubscribe(M.events.SORT_CONTAINER),pubsub.unsubscribe(M.events.UPDATE_MOVIE)}),[m.movieId]),!c)return jsxRuntimeExports.jsx("div",{style:{color:"red"},children:"必须填写注册ID，注册ID可通过https://video.h5ds.com进行申请"});if(!x)return jsxRuntimeExports.jsxs("div",{style:{color:"#ccc"},children:["loading ",_.toFixed(1),"%"]});P={width:t.width*v,height:t.height*v};M.updateGroup();let D=t.transitions;return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Stage,{options:{resizeTo:"export"===g?void 0:r||window,preserveDrawingBuffer:"export"!==g,resolution:1},store:M,target:r,debug:!0,viewSize:P,env:g,callback:m.callback,children:[jsxRuntimeExports.jsx(Watermark,{size:[t.width*v,t.height*v]}),jsxRuntimeExports.jsx(ContainerElement,{trackIndex:10,store:M,scale:v,hide:!1,lock:!1,visible:!0,name:"caption",sortableChildren:!0,env:g,children:t.captions.map(e=>{var{startTime:t,duration:r}=e,i=e.id+"_"+e._dirty,r=M.currentTime>=t&&M.currentTime<=r+t,t=r?M.currentTime-t:null;return jsxRuntimeExports.jsx(CaptionText,{store:M,scale:v,hide:!1,lock:!1,dirty:e._dirty,trackIndex:1,relativeTime:t,currentTime:M.currentTime,visible:r,env:g,element:e},i)})}),jsxRuntimeExports.jsx(ContainerElement,{trackIndex:20,hide:!1,lock:!1,store:M,scale:v,visible:!0,name:"body",backgroundColor:t.background.color,env:g,sortableChildren:!0,sortChildrenUpdate:C,children:M.groups.map(d=>{let p=d[0].trackIndex,f=M.getHideLock(p)||{hide:!1,lock:!1};return jsxRuntimeExports.jsx(ContainerElement,{env:g,name:"trackIndex_"+d[0].trackIndex,trackIndex:d[0].trackIndex,store:M,hide:f.hide,lock:f.lock,placeholderGraphics:["image","video"].includes(d[0].type),visible:!0,children:d.map((t,e)=>{var{startTime:r,duration:i}=t,n=videoAvgSpeed(t),a=M.currentTime>=r&&M.currentTime<i/n+r,s=a?(M.currentTime-r)*n:null,i=M.getFrameStatus(t,s),o=(M.asyncFrameAnimateStatus(t,i),d[e+1]);let l=null,u=!1;["image","video"].includes(t.type)&&((l=D.find(e=>e.startElementId===t.id))&&o&&Math.abs(t.startTime+t.duration-o.startTime)<.01&&(u=!0),l&&o&&.01<Math.abs(t.startTime+t.duration-o.startTime)||l&&!o)&&(r=D.findIndex(e=>e.startElementId===t.id),D.splice(r,1));var c=t.id+"_"+t._dirty;switch(t.type){case"lottie":return jsxRuntimeExports.jsx(LottieEl,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,element:t},c);case"image":return jsxRuntimeExports.jsx(SpriteElement,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,hasTransition:u,nextElement:o,transitionElement:l,element:t},c);case"video":return jsxRuntimeExports.jsx(VElement$1,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,hasTransition:u,nextElement:o,transitionElement:l,element:t},c);case"audio":return jsxRuntimeExports.jsx(VElement,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,element:t},c);case"filter":return jsxRuntimeExports.jsx(LutFilterElement,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,element:t},c);case"text":return jsxRuntimeExports.jsx(TaggedTextElement,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,element:t},c);case"effect":return jsxRuntimeExports.jsx(EffectCanvas,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,element:t},c);default:if(m.plugins){var h=m.plugins.find(e=>t.type===e.type);if(h)return h=h.Element,jsxRuntimeExports.jsx(h,{hide:f.hide,lock:f.lock,store:M,scale:v,dirty:t._dirty,trackIndex:p,relativeTime:s,currentTime:M.currentTime,visible:a,env:g,hasTransition:u,nextElement:o,transitionElement:l,element:t},c)}return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}})},p)})})]}),("editor"===g||m.useRecordManager)&&jsxRuntimeExports.jsx(RecordManager,{store:M}),"editor"===g&&T&&jsxRuntimeExports.jsx(Control,{scale:v,store:M,stopControl:m.stopControl,viewSize:P,onSelectElements:m.onSelectElements,rootContainer:r,dragContainer:document.getElementById("h5dsCanvasOuter")})]})}window.EModule=EModule;let Movie$1=reactExports.forwardRef(Movie);class ResourceItem{constructor(e){this.id=createID(),this.name="",this.type="",this.url="",this.originId=void 0,this.thumb=void 0,this.styleSize=void 0,this.fileSize=void 0,this.wave=void 0,this.frames=void 0,this.noAudioTracks=void 0,this.fileType="",this.from="other",this.mustFetch=!1,this.duration=void 0,this.extend=void 0,this.attrs=void 0,Object.assign(this,e)}}var client={},m=reactDomExports,__accessCheck=(client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot,(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)}),__privateGet=(e,t,r)=>(__accessCheck(e,t,"read from private field"),r?r.call(e):t.get(e)),__privateAdd=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},__privateSet=(e,t,r,i)=>(__accessCheck(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r),__privateWrapper=(t,r,i,e)=>({set _(e){__privateSet(t,r,e,i)},get _(){return __privateGet(t,r,e)}}),__privateMethod=(e,t,r)=>(__accessCheck(e,t,"access private method"),r),bytes=new Uint8Array(8),view=new DataView(bytes.buffer),u8=e=>[(e%256+256)%256],u16=e=>(view.setUint16(0,e,!1),[bytes[0],bytes[1]]),i16=e=>(view.setInt16(0,e,!1),[bytes[0],bytes[1]]),u24=e=>(view.setUint32(0,e,!1),[bytes[1],bytes[2],bytes[3]]),u32=e=>(view.setUint32(0,e,!1),[bytes[0],bytes[1],bytes[2],bytes[3]]),i32=e=>(view.setInt32(0,e,!1),[bytes[0],bytes[1],bytes[2],bytes[3]]),u64=e=>(view.setUint32(0,Math.floor(e/2**32),!1),view.setUint32(4,e,!1),[bytes[0],bytes[1],bytes[2],bytes[3],bytes[4],bytes[5],bytes[6],bytes[7]]),fixed_8_8=e=>(view.setInt16(0,256*e,!1),[bytes[0],bytes[1]]),fixed_16_16=e=>(view.setInt32(0,65536*e,!1),[bytes[0],bytes[1],bytes[2],bytes[3]]),fixed_2_30=e=>(view.setInt32(0,2**30*e,!1),[bytes[0],bytes[1],bytes[2],bytes[3]]),ascii=(r,e=!1)=>{var t=Array(r.length).fill(null).map((e,t)=>r.charCodeAt(t));return e&&t.push(0),t},last=e=>e&&e[e.length-1],lastPresentedSample=e=>{let t=void 0;for(var r of e)(!t||r.presentationTimestamp>t.presentationTimestamp)&&(t=r);return t},intoTimescale=(e,t,r=!0)=>{e*=t;return r?Math.round(e):e},rotationMatrix=e=>{var e=e*(Math.PI/180),t=Math.cos(e),e=Math.sin(e);return[t,e,0,-e,t,0,0,0,1]},IDENTITY_MATRIX=rotationMatrix(0),matrixToBytes=e=>[fixed_16_16(e[0]),fixed_16_16(e[1]),fixed_2_30(e[2]),fixed_16_16(e[3]),fixed_16_16(e[4]),fixed_2_30(e[5]),fixed_16_16(e[6]),fixed_16_16(e[7]),fixed_2_30(e[8])],deepClone=e=>e&&("object"!=typeof e?e:Array.isArray(e)?e.map(deepClone):Object.fromEntries(Object.entries(e).map(([e,t])=>[e,deepClone(t)]))),isU32=e=>0<=e&&e<2**32,box=(e,t,r)=>({type:e,contents:t&&new Uint8Array(t.flat(10)),children:r}),fullBox=(e,t,r,i,n)=>box(e,[u8(t),u24(r),i??[]],n),ftyp=e=>e.fragmented?box("ftyp",[ascii("iso5"),u32(512),ascii("iso5"),ascii("iso6"),ascii("mp41")]):box("ftyp",[ascii("isom"),u32(512),ascii("isom"),e.holdsAvc?ascii("avc1"):[],ascii("mp41")]),mdat=e=>({type:"mdat",largeSize:e}),free=e=>({type:"free",size:e}),moov=(e,t,r=!1)=>box("moov",null,[mvhd(t,e),...e.map(e=>trak(e,t)),r?mvex(e):null]),mvhd=(e,t)=>{var r=intoTimescale(Math.max(0,...t.filter(e=>0<e.samples.length).map(e=>{e=lastPresentedSample(e.samples);return e.presentationTimestamp+e.duration})),GLOBAL_TIMESCALE),t=Math.max(...t.map(e=>e.id))+1,i=!isU32(e)||!isU32(r),n=i?u64:u32;return fullBox("mvhd",+i,0,[n(e),n(e),u32(GLOBAL_TIMESCALE),n(r),fixed_16_16(1),fixed_8_8(1),Array(10).fill(0),matrixToBytes(IDENTITY_MATRIX),Array(24).fill(0),u32(t)])},trak=(e,t)=>box("trak",null,[tkhd(e,t),mdia(e,t)]),tkhd=(e,t)=>{var r=lastPresentedSample(e.samples),r=intoTimescale(r?r.presentationTimestamp+r.duration:0,GLOBAL_TIMESCALE),i=!isU32(t)||!isU32(r),n=i?u64:u32;let a;return a="video"===e.info.type?"number"==typeof e.info.rotation?rotationMatrix(e.info.rotation):e.info.rotation:IDENTITY_MATRIX,fullBox("tkhd",+i,3,[n(t),n(t),u32(e.id),u32(0),n(r),Array(8).fill(0),u16(0),u16(0),fixed_8_8("audio"===e.info.type?1:0),u16(0),matrixToBytes(a),fixed_16_16("video"===e.info.type?e.info.width:0),fixed_16_16("video"===e.info.type?e.info.height:0)])},mdia=(e,t)=>box("mdia",null,[mdhd(e,t),hdlr("video"===e.info.type?"vide":"soun"),minf(e)]),mdhd=(e,t)=>{var r=lastPresentedSample(e.samples),r=intoTimescale(r?r.presentationTimestamp+r.duration:0,e.timescale),i=!isU32(t)||!isU32(r),n=i?u64:u32;return fullBox("mdhd",+i,0,[n(t),n(t),u32(e.timescale),n(r),u16(21956),u16(0)])},hdlr=e=>fullBox("hdlr",0,0,[ascii("mhlr"),ascii(e),u32(0),u32(0),u32(0),ascii("mp4-muxer-hdlr",!0)]),minf=e=>box("minf",null,[("video"===e.info.type?vmhd:smhd)(),dinf(),stbl(e)]),vmhd=()=>fullBox("vmhd",0,1,[u16(0),u16(0),u16(0),u16(0)]),smhd=()=>fullBox("smhd",0,0,[u16(0),u16(0)]),dinf=()=>box("dinf",null,[dref()]),dref=()=>fullBox("dref",0,0,[u32(1)],[url()]),url=()=>fullBox("url ",0,1),stbl=e=>{var t=1<e.compositionTimeOffsetTable.length||e.compositionTimeOffsetTable.some(e=>0!==e.sampleCompositionTimeOffset);return box("stbl",null,[stsd(e),stts(e),stss(e),stsc(e),stsz(e),stco(e),t?ctts(e):null])},stsd=e=>fullBox("stsd",0,0,[u32(1)],["video"===e.info.type?videoSampleDescription(VIDEO_CODEC_TO_BOX_NAME[e.info.codec],e):soundSampleDescription(AUDIO_CODEC_TO_BOX_NAME[e.info.codec],e)]),videoSampleDescription=(e,t)=>box(e,[Array(6).fill(0),u16(1),u16(0),u16(0),Array(12).fill(0),u16(t.info.width),u16(t.info.height),u32(4718592),u32(4718592),u32(0),u16(1),Array(32).fill(0),u16(24),i16(65535)],[VIDEO_CODEC_TO_CONFIGURATION_BOX[t.info.codec](t)]),avcC=e=>e.info.decoderConfig&&box("avcC",[...new Uint8Array(e.info.decoderConfig.description)]),hvcC=e=>e.info.decoderConfig&&box("hvcC",[...new Uint8Array(e.info.decoderConfig.description)]),vpcC=e=>{if(!e.info.decoderConfig)return null;var t,r,i,e=e.info.decoderConfig;if(e.colorSpace)return i=e.codec.split("."),t=Number(i[1]),r=Number(i[2]),i=(Number(i[3])<<4)+Number(e.colorSpace.fullRange),fullBox("vpcC",1,0,[u8(t),u8(r),u8(i),u8(2),u8(2),u8(2),u16(0)]);throw new Error("'colorSpace' is required in the decoder config for VP9.")},av1C=()=>box("av1C",[129,0,0,0]),soundSampleDescription=(e,t)=>box(e,[Array(6).fill(0),u16(1),u16(0),u16(0),u32(0),u16(t.info.numberOfChannels),u16(16),u16(0),u16(0),fixed_16_16(t.info.sampleRate)],[AUDIO_CODEC_TO_CONFIGURATION_BOX[t.info.codec](t)]),esds=e=>{e=new Uint8Array(e.info.decoderConfig.description);return fullBox("esds",0,0,[u32(58753152),u8(32+e.byteLength),u16(1),u8(0),u32(75530368),u8(18+e.byteLength),u8(64),u8(21),u24(0),u32(130071),u32(130071),u32(92307584),u8(e.byteLength),...e,u32(109084800),u8(1),u8(2)])},dOps=e=>{let t,r=3840,i=0;var n=null==(t=e.info.decoderConfig)?void 0:t.description;if(n){if(n.byteLength<18)throw new TypeError("Invalid decoder description provided for Opus; must be at least 18 bytes long.");n=ArrayBuffer.isView(n)?new DataView(n.buffer,n.byteOffset,n.byteLength):new DataView(n);r=n.getUint16(10,!0),i=n.getInt16(14,!0)}return box("dOps",[u8(0),u8(e.info.numberOfChannels),u16(r),u32(e.info.sampleRate),fixed_8_8(i),u8(0)])},stts=e=>fullBox("stts",0,0,[u32(e.timeToSampleTable.length),e.timeToSampleTable.map(e=>[u32(e.sampleCount),u32(e.sampleDelta)])]),stss=e=>e.samples.every(e=>"key"===e.type)?null:(e=[...e.samples.entries()].filter(([,e])=>"key"===e.type),fullBox("stss",0,0,[u32(e.length),e.map(([e])=>u32(e+1))])),stsc=e=>fullBox("stsc",0,0,[u32(e.compactlyCodedChunkTable.length),e.compactlyCodedChunkTable.map(e=>[u32(e.firstChunk),u32(e.samplesPerChunk),u32(1)])]),stsz=e=>fullBox("stsz",0,0,[u32(0),u32(e.samples.length),e.samples.map(e=>u32(e.size))]),stco=e=>0<e.finalizedChunks.length&&last(e.finalizedChunks).offset>=2**32?fullBox("co64",0,0,[u32(e.finalizedChunks.length),e.finalizedChunks.map(e=>u64(e.offset))]):fullBox("stco",0,0,[u32(e.finalizedChunks.length),e.finalizedChunks.map(e=>u32(e.offset))]),ctts=e=>fullBox("ctts",0,0,[u32(e.compositionTimeOffsetTable.length),e.compositionTimeOffsetTable.map(e=>[u32(e.sampleCount),u32(e.sampleCompositionTimeOffset)])]),mvex=e=>box("mvex",null,e.map(trex)),trex=e=>fullBox("trex",0,0,[u32(e.id),u32(1),u32(0),u32(0),u32(0)]),moof=(e,t)=>box("moof",null,[mfhd(e),...t.map(traf)]),mfhd=e=>fullBox("mfhd",0,0,[u32(e)]),fragmentSampleFlags=e=>{let t=0;var r=0,e="delta"===e.type;return r|=+e,(t|=e?1:2)<<24|r<<16|0},traf=e=>box("traf",null,[tfhd(e),tfdt(e),trun(e)]),tfhd=e=>{var t=0,t=(t|8|16|32|131072,e.currentChunk.samples[1]??e.currentChunk.samples[0]),t={duration:t.timescaleUnitsToNextSample,size:t.size,flags:fragmentSampleFlags(t)};return fullBox("tfhd",0,131128,[u32(e.id),u32(t.duration),u32(t.size),u32(t.flags)])},tfdt=e=>fullBox("tfdt",1,0,[u64(intoTimescale(e.currentChunk.startTimestamp,e.timescale))]),trun=t=>{let r=t.currentChunk.samples.map(e=>e.timescaleUnitsToNextSample),i=t.currentChunk.samples.map(e=>e.size),n=t.currentChunk.samples.map(fragmentSampleFlags),a=t.currentChunk.samples.map(e=>intoTimescale(e.presentationTimestamp-e.decodeTimestamp,t.timescale));var e=new Set(r),s=new Set(i),o=new Set(n),l=new Set(a),u=2===o.size&&n[0]!==n[1];let c=1<e.size,h=1<s.size,d=!u&&1<o.size,p=1<l.size||[...l].some(e=>0!==e);e=0,e=(e=(e=(e=(e|=1)|4*u|256*c)|512*h)|1024*d)|2048*+p;return fullBox("trun",1,e,[u32(t.currentChunk.samples.length),u32(t.currentChunk.offset-t.currentChunk.moofOffset||0),u?u32(n[0]):[],t.currentChunk.samples.map((e,t)=>[c?u32(r[t]):[],h?u32(i[t]):[],d?u32(n[t]):[],p?i32(a[t]):[]])])},mfra=e=>box("mfra",null,[...e.map(tfra),mfro()]),tfra=(t,r)=>fullBox("tfra",1,0,[u32(t.id),u32(63),u32(t.finalizedChunks.length),t.finalizedChunks.map(e=>[u64(intoTimescale(e.startTimestamp,t.timescale)),u64(e.moofOffset),u32(r+1),u32(1),u32(1)])]),mfro=()=>fullBox("mfro",0,0,[u32(0)]),VIDEO_CODEC_TO_BOX_NAME={avc:"avc1",hevc:"hvc1",vp9:"vp09",av1:"av01"},VIDEO_CODEC_TO_CONFIGURATION_BOX={avc:avcC,hevc:hvcC,vp9:vpcC,av1:av1C},AUDIO_CODEC_TO_BOX_NAME={aac:"mp4a",opus:"Opus"},AUDIO_CODEC_TO_CONFIGURATION_BOX={aac:esds,opus:dOps},Target=class{},ArrayBufferTarget=class extends Target{constructor(){super(...arguments),this.buffer=null}},StreamTarget=class extends Target{constructor(e){if(super(),"object"!=typeof(this.options=e))throw new TypeError("StreamTarget requires an options object to be passed to its constructor.");if(e.onData){if("function"!=typeof e.onData)throw new TypeError("options.onData, when provided, must be a function.");if(e.onData.length<2)throw new TypeError("options.onData, when provided, must be a function that takes in at least two arguments (data and position). Ignoring the position argument, which specifies the byte offset at which the data is to be written, can lead to broken outputs.")}if(void 0!==e.chunked&&"boolean"!=typeof e.chunked)throw new TypeError("options.chunked, when provided, must be a boolean.");if(void 0!==e.chunkSize&&(!Number.isInteger(e.chunkSize)||e.chunkSize<=0))throw new TypeError("options.chunkSize, when provided, must be a positive integer.")}},FileSystemWritableFileStreamTarget=class extends Target{constructor(e,t){if(super(),this.stream=e,this.options=t,!(e instanceof FileSystemWritableFileStream))throw new TypeError("FileSystemWritableFileStreamTarget requires a FileSystemWritableFileStream instance.");if(void 0!==t&&"object"!=typeof t)throw new TypeError("FileSystemWritableFileStreamTarget's options, when provided, must be an object.");if(t&&void 0!==t.chunkSize&&(!Number.isInteger(t.chunkSize)||t.chunkSize<=0))throw new TypeError("options.chunkSize, when provided, must be a positive integer")}},_helper,_helperView,Writer=class{constructor(){this.pos=0,__privateAdd(this,_helper,new Uint8Array(8)),__privateAdd(this,_helperView,new DataView(__privateGet(this,_helper).buffer)),this.offsets=new WeakMap}seek(e){this.pos=e}writeU32(e){__privateGet(this,_helperView).setUint32(0,e,!1),this.write(__privateGet(this,_helper).subarray(0,4))}writeU64(e){__privateGet(this,_helperView).setUint32(0,Math.floor(e/2**32),!1),__privateGet(this,_helperView).setUint32(4,e,!1),this.write(__privateGet(this,_helper).subarray(0,8))}writeAscii(t){for(let e=0;e<t.length;e++)__privateGet(this,_helperView).setUint8(e%8,t.charCodeAt(e)),e%8==7&&this.write(__privateGet(this,_helper));t.length%8!=0&&this.write(__privateGet(this,_helper).subarray(0,t.length%8))}writeBox(e){if(this.offsets.set(e,this.pos),e.contents&&!e.children)this.writeBoxHeader(e,e.size??e.contents.byteLength+8),this.write(e.contents);else{var t=this.pos;if(this.writeBoxHeader(e,0),e.contents&&this.write(e.contents),e.children)for(var r of e.children)r&&this.writeBox(r);var i=this.pos,n=e.size??i-t;this.seek(t),this.writeBoxHeader(e,n),this.seek(i)}}writeBoxHeader(e,t){this.writeU32(e.largeSize?1:t),this.writeAscii(e.type),e.largeSize&&this.writeU64(t)}measureBoxHeader(e){return 8+(e.largeSize?8:0)}patchBox(e){var t=this.pos;this.seek(this.offsets.get(e)),this.writeBox(e),this.seek(t)}measureBox(t){if(t.contents&&!t.children)return this.measureBoxHeader(t)+t.contents.byteLength;{let e=this.measureBoxHeader(t);if(t.contents&&(e+=t.contents.byteLength),t.children)for(var r of t.children)r&&(e+=this.measureBox(r));return e}}},_target,_buffer,_bytes,_maxPos,_ensureSize,ensureSize_fn,_helper=new WeakMap,_helperView=new WeakMap,ArrayBufferTargetWriter=class extends Writer{constructor(e){super(),__privateAdd(this,_ensureSize),__privateAdd(this,_target,void 0),__privateAdd(this,_buffer,new ArrayBuffer(65536)),__privateAdd(this,_bytes,new Uint8Array(__privateGet(this,_buffer))),__privateAdd(this,_maxPos,0),__privateSet(this,_target,e)}write(e){__privateMethod(this,_ensureSize,ensureSize_fn).call(this,this.pos+e.byteLength),__privateGet(this,_bytes).set(e,this.pos),this.pos+=e.byteLength,__privateSet(this,_maxPos,Math.max(__privateGet(this,_maxPos),this.pos))}finalize(){__privateMethod(this,_ensureSize,ensureSize_fn).call(this,this.pos),__privateGet(this,_target).buffer=__privateGet(this,_buffer).slice(0,Math.max(__privateGet(this,_maxPos),this.pos))}},_target2,_sections,_target=new WeakMap,_buffer=new WeakMap,_bytes=new WeakMap,_maxPos=new WeakMap,_ensureSize=new WeakSet,ensureSize_fn=function(e){let t=__privateGet(this,_buffer).byteLength;for(;t<e;)t*=2;var r,i;t!==__privateGet(this,_buffer).byteLength&&(r=new ArrayBuffer(t),(i=new Uint8Array(r)).set(__privateGet(this,_bytes),0),__privateSet(this,_buffer,r),__privateSet(this,_bytes,i))},StreamTargetWriter=class extends Writer{constructor(e){super(),__privateAdd(this,_target2,void 0),__privateAdd(this,_sections,[]),__privateSet(this,_target2,e)}write(e){__privateGet(this,_sections).push({data:e.slice(),start:this.pos}),this.pos+=e.byteLength}flush(){var e,t;if(0!==__privateGet(this,_sections).length){var r,i=[],n=[...__privateGet(this,_sections)].sort((e,t)=>e.start-t.start);i.push({start:n[0].start,size:n[0].data.byteLength});for(let e=1;e<n.length;e++){var a=i[i.length-1],s=n[e];s.start<=a.start+a.size?a.size=Math.max(a.size,s.start+s.data.byteLength-a.start):i.push({start:s.start,size:s.data.byteLength})}for(r of i){r.data=new Uint8Array(r.size);for(var o of __privateGet(this,_sections))r.start<=o.start&&o.start<r.start+r.size&&r.data.set(o.data,o.start-r.start);null!=(t=(e=__privateGet(this,_target2).options).onData)&&t.call(e,r.data,r.start)}__privateGet(this,_sections).length=0}}finalize(){}},_target2=new WeakMap,_sections=new WeakMap,DEFAULT_CHUNK_SIZE=2**24,MAX_CHUNKS_AT_ONCE=2,_target3,_chunkSize,_chunks,_writeDataIntoChunks,writeDataIntoChunks_fn,_insertSectionIntoChunk,insertSectionIntoChunk_fn,_createChunk,createChunk_fn,_flushChunks,flushChunks_fn,ChunkedStreamTargetWriter=class extends Writer{constructor(e){if(super(),__privateAdd(this,_writeDataIntoChunks),__privateAdd(this,_insertSectionIntoChunk),__privateAdd(this,_createChunk),__privateAdd(this,_flushChunks),__privateAdd(this,_target3,void 0),__privateAdd(this,_chunkSize,void 0),__privateAdd(this,_chunks,[]),__privateSet(this,_target3,e),__privateSet(this,_chunkSize,(null==(e=e.options)?void 0:e.chunkSize)??DEFAULT_CHUNK_SIZE),!Number.isInteger(__privateGet(this,_chunkSize))||__privateGet(this,_chunkSize)<1024)throw new Error("Invalid StreamTarget options: chunkSize must be an integer not smaller than 1024.")}write(e){__privateMethod(this,_writeDataIntoChunks,writeDataIntoChunks_fn).call(this,e,this.pos),__privateMethod(this,_flushChunks,flushChunks_fn).call(this),this.pos+=e.byteLength}finalize(){__privateMethod(this,_flushChunks,flushChunks_fn).call(this,!0)}},_target3=new WeakMap,_chunkSize=new WeakMap,_chunks=new WeakMap,_writeDataIntoChunks=new WeakSet,writeDataIntoChunks_fn=function(e,t){let r=__privateGet(this,_chunks).findIndex(e=>e.start<=t&&t<e.start+__privateGet(this,_chunkSize));-1===r&&(r=__privateMethod(this,_createChunk,createChunk_fn).call(this,t));var i=__privateGet(this,_chunks)[r],n=t-i.start,a=e.subarray(0,Math.min(__privateGet(this,_chunkSize)-n,e.byteLength)),n=(i.data.set(a,n),{start:n,end:n+a.byteLength});if(__privateMethod(this,_insertSectionIntoChunk,insertSectionIntoChunk_fn).call(this,i,n),0===i.written[0].start&&i.written[0].end===__privateGet(this,_chunkSize)&&(i.shouldFlush=!0),__privateGet(this,_chunks).length>MAX_CHUNKS_AT_ONCE){for(let e=0;e<__privateGet(this,_chunks).length-1;e++)__privateGet(this,_chunks)[e].shouldFlush=!0;__privateMethod(this,_flushChunks,flushChunks_fn).call(this)}a.byteLength<e.byteLength&&__privateMethod(this,_writeDataIntoChunks,writeDataIntoChunks_fn).call(this,e.subarray(a.byteLength),t+a.byteLength)},_insertSectionIntoChunk=new WeakSet,insertSectionIntoChunk_fn=function(e,t){let r=0,i=e.written.length-1,n=-1;for(;r<=i;){var a=Math.floor(r+(i-r+1)/2);e.written[a].start<=t.start?(r=a+1,n=a):i=a-1}for(e.written.splice(n+1,0,t),(-1===n||e.written[n].end<t.start)&&n++;n<e.written.length-1&&e.written[n].end>=e.written[n+1].start;)e.written[n].end=Math.max(e.written[n].end,e.written[n+1].end),e.written.splice(n+1,1)},_createChunk=new WeakSet,createChunk_fn=function(e){e={start:Math.floor(e/__privateGet(this,_chunkSize))*__privateGet(this,_chunkSize),data:new Uint8Array(__privateGet(this,_chunkSize)),written:[],shouldFlush:!1};return __privateGet(this,_chunks).push(e),__privateGet(this,_chunks).sort((e,t)=>e.start-t.start),__privateGet(this,_chunks).indexOf(e)},_flushChunks=new WeakSet,flushChunks_fn=function(t=!1){var r,i;for(let e=0;e<__privateGet(this,_chunks).length;e++){var n=__privateGet(this,_chunks)[e];if(n.shouldFlush||t){for(var a of n.written)null!=(i=(r=__privateGet(this,_target3).options).onData)&&i.call(r,n.data.subarray(a.start,a.end),n.start+a.start);__privateGet(this,_chunks).splice(e--,1)}}},FileSystemWritableFileStreamTargetWriter=class extends ChunkedStreamTargetWriter{constructor(r){var e;super(new StreamTarget({onData:(e,t)=>r.stream.write({type:"write",data:e,position:t}),chunkSize:null==(e=r.options)?void 0:e.chunkSize}))}},GLOBAL_TIMESCALE=1e3,SUPPORTED_VIDEO_CODECS=["avc","hevc","vp9","av1"],SUPPORTED_AUDIO_CODECS=["aac","opus"],TIMESTAMP_OFFSET=2082844800,FIRST_TIMESTAMP_BEHAVIORS=["strict","offset","cross-track-offset"],_options,_writer,_ftypSize,_mdat,_videoTrack,_audioTrack,_creationTime,_finalizedChunks,_nextFragmentNumber,_videoSampleQueue,_audioSampleQueue,_finalized,_validateOptions,validateOptions_fn,_writeHeader,writeHeader_fn,_computeMoovSizeUpperBound,computeMoovSizeUpperBound_fn,_prepareTracks,prepareTracks_fn,_generateMpeg4AudioSpecificConfig,generateMpeg4AudioSpecificConfig_fn,_createSampleForTrack,createSampleForTrack_fn,_addSampleToTrack,addSampleToTrack_fn,_validateTimestamp,validateTimestamp_fn,_finalizeCurrentChunk,finalizeCurrentChunk_fn,_finalizeFragment,finalizeFragment_fn,_maybeFlushStreamingTargetWriter,maybeFlushStreamingTargetWriter_fn,_ensureNotFinalized,ensureNotFinalized_fn,Muxer=class{constructor(e){var t;if(__privateAdd(this,_validateOptions),__privateAdd(this,_writeHeader),__privateAdd(this,_computeMoovSizeUpperBound),__privateAdd(this,_prepareTracks),__privateAdd(this,_generateMpeg4AudioSpecificConfig),__privateAdd(this,_createSampleForTrack),__privateAdd(this,_addSampleToTrack),__privateAdd(this,_validateTimestamp),__privateAdd(this,_finalizeCurrentChunk),__privateAdd(this,_finalizeFragment),__privateAdd(this,_maybeFlushStreamingTargetWriter),__privateAdd(this,_ensureNotFinalized),__privateAdd(this,_options,void 0),__privateAdd(this,_writer,void 0),__privateAdd(this,_ftypSize,void 0),__privateAdd(this,_mdat,void 0),__privateAdd(this,_videoTrack,null),__privateAdd(this,_audioTrack,null),__privateAdd(this,_creationTime,Math.floor(Date.now()/1e3)+TIMESTAMP_OFFSET),__privateAdd(this,_finalizedChunks,[]),__privateAdd(this,_nextFragmentNumber,1),__privateAdd(this,_videoSampleQueue,[]),__privateAdd(this,_audioSampleQueue,[]),__privateAdd(this,_finalized,!1),__privateMethod(this,_validateOptions,validateOptions_fn).call(this,e),e.video=deepClone(e.video),e.audio=deepClone(e.audio),e.fastStart=deepClone(e.fastStart),this.target=e.target,__privateSet(this,_options,{firstTimestampBehavior:"strict",...e}),e.target instanceof ArrayBufferTarget)__privateSet(this,_writer,new ArrayBufferTargetWriter(e.target));else if(e.target instanceof StreamTarget)__privateSet(this,_writer,new(null!=(t=e.target.options)&&t.chunked?ChunkedStreamTargetWriter:StreamTargetWriter)(e.target));else{if(!(e.target instanceof FileSystemWritableFileStreamTarget))throw new Error("Invalid target: "+e.target);__privateSet(this,_writer,new FileSystemWritableFileStreamTargetWriter(e.target))}__privateMethod(this,_prepareTracks,prepareTracks_fn).call(this),__privateMethod(this,_writeHeader,writeHeader_fn).call(this)}addVideoChunk(e,t,r,i){if(!(e instanceof EncodedVideoChunk))throw new TypeError("addVideoChunk's first argument (sample) must be of type EncodedVideoChunk.");if(t&&"object"!=typeof t)throw new TypeError("addVideoChunk's second argument (meta), when provided, must be an object.");if(void 0!==r&&(!Number.isFinite(r)||r<0))throw new TypeError("addVideoChunk's third argument (timestamp), when provided, must be a non-negative real number.");if(void 0!==i&&!Number.isFinite(i))throw new TypeError("addVideoChunk's fourth argument (compositionTimeOffset), when provided, must be a real number.");var n=new Uint8Array(e.byteLength);e.copyTo(n),this.addVideoChunkRaw(n,e.type,r??e.timestamp,e.duration,t,i)}addVideoChunkRaw(e,t,r,i,n,a){if(!(e instanceof Uint8Array))throw new TypeError("addVideoChunkRaw's first argument (data) must be an instance of Uint8Array.");if("key"!==t&&"delta"!==t)throw new TypeError("addVideoChunkRaw's second argument (type) must be either 'key' or 'delta'.");if(!Number.isFinite(r)||r<0)throw new TypeError("addVideoChunkRaw's third argument (timestamp) must be a non-negative real number.");if(!Number.isFinite(i)||i<0)throw new TypeError("addVideoChunkRaw's fourth argument (duration) must be a non-negative real number.");if(n&&"object"!=typeof n)throw new TypeError("addVideoChunkRaw's fifth argument (meta), when provided, must be an object.");if(void 0!==a&&!Number.isFinite(a))throw new TypeError("addVideoChunkRaw's sixth argument (compositionTimeOffset), when provided, must be a real number.");if(__privateMethod(this,_ensureNotFinalized,ensureNotFinalized_fn).call(this),!__privateGet(this,_options).video)throw new Error("No video track declared.");if("object"==typeof __privateGet(this,_options).fastStart&&__privateGet(this,_videoTrack).samples.length===__privateGet(this,_options).fastStart.expectedVideoChunks)throw new Error(`Cannot add more video chunks than specified in 'fastStart' (${__privateGet(this,_options).fastStart.expectedVideoChunks}).`);var s=__privateMethod(this,_createSampleForTrack,createSampleForTrack_fn).call(this,__privateGet(this,_videoTrack),e,t,r,i,n,a);if("fragmented"===__privateGet(this,_options).fastStart&&__privateGet(this,_audioTrack)){for(;0<__privateGet(this,_audioSampleQueue).length&&__privateGet(this,_audioSampleQueue)[0].decodeTimestamp<=s.decodeTimestamp;){var o=__privateGet(this,_audioSampleQueue).shift();__privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_audioTrack),o)}s.decodeTimestamp<=__privateGet(this,_audioTrack).lastDecodeTimestamp?__privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_videoTrack),s):__privateGet(this,_videoSampleQueue).push(s)}else __privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_videoTrack),s)}addAudioChunk(e,t,r){if(!(e instanceof EncodedAudioChunk))throw new TypeError("addAudioChunk's first argument (sample) must be of type EncodedAudioChunk.");if(t&&"object"!=typeof t)throw new TypeError("addAudioChunk's second argument (meta), when provided, must be an object.");if(void 0!==r&&(!Number.isFinite(r)||r<0))throw new TypeError("addAudioChunk's third argument (timestamp), when provided, must be a non-negative real number.");var i=new Uint8Array(e.byteLength);e.copyTo(i),this.addAudioChunkRaw(i,e.type,r??e.timestamp,e.duration,t)}addAudioChunkRaw(e,t,r,i,n){if(!(e instanceof Uint8Array))throw new TypeError("addAudioChunkRaw's first argument (data) must be an instance of Uint8Array.");if("key"!==t&&"delta"!==t)throw new TypeError("addAudioChunkRaw's second argument (type) must be either 'key' or 'delta'.");if(!Number.isFinite(r)||r<0)throw new TypeError("addAudioChunkRaw's third argument (timestamp) must be a non-negative real number.");if(!Number.isFinite(i)||i<0)throw new TypeError("addAudioChunkRaw's fourth argument (duration) must be a non-negative real number.");if(n&&"object"!=typeof n)throw new TypeError("addAudioChunkRaw's fifth argument (meta), when provided, must be an object.");if(__privateMethod(this,_ensureNotFinalized,ensureNotFinalized_fn).call(this),!__privateGet(this,_options).audio)throw new Error("No audio track declared.");if("object"==typeof __privateGet(this,_options).fastStart&&__privateGet(this,_audioTrack).samples.length===__privateGet(this,_options).fastStart.expectedAudioChunks)throw new Error(`Cannot add more audio chunks than specified in 'fastStart' (${__privateGet(this,_options).fastStart.expectedAudioChunks}).`);var a=__privateMethod(this,_createSampleForTrack,createSampleForTrack_fn).call(this,__privateGet(this,_audioTrack),e,t,r,i,n);if("fragmented"===__privateGet(this,_options).fastStart&&__privateGet(this,_videoTrack)){for(;0<__privateGet(this,_videoSampleQueue).length&&__privateGet(this,_videoSampleQueue)[0].decodeTimestamp<=a.decodeTimestamp;){var s=__privateGet(this,_videoSampleQueue).shift();__privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_videoTrack),s)}a.decodeTimestamp<=__privateGet(this,_videoTrack).lastDecodeTimestamp?__privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_audioTrack),a):__privateGet(this,_audioSampleQueue).push(a)}else __privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_audioTrack),a)}finalize(){if(__privateGet(this,_finalized))throw new Error("Cannot finalize a muxer more than once.");if("fragmented"===__privateGet(this,_options).fastStart){for(var e of __privateGet(this,_videoSampleQueue))__privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_videoTrack),e);for(var t of __privateGet(this,_audioSampleQueue))__privateMethod(this,_addSampleToTrack,addSampleToTrack_fn).call(this,__privateGet(this,_audioTrack),t);__privateMethod(this,_finalizeFragment,finalizeFragment_fn).call(this,!1)}else __privateGet(this,_videoTrack)&&__privateMethod(this,_finalizeCurrentChunk,finalizeCurrentChunk_fn).call(this,__privateGet(this,_videoTrack)),__privateGet(this,_audioTrack)&&__privateMethod(this,_finalizeCurrentChunk,finalizeCurrentChunk_fn).call(this,__privateGet(this,_audioTrack));var r,i=[__privateGet(this,_videoTrack),__privateGet(this,_audioTrack)].filter(Boolean);if("in-memory"===__privateGet(this,_options).fastStart){let t;for(let e=0;e<2;e++){var n,a=moov(i,__privateGet(this,_creationTime)),a=__privateGet(this,_writer).measureBox(a);t=__privateGet(this,_writer).measureBox(__privateGet(this,_mdat));let e=__privateGet(this,_writer).pos+a+t;for(n of __privateGet(this,_finalizedChunks)){n.offset=e;for(var{data:s}of n.samples)e+=s.byteLength,t+=s.byteLength}if(e<2**32)break;t>=2**32&&(__privateGet(this,_mdat).largeSize=!0)}var o,l=moov(i,__privateGet(this,_creationTime));__privateGet(this,_writer).writeBox(l),__privateGet(this,_mdat).size=t,__privateGet(this,_writer).writeBox(__privateGet(this,_mdat));for(o of __privateGet(this,_finalizedChunks))for(var u of o.samples)__privateGet(this,_writer).write(u.data),u.data=null}else"fragmented"===__privateGet(this,_options).fastStart?(l=__privateGet(this,_writer).pos,r=mfra(i),__privateGet(this,_writer).writeBox(r),r=__privateGet(this,_writer).pos-l,__privateGet(this,_writer).seek(__privateGet(this,_writer).pos-4),__privateGet(this,_writer).writeU32(r)):(l=__privateGet(this,_writer).offsets.get(__privateGet(this,_mdat)),r=__privateGet(this,_writer).pos-l,__privateGet(this,_mdat).size=r,__privateGet(this,_mdat).largeSize=2**32<=r,__privateGet(this,_writer).patchBox(__privateGet(this,_mdat)),r=moov(i,__privateGet(this,_creationTime)),"object"==typeof __privateGet(this,_options).fastStart?(__privateGet(this,_writer).seek(__privateGet(this,_ftypSize)),__privateGet(this,_writer).writeBox(r),l=l-__privateGet(this,_writer).pos,__privateGet(this,_writer).writeBox(free(l))):__privateGet(this,_writer).writeBox(r));__privateMethod(this,_maybeFlushStreamingTargetWriter,maybeFlushStreamingTargetWriter_fn).call(this),__privateGet(this,_writer).finalize(),__privateSet(this,_finalized,!0)}};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _options=new WeakMap,_writer=new WeakMap,_ftypSize=new WeakMap,_mdat=new WeakMap,_videoTrack=new WeakMap,_audioTrack=new WeakMap,_creationTime=new WeakMap,_finalizedChunks=new WeakMap,_nextFragmentNumber=new WeakMap,_videoSampleQueue=new WeakMap,_audioSampleQueue=new WeakMap,_finalized=new WeakMap,_validateOptions=new WeakSet,validateOptions_fn=function(e){if("object"!=typeof e)throw new TypeError("The muxer requires an options object to be passed to its constructor.");if(!(e.target instanceof Target))throw new TypeError("The target must be provided and an instance of Target.");if(e.video){if(!SUPPORTED_VIDEO_CODECS.includes(e.video.codec))throw new TypeError("Unsupported video codec: "+e.video.codec);if(!Number.isInteger(e.video.width)||e.video.width<=0)throw new TypeError(`Invalid video width: ${e.video.width}. Must be a positive integer.`);if(!Number.isInteger(e.video.height)||e.video.height<=0)throw new TypeError(`Invalid video height: ${e.video.height}. Must be a positive integer.`);var t=e.video.rotation;if("number"==typeof t&&![0,90,180,270].includes(t))throw new TypeError(`Invalid video rotation: ${t}. Has to be 0, 90, 180 or 270.`);if(Array.isArray(t)&&(9!==t.length||t.some(e=>"number"!=typeof e)))throw new TypeError("Invalid video transformation matrix: "+t.join());if(void 0!==e.video.frameRate&&(!Number.isInteger(e.video.frameRate)||e.video.frameRate<=0))throw new TypeError(`Invalid video frame rate: ${e.video.frameRate}. Must be a positive integer.`)}if(e.audio){if(!SUPPORTED_AUDIO_CODECS.includes(e.audio.codec))throw new TypeError("Unsupported audio codec: "+e.audio.codec);if(!Number.isInteger(e.audio.numberOfChannels)||e.audio.numberOfChannels<=0)throw new TypeError(`Invalid number of audio channels: ${e.audio.numberOfChannels}. Must be a positive integer.`);if(!Number.isInteger(e.audio.sampleRate)||e.audio.sampleRate<=0)throw new TypeError(`Invalid audio sample rate: ${e.audio.sampleRate}. Must be a positive integer.`)}if(e.firstTimestampBehavior&&!FIRST_TIMESTAMP_BEHAVIORS.includes(e.firstTimestampBehavior))throw new TypeError("Invalid first timestamp behavior: "+e.firstTimestampBehavior);if("object"==typeof e.fastStart){if(e.video){if(void 0===e.fastStart.expectedVideoChunks)throw new TypeError("'fastStart' is an object but is missing property 'expectedVideoChunks'.");if(!Number.isInteger(e.fastStart.expectedVideoChunks)||e.fastStart.expectedVideoChunks<0)throw new TypeError("'expectedVideoChunks' must be a non-negative integer.")}if(e.audio){if(void 0===e.fastStart.expectedAudioChunks)throw new TypeError("'fastStart' is an object but is missing property 'expectedAudioChunks'.");if(!Number.isInteger(e.fastStart.expectedAudioChunks)||e.fastStart.expectedAudioChunks<0)throw new TypeError("'expectedAudioChunks' must be a non-negative integer.")}}else if(![!1,"in-memory","fragmented"].includes(e.fastStart))throw new TypeError("'fastStart' option must be false, 'in-memory', 'fragmented' or an object.")},_writeHeader=new WeakSet,writeHeader_fn=function(){var e;__privateGet(this,_writer).writeBox(ftyp({holdsAvc:"avc"===(null==(e=__privateGet(this,_options).video)?void 0:e.codec),fragmented:"fragmented"===__privateGet(this,_options).fastStart})),__privateSet(this,_ftypSize,__privateGet(this,_writer).pos),"in-memory"===__privateGet(this,_options).fastStart?__privateSet(this,_mdat,mdat(!1)):"fragmented"!==__privateGet(this,_options).fastStart&&("object"==typeof __privateGet(this,_options).fastStart&&(e=__privateMethod(this,_computeMoovSizeUpperBound,computeMoovSizeUpperBound_fn).call(this),__privateGet(this,_writer).seek(__privateGet(this,_writer).pos+e)),__privateSet(this,_mdat,mdat(!0)),__privateGet(this,_writer).writeBox(__privateGet(this,_mdat))),__privateMethod(this,_maybeFlushStreamingTargetWriter,maybeFlushStreamingTargetWriter_fn).call(this)},_computeMoovSizeUpperBound=new WeakSet,computeMoovSizeUpperBound_fn=function(){if("object"==typeof __privateGet(this,_options).fastStart){let e=0;var t;for(t of[__privateGet(this,_options).fastStart.expectedVideoChunks,__privateGet(this,_options).fastStart.expectedAudioChunks])t&&(e=(e=(e=(e=(e+=8*Math.ceil(2/3*t))+4*t)+12*Math.ceil(2/3*t))+4*t)+8*t);return e+=4096}},_prepareTracks=new WeakSet,prepareTracks_fn=function(){var e;__privateGet(this,_options).video&&__privateSet(this,_videoTrack,{id:1,info:{type:"video",codec:__privateGet(this,_options).video.codec,width:__privateGet(this,_options).video.width,height:__privateGet(this,_options).video.height,rotation:__privateGet(this,_options).video.rotation??0,decoderConfig:null},timescale:__privateGet(this,_options).video.frameRate??57600,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]}),__privateGet(this,_options).audio&&(__privateSet(this,_audioTrack,{id:__privateGet(this,_options).video?2:1,info:{type:"audio",codec:__privateGet(this,_options).audio.codec,numberOfChannels:__privateGet(this,_options).audio.numberOfChannels,sampleRate:__privateGet(this,_options).audio.sampleRate,decoderConfig:null},timescale:__privateGet(this,_options).audio.sampleRate,samples:[],finalizedChunks:[],currentChunk:null,firstDecodeTimestamp:void 0,lastDecodeTimestamp:-1,timeToSampleTable:[],compositionTimeOffsetTable:[],lastTimescaleUnits:null,lastSample:null,compactlyCodedChunkTable:[]}),"aac"===__privateGet(this,_options).audio.codec)&&(e=__privateMethod(this,_generateMpeg4AudioSpecificConfig,generateMpeg4AudioSpecificConfig_fn).call(this,2,__privateGet(this,_options).audio.sampleRate,__privateGet(this,_options).audio.numberOfChannels),__privateGet(this,_audioTrack).info.decoderConfig={codec:__privateGet(this,_options).audio.codec,description:e,numberOfChannels:__privateGet(this,_options).audio.numberOfChannels,sampleRate:__privateGet(this,_options).audio.sampleRate})},_generateMpeg4AudioSpecificConfig=new WeakSet,generateMpeg4AudioSpecificConfig_fn=function(e,t,r){var i=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350].indexOf(t);let n="";n=(n+=e.toString(2).padStart(5,"0"))+i.toString(2).padStart(4,"0"),15===i&&(n+=t.toString(2).padStart(24,"0")),n+=r.toString(2).padStart(4,"0");var e=8*Math.ceil(n.length/8),a=(n=n.padEnd(e,"0"),new Uint8Array(n.length/8));for(let e=0;e<n.length;e+=8)a[e/8]=parseInt(n.slice(e,e+8),2);return a},_createSampleForTrack=new WeakSet,createSampleForTrack_fn=function(e,t,r,i,n,a,s){var o=i/1e6,i=(i-(s??0))/1e6,s=n/1e6,n=__privateMethod(this,_validateTimestamp,validateTimestamp_fn).call(this,o,i,e),o=n.presentationTimestamp,i=n.decodeTimestamp;return null!=a&&a.decoderConfig&&(null===e.info.decoderConfig?e.info.decoderConfig=a.decoderConfig:Object.assign(e.info.decoderConfig,a.decoderConfig)),{presentationTimestamp:o,decodeTimestamp:i,duration:s,data:t,size:t.byteLength,type:r,timescaleUnitsToNextSample:intoTimescale(s,e.timescale)}},_addSampleToTrack=new WeakSet,addSampleToTrack_fn=function(e,t){"fragmented"!==__privateGet(this,_options).fastStart&&e.samples.push(t);var r,i,n=intoTimescale(t.presentationTimestamp-t.decodeTimestamp,e.timescale);null!==e.lastTimescaleUnits?(i=intoTimescale(t.decodeTimestamp,e.timescale,!1),i=Math.round(i-e.lastTimescaleUnits),e.lastTimescaleUnits+=i,e.lastSample.timescaleUnitsToNextSample=i,"fragmented"!==__privateGet(this,_options).fastStart&&(1===(r=last(e.timeToSampleTable)).sampleCount?(r.sampleDelta=i,r.sampleCount++):r.sampleDelta===i?r.sampleCount++:(r.sampleCount--,e.timeToSampleTable.push({sampleCount:2,sampleDelta:i})),(r=last(e.compositionTimeOffsetTable)).sampleCompositionTimeOffset===n?r.sampleCount++:e.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:n}))):(e.lastTimescaleUnits=0,"fragmented"!==__privateGet(this,_options).fastStart&&(e.timeToSampleTable.push({sampleCount:1,sampleDelta:intoTimescale(t.duration,e.timescale)}),e.compositionTimeOffsetTable.push({sampleCount:1,sampleCompositionTimeOffset:n}))),e.lastSample=t;let a=!1;e.currentChunk?(i=t.presentationTimestamp-e.currentChunk.startTimestamp,"fragmented"===__privateGet(this,_options).fastStart?e===(__privateGet(this,_videoTrack)??__privateGet(this,_audioTrack))&&"key"===t.type&&1<=i&&(a=!0,__privateMethod(this,_finalizeFragment,finalizeFragment_fn).call(this)):a=.5<=i):a=!0,a&&(e.currentChunk&&__privateMethod(this,_finalizeCurrentChunk,finalizeCurrentChunk_fn).call(this,e),e.currentChunk={startTimestamp:t.presentationTimestamp,samples:[]}),e.currentChunk.samples.push(t)},_validateTimestamp=new WeakSet,validateTimestamp_fn=function(t,r,i){var n="strict"===__privateGet(this,_options).firstTimestampBehavior,a=-1===i.lastDecodeTimestamp;if(n&&a&&0!==r)throw new Error(`The first chunk for your media track must have a timestamp of 0 (received DTS=${r}).Non-zero first timestamps are often caused by directly piping frames or audio data from a MediaStreamTrack into the encoder. Their timestamps are typically relative to the age of thedocument, which is probably what you want.

If you want to offset all timestamps of a track such that the first one is zero, set firstTimestampBehavior: 'offset' in the options.
`);if("offset"===__privateGet(this,_options).firstTimestampBehavior||"cross-track-offset"===__privateGet(this,_options).firstTimestampBehavior){void 0===i.firstDecodeTimestamp&&(i.firstDecodeTimestamp=r);let e;r-=e="offset"===__privateGet(this,_options).firstTimestampBehavior?i.firstDecodeTimestamp:Math.min((null==(n=__privateGet(this,_videoTrack))?void 0:n.firstDecodeTimestamp)??1/0,(null==(a=__privateGet(this,_audioTrack))?void 0:a.firstDecodeTimestamp)??1/0),t-=e}if(r<i.lastDecodeTimestamp)throw new Error(`Timestamps must be monotonically increasing (DTS went from ${1e6*i.lastDecodeTimestamp} to ${1e6*r}).`);return{presentationTimestamp:t,decodeTimestamp:i.lastDecodeTimestamp=r}},_finalizeCurrentChunk=new WeakSet,finalizeCurrentChunk_fn=function(e){if("fragmented"===__privateGet(this,_options).fastStart)throw new Error("Can't finalize individual chunks if 'fastStart' is set to 'fragmented'.");if(e.currentChunk)if(e.finalizedChunks.push(e.currentChunk),__privateGet(this,_finalizedChunks).push(e.currentChunk),0!==e.compactlyCodedChunkTable.length&&last(e.compactlyCodedChunkTable).samplesPerChunk===e.currentChunk.samples.length||e.compactlyCodedChunkTable.push({firstChunk:e.finalizedChunks.length,samplesPerChunk:e.currentChunk.samples.length}),"in-memory"===__privateGet(this,_options).fastStart)e.currentChunk.offset=0;else{e.currentChunk.offset=__privateGet(this,_writer).pos;for(var t of e.currentChunk.samples)__privateGet(this,_writer).write(t.data),t.data=null;__privateMethod(this,_maybeFlushStreamingTargetWriter,maybeFlushStreamingTargetWriter_fn).call(this)}},_finalizeFragment=new WeakSet,finalizeFragment_fn=function(e=!0){if("fragmented"!==__privateGet(this,_options).fastStart)throw new Error("Can't finalize a fragment unless 'fastStart' is set to 'fragmented'.");var r=[__privateGet(this,_videoTrack),__privateGet(this,_audioTrack)].filter(e=>e&&e.currentChunk);if(0!==r.length){var t,i=__privateWrapper(this,_nextFragmentNumber)._++,n=(1==i&&(a=moov(r,__privateGet(this,_creationTime),!0),__privateGet(this,_writer).writeBox(a)),__privateGet(this,_writer).pos),a=moof(i,r);__privateGet(this,_writer).writeBox(a);{var s,o=mdat(!1);let e=0;for(s of r)for(var l of s.currentChunk.samples)e+=l.size;let t=__privateGet(this,_writer).measureBox(o)+e;t>=2**32&&(o.largeSize=!0,t=__privateGet(this,_writer).measureBox(o)+e),o.size=t,__privateGet(this,_writer).writeBox(o)}for(t of r){t.currentChunk.offset=__privateGet(this,_writer).pos,t.currentChunk.moofOffset=n;for(var u of t.currentChunk.samples)__privateGet(this,_writer).write(u.data),u.data=null}var c,o=__privateGet(this,_writer).pos,a=(__privateGet(this,_writer).seek(__privateGet(this,_writer).offsets.get(a)),moof(i,r));__privateGet(this,_writer).writeBox(a),__privateGet(this,_writer).seek(o);for(c of r)c.finalizedChunks.push(c.currentChunk),__privateGet(this,_finalizedChunks).push(c.currentChunk),c.currentChunk=null;e&&__privateMethod(this,_maybeFlushStreamingTargetWriter,maybeFlushStreamingTargetWriter_fn).call(this)}},_maybeFlushStreamingTargetWriter=new WeakSet,maybeFlushStreamingTargetWriter_fn=function(){__privateGet(this,_writer)instanceof StreamTargetWriter&&__privateGet(this,_writer).flush()},_ensureNotFinalized=new WeakSet,ensureNotFinalized_fn=function(){if(__privateGet(this,_finalized))throw new Error("Cannot add new video or audio chunks after the file has been finalized.")},gif={exports:{}},gifExports=(gif.exports=function i(n,a,s){function o(r,e){if(!a[r]){if(!n[r]){var t="function"==typeof commonjsRequire&&commonjsRequire;if(!e&&t)return t(r,!0);if(l)return l(r,!0);e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}t=a[r]={exports:{}};n[r][0].call(t.exports,function(e){var t=n[r][1][e];return o(t||e)},t,t.exports,i,n,a,s)}return a[r].exports}for(var l="function"==typeof commonjsRequire&&commonjsRequire,e=0;e<s.length;e++)o(s[e]);return o}({1:[function(e,t,r){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function c(e){return void 0===e}((t.exports=i).EventEmitter=i).prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,r,i,n,a,s,o;if((this._events||(this._events={}),"error"===e)&&(!this._events.error||u(this._events.error)&&!this._events.error.length))throw(o=arguments[1])instanceof Error?o:((s=new Error('Uncaught, unspecified "error" event. ('+o+")")).context=o,s);if(c(t=this._events[e]))return!1;if(l(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),t.apply(this,i)}else if(u(t))for(i=Array.prototype.slice.call(arguments,1),r=(a=t.slice()).length,n=0;n<r;n++)a[n].apply(this,i);return!0},i.prototype.on=i.prototype.addListener=function(e,t){if(l(t))return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(t=c(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&0<t&&this._events[e].length>t&&(this._events[e].warned=!0,console.trace),this;throw TypeError("listener must be a function")},i.prototype.once=function(e,t){var r;if(l(t))return r=!1,i.listener=t,this.on(e,i),this;throw TypeError("listener must be a function");function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}},i.prototype.removeListener=function(e,t){var r,i,n,a;if(!l(t))throw TypeError("listener must be a function");if(this._events&&this._events[e])if(n=(r=this._events[e]).length,i=-1,r===t||l(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(r)){for(a=n;0<a--;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,r;if(this._events)if(this._events.removeListener)if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);this.removeAllListeners("removeListener"),this._events={}}else{if(l(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);delete this._events[e]}else 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e];return this},i.prototype.listeners=function(e){e=this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[];return e},i.prototype.listenerCount=function(e){if(this._events){e=this._events[e];if(l(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){var i=navigator.userAgent.toLowerCase(),n=navigator.platform.toLowerCase(),a=i.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],s="ie"===a[1]&&document.documentMode,s={name:"version"===a[1]?a[3]:a[1],version:s||parseFloat("opera"===a[1]&&a[4]?a[4]:a[2]),platform:{name:i.match(/ip(?:ad|od|hone)/)?"ios":(i.match(/(?:webos|android)/)||n.match(/mac|win|linux/)||["other"])[0]}};s[s.name]=!0,s[s.name+parseInt(s.version,10)]=!0,s.platform[s.platform.name]=!0,t.exports=s},{}],3:[function(e,t,r){var o={}.hasOwnProperty,l=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},u=[].slice,c=e("events").EventEmitter,h=e("./browser.coffee"),e=(()=>{var n,a,e,t=s,r=c;for(e in r)o.call(r,e)&&(t[e]=r[e]);function i(){this.constructor=t}function s(e){var t,r,i;for(r in this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(e),n)i=n[r],null==(t=this.options)[r]&&(t[r]=i)}return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,a={delay:500,copy:!(n={workerScript:"gif.worker.js",workers:2,repeat:0,background:"#fff",quality:10,width:null,height:null,transparent:null,debug:!1,dither:!1})},s.prototype.setOption=function(e,t){if(this.options[e]=t,null!=this._canvas&&("width"===e||"height"===e))return this._canvas[e]=t},s.prototype.setOptions=function(e){var t,r,i=[];for(t in e)o.call(e,t)&&(r=e[t],i.push(this.setOption(t,r)));return i},s.prototype.addFrame=function(e,t){var r,i;for(i in null==t&&(t={}),(r={}).transparent=this.options.transparent,a)r[i]=t[i]||a[i];if(null==this.options.width&&this.setOption("width",e.width),null==this.options.height&&this.setOption("height",e.height),"undefined"!=typeof ImageData&&null!==ImageData&&e instanceof ImageData)r.data=e.data;else if("undefined"!=typeof CanvasRenderingContext2D&&null!==CanvasRenderingContext2D&&e instanceof CanvasRenderingContext2D||"undefined"!=typeof WebGLRenderingContext&&null!==WebGLRenderingContext&&e instanceof WebGLRenderingContext)t.copy?r.data=this.getContextData(e):r.context=e;else{if(null==e.childNodes)throw new Error("Invalid image");t.copy?r.data=this.getImageData(e):r.image=e}return this.frames.push(r)},s.prototype.render=function(){var e,t,r;if(this.running)throw new Error("Already running");if(null==this.options.width||null==this.options.height)throw new Error("Width and height must be set prior to rendering");if(this.running=!0,this.nextFrame=0,this.finishedFrames=0,this.imageParts=function(){for(var e=[],t=0,r=this.frames.length;0<=r?t<r:r<t;0<=r?++t:--t)e.push(null);return e}.call(this),t=this.spawnWorkers(),!0===this.options.globalPalette)this.renderNextFrame();else for(e=0,r=t;0<=r?e<r:r<e;0<=r?++e:--e)this.renderNextFrame();return this.emit("start"),this.emit("progress",0)},s.prototype.abort=function(){for(var e;null!=(e=this.activeWorkers.shift());)this.log("killing active worker"),e.terminate();return this.running=!1,this.emit("abort")},s.prototype.spawnWorkers=function(){var t,r,i,n=Math.min(this.options.workers,this.frames.length);return function(){r=[];for(var e=t=this.freeWorkers.length;t<=n?e<n:n<e;t<=n?e++:e--)r.push(e);return r}.apply(this).forEach((i=this,function(e){var t;return i.log("spawning worker "+e),(t=new Worker(i.options.workerScript)).onmessage=function(e){return i.activeWorkers.splice(i.activeWorkers.indexOf(t),1),i.freeWorkers.push(t),i.frameFinished(e.data)},i.freeWorkers.push(t)})),n},s.prototype.frameFinished=function(e){var t,r;if(this.log("frame "+e.index+" finished - "+this.activeWorkers.length+" active"),this.finishedFrames++,this.emit("progress",this.finishedFrames/this.frames.length),this.imageParts[e.index]=e,!0===this.options.globalPalette&&(this.options.globalPalette=e.globalPalette,this.log("global palette analyzed"),2<this.frames.length))for(t=1,r=this.freeWorkers.length;1<=r?t<r:r<t;1<=r?++t:--t)this.renderNextFrame();return 0<=l.call(this.imageParts,null)?this.renderNextFrame():this.finishRendering()},s.prototype.finishRendering=function(){for(var e,t,r,i,n,a,s,o,l,u,c,h,d=0,p=this.imageParts,f=0,m=p.length;f<m;f++)d+=((t=p[f]).data.length-1)*t.pageSize+t.cursor;for(d+=t.pageSize-t.cursor,this.log("rendering finished - filesize "+Math.round(d/1e3)+"kb"),e=new Uint8Array(d),n=l=0,s=(c=this.imageParts).length;n<s;n++)for(r=a=0,o=(h=(t=c[n]).data).length;a<o;r=++a)u=h[r],e.set(u,l),r===t.data.length-1?l+=t.cursor:l+=t.pageSize;return i=new Blob([e],{type:"image/gif"}),this.emit("finished",i,e)},s.prototype.renderNextFrame=function(){var e,t;if(0===this.freeWorkers.length)throw new Error("No free workers");if(!(this.nextFrame>=this.frames.length))return e=this.frames[this.nextFrame++],t=this.freeWorkers.shift(),e=this.getTask(e),this.log("starting frame "+(e.index+1)+" of "+this.frames.length),this.activeWorkers.push(t),t.postMessage(e)},s.prototype.getContextData=function(e){return e.getImageData(0,0,this.options.width,this.options.height).data},s.prototype.getImageData=function(e){var t;return null==this._canvas&&(this._canvas=document.createElement("canvas"),this._canvas.width=this.options.width,this._canvas.height=this.options.height),(t=this._canvas.getContext("2d")).setFill=this.options.background,t.fillRect(0,0,this.options.width,this.options.height),t.drawImage(e,0,0),this.getContextData(t)},s.prototype.getTask=function(e){var t=this.frames.indexOf(e),t={index:t,last:t===this.frames.length-1,delay:e.delay,transparent:e.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:"chrome"===h.name};if(null!=e.data)t.data=e.data;else if(null!=e.context)t.data=this.getContextData(e.context);else{if(null==e.image)throw new Error("Invalid frame");t.data=this.getImageData(e.image)}return t},s.prototype.log=function(){1<=arguments.length&&u.call(arguments,0);this.options.debug},s})();t.exports=e},{"./browser.coffee":2,events:1}]},{},[3])(3),gif.exports),_dec,_dec2,_dec3,_dec4,_dec5,_dec6,_dec7,_dec8,_dec9,_dec10,_dec11,_dec12,_dec13,_dec14,_dec15,_dec16,_dec17,_dec18,_class;let GIF=getDefaultExportFromCjs(gifExports),ERROR_RESPONSE_BODY_READER=new Error("failed to get response body reader"),ERROR_INCOMPLETED_DOWNLOAD=new Error("failed to complete download"),HeaderContentLength="Content-Length",downloadWithProgress=async(r,i)=>{var n,a=await fetch(r);let s;try{var o=parseInt(a.headers.get(HeaderContentLength)||"-1"),l=null==(n=a.body)?void 0:n.getReader();if(!l)throw ERROR_RESPONSE_BODY_READER;var u=[];let e=0;for(;;){var{done:c,value:h}=await l.read(),d=h?h.length:0;if(c){if(-1!=o&&o!==e)throw ERROR_INCOMPLETED_DOWNLOAD;i&&i({url:r,total:o,received:e,delta:d,done:c});break}u.push(h),e+=d,i&&i({url:r,total:o,received:e,delta:d,done:c})}var p,f=new Uint8Array(e);let t=0;for(p of u)f.set(p,t),t+=p.length;s=f.buffer}catch(e){s=await a.arrayBuffer(),i&&i({url:r,total:s.byteLength,received:s.byteLength,delta:0,done:!0})}return s},toBlobURL=async(e,t,r=!1,i)=>{r=r?await downloadWithProgress(e,i):await(await fetch(e)).arrayBuffer(),i=new Blob([r],{type:t});return URL.createObjectURL(i)};function _applyDecoratedDescriptor(r,i,e,t,n){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(r,i,e)||e},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(r,i,a),null):a}let win=window,loadFFmpeg=async e=>{e=e||"/assets/ffmpeg";var t=new win.FFmpegWASM.FFmpeg;t.on("log",e=>{}),await(win._ffmpegWASMInstance=t).load({coreURL:await toBlobURL(e+"/ffmpeg-core.js","text/javascript"),wasmURL:await toBlobURL(e+"/ffmpeg-core.wasm","application/wasm")})},MovieEncoding=(_dec=bindSelf,_dec2=bindSelf,_dec3=bindSelf,_dec4=bindSelf,_dec5=bindSelf,_dec6=bindSelf,_dec7=bindSelf,_dec8=bindSelf,_dec9=bindSelf,_dec10=bindSelf,_dec11=bindSelf,_dec12=bindSelf,_dec13=bindSelf,_dec14=bindSelf,_dec15=bindSelf,_dec16=bindSelf,_dec17=bindSelf,_dec18=bindSelf,_class=class MovieEncoding2{constructor(e){this._params=void 0,this._currentTime=0,this._root=null,this._movie=void 0,this._totalTime=0,this._endTime=0,this._startTime=0,this._muxer=null,this._bitrate=1e6,this._scale=1,this._encoder=void 0,this._drawFrameCount=0,this._stopDraw=!1,this._remixAudioURL="ready",this._hasEncoderAudio=!1,this._streamTarget=void 0,this._fileStream=null,this._fileHandle=null,this.cache_color="start",this.checkBlockColor=async()=>{var e=this._movie.app.renderer.context.gl,t=new Uint8Array(4),r=new Uint8Array(4),e=(e.readPixels(0,this._movie.app.view.height-1,1,1,e.RGBA,e.UNSIGNED_BYTE,t),e.readPixels(this._movie.app.view.width-1,0,1,1,e.RGBA,e.UNSIGNED_BYTE,r),await e.finish(),t.join("-")+"#"+r.join("-"));return e},this._params=e,this._init()}async _onFinish(){}get remixAudioURL(){return this._remixAudioURL}async ffmpegRun(e,t,r){for(var i,n=win._ffmpegWASMInstance;!n.loaded;)await sleep(1e3);n.on("progress",({progress:e,time:t})=>{r&&r({ratio:e,time:t})});for(i of e.files)await n.writeFile(i.name,i.data);await n.exec(e.arguments||[]);var a,s=await n.readFile(e.arguments[e.arguments.length-1]),s=new Blob([s.buffer],{type:t}),t=URL.createObjectURL(s);for(a of e.files)n.deleteFile(a.name);return t}async fetchFile(e){return fetchFile(e)}async fetchFileBuffer(e){return fetch(e).then(async e=>await e.arrayBuffer())}downURL(e,t){var r=document.createElement("a");r.style.display="none",r.href=e,r.download=t,document.body.appendChild(r),r.click()}getAllMedia(){return getAllMedia(this._params.movieData,this._movie,this._params.times)}getUsedMedia(){var e=this.getAllMedia();return 0===e.length?(this._remixAudioURL=null,this._params.onProgress&&this._params.onProgress({type:"encoderAudio",progress:1}),this._hasEncoderAudio=!0,null):e}encoderAudioFFmpegCMD(){var e=this.getUsedMedia();return e?getFFmpegAudioCMD(e,"server"):""}async encoderAudio(){var e,t=this.getUsedMedia();return t?({files:t,arguments:e}=await getFFmpegAudioCMD(t),t=await this.ffmpegRun({files:[...t],arguments:[...e]},"audio/mp3",e=>{this._params.onProgress&&this._params.onProgress({type:"encoderAudio",progress:e.ratio})}),this._remixAudioURL=t,this.encoderAudio2Video(),t):null}async encoderAudio2Video(){var e,t;"mp4"===this._params.format&&this._muxer&&(this._remixAudioURL&&(t=await this.fetchFileBuffer(this._remixAudioURL),t=await(new AudioContext).decodeAudioData(t),(e=new AudioEncoder({output:(e,t)=>this._muxer.addAudioChunk(e,t),error:e=>{}})).configure({codec:"mp4a.40.2",numberOfChannels:1,sampleRate:t.sampleRate,bitrate:128e3}),t=new AudioData({format:"f32",sampleRate:t.sampleRate,data:t.getChannelData(0),numberOfChannels:1,numberOfFrames:~~(t.sampleRate*t.duration),timestamp:~~(1e6*t.duration)}),e.encode(t),await e.flush()),this._hasEncoderAudio=!0)}async _createMuxer(){var{movieData:e,fps:t,format:r="mp4"}=this._params;if("mp4"===r){r={width:e.width*this._scale,height:e.height*this._scale,bitrate:this._bitrate};try{if("server"===this._params.env&&this._params.onShowSaveFilePicker&&this._params.onShowSaveFilePicker(),"server"===this._params.env){this._fileHandle={getFile:async()=>win.nodeFilePath()};class i{write(t){win.nodeConsole("数据块大小: "+t.data.length);var r=t.data;win.nodeConsole("数据块---------------------------\x3e",r.length,t.position);for(let e=0;e<r.length;e+=1048576){var i=r.slice(e,e+1048576);win.nodeFileStreamWrite({data:i,position:t.position+e}),win.nodeConsole("数据块已发送: "+(e/1048576+1))}}async close(){win.nodeConsole("全部数据块写入了111111111111"),await win.nodeFileStreamClose()}seek(){}truncate(){}}window.FileSystemWritableFileStream=i,this._fileStream=new i}else this._fileHandle=await win.showSaveFilePicker({suggestedName:`${this._params.movieData.title}-${createID()}.mp4`,types:[{description:"Video File",accept:{"video/mp4":[".mp4"]}}]}),this._fileStream=await this._fileHandle.createWritable();this._streamTarget=new FileSystemWritableFileStreamTarget(this._fileStream)}catch(e){return!1}e=getEffectiveAudio(e);this._muxer=new Muxer({target:this._streamTarget,video:{codec:"avc",frameRate:t,...r},audio:0<e?{codec:"aac",numberOfChannels:2,sampleRate:128e3}:void 0,fastStart:!1,firstTimestampBehavior:"offset"}),this._encoder=new VideoEncoder({output:(e,t)=>{this._muxer.addVideoChunk(e,t)},error:e=>{}}),this._encoder.configure({codec:"avc1.420034",...r})}return!0}encoderGIF(u){return new Promise(async t=>{let{gifFps:r,gifTimes:e,gifSpeed:i}=u,n=new GIF({workers:1,quality:9,workerScript:this._params.gifWorkerPath}),[a,s]=e,o=(this._currentTime=a,this._drawFrameCount=0,()=>new Promise(e=>{let t,r=new Image,i="";var n=null==(t=this._movie.app)?void 0:t.view;n&&(i=n.toDataURL("image/jpeg",.8)),r.src=i,r.onload=()=>{e(r)}})),l=(this._movie.currentTime=a,await this._movie.update(a),async()=>{var e,t;this._stopDraw||(e=this._currentTime-a,this._currentTime+=1/r*i,await this._movie.update(this._currentTime),e>s-a?(this._params.onProgress({type:"encoderVideo",progress:1}),n.render()):(t=await o(),n.addFrame(t,{delay:~~(1/r/i*1e3)}),this._params.onProgress({type:"encoderVideo",progress:e/(s-a)}),await l()))});await l(),n.on("finished",function(e){t(URL.createObjectURL(e))})})}async _init(){this._movie&&(this._movie.renderAsyncMark={}),this._hasEncoderAudio=!1,this._stopDraw=!1;let{movieData:t,onProgress:r,onReady:i,initSuccess:n,resolution:e,times:a,format:s="mp4",gifWidth:o,onEachSourceProgress:l}=this._params;if("gif"===s)this._scale=o/t.width;else{var u=geVideoSizeResolution(e,t.width+":"+t.height);if(!u)return;this._scale=u.width/t.width,this._bitrate=u.bitrate}if(a&&(this._currentTime=a[0],this._startTime=a[0],this._endTime=a[1]),await this._createMuxer()){let e=document.createElement("div");this._params.id&&(u=document.getElementById(this._params.id))&&(e=u),this._root=client.createRoot(e),this._root.render(jsxRuntimeExports.jsx(Movie$1,{scale:this._scale,ref:e=>this._movie=e,target:e,movieId:"exportMovieId",fetchSourceBeforeRender:!0,data:t,resourceHost:this._params.resourceHost,env:"export",server:"server"===this._params.env,registerId:"H5DS",times:this._params.times,workerPath:this._params.workerPath,currentTime:this._currentTime,onEachSourceProgress:l,initSuccess:n,onSourceProgress:e=>{r({type:"sourceLoad",progress:e})},callback:async()=>{r({type:"sourceLoad",progress:1}),this._movie&&(this._totalTime=this._movie.getTotalTime()||0,this._endTime||(this._endTime=this._totalTime),"mp4"===this._params.format&&(await this.encoderPoster(),"server"===this._params.env?(this._remixAudioURL="",await this.encoderAudio2Video()):this.encoderAudio()),i())}}))}}async _runEnd(){for(await this._movie.update(this._endTime),await this._encoder.flush(),this._params.onProgress({type:"encoderVideo",progress:1});!this._hasEncoderAudio;){if(this._stopDraw)return;await sleep(1e3)}this._muxer.finalize(),null!=(e=this._fileStream)&&e.close&&await this._fileStream.close(),await this._onFinish();var e=await this._fileHandle.getFile();"string"==typeof e?this._params.onFinish(e):(e=new Blob([e],{type:e.type}),e=URL.createObjectURL(e),this._params.onFinish(e))}file2Buffer(){return new Promise(async t=>{var e=await this._fileHandle.getFile();let r=new FileReader;r.onloadend=function(){var e=r.result;t(new Uint8Array(e))},r.readAsArrayBuffer(e)})}async run(){var e,t,r;this._encoder&&!this._stopDraw&&(null!=(e=this._movie.app)&&e.view?(win.stats&&win.stats.update(),e=this._currentTime,this._currentTime>=this._endTime?await this._runEnd.bind(this)():(0===this._currentTime&&(this._currentTime+=.001),await this._movie.update(this._currentTime),r=this._params.fps,this._currentTime+=1/r,t=this._drawFrameCount%25==0,r=toNum(this._drawFrameCount/r*1e6,0),r=new VideoFrame(this._movie.app.view,{timestamp:~~r}),this._encoder.encode(r,{keyFrame:t}),r.close(),this._params.onProgress({type:"encoderVideo",progress:(e-this._startTime)/(this._endTime-this._startTime)}),await this._encoder.flush(),this._drawFrameCount++,requestAnimationFrame(this.run.bind(this)))):(await sleep(10),await this.run.bind(this)()))}async encoderPoster(){var e=this._params.movieData;e.poster&&(e=await lazyImage(e.poster),e=new VideoFrame(e,{timestamp:0}),this._encoder.encode(e,{keyFrame:!0}),e.close(),await this._encoder.flush(),this._drawFrameCount=1)}destroy(){this._onFinish(),this._movie.renderAsyncMark={},this._stopDraw=!0,this._root&&(this._root.unmount(),this._root=null)}download(){}},_applyDecoratedDescriptor(_class.prototype,"_onFinish",[_dec],Object.getOwnPropertyDescriptor(_class.prototype,"_onFinish"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"ffmpegRun",[_dec2],Object.getOwnPropertyDescriptor(_class.prototype,"ffmpegRun"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"fetchFile",[_dec3],Object.getOwnPropertyDescriptor(_class.prototype,"fetchFile"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"fetchFileBuffer",[_dec4],Object.getOwnPropertyDescriptor(_class.prototype,"fetchFileBuffer"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"downURL",[_dec5],Object.getOwnPropertyDescriptor(_class.prototype,"downURL"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"getAllMedia",[_dec6],Object.getOwnPropertyDescriptor(_class.prototype,"getAllMedia"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"getUsedMedia",[_dec7],Object.getOwnPropertyDescriptor(_class.prototype,"getUsedMedia"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"encoderAudioFFmpegCMD",[_dec8],Object.getOwnPropertyDescriptor(_class.prototype,"encoderAudioFFmpegCMD"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"encoderAudio",[_dec9],Object.getOwnPropertyDescriptor(_class.prototype,"encoderAudio"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"encoderAudio2Video",[_dec10],Object.getOwnPropertyDescriptor(_class.prototype,"encoderAudio2Video"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_createMuxer",[_dec11],Object.getOwnPropertyDescriptor(_class.prototype,"_createMuxer"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"encoderGIF",[_dec12],Object.getOwnPropertyDescriptor(_class.prototype,"encoderGIF"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_init",[_dec13],Object.getOwnPropertyDescriptor(_class.prototype,"_init"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_runEnd",[_dec14],Object.getOwnPropertyDescriptor(_class.prototype,"_runEnd"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"run",[_dec15],Object.getOwnPropertyDescriptor(_class.prototype,"run"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"encoderPoster",[_dec16],Object.getOwnPropertyDescriptor(_class.prototype,"encoderPoster"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"destroy",[_dec17],Object.getOwnPropertyDescriptor(_class.prototype,"destroy"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"download",[_dec18],Object.getOwnPropertyDescriptor(_class.prototype,"download"),_class.prototype),_class);class VideoCoreSDK{constructor(e){this._params={data:null,env:"editor",movieId:"movieID",scale:1,EModuleEffectSourcePath:"/assets/effectcanvas",registerId:"",currentTime:0,plugins:[],useRecordManager:!1,stopControl:!1,workerPath:"assets"},this._root=null,this.destroy=()=>{this._root.unmount()},Object.assign(this._params,e)}init(){return new Promise(t=>{let{data:e,target:r,callback:i,registerId:n}=this._params;if(!e)return new Error("data数据为页面数据，必须传入");this._root||(this._root=client.createRoot(r)),this._root.render(jsxRuntimeExports.jsx(Canvas,{...this._params,registerId:n,callback:e=>{i&&i(e),t(e)}}))})}}function Canvas(e){let{target:t,data:r,scale:i=1,plugins:n,workerPath:a,currentTime:s,env:o,registerId:l,triggerCurrentTime:u,callback:c,movieId:h,...d}=e,[p,f]=reactExports.useState(s);return jsxRuntimeExports.jsx(Movie$1,{scale:i,data:r,movieId:h,plugins:n,env:o,registerId:l,workerPath:a+"/decode.worker.js",target:t,currentTime:p,callback:c,triggerCurrentTime:e=>{f(e),u&&u(e)},...d})}export{Movie$1 as Movie,MovieEncoding,ResourceItem,VideoCoreSDK,helper,loadFFmpeg,utils$3 as utils};